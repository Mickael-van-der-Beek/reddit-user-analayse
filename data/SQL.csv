created_utc,score,domain,id,title,author,ups,downs,num_comments,permalink,selftext,link_flair_text,over_18,thumbnail,subreddit_id,edited,link_flair_css_class,author_flair_css_class,is_self,name,url,distinguished
1354608410.0,56,class.stanford.edu,1494mj,"free online DB class from stanford, starts january",mrkurtz,57,1,21,http://www.reddit.com/r/SQL/comments/1494mj/free_online_db_class_from_stanford_starts_january/,,,False,http://a.thumbs.redditmedia.com/XWMrbx_QwjdNq4uN.jpg,t5_2qp8q,False,,,False,t3_1494mj,https://class.stanford.edu/db/Winter2013/preview/,
1376572691.0,47,udemy.com,1kezyc,Offer of *free* SSRS course for reddit readers...hopefully you will find something of use,garyk1968,52,5,16,http://www.reddit.com/r/SQL/comments/1kezyc/offer_of_free_ssrs_course_for_reddit/,,,False,http://c.thumbs.redditmedia.com/-ZwbSXWa2ZFUuUDh.jpg,t5_2qp8q,False,,,False,t3_1kezyc,https://www.udemy.com/practical-sql-reporting-with-ssrs/?couponCode=REDDITSSRS,
1371240252.0,40,youtube.com,1gcy6f,"Cringesome, Funny Blast from [MS SQL]'s Past",xilanthro,45,5,9,http://www.reddit.com/r/SQL/comments/1gcy6f/cringesome_funny_blast_from_ms_sqls_past/,,,False,http://a.thumbs.redditmedia.com/d09rXAvdBRUDRRhf.jpg,t5_2qp8q,False,,,False,t3_1gcy6f,https://www.youtube.com/watch?v=5ycx9hFGHog,
1360760072.0,40,self.SQL,18fxho,Are there any sites like Codecademy to learn sql?,rbevans,46,6,25,http://www.reddit.com/r/SQL/comments/18fxho/are_there_any_sites_like_codecademy_to_learn_sql/,For my current job I utilize SQL and I know some basic SQL usage.  I want to expand on what I know and I enjoy Codecademy's approach.,,False,self,t5_2qp8q,False,,,True,t3_18fxho,http://www.reddit.com/r/SQL/comments/18fxho/are_there_any_sites_like_codecademy_to_learn_sql/,
1346960130.0,36,stackoverflow.com,zgqgv,TIL: The Significance Of The Year 1753 In SQL,iheartreddit2,42,6,2,http://www.reddit.com/r/SQL/comments/zgqgv/til_the_significance_of_the_year_1753_in_sql/,,,False,default,t5_2qp8q,False,,,False,t3_zgqgv,http://stackoverflow.com/questions/3310569/what-is-the-significance-of-1-1-1753-in-sql-server,
1373216692.0,33,seldo.com,1ht563,In defence of SQL,lukaseder,40,7,10,http://www.reddit.com/r/SQL/comments/1ht563/in_defence_of_sql/,,,False,http://a.thumbs.redditmedia.com/z2Bn9ACkOHfoW47r.jpg,t5_2qp8q,False,,,False,t3_1ht563,http://seldo.com/weblog/2010/07/12/in_defence_of_sql,
1359642111.0,34,self.SQL,17mo1d,SQL formatter(s): best thing ever,vectaur,39,5,36,http://www.reddit.com/r/SQL/comments/17mo1d/sql_formatters_best_thing_ever/,"Saw the ""poorly written"" SQL post and made me think of this.

If you write/tweak a lot of SQL -- especially *other people's* SQL -- consider tracking down a free SQL (re)formatter.  I ""inherited"" a crapton of SQL from others at my job, with some queries pushing a couple hundred lines (tons of inline views, formulas, etc).  The formatter has changed my life.

What it does is pretty simple, just parses out the code and inserts standard/proper spacing and indentation with the commas in places you desire.  You COULD do this yourself, but wow does one of these things save time.  The change in readability is amazing; makes it MUCH easier to discern WTF the query is doing.  Plus if you use it on your own SQL, it kind of shows you some good recommendations on formatting for readability.

I've been using [this one](http://sourceforge.net/projects/fsqlf/) at work, but a quick Google search will turn up others that I'm sure are just as good.

Hope you guys find this as helpful as I did.",,False,self,t5_2qp8q,False,,,True,t3_17mo1d,http://www.reddit.com/r/SQL/comments/17mo1d/sql_formatters_best_thing_ever/,
1354126302.0,30,self.SQL,13y0bu,"When commenting out large chunks of data, I've starting using /* followed by --*/",,36,6,17,http://www.reddit.com/r/SQL/comments/13y0bu/when_commenting_out_large_chunks_of_data_ive/,"Using the -- in front of the closing comment * / provides me a lot of flexibility for uncommenting that section, as all that I have to do is add a -- in front of the starting /*.",,False,self,t5_2qp8q,False,,,True,t3_13y0bu,http://www.reddit.com/r/SQL/comments/13y0bu/when_commenting_out_large_chunks_of_data_ive/,
1375416585.0,24,self.SQL,1jjlzo,I literally only know how to write queries and get results. Where to go from here?,becausefuckuthatswhy,27,3,26,http://www.reddit.com/r/SQL/comments/1jjlzo/i_literally_only_know_how_to_write_queries_and/,"So recently got a job with a lot of adhoc reporting. I think I'm doing pretty good as far as writing queries and knowing my company's database, **but that's all I know**. I hear there are some things called ...servers...? 

The real issue I have is that I don't know what I don't know. So I guess my question is, is there an important topic I need to quickly study up on since I'm already using the db and writing queries? OR should just keep studying relational db from a broad starting point? Currently, I'm trudging my way through [SQL All-in-One For Dummies](http://www.amazon.com/SQL-All-One-For-Dummies/dp/0470929960/ref=pd_sim_b_3) and plan on doing the Stanford web course soon.
&gt;tl;dr Currently writing queries at my job, is there anything I should be aware of so I don't eff things up?",,False,self,t5_2qp8q,False,,,True,t3_1jjlzo,http://www.reddit.com/r/SQL/comments/1jjlzo/i_literally_only_know_how_to_write_queries_and/,
1316996242.0,24,db-class.org,kraof,Stanford Open Course - Introduction to Databases,b1tsh1ft,26,2,0,http://www.reddit.com/r/SQL/comments/kraof/stanford_open_course_introduction_to_databases/,,,False,http://thumbs.reddit.com/t3_kraof.png,t5_2qp8q,False,,,False,t3_kraof,http://www.db-class.org/course/auth/welcome,
1342007714.0,19,self.SQL,wdpws,Congratulations on 2000 readers /r/SQL,Quadman,26,7,10,http://www.reddit.com/r/SQL/comments/wdpws/congratulations_on_2000_readers_rsql/,"To celebrate, here is a novelty query [MSSQL].

    WITH two as (SELECT 'foo' as a UNION SELECT 'bar' )
    ,five as (SELECT 'i' as b UNION SELECT 'can' UNION SELECT 'has' UNION SELECT 'cheese' UNION SELECT 'burger')
    SELECT
    COUNT(*) as [SQL-redditors]
    FROM two as [2] ,two as [4],two as [8],two as [16],five as [80],five as [400],five as [omg]",,False,self,t5_2qp8q,False,,,True,t3_wdpws,http://www.reddit.com/r/SQL/comments/wdpws/congratulations_on_2000_readers_rsql/,
1336097744.0,21,gluecomic.blogspot.com,t66gj,"Beck, expressed in SQL code",,25,4,7,http://www.reddit.com/r/SQL/comments/t66gj/beck_expressed_in_sql_code/,,,False,http://d.thumbs.redditmedia.com/YUCw3hqcGZu28OaE.jpg,t5_2qp8q,False,,,False,t3_t66gj,http://gluecomic.blogspot.com/2012/04/beck-sql.html,
1365131084.0,20,self.SQL,1bpk48,What are some good sites to practice queries?,ITCHY_VAGINA,24,4,13,http://www.reddit.com/r/SQL/comments/1bpk48/what_are_some_good_sites_to_practice_queries/,Title says it all. Thanks everyone.,,False,self,t5_2qp8q,False,,,True,t3_1bpk48,http://www.reddit.com/r/SQL/comments/1bpk48/what_are_some_good_sites_to_practice_queries/,
1304340320.0,16,self.SQL,h27l5,What should I expect in the day to day life in a  SQL job?,notBenstar,19,3,2,http://www.reddit.com/r/SQL/comments/h27l5/what_should_i_expect_in_the_day_to_day_life_in_a/,"Hello everyone. I am seeking jobs in Sql, I spent a year and a half pretty much doing sql tuning for a non profit during my college career. Now that I've graduated, I would like to know what to expect in the business world of sql. 

*What are some major points I should make sure I have a firm grip on?

*What level of knowledge should I have in order to actually get a job?

I am currently going through the process of studying for OCA/OCP, via the SQL route of tests to further my knowledge and get certs as I go.

Any information would be greatly appreciated.

Thanks Reddit.",,False,self,t5_2qp8q,False,,,True,t3_h27l5,http://www.reddit.com/r/SQL/comments/h27l5/what_should_i_expect_in_the_day_to_day_life_in_a/,
1365943385.0,16,blog.yhathq.com,1cbmqe,7 Handy SQL Features,hernamesbarbara,23,7,1,http://www.reddit.com/r/SQL/comments/1cbmqe/7_handy_sql_features/,,,False,default,t5_2qp8q,False,,,False,t3_1cbmqe,http://blog.yhathq.com/posts/sql-for-data-scientists.html,
1363021370.0,18,i.imgur.com,1a39y1,My homework this week is on SQL. I have gotten everything right but this problem. I don't understand what I'm doing wrong!,enfinitee,21,3,19,http://www.reddit.com/r/SQL/comments/1a39y1/my_homework_this_week_is_on_sql_i_have_gotten/,,,False,http://c.thumbs.redditmedia.com/DDb50hxDBm1Du5n2.jpg,t5_2qp8q,False,,,False,t3_1a39y1,http://i.imgur.com/c5CnE2o.png,
1314380385.0,15,adminnation.com,jvbca,Friday Freebies – 10 FREE ebooks about SQL!,bran0923,18,3,4,http://www.reddit.com/r/SQL/comments/jvbca/friday_freebies_10_free_ebooks_about_sql/,,,False,http://thumbs.reddit.com/t3_jvbca.png,t5_2qp8q,False,,,False,t3_jvbca,http://www.adminnation.com/articles/friday-freebies-%e2%80%93-10-free-ebooks-about-sql/,
1347761193.0,16,self.SQL,zyc57,What is the best interactive website to learn SQL? Something equivalent to codeacademy.,LOVE_CHOCOLATE_MILK,19,3,7,http://www.reddit.com/r/SQL/comments/zyc57/what_is_the_best_interactive_website_to_learn_sql/,,,False,self,t5_2qp8q,False,,,True,t3_zyc57,http://www.reddit.com/r/SQL/comments/zyc57/what_is_the_best_interactive_website_to_learn_sql/,
1364254048.0,15,self.SQL,1b08iy,"Why use joins (inner, outer, etc)?",hbiz,18,3,59,http://www.reddit.com/r/SQL/comments/1b08iy/why_use_joins_inner_outer_etc/,"Currently in my second year degree at Uni and we have been explicitly told to not use joins, especially in our coursework. Now, today I had my first interview with a company (trying to get hired for an industry placement) and they had three questions for me, the first one using JOINS which really threw me off.

It may be because I am used to doing:

    SELECT s.studentid,s.fName,s.lName,n.ContactTelNo 
    FROM student s, nextofkin n 
    WHERE s.studentid = n.studentid and `sex` = 'm' 
    Order By lName, fName;

but using joins makes the code seem very difficult to read?

I hear its all to do with load on the server?

I appreciate anyone that can shed some light for me.

EDIT:
to be clear guys, there has been a bit of a miscommunication - we were told not to use JOINS, I feel that she meant not to use it explicitly - I'm unsure why though... perhaps it was to keep things simple? I understand whilst not saying JOIN in the query, we re still using them.",,False,self,t5_2qp8q,1364315820.0,,,True,t3_1b08iy,http://www.reddit.com/r/SQL/comments/1b08iy/why_use_joins_inner_outer_etc/,
1351622624.0,15,dpriver.com,12cng8,Instant SQL Formatter - I use this SQL formatter all the time for T-SQL and Oracle SQL. /r/SQL: What other web based tools do you find useful?,MeGustaDerp,16,1,21,http://www.reddit.com/r/SQL/comments/12cng8/instant_sql_formatter_i_use_this_sql_formatter/,,,False,default,t5_2qp8q,False,,,False,t3_12cng8,http://www.dpriver.com/pp/sqlformat.htm,
1320875886.0,16,thedailywtf.com,m6lpa,The Query of Despair - The Daily WTF,j1mcamp,18,2,10,http://www.reddit.com/r/SQL/comments/m6lpa/the_query_of_despair_the_daily_wtf/,,,False,http://d.thumbs.redditmedia.com/VfFvvGaJRsJ4wVBE.jpg,t5_2qp8q,False,,,False,t3_m6lpa,http://thedailywtf.com/Comments/The-Query-of-Despair.aspx,
1368020428.0,14,self.SQL,1dxiiv,What self learning book is best to learn SQL?,question89,16,2,25,http://www.reddit.com/r/SQL/comments/1dxiiv/what_self_learning_book_is_best_to_learn_sql/,"I want to learn this better. I think i am going to buy Sams learn SQL in 10 minute book. But wanted a second opinion first.

Ive heard its not all that hard to learn the basics of in a short amount of time. True?",,False,self,t5_2qp8q,False,,,True,t3_1dxiiv,http://www.reddit.com/r/SQL/comments/1dxiiv/what_self_learning_book_is_best_to_learn_sql/,
1348236028.0,15,i.imgur.com,108xpy,Visual guide to SQL joins.,Sofa_King_Hard,15,0,3,http://www.reddit.com/r/SQL/comments/108xpy/visual_guide_to_sql_joins/,,,False,http://e.thumbs.redditmedia.com/4TzvIX52ZP7Ebc1p.jpg,t5_2qp8q,False,,,False,t3_108xpy,http://i.imgur.com/7Ssc4.jpg,
1339036286.0,16,self.SQL,up3ug,"What is the ""best"" [MS SQL] certification or class for someone already using SQL?",BinaryMagick,18,2,14,http://www.reddit.com/r/SQL/comments/up3ug/what_is_the_best_ms_sql_certification_or_class/,"I am already a working professional using MS SQL every day, but the higher ups at my job have made it an unspoken requirement that I should have some sort of SQL certification.

I'd say I already know enough so a beginner's SQL book would bore me. Select, join, drop, update, etc. have been grokked, but the exact reason indexes work to optimize queries is still a little magical to me and following an execution plan makes my eyes glaze over. So, what I'm really looking for is a curriculum in the intermediate range. I'd prefer not to fly through an introductory class just for the pretty certificate to hang on my wall or whatever.

The company is large enough that they will pay for the classes, but not so large that they've completely thought through a set-in-stone requirement. I'm sort of blazing a trail by being the first programmer in the company to make my SQL knowledge ""official"" and I'd like to get it right.

Any suggestions?

EDIT: clarifying my current knowledge level.",,False,self,t5_2qp8q,1339036489.0,,,True,t3_up3ug,http://www.reddit.com/r/SQL/comments/up3ug/what_is_the_best_ms_sql_certification_or_class/,
1374604937.0,13,imgur.com,1iwfy6,[Help] I'm new to SQL and trying to make a list of 20 MySQL/DB2/Oracle/SQL Server commands and their differences. I need help checking it!,SupermotoChick,21,8,12,http://www.reddit.com/r/SQL/comments/1iwfy6/help_im_new_to_sql_and_trying_to_make_a_list_of/,,,False,http://f.thumbs.redditmedia.com/2Yn15dl30ObQgyQS.jpg,t5_2qp8q,False,,,False,t3_1iwfy6,http://imgur.com/a/oyEEQ#0,
1359590903.0,13,self.SQL,17lfva,[MS SQL] A poorly written query. But why?,drakefyre,13,0,31,http://www.reddit.com/r/SQL/comments/17lfva/ms_sql_a_poorly_written_query_but_why/,"OK, I have this query for an assignment out of Mannino's book that I'm working on. The query is put forward to us as being incorrect, despite the fact it returns data from the Northwind DB without any errors.

My first thought is that there are multiple joins on the same data that seem to be poorly defined, but I'm not sure my reasoning behind that is correct.

-----
    SELECT Customers.CompanyName
	, Orders.ShippedDate
	, [Order Details].UnitPrice
	, Products.ProductName
    FROM Products INNER JOIN Customers 
 	 INNER JOIN Orders ON Customers.CustomerID = Orders.CustomerID
 	 INNER JOIN [Order Details] ON Orders.OrderID = [Order Details].OrderID 
	 ON [Order Details].ProductID = [Order Details].ProductID
    Where Orders.ShippedDate Between '4/1/2008' And '4/30/2008'
	And products.productname = 'TOFU'
    Order By CompanyName

-----

The question asked is, ""Why is this incorrect?""

My answer, ""The INNER JOINS are both trying to join the same data, and the last join does not have a type specified.""

I feel like I've missed a glaringly obvious facet of the language. Is this really just about query optimization, or is it something else?

---
**EDIT** : Thank you everyone who gave input on this. I've learned more about joins from this thread than I have with my course material. Our whole IT curriculum got messed up when the state switched us to semesters from quarters. The original Intro to Databases that  I took last year did not cover anything at all regarding SQL other than its existence. It was all taught in Access. Since I got credit for the *new* Database I course, but didn't actually get a connector course to bring us all into the new curriculum I'm playing catch up along with at least 4 other people in my class. This information will help all of us immensely. You are all awesome.",,False,self,t5_2qp8q,1359616671.0,,,True,t3_17lfva,http://www.reddit.com/r/SQL/comments/17lfva/ms_sql_a_poorly_written_query_but_why/,
1359055938.0,13,sqltrainingonline.com,177fr8,Simple Trick to Copy and Paste Web Data into SQL Server,sqltrainingonline,18,5,4,http://www.reddit.com/r/SQL/comments/177fr8/simple_trick_to_copy_and_paste_web_data_into_sql/,,,False,http://d.thumbs.redditmedia.com/oaom1WULMdq0uoOK.jpg,t5_2qp8q,False,,,False,t3_177fr8,http://www.sqltrainingonline.com/simple-trick-to-copy-and-paste-web-data-into-sql-server/,
1353424501.0,13,craigkerstiens.com,13if1a,How I Write SQL,gthank,21,8,22,http://www.reddit.com/r/SQL/comments/13if1a/how_i_write_sql/,,,False,default,t5_2qp8q,False,,,False,t3_13if1a,http://craigkerstiens.com/2012/11/17/how-i-write-sql/,
1370529791.0,12,learnsomesql.com,1fsjcl,"Learn Some SQL: a ""learning by doing"" prototype for SQL",mwilliamson,16,4,3,http://www.reddit.com/r/SQL/comments/1fsjcl/learn_some_sql_a_learning_by_doing_prototype_for/,,,False,default,t5_2qp8q,False,,,False,t3_1fsjcl,http://www.learnsomesql.com/lesson/simple-selects,
1366505649.0,11,self.SQL,1crvak,Best Practice for storing email (gmail) into SQL?,jgagnon_in_FL,14,3,8,http://www.reddit.com/r/SQL/comments/1crvak/best_practice_for_storing_email_gmail_into_sql/,"Title almost says it all.  Ideally I'd like to be able to send an email to my SQL Server to either reply by sending me reports or to disable jobs etc.  I figured the easiest way to accomplish this would be to have it poll on a timed interval (every 5-10 seconds) to check for new mail on an email account, read it, and react accordingly.

If there are relatively inexpensive 3rd party tools available those are ok too.",,False,self,t5_2qp8q,False,,,True,t3_1crvak,http://www.reddit.com/r/SQL/comments/1crvak/best_practice_for_storing_email_gmail_into_sql/,
1363809211.0,13,darrenkopp.com,1aom2h,Read and write in one statement with OUTPUT,darrenkopp,15,2,5,http://www.reddit.com/r/SQL/comments/1aom2h/read_and_write_in_one_statement_with_output/,,,False,http://d.thumbs.redditmedia.com/T406pkDtXMO8Jb6c.jpg,t5_2qp8q,False,,,False,t3_1aom2h,http://darrenkopp.com/posts/2013/03/20/Read-and-Write-in-one-statement.html,
1355019337.0,10,self.SQL,14j0fb,Learning SQL for a Marketing Job,avon_barksale,12,2,24,http://www.reddit.com/r/SQL/comments/14j0fb/learning_sql_for_a_marketing_job/,"My situation--

I'm learning SQL to become a stronger candidate for a marketing job(account exec) in the online advertising space. For most jobs they mention ""SQL skills is a plus"". So, i've took it upon myself to learn SQL.

I installed MAMP, am reading through W3Schools tutorials, and writing queries via Terminal(mac). However, I just installed Sequel Pro and things are much easier. It auto-completes queries, I can save queries and just edit as need be, also I can adjust tables via GUI, overall MUCH easier than a CLI.

My question: 

What skills should I focus on to become fluent in SQL for this type of job? I'd imagine id just having to retrieve(select) data rather than create or insert data.

Can I say i'm fluent in SQL without knowing how to hand write queries via a CLI ? is using a program  like SequelPro a handicap ?

Any help would be appreciated, thank you!",,False,self,t5_2qp8q,1355019842.0,,,True,t3_14j0fb,http://www.reddit.com/r/SQL/comments/14j0fb/learning_sql_for_a_marketing_job/,
1348495023.0,13,self.SQL,10e4e7,"DBA vs. ETL. vs BI - Wait, what are all the jobs again in this field?",factory81,20,7,15,http://www.reddit.com/r/SQL/comments/10e4e7/dba_vs_etl_vs_bi_wait_what_are_all_the_jobs_again/,"Soon to be CIS college grad. I went to a PASS event this pass weekend, and got an eye opener. At least to the Microsoft world. But I am trying to wrap my head around all the jobs in this field. 

There seem to be at least these kinds of jobs I have identified

DBA's - actual server admin. Backups, maintenance, database design and optimization kind of work. 

ETL work - ETL with SSIS involving everything from .net, C#, and Java

Report builder/Analysis work - Building reports, dashboards, and enabling office workers to actually get to the data.

Consulting - I still.........dont know exactly what this is, other then a phrase that means ALL THE ABOVE kinda thing.



Anyways, can anyone help me come up with a better idea of the actual jobs in this field, like what are the actual ""career tracks"" people go down,? Or do they just expect you to know the whole SQL server stack, C#, .net, and java.


Coming from a physical infrastructure side of things, you may work in the managed service kind of things, consulting in general, you may be a network technician, you may be a vmware specialist, you may be an exchange/windows server specialist, you may try and become good in all of these fields even. But you can get a job just having a good understanding of one of these rather HUGE topics.


After leaving the PASS event I never felt more disqualified in my life for a job. As if college has left a void by not teaching me the SQL server stack, or any other stack for that matter..........

I have a class on data mining coming up with that R stats program or whatever, but that still isn't a niche, or is it?",,False,self,t5_2qp8q,1348503347.0,,,True,t3_10e4e7,http://www.reddit.com/r/SQL/comments/10e4e7/dba_vs_etl_vs_bi_wait_what_are_all_the_jobs_again/,
1343941089.0,11,self.SQL,xl0xq,How do you know data that you queried is data that you were wanting?,loki0wn,14,3,15,http://www.reddit.com/r/SQL/comments/xl0xq/how_do_you_know_data_that_you_queried_is_data/,"I had some interview questions over the last month that asked 'When you do a query, how do you know that the data that you received is what you were looking for?'.

I gave some answers about looking at methodology, comparing to past historical information, looking for anomalies, etc. but I don't think that they were sufficient. How would you answer this?",,False,self,t5_2qp8q,False,,,True,t3_xl0xq,http://www.reddit.com/r/SQL/comments/xl0xq/how_do_you_know_data_that_you_queried_is_data/,
1320451818.0,10,self.SQL,m0wwc,(DB Newb) What makes MS SQL Server worth paying for over MySQL?,lwl,12,2,19,http://www.reddit.com/r/SQL/comments/m0wwc/db_newb_what_makes_ms_sql_server_worth_paying_for/,"Considering well designed, large DBs that have high usage, what do MS SQL Server and another commercial DB systems offer that MySQL and other free systems don't? 
Is it a performance thing? security, backup, redundancy?

UPDATE: Hey, thanks a lot for some very helpful responses!",,False,self,t5_2qp8q,True,,,True,t3_m0wwc,http://www.reddit.com/r/SQL/comments/m0wwc/db_newb_what_makes_ms_sql_server_worth_paying_for/,
1317075690.0,10,self.SQL,ks9zy,Dangers of string concatenation in SQL,geofft,12,2,3,http://www.reddit.com/r/SQL/comments/ks9zy/dangers_of_string_concatenation_in_sql/,"So I had some slow code in SQL Server 2008 that I was maintaining that looked something like this:

    declare @s varchar(max)
    set @s = ''

    select @s = @s + sometable.somecolumn
    from sometable

This was massively slow for large amounts of data, so I wrote a simple User-Defined Aggregate in C# that concatentates strings using a StringBuilder.

I did some performance tests and noticed that while SQL displayed the expected O(n^2) time when repeatedly concatenating strings (due to the creation of a new string and copying the data), things got dramatically worse once the resulting string reached 500,000 chars.

Enough words, [here are the graphs](http://imgur.com/a/MRcha).

",,False,self,t5_2qp8q,False,,,True,t3_ks9zy,http://www.reddit.com/r/SQL/comments/ks9zy/dangers_of_string_concatenation_in_sql/,
1369375941.0,11,imgur.com,1eygjx,SQL noob here. What is this program?,Darrensmushbrain,13,2,28,http://www.reddit.com/r/SQL/comments/1eygjx/sql_noob_here_what_is_this_program/,,,False,http://a.thumbs.redditmedia.com/hRveVU4ZM-OVoHSN.jpg,t5_2qp8q,False,,,False,t3_1eygjx,http://imgur.com/XKzKnoN,
1368715829.0,11,self.SQL,1egbn6,I am learning SQL and having problems understanding this logic of a self join,sqllearner298,11,0,14,http://www.reddit.com/r/SQL/comments/1egbn6/i_am_learning_sql_and_having_problems/,"My books example is

Select c1.Cust_ud, c1.cust_name, c1. cust_contact
from customers as c1, customers as c2
where c1.cust_name= c2.cust_name
and c2.cust_contact= 'Jim Jones '


why dont all the results of the query just return with Jim Jones as the cust_contact?",,False,self,t5_2qp8q,False,,,True,t3_1egbn6,http://www.reddit.com/r/SQL/comments/1egbn6/i_am_learning_sql_and_having_problems/,
1357544383.0,9,self.SQL,163yxn,"New SQL based subreddit, /r/SQLOptimization!",bingostud722,16,7,11,http://www.reddit.com/r/SQL/comments/163yxn/new_sql_based_subreddit_rsqloptimization/,"Hello /r/SQL,

I have taken it upon myself to create a subreddit specifically for SQL Optimization discussion, questions, and articles. /r/SQLOptimization.  I got the idea for this tonight while I was spending hours looking at execution plans, creating indexes, and just going on an optimization spree :p.

Anyway, I literally just created it, haven't added any content YET, but wanted to throw it out there to see if there is interest. If it's ok with the mods here I'd like to steal the sidebar data, as it will be basically the same format as /r/SQL, but more focused on specifically optimizing queries, stored procedures, etc.

Any interest in this kind of thing?",,False,self,t5_2qp8q,False,,,True,t3_163yxn,http://www.reddit.com/r/SQL/comments/163yxn/new_sql_based_subreddit_rsqloptimization/,
1343329287.0,13,self.SQL,x7d0p,[Oracle and/or SQL Server] IDE's - What do you use?,sqldiaries,14,1,22,http://www.reddit.com/r/SQL/comments/x7d0p/oracle_andor_sql_server_ides_what_do_you_use/,"With the recent announcement about the acquisition of Quest Software by Dell, I'm looking for IDE/Development alternatives.

My employer currently has an unlimited Enterprise license with Quest for all of their software (which is actually quite nice), but... recent issues with Toad for Oracle and Toad for Data Analysts (not just this acquisition) have made it clear that we need other solutions.

So, what does everyone else use?

We do have some features that are ***must haves*** simply because of our daily reporting needs:

* Ability to build automated scripts to execute, export, email, etc. (#1 reason why we use TDA)

* Cross-functional ability to use with Oracle &amp; SQL Server is desired.  Note, we don't need the Heterogeneous query functionality that TDA has, as, quite frankly, it's crap and doesn't work right 99% of time (Really Quest, using MS JET as the driver?!?!)

* Large (100k+) data set support.  We regularly pull down 100k records, and have, and will again, pull 15M down.

* Relatively small memory footprint.  I develop on a crappy Dell laptop (sense a theme?!) with XP and 2GB of RAM because IT has no clue what I do and doesn't care.

So, if you've got any recommendations or other products to check out, I'd love to hear about them - I'm always interested in new software/toys.",,False,self,t5_2qp8q,False,,,True,t3_x7d0p,http://www.reddit.com/r/SQL/comments/x7d0p/oracle_andor_sql_server_ides_what_do_you_use/,
1318527681.0,12,dbainspace.com,lb1oc,DBA in Space,Eat1,14,2,3,http://www.reddit.com/r/SQL/comments/lb1oc/dba_in_space/,,,False,default,t5_2qp8q,False,,,False,t3_lb1oc,https://www.dbainspace.com/,
1317913262.0,10,self.SQL,l3115,I would like to teach myself SQL now that I have lost my job.  Any of you know a good place to learn that's online and free?,mapguy,12,2,20,http://www.reddit.com/r/SQL/comments/l3115/i_would_like_to_teach_myself_sql_now_that_i_have/,,,False,self,t5_2qp8q,False,,,True,t3_l3115,http://www.reddit.com/r/SQL/comments/l3115/i_would_like_to_teach_myself_sql_now_that_i_have/,
1312508110.0,12,self.SQL,j9f19,Interview Questions for an Entry-Level SQL Developer Job,b1tsh1ft,14,2,21,http://www.reddit.com/r/SQL/comments/j9f19/interview_questions_for_an_entrylevel_sql/,"Hey, any SQL Developers out there that have had or given interviews for a SQL Developer job? I will be interviewing soon and I was wondering if there are any pointers. The job is for an Entry-Level SQL Developer. Basically I would be creating stored procedures and general queries supporting a business application that needs constant changes and updates.

Keep in mind this is an entry-level position for someone with little experience and coming out of college. I am expected to know SQL obviously but I'm wondering what could be asked. I know little of stored procedures because I never used them in school but I am decent on general queries. Any tips, suggestions or possible questions? They are using MS-SQL but I don't think that really matters for the interview.",,False,self,t5_2qp8q,True,,,True,t3_j9f19,http://www.reddit.com/r/SQL/comments/j9f19/interview_questions_for_an_entrylevel_sql/,
1288731437.0,11,self.SQL,e08wt,Ma lost her job as an AS/400 and other mainframe report writer/data analyst.  Everyone hiring wants SQL experience.  What (free) resources are available to help her get up to speed on writing queries for SQL?,smooth_and_creamy,11,0,10,http://www.reddit.com/r/SQL/comments/e08wt/ma_lost_her_job_as_an_as400_and_other_mainframe/,"Getting her the SQL server software isn't really the challenge, I have access to most SQL server software suites.  It is more of getting a big sample set database and perhaps even some tutorials and challenge questions, like ""find how many red cars were sold on holiday weekends between 1999-2010 with at least a 7% markup.""   Something that would require her to truly apply report writing knowledge.

Any thoughts on where to start, where you started, and any lessons learned?   

I found BicycleWorks for MS SQL 2008 server but I haven't taken a look at it yet, if you have any first hand experience on if its worth my time, appreciated.

Lastly, I know third party tools (Crystal Reports, etc) may likely be used, but she should probably start with fundamental SQL knowledge first, then apply those tools as required.",,False,self,t5_2qp8q,False,,,True,t3_e08wt,http://www.reddit.com/r/SQL/comments/e08wt/ma_lost_her_job_as_an_as400_and_other_mainframe/,
1373669027.0,11,blog.metricadb.com,1i6oe1,SQL case study: Finding the most recent purchase by each customer,getmetrica,11,0,8,http://www.reddit.com/r/SQL/comments/1i6oe1/sql_case_study_finding_the_most_recent_purchase/,,,False,http://b.thumbs.redditmedia.com/rSNNrLmbmXffGi2s.jpg,t5_2qp8q,False,,,False,t3_1i6oe1,http://blog.metricadb.com/post/54735021407/finding-the-most-recent-purchase-by-each-customer-with,
1363279596.0,9,self.SQL,1aajtb,A very newbie and stupid question about SQL,,13,4,13,http://www.reddit.com/r/SQL/comments/1aajtb/a_very_newbie_and_stupid_question_about_sql/,"Hi guys, 

I know that this is a very stupid and silly question about SQL - but I have never actually used SQL in real business environments (Just Business Objects)

However I understand the structure of how SQL commands are run etc... but this is what I don't know and it's basically laughable..


Where do you type in the queries and where does the data go? 

Excel? CSV? etc? ",,False,self,t5_2qp8q,False,,,True,t3_1aajtb,http://www.reddit.com/r/SQL/comments/1aajtb/a_very_newbie_and_stupid_question_about_sql/,
1361578750.0,10,self.SQL,191x9x,How to solve this particular join (maybe it's not a join)...,mitzman,10,0,8,http://www.reddit.com/r/SQL/comments/191x9x/how_to_solve_this_particular_join_maybe_its_not_a/,"So I'm working on this report in SSRS (so this is in MS SQL obviously).  The table I'm reading from contains the following columns:

Vendor Name, Receiving Period, Amount

Now the receiving period will be in the format YYMM (i.e. 1210, 1211, etc).  There is also another table I have which will have a single column with five rows; the current period date and the 4 preceding (i.e. 1211, 1210, 1209, 1208, 1207). 

What I need to do is select from the sum from the vendor table and group it on vendor name and period which is easy

    select vendorname, period, sum(amount) from vendortable group by vendorname, period

The problem is that say that for vendor ABC, there are only rows for period 1211 and 1210, I will only get results for those periods.  I need to have rows for all 5 periods corresponding to the periods in the period table (and even better, the oldest period [in this example 1207]) will be a sum of the amount for that period and all periods prior (1206, 1205, 120,etc).  It's pretty easy to sum up the oldest period and previous ones by just doing a case in my query...

    select vendorname, case when period&lt;=@oldestperiod then @oldestperiod else period end as period, sum(amount) from vendortable group by vendorname, period

I'm still just stuck on getting rows to show a 0 sum when there's no rows for a vendor and a period in that table.  I've been picking my brain on this all day and I'm just not sure where else to look.  Any thoughts?",,False,self,t5_2qp8q,1361578943.0,,,True,t3_191x9x,http://www.reddit.com/r/SQL/comments/191x9x/how_to_solve_this_particular_join_maybe_its_not_a/,
1353286343.0,10,self.SQL,13fak2,"In a SELECT with multiple WHERE, does the order of the WHERE matter?",frescani,10,0,13,http://www.reddit.com/r/SQL/comments/13fak2/in_a_select_with_multiple_where_does_the_order_of/,"i.e. will each record be evaluated on the first WHERE, then only be passed into the 2nd if the first WHERE resolves to true?

(assume all additional WHERE are preceded with AND, as opposed to OR)

edit: a couple letters ran off somewhere",,False,self,t5_2qp8q,1353291552.0,,,True,t3_13fak2,http://www.reddit.com/r/SQL/comments/13fak2/in_a_select_with_multiple_where_does_the_order_of/,
1342848267.0,10,ledgersmbdev.blogspot.com,wwvht,Discussion:  Best practices for long queries/stored procedures,einhverfr,11,1,2,http://www.reddit.com/r/SQL/comments/wwvht/discussion_best_practices_for_long_queriesstored/,,,False,default,t5_2qp8q,False,,,False,t3_wwvht,http://ledgersmbdev.blogspot.com/2012/07/long-queries-stored-procedures.html,
1313234183.0,9,self.SQL,jhmj8,Best way to become fluent in SQL? No prior experience.,whipper515,13,4,19,http://www.reddit.com/r/SQL/comments/jhmj8/best_way_to_become_fluent_in_sql_no_prior/,"I work with a RDBMS that keeps tracks of a vast amount of equipment moving around all over the place. I don't need much knowledge with SQL to do my current role, but I've got some downtime to mess with queries and I'd like to be an SQL whiz. What's the best way of doing this? Getting a good SQL for Dummies type book or is there any online courses out there that I can take? Any insight for a noob will be greatly appreciated.  ",,False,self,t5_2qp8q,False,,,True,t3_jhmj8,http://www.reddit.com/r/SQL/comments/jhmj8/best_way_to_become_fluent_in_sql_no_prior/,
1303321847.0,9,self.SQL,gun6p,"The Biggest, Baddest SQL Query I've Ever Written (DB2)",ninjaroach,12,3,10,http://www.reddit.com/r/SQL/comments/gun6p/the_biggest_baddest_sql_query_ive_ever_written_db2/,"Our company is preparing to implement a new software package to run our web-based storefront.  The company providing the software package has asked us to provide a view they will use to import parts and equipment information from our ERP package.  Today, I finished the view and I have to say:  I nailed it.

I just learned about Common Table Expressions (CTEs) last week and now I've littered them all over the query.  I award myself extra bonus points for the recursive CTE titled ""JDECATALOG.""

So here it is, the biggest, baddest SQL query I've ever written.

WITH 

-- Start with all Item Master records
IM AS (
	SELECT RTRIM(IMLITM) AS IMLITM, IMITM, IMUOM1, IMSRP8, IMSTKT, RTRIM(IMDSC1) as IMDSC1, IMIFLA FROM HPPRDDTA.F4101
),

-- Find all Alternative Descriptions for language 'S' and combine both description fields to provide a single 60 char field

ALTDSC AS (
	SELECT IMITM, RTRIM(IMDSC1 || IMDSC2) as ""CombinedDesc"" FROM HPPRDDTA.F4101D WHERE IMLNGP = 'S'
),

-- Find distinct configurator children in Branch Plant 10

Configurator AS (
	SELECT DISTINCT KYITM FROM HPPRDDTA.F3293 WHERE KYMCU = '          10'
),

-- Find branch plant availability for parts

BPCHECK AS (
	SELECT IBITM, SUM(
		CASE 
			WHEN IBMCU = '         255' THEN 2
			WHEN IBMCU = '          20' THEN 1
			ELSE 0 
		END) AS ""BPSUM"" FROM HPPRDDTA.F4102 GROUP BY IBITM
),

-- Convert BPCHECK SUMs back into the most-preferred branch plant. Created as CTE for re-usability purposes (once in the SELECT and again in the join to SHIPPING)

BP AS (
	SELECT BPCHECK.IBITM,
	CASE
		WHEN BPCHECK.""BPSUM"" &gt; 1 THEN '         255'
		WHEN BPCHECK.""BPSUM"" = 1 THEN '          20'
		ELSE '          10'
	END AS ""BranchPlant"" FROM BPCHECK
),

-- Shipping dimensions

SHIPPING AS (
	SELECT IQITM, IQMCU, IQGWID / 100 AS ""Width"", IQGDEP / 100 AS ""Depth"", IQGHET / 100 AS ""Height"", IQGWEI / 100 AS ""Weight"" FROM HPPRDDTA.F46011
),

-- Part Replacement Message:  Pull all type ""R"" X-Ref records with AN8 = 0 and combine description with optional ""S"" and ""SS"" records

REPLACEMENTS AS (
	SELECT RTRIM(R.IVCITM) || RTRIM(COALESCE(' / ' || S.IVCITM, '')) ||RTRIM(COALESCE(' / ' || SS.IVCITM,'')) AS ""New"", R.IVLITM AS ""Old""
	FROM HPPRDDTA.F4104 R LEFT JOIN HPPRDDTA.F4104 S
		ON S.IVAN8 = 0 AND S.IVXRT = 'S' AND R.IVLITM = S.IVLITM
	LEFT JOIN HPPRDDTA.F4104 SS
		ON SS.IVAN8 = 0 AND SS.IVXRT = 'SS' AND R.IVLITM = SS.IVLITM
	WHERE R.IVAN8 = 0 AND R.IVXRT = 'R'
),

-- Recursively build JDE Catalog Hierarchy, cast empty string selection criteria to NULL

JDECATALOG (ID, PARENT, CATEGORY, CATFIELD, CATCODE, LEVEL) AS (
	SELECT IHUKID AS ""ID"", IHPUKID AS ""PARENT"", IHDL01 AS ""CATEGORY"", CASE WHEN IHDTAI = '' THEN NULL ELSE IHDTAI END AS ""CATFIELD"", CASE WHEN IHKY = '' THEN NULL ELSE IHKY END AS ""CATCODE"", 1 AS ""LEVEL""
	FROM HPPRDDTA.F4101H ROOT
	WHERE IHPUKID = 0

	UNION ALL

	SELECT CHILD.IHUKID AS ""ID"", IHPUKID AS ""PARENT"", IHDL01 AS ""CATEGORY"", CASE WHEN IHDTAI = '' THEN NULL ELSE IHDTAI END AS ""CATFIELD"", CASE WHEN IHKY = '' THEN NULL ELSE IHKY END AS ""CATCODE"", ROOT.LEVEL +1 AS ""LEVEL""
	FROM JDECATALOG ROOT INNER JOIN HPPRDDTA.F4101H CHILD ON CHILD.IHPUKID = ROOT.ID
),

-- Self-Join 5 copies of JDECATALOG to build ""Online Catalog"" + 5 columns of ""Categories"".  Use Coalesce to grab the right-most Item Master Selection Criteria

CATEGORIES AS (
	SELECT 'Online Catalog' AS ""CATALOG"", ""1"".CATEGORY AS ""CATEGORY1"", ""2"".CATEGORY AS ""CATEGORY2"", ""3"".CATEGORY AS ""CATEGORY3"", ""4"".CATEGORY AS ""CATEGORY4"", ""5"".CATEGORY AS ""CATEGORY5"", COALESCE(""5"".CATFIELD, ""4"".CATFIELD, ""3"".CATFIELD, ""2"".CATFIELD, ""1"".CATFIELD) AS ""CATFIELD"", COALESCE(""5"".CATCODE, ""4"".CATCODE, ""3"".CATCODE, ""2"".CATCODE, ""1"".CATCODE) AS ""CATCODE""
	FROM JDECATALOG ""1"" INNER JOIN JDECATALOG ""2"" ON ""1"".LEVEL = 1 AND ""2"".LEVEL = 2 AND ""2"".PARENT = ""1"".ID
	LEFT JOIN JDECATALOG ""3"" ON ""3"".LEVEL = 3 AND ""3"".PARENT = ""2"".ID
	LEFT JOIN JDECATALOG ""4"" ON ""4"".LEVEL = 4 AND ""4"".PARENT = ""3"".ID
	LEFT JOIN JDECATALOG ""5"" ON ""5"".LEVEL = 5 AND ""5"".PARENT = ""4"".ID
),

-- Return (perhaps duplicate) Item Master records with category information based on selection criteria defined in CATEGORIES CTE

ITEMCATEGORIES AS (
	SELECT IMITM, CATEGORIES.CATALOG, CATEGORIES.CATEGORY1, CATEGORIES.CATEGORY2, CATEGORIES.CATEGORY3, CATEGORIES.CATEGORY4, CATEGORIES.CATEGORY5 FROM HPPRDDTA.F4101 IMCATS INNER JOIN CATEGORIES ON CATEGORIES.CATFIELD = 'SRP1' AND IMCATS.IMSRP1 = CATEGORIES.CATCODE
),

-- Grab ""Flash Message"" UDC codes

FLASH AS (
	SELECT LTRIM(DRKY) AS DRKY, RTRIM(DRDL01) AS DRDL01 FROM HPCOM.F0005 WHERE DRSY = '40' AND DRRT = 'FL' AND DRKY != ''
)

 SELECT 

 IM.IMLITM,

 IM.IMITM, 

 IM.IMUOM1, 

 CAST('2010-01-01' as DATE) as ""EffectiveFrom"",

 CAST('2020-01-01' as DATE) as ""EffectiveThrough"",

 SHIPPING.""Weight"" as ""Weight"",

 SHIPPING.""Width"" as ""Width"",

 SHIPPING.""Height"" as ""Height"",

 SHIPPING.""Depth"" as ""Depth"",

 CASE

 	WHEN IM.IMSRP8 =  'E' THEN 1

 	ELSE 0

 END as ""Order Online"",

 '' as ""ThumbnailImg"",

 '' as ""ActualPicture"",

 0 as ""BasePrice"",

 '' as ""ExcelFile"",

 '' as ""WordFile"",

 '' as ""PDFFile"",

 '' as ""PPTFile"",

 IM.IMSTKT,

 0 as ""MinQty"",

 COALESCE(ALTDSC.""CombinedDesc"", IM.IMDSC1) as ""ShortDescription"",

 '' as ""Long Description"",

 '' as ""Specs"",

 '' as ""Features"",

 FLASH.DRDL01 as ""Desc1"",

 'This item has been replaced by '||REPLACEMENTS.""New"" as ""Desc2"", -- Item Replacement Messages

 '' as ""Desc3"",

 '' as ""Desc4"",

 '' as ""Desc5"",

 '' as ""MetaKeywords"",

 '' as ""MetaDescription"",

 '' as ""MetaTitle"",
 BP.""BranchPlant"" as ""BranchPlant"",

 ITEMCATEGORIES.CATALOG as ""Catalog"",

 ITEMCATEGORIES.CATEGORY1 as ""Category1"",

 ITEMCATEGORIES.CATEGORY2 as ""Category2"",

 ITEMCATEGORIES.CATEGORY3 as ""Category3"",

 ITEMCATEGORIES.CATEGORY4 as ""Category4"",

 ITEMCATEGORIES.CATEGORY5 as ""Category5""

 FROM 

 IM LEFT JOIN Configurator ON Configurator.KYITM = IM.IMITM

 LEFT JOIN ALTDSC ON IM.IMITM = ALTDSC.IMITM

 LEFT JOIN BP ON IM.IMITM = BP.IBITM

 LEFT JOIN SHIPPING ON IM.IMITM = SHIPPING.IQITM AND BP.""BranchPlant"" = SHIPPING.IQMCU

 LEFT JOIN REPLACEMENTS ON IM.IMLITM = REPLACEMENTS.""Old""

 LEFT JOIN FLASH ON IM.IMIFLA = FLASH.DRKY

 LEFT JOIN ITEMCATEGORIES ON IM.IMITM = ITEMCATEGORIES.IMITM -- This is the only JOIN that should ever 
have the chance to produce multiple matches
 
 WHERE

(IM.IMSRP8 = 'E' OR IM.IMSRP8 = 'SO' OR Configurator.KYITM IS NOT NULL)
",,False,self,t5_2qp8q,False,,,True,t3_gun6p,http://www.reddit.com/r/SQL/comments/gun6p/the_biggest_baddest_sql_query_ive_ever_written_db2/,
1374255333.0,9,mherman.org,1in6rc,Cohort Analysis: Data Sourcing With SQL,michaelherman,10,1,0,http://www.reddit.com/r/SQL/comments/1in6rc/cohort_analysis_data_sourcing_with_sql/,,,False,http://a.thumbs.redditmedia.com/21M7Aj9gqIQUS76T.jpg,t5_2qp8q,False,,,False,t3_1in6rc,http://mherman.org/blog/2013/07/19/cohort-analysis-data-sourcing-with-sql/,
1368396984.0,9,self.SQL,1e7gu3,Why can't UPDATE statements be reverted?,Xolom,15,6,39,http://www.reddit.com/r/SQL/comments/1e7gu3/why_cant_update_statements_be_reverted/,"I screwed up a query at work and wiped out a whole bunch of data with an update statement. There are backups, but I'm still in trouble.
Why can't an update be easily reversed?

This is on SQL Server 2008 and SQL has been around for decades - is there a structural reason why queries can't be revered or a change history instituted? I don't expect Ctrl+Z, though it would be nice. Major companies use this software - how can so much data be permanently destroyed by such a simple mistake?

Also, how common is it for an UPDATE statement to go haywire (or DELETE, or a table to be dropped, etc.)? What are the professional practices for when these mistakes occur? Any DBAs here that can chime in?",,False,self,t5_2qp8q,False,,,True,t3_1e7gu3,http://www.reddit.com/r/SQL/comments/1e7gu3/why_cant_update_statements_be_reverted/,
1366417258.0,9,self.SQL,1cplgq,"My friends are getting married, and I want to gift them a SQL statement. Help!",BidipBoo,16,7,14,http://www.reddit.com/r/SQL/comments/1cplgq/my_friends_are_getting_married_and_i_want_to_gift/,"Hi folks,

I'm not much of a coder, but two of my friends (huge techies) are getting hitched next week, and I want to get them a special gift. I am going to get a piece of code referencing them done in nice calligraphy and framed.

I figured that maybe a SQL join would be fun, but am unsure whether what I pulled outta my ass was anything close to 'legit'. Any edits/ critiques would be greatly appreciated!

Here's what I got:

SELECT Beth.Smith FROM tbl.Brides, 
Dave.Williams FROM tbl.Grooms 
JOIN Wedding ON 
Wedding.Date = '2013-04-27'",,False,self,t5_2qp8q,False,,,True,t3_1cplgq,http://www.reddit.com/r/SQL/comments/1cplgq/my_friends_are_getting_married_and_i_want_to_gift/,
1364342088.0,9,self.SQL,1b2rrt,MS SQL Management Studio collapse tree by pressing left arrow,lews0r,11,2,10,http://www.reddit.com/r/SQL/comments/1b2rrt/ms_sql_management_studio_collapse_tree_by/,"Hey folks, in my work we have a few databases that have an ever growing list of stored procedures. When viewing these in SQL Management studio by expanding the stored procedure folder it can make the tree view look a little wild. I know you can filter the list down but - as an example - filtering by the word report will still return a hefty number of results in my case. If anyone finds themselves in a similar scenario you can press the left arrow which will collapse whatever part of the tree you currently have highlighted.

I think this is just a default OS action which works in windows explorer and anywhere else you have a tree structure but when working between several databases I find this simple little shortcut to be all kinds of awesome and saves me having to do a lot of scrolling :-)",,False,self,t5_2qp8q,False,,,True,t3_1b2rrt,http://www.reddit.com/r/SQL/comments/1b2rrt/ms_sql_management_studio_collapse_tree_by/,
1357316599.0,7,self.SQL,15yf3w,[LINUX] Help with Database ETL process.,IceMenthols,10,3,6,http://www.reddit.com/r/SQL/comments/15yf3w/linux_help_with_database_etl_process/,"As someone that primarily uses Microsoft products and relies heavily on SSIS for ETL to get data from files and databases, cleanse the data and insert into databases I'm curious to learn how this task is performed on Linux/Unix.

When dealing with 'dirty' files (is there a term for these?) that are outside the scope of the included transformations then .net scripts can normally provide a stop-gap but how is this performed in Linux/Unix? 

Are scripting languages used primarily? reg-ex? is the file first processed by a script to get it into a usable state then processed by the database client?

For example, how would one go about cleansing, say a .csv file that had 4 lines of crap text at the top of the file, or parsing a log file and ensure the time also has the date, etc.

I know this is a very open ended question but I'm very new to this and your input/perspective would be welcomed. Many thanks.",,False,self,t5_2qp8q,False,,,True,t3_15yf3w,http://www.reddit.com/r/SQL/comments/15yf3w/linux_help_with_database_etl_process/,
1348233499.0,11,self.SQL,108vrc,Can this query be more efficient?  Get all users' names and their highest price order if any.,not_a_temp_account,12,1,12,http://www.reddit.com/r/SQL/comments/108vrc/can_this_query_be_more_efficient_get_all_users/,"I think my query performs a pretty common need so I imagine that there's a better way to do this.  I want to find ALL the people in my customers table (whether or not they've ever placed an order).  If they HAVE placed an order, I want to mention the description and price from their highest price order.



I already have an answer.  This query will work:



SELECT DISTINCT cust.full_name, od1.order_price, od1.description

FROM customers cust

LEFT JOIN orders od1 ON od1.cust_id = cust.id 

WHERE order_price= 

		     (SELECT max(order_price) 

		     FROM orders od2 

		     WHERE od1.cust_id = od2.cust_id) 

OR order_price is null;



But I can't help but feel that there's an easier way to do this, maybe without a sub-query, that would be more efficient.

Thanks for any help.",,False,self,t5_2qp8q,False,,,True,t3_108vrc,http://www.reddit.com/r/SQL/comments/108vrc/can_this_query_be_more_efficient_get_all_users/,
1341989193.0,8,self.SQL,wdh6m,Think Before You Hit 'Execute',LepcisMagna,11,3,10,http://www.reddit.com/r/SQL/comments/wdh6m/think_before_you_hit_execute/,"I am new to learning SQL (and to Reddit), but so far I have been able to gain a moderate understanding of it and am fairly well-versed in set theory (hooray for being a math major).  Happily, I haven't made any big mistakes while working at my job at the IT department - until today.  At my college, we have a POWERCampus/Microsoft T-SQL Server database, and since we don't have a computer science degree, the number of people willing and able to learn SQL are few and far between.  I was working on making a new applet to recalculate the GPA of students in the database, and was using a stored procedure given to us by SunGard to test it.  One of the 'features' of this stored procedure is that if you don't provide an argument, it recalculates the GPA for everyone in the database, which, as you might imagine, takes quite some time - especially when there are hundreds of thousands of students.  As I was working on testing the results of my applet against the stored procedure results, I accidentally ran this stored procedure without an argument and in the Live database.  I stopped it immediately, because I hadn't meant to do either of those things.  I looked at what records it had already processed, and was about to fix them when I remembered that this stored procedure, to save time, deletes all of the contents of the transcript GPA table before calculating individual GPAs (this was one of several reasons for rewriting the stored procedure).  Not thirty seconds later, we get an email from a student complaining that their GPA doesn't show up in their online transcript.  I tell you, people are clairvoyant when it comes to things going wrong.  

tl:dr - I deleted all the student GPA records because of a badly thought out stored procedure and a giant 'D'oh' moment on my part.",,False,self,t5_2qp8q,False,,,True,t3_wdh6m,http://www.reddit.com/r/SQL/comments/wdh6m/think_before_you_hit_execute/,
1339827123.0,7,self.SQL,v4p20,"Job Interview 
Basic knowledge in SQL server is a plus",ween101,10,3,10,http://www.reddit.com/r/SQL/comments/v4p20/job_interview_basic_knowledge_in_sql_server_is_a/,"Its been a few years since I have done anything with SQL server. I'm sure I could pick it up again pretty easily. I was seeing if anyone could offer any tips that I might be able to help me bullshit my way through any questions or direct me to any sites that offers a crash course. I really need this job or my mom will  kick me out of the basement and has threaten to stop doing my laundry 

Thanks in advance ",,False,self,t5_2qp8q,False,,,True,t3_v4p20,http://www.reddit.com/r/SQL/comments/v4p20/job_interview_basic_knowledge_in_sql_server_is_a/,
1332635270.0,9,en.wikipedia.org,rc2eq,[ANSI] Help me expand the SQL:2011 article on Wikipedia,ysangkok,9,0,1,http://www.reddit.com/r/SQL/comments/rc2eq/ansi_help_me_expand_the_sql2011_article_on/,,,False,default,t5_2qp8q,False,,,False,t3_rc2eq,http://en.wikipedia.org/wiki/SQL:2011,
1330055520.0,9,self.SQL,q3kr3,SQL 2005 Need help returning NULL values,,10,1,3,http://www.reddit.com/r/SQL/comments/q3kr3/sql_2005_need_help_returning_null_values/,"Hi, I am trying to write a query and could use some help.  I figure I need two select join statements with a union but cannot get the output I want based off a simpler example:
 
Table 1
Column 1a           
2
4
7
8

Column 1b
22-Feb-2012
13-Jan-2012
05-Jan-2012
18-Dec-2011
 
Table 2
Column 2a
1
2
3
4
5
6
7
8
9
 
I am trying to write a query which would return the values for Column 1b and Column 2a where Column 1a = Column 2a.  However, I would want it to return Null values for the empty Column 1b.  Any ideas?",,False,self,t5_2qp8q,False,,,True,t3_q3kr3,http://www.reddit.com/r/SQL/comments/q3kr3/sql_2005_need_help_returning_null_values/,
1328723355.0,10,self.SQL,pghx0,Fun Fact:  The T-SQL LEN() function for determining the length of the string does not count trailing spaces.,hypo11,12,2,11,http://www.reddit.com/r/SQL/comments/pghx0/fun_fact_the_tsql_len_function_for_determining/,"Today I Learned: The SQL LEN() function (to determine the length of the string) does NOT include trailing spaces.  It DOES include leading spaces and spaces between non-space characters:

    SELECT LEN('hi') = 2  
    SELECT LEN('hi ') = 2!  
    SELECT LEN(' hi') = 3  
    SELECT LEN('hi 1') = 4  
    SELECT LEN('hi 1 ') = 4!  

Heads up for anyone who uses this function.
",,False,self,t5_2qp8q,False,,,True,t3_pghx0,http://www.reddit.com/r/SQL/comments/pghx0/fun_fact_the_tsql_len_function_for_determining/,
1324138383.0,9,self.SQL,ngeop,New /r/SQL Moderators! Huzzah!,,10,1,2,http://www.reddit.com/r/SQL/comments/ngeop/new_rsql_moderators_huzzah/,"Please welcome your new moderators:
## [hypo11](http://www.reddit.com/user/hypo11) 

and 

##[mgdmw](http://www.reddit.com/user/mgdmw)

Both are active and well-karmaed posters and commenters with what I feel is a good sense of community. Do right by each other, reader, subscriber, and moderator, and /r/SQL will thrive and be a source of joy to all!",,False,self,t5_2qp8q,False,,,True,t3_ngeop,http://www.reddit.com/r/SQL/comments/ngeop/new_rsql_moderators_huzzah/,moderator
1324093399.0,9,self.SQL,nfz9c,/r/sql moderator stepping down. Long live the new moderator!,,9,0,3,http://www.reddit.com/r/SQL/comments/nfz9c/rsql_moderator_stepping_down_long_live_the_new/,"I started this subreddit because I had an interest in SQL and database programming in general, but I barely even read it anymore. I'll pass on the torch, and someone else take over. Anyone have any interest? Message me, and I'll let the community decide.",,False,self,t5_2qp8q,False,,,True,t3_nfz9c,http://www.reddit.com/r/SQL/comments/nfz9c/rsql_moderator_stepping_down_long_live_the_new/,moderator
1320242093.0,10,self.SQL,lxoaf,Learning to write better queries,ElvisLikeBear,11,1,13,http://www.reddit.com/r/SQL/comments/lxoaf/learning_to_write_better_queries/,"Hi all!

In my current role I'm finding myself using more and more SQL on a daily basis (Microsoft SQL R8). I feel like I'm at a point where I know enough to get by, but not enough to write efficient / easy to maintain queries.

I really want to change this to be a better developer - What resources would you recommend for learning good practices and writing more efficient queries? What are good standards? What should I completely avoid doing even though it may seem like the best way to approach a problem?",,False,self,t5_2qp8q,False,,,True,t3_lxoaf,http://www.reddit.com/r/SQL/comments/lxoaf/learning_to_write_better_queries/,
1313769446.0,11,imgur.com,jnymv,Finally!! (Denali CTP3),firepool,14,3,2,http://www.reddit.com/r/SQL/comments/jnymv/finally_denali_ctp3/,,,False,http://thumbs.reddit.com/t3_jnymv.png,t5_2qp8q,False,,,False,t3_jnymv,http://imgur.com/yjKZK,
1311177553.0,10,self.SQL,iuwxr,"Noob here, right now I have been running my SQL stuff in Access and I was wondering where to go from here.",vpersaud03,10,0,7,http://www.reddit.com/r/SQL/comments/iuwxr/noob_here_right_now_i_have_been_running_my_sql/,"Just want to know what a good step up from Access is, thanks!",,False,self,t5_2qp8q,False,,,True,t3_iuwxr,http://www.reddit.com/r/SQL/comments/iuwxr/noob_here_right_now_i_have_been_running_my_sql/,
1252848016.0,9,simple-talk.com,9k34p,Ten Common SQL Programming Mistakes,,9,0,0,http://www.reddit.com/r/SQL/comments/9k34p/ten_common_sql_programming_mistakes/,,,False,http://thumbs.reddit.com/t3_9k34p.png,t5_2qp8q,False,,,False,t3_9k34p,http://www.simple-talk.com/sql/t-sql-programming/ten-common-sql-programming-mistakes/?utm_source=simpletalk&amp;utm_medium=email&amp;utm_content=10CommonMistakes20090824&amp;utm_campaign=TSQL,
1371841938.0,7,self.SQL,1gt8su,"[SQL Server] How do I Search for a specific value, within all tables of a database.",270,8,1,25,http://www.reddit.com/r/SQL/comments/1gt8su/sql_server_how_do_i_search_for_a_specific_value/,"Hello

I have been tasked to search and find which table a certain field lives in, but the tables were originally named very poorely.

I have this query below that has helped searching for a column name within a table. The results show me the Table Name, Schema Name and Column Name. But now I need to search for a value, and I need to know which table the value is in. For example, I would like the results to show ""Table Name"", ""Schema Name"" and ""Column Name"" when I search for ""Value1"". Please let me know if you can help.

Thank you

Here is the query I use to search for Column Name:
    
    USE DATABASE NAME
    GO
    SELECT t.name As table_name, 
    Schema_name(schema_id) AS Schema_name, 
    c.name AS column_name
    FROM sys.tables AS t
    INNER JOIN sys.columns c ON t.OBJECT_ID = c.OBJECT_ID
    WHERE c.name LIKE '%results%'
    ORDER BY schema_name, table_name;

EDIT: **I am using SQL Server 2005**",,False,self,t5_2qp8q,1371851989.0,,,True,t3_1gt8su,http://www.reddit.com/r/SQL/comments/1gt8su/sql_server_how_do_i_search_for_a_specific_value/,
1369765783.0,7,stefantsov.com,1f7pql,Editing Skype history database (SQLite),Dima_Stefantsov,8,1,2,http://www.reddit.com/r/SQL/comments/1f7pql/editing_skype_history_database_sqlite/,,,False,http://a.thumbs.redditmedia.com/-3rgeqoSLI5zKzd6.jpg,t5_2qp8q,False,,,False,t3_1f7pql,http://stefantsov.com/2013/may/editing-skype-history-messages-database,
1363907788.0,6,self.SQL,1arjtc,Oracle Database 11g: SQL Fundamentals I Exam,SparraticDitto,8,2,3,http://www.reddit.com/r/SQL/comments/1arjtc/oracle_database_11g_sql_fundamentals_i_exam/,"Will be taking the exam this weekend, any advice? What did you think of the exam? 

Some people have told me it was more difficult than most of their practice tests, and some have told me that the test was not so bad. 

Any help would be appreciated, thanks!",,False,self,t5_2qp8q,False,,,True,t3_1arjtc,http://www.reddit.com/r/SQL/comments/1arjtc/oracle_database_11g_sql_fundamentals_i_exam/,
1361574541.0,10,self.SQL,191sva,Pretty new. Need help with the 'Like' command.,Cassiop,10,0,13,http://www.reddit.com/r/SQL/comments/191sva/pretty_new_need_help_with_the_like_command/,"Hello,

Is there any way to use the like command to display only results with one word?  I have a long list of books and want to display only the books with one word for their title. I have a basic concept of wildcards but I can't seem to figure this one out.

Any help would be great!

Thank you.",,False,self,t5_2qp8q,False,,,True,t3_191sva,http://www.reddit.com/r/SQL/comments/191sva/pretty_new_need_help_with_the_like_command/,
1359872699.0,8,reddit.com,17solp,Database developers: triggers; good or bad? (x-post from /r/oracle),MeGustaDerp,13,5,4,http://www.reddit.com/r/SQL/comments/17solp/database_developers_triggers_good_or_bad_xpost/,,,False,default,t5_2qp8q,False,,,False,t3_17solp,http://www.reddit.com/r/oracle/comments/17rjr8/database_developers_triggers_good_or_bad/,
1359398818.0,8,oreillynet.com,17fxlh,Webcast: View Updating: How to Make it Work,MeGustaDerp,8,0,0,http://www.reddit.com/r/SQL/comments/17fxlh/webcast_view_updating_how_to_make_it_work/,,,False,http://c.thumbs.redditmedia.com/Dw46ALNvWhirTttV.jpg,t5_2qp8q,False,,,False,t3_17fxlh,http://oreillynet.com/pub/e/2575,
1359314008.0,9,self.SQL,17dpoo,"Need help with a syntax error, please",Targetshopper4000,10,1,19,http://www.reddit.com/r/SQL/comments/17dpoo/need_help_with_a_syntax_error_please/,"I just started learning SQL so I can put it on my resume. I'm using the book Sams Teach Yourself SQL in 24 hours. I've gotten to a part where i have to create tables, one them is using a foreign key. I've typed the line from the book exactly as it appears but it keeps spitting back a syntax error.
the line in question is

CONSTRAINT EMP_FK FOREIGN KEY (EMP_ID) REFERENCES EMPLOYEE_TBL (EMP_ID)

im using MySQL if that helps at all.",,False,self,t5_2qp8q,False,,,True,t3_17dpoo,http://www.reddit.com/r/SQL/comments/17dpoo/need_help_with_a_syntax_error_please/,
1355294126.0,6,self.SQL,14pplc,[MSSQL] Grouping by fortnight,youarenotyourjerb,8,2,9,http://www.reddit.com/r/SQL/comments/14pplc/mssql_grouping_by_fortnight/,"Hi guys!

I have a challenge for you...

I've got daily data that I want to group by fortnight for summing up.

So far, I've managed to the following:

    SELECT 
         DATEADD(DD, DATEDIFF(DAY, '1-Jan-2013', TABLE.DATE) / 15 * 15, '1-Jan-2013') AS FORTNIGHT, 
         sum(mynumbers) AS SUM
    from TABLE
     GROUP BY DATEADD(DD, DATEDIFF(DAY, '1-Jan-2013', t1.date) / 15 * 15, '1-Jan-2013')


The problem lies in that months have a different number of days, meaning that a 15 day offset is not quite right, and as time goes on my fortnight groups go off kilter. eg:

    FORTNIGHT               SUM
     2013-01-01 00:00:00.000	456
     2013-01-16 00:00:00.000	518
     2013-01-30 00:00:00.000	537
     2013-02-13 00:00:00.000	535
     2013-02-27 00:00:00.000	508
     2013-03-13 00:00:00.000	530
     2013-03-27 00:00:00.000	516
     2013-04-10 00:00:00.000	558
     2013-04-24 00:00:00.000	586


EDIT: Desired result set:

       FORTNIGHT               SUM
    2013-01-01 00:00:00.000	456      this is 1/1/13 to 15/1/13
    2013-01-16 00:00:00.000	518      this is 16/1/13 to 31/1/13
    2013-02-01 00:00:00.000	537      this is 1/2/13 to 15/2/13
    2013-02-16 00:00:00.000	535      **this is 16/2/13 to 28/2/13**
    2013-03-01 00:00:00.000	508      this is 1/3/13 to 15/3/13
    2013-03-16 00:00:00.000	530      etc.
    2013-04-01 00:00:00.000	516
    2013-04-16 00:00:00.000	558
    2013-05-01 00:00:00.000	586

Thanks",,False,self,t5_2qp8q,1355303657.0,,,True,t3_14pplc,http://www.reddit.com/r/SQL/comments/14pplc/mssql_grouping_by_fortnight/,
1354385356.0,8,self.SQL,14406m,How difficult/easy was it to find your first SQL job?,,9,1,15,http://www.reddit.com/r/SQL/comments/14406m/how_difficulteasy_was_it_to_find_your_first_sql/,"Hey

I've recently finished uni and seeking a job as a junior SQL dba. Problem is, I've got no commercial experience what so ever but I feel like if I was being quizzed in an interview I remember a lot of what I've learnt over the 3 years I was there about SQL. So I'm just wondering do I stand a chance or will I be ignored because I have no commercial experience?

How did you get your job as a SQL developer/ dba? ",,False,self,t5_2qp8q,False,,,True,t3_14406m,http://www.reddit.com/r/SQL/comments/14406m/how_difficulteasy_was_it_to_find_your_first_sql/,
1354038545.0,9,self.SQL,13vsp3,[MS Access SQL],jayvfman,10,1,10,http://www.reddit.com/r/SQL/comments/13vsp3/ms_access_sql/,"I am a SQL noob so any explanation will help.

I have a table that list patient visit times to a doctor's office. What I am trying to do is be able to count the number of visits falling in a specific time period (ex. number of visits between 8:00 AM and 8:59 AM.

I am able do a count on one set of criteria:

    SELECT Count(EnterTM)
    FROM [Prescription_Timing_9/12]
    WHERE (EnterTM) Between #8:00# And #8:59#

But is it possible to me to count multiple ""time blocks"" and get a count result for each?

I am trying to get a count for 
*8-8:59
*9-9:59
*10-10:59
*etc, etc.. up until 11:00 PM.

Is somthing like this possible?",,False,self,t5_2qp8q,False,,,True,t3_13vsp3,http://www.reddit.com/r/SQL/comments/13vsp3/ms_access_sql/,
1347905529.0,9,self.SQL,1017pn,Giving back to the community. Here are some random tips for jr DBA interview exams,aboxofrice,13,4,8,http://www.reddit.com/r/SQL/comments/1017pn/giving_back_to_the_community_here_are_some_random/,"I'm not a DBA by trade but I do work with a few DBAs and have a huge interest in SQL. The DBA I work with was doing interviews and I reviewed the exam he had given for a juniour DBA postion. I was surprised at how many people didn't catch some simple things. 

1. If you have a question asking to delete some records, ask if there is a delete flag. This can save you the embarrassing reaction later if they ask for you to restore the records.

2. Look very carefully at the schema including the column types and ask questions. I saw a price column of Price varchar(255), a unit column of Unit FLOAT(8,4), and a album name column Albumn_Name nvarchar(128). I questioned him about it and he mentioned that nobody brought up any questions about it and essentially failed for not noticing the basic. 

I'm hoping some people here will post more to help out anybody going for a Jr DBA. ",,False,self,t5_2qp8q,False,,,True,t3_1017pn,http://www.reddit.com/r/SQL/comments/1017pn/giving_back_to_the_community_here_are_some_random/,
1340678865.0,8,self.SQL,vlxcg,I am somewhat new to SQL still.  I have a question on views and temp tables.,,9,1,17,http://www.reddit.com/r/SQL/comments/vlxcg/i_am_somewhat_new_to_sql_still_i_have_a_question/,I was told by someone who review my stored procedure that I should not use so many tables(even temps) and that I should start to incorporate Views more into my programming more.  To my understanding Views are sort of product tables?  Can I interchange temp tables with Views as far as functionality?  ,,False,self,t5_2qp8q,False,,,True,t3_vlxcg,http://www.reddit.com/r/SQL/comments/vlxcg/i_am_somewhat_new_to_sql_still_i_have_a_question/,
1334107140.0,7,self.SQL,s3k2s,Have a SQL question about WHERE vs. ON,syneofeternity,9,2,16,http://www.reddit.com/r/SQL/comments/s3k2s/have_a_sql_question_about_where_vs_on/,"EDIT: Fixed formatting... somewhat
I had a question about the uses for both.


Example with WHERE:

SELECT tab1.col1, tab2.col1

FROM tab1, tab2

WHERE tab1.col1 = tab2.col1


Example with ON:


SELECT tab1.col1, tab1,col2, tab2.col1

FROM tab1

JOIN tab2 ON tab1.col1=tab2.col1


Is it just because there is a JOIN?
Also, is the only reason to use AS is if the tables have matching columns?",,False,self,t5_2qp8q,True,,,True,t3_s3k2s,http://www.reddit.com/r/SQL/comments/s3k2s/have_a_sql_question_about_where_vs_on/,
1328288856.0,8,self.SQL,p9fy2,Bringing two rows into one,captshady,8,0,11,http://www.reddit.com/r/SQL/comments/p9fy2/bringing_two_rows_into_one/,"What my table data looks like:

    Division Number	GDGROUP	Group Name	Division Phone Number	Local Code	VNG_Plan_ID	Subscriber_Count	Local_Name
    173	127112	CARL C FEESMAN BUILDING	555.555.5555	3924	ADM-ADMINISTRATION	8	BUILDERS ASSOC OF AMERICA
    173	127112	CARL C FEESMAN BUILDING	555.555.5555	3924	ADM-ANCILLARY	2	BUILDERS ASSOC OF AMERICA

What I want my SELECT statement to produce:

    Local Code 	Local Name                      	Division Name                   	Total Members At 11.00	Total Members At 3.00 
    3924		CARL C FEESMAN BUILDING                 BUILDERS ASSOC OF AMERICA			8			2

I need the 2 lines above to output as one line.

",,False,self,t5_2qp8q,False,,,True,t3_p9fy2,http://www.reddit.com/r/SQL/comments/p9fy2/bringing_two_rows_into_one/,
1291774671.0,8,codeproject.com,ei0rs,Visual Representation of SQL Joins - CodeProject,,10,2,1,http://www.reddit.com/r/SQL/comments/ei0rs/visual_representation_of_sql_joins_codeproject/,,,False,http://thumbs.reddit.com/t3_ei0rs.png,t5_2qp8q,False,,,False,t3_ei0rs,http://www.codeproject.com/KB/database/Visual_SQL_Joins.aspx,
1282832626.0,8,howfuckedismydatabase.com,d5q1p,How fucked is my database ? ,cms,13,5,3,http://www.reddit.com/r/SQL/comments/d5q1p/how_fucked_is_my_database/,,,False,default,t5_2qp8q,False,,,False,t3_d5q1p,http://howfuckedismydatabase.com,
1376735903.0,7,self.SQL,1kjlrr,Need help with an SQL Select Query,makonde,10,3,11,http://www.reddit.com/r/SQL/comments/1kjlrr/need_help_with_an_sql_select_query/,"Given this table: 

City		|	Person
------------|----------
Cape Town	|	Fred
Cape Town	|	Joe
Cape Town	|	Anna
Durban		|	John
Durban		|	Mary
Johannesburg|	Frank

I need a SELECT Query that will get these results

City		|	Person
------------|----------
Durban		|	John
Durban		|	Mary
Johannesburg|	Frank
Cape Town	|	Anna
Cape Town	|	Fred
Cape Town	|	Joe

The best I have been able to do is use a CASE:


    SELECT * FROM Customers
    	ORDER BY (
    	CASE Region
    		WHEN 'Durban' THEN 1
    		WHEN 'Johannesburg' THEN 2
    		WHEN 'Cape Town' THEN 3
    		ELSE 100 END), Contact;

		
But this feels kinda hacky, can anyone see if there is any real order to the required result? Thanx
		
",,False,self,t5_2qp8q,False,,,True,t3_1kjlrr,http://www.reddit.com/r/SQL/comments/1kjlrr/need_help_with_an_sql_select_query/,
1375806798.0,7,self.SQL,1jtixc,How can I combine two rows in the same column?,lamppost9,9,2,7,http://www.reddit.com/r/SQL/comments/1jtixc/how_can_i_combine_two_rows_in_the_same_column/,"[TSQL]  I am trying to combine two values in the same column into one.  Specifically I have a column where if a visit is 1 hours and 15 minutes for client 132151, it will have:

Duration             Client ID

15 MINUTES	  132151

1 HOUR	          132151

I need to get it into one cell which is similar to '1 HOUR 15 MINUTES'.  I can take it from there but am stuck at this point.",,False,self,t5_2qp8q,False,,,True,t3_1jtixc,http://www.reddit.com/r/SQL/comments/1jtixc/how_can_i_combine_two_rows_in_the_same_column/,
1375800454.0,7,self.SQL,1jtarj,Is this really an error?,pythor,10,3,14,http://www.reddit.com/r/SQL/comments/1jtarj/is_this_really_an_error/,"Say we have    
table1 (name varchar(30), address varchar(30), zip char(5))    
and    
table2 (name varchar(30), jobid number(5), jobdate date)

And we have a query:

    select t1.*, jobid, jobdate
    from table1 t1 inner join 
           table2 t2 on (t1.name=t2.name)
    where jobdate &gt; to_date('20130101', 'yyyymmdd')
    order by jobdate, name;


So... Should this throw an error?  name exists in both tables, but only once in the select list.  The order by isn't really ambiguous, because by the time ordering starts, there's only one name field involved (ignoring the fact that the two tables fields would be the same because of the join, anyway).  

",,False,self,t5_2qp8q,False,,,True,t3_1jtarj,http://www.reddit.com/r/SQL/comments/1jtarj/is_this_really_an_error/,
1375303169.0,6,self.SQL,1jg2h3,[MS SQL] PIVOT for a range of data,softball753,8,2,14,http://www.reddit.com/r/SQL/comments/1jg2h3/ms_sql_pivot_for_a_range_of_data/,"(Accidentally hit F5 before submitting, so I'm going to keep this brief...)


Using MS SQL 2008R2, and assuming a temp table #Ages with a single int column, AgeYears, I can PIVOT the table like this without an issue:

    	SELECT * FROM
    		(SELECT 
    		 AgeYears
    		 FROM #Ages
    		 ) as A
    	PIVOT
    		(
    		count(AgeYears)
    		FOR AgeYears IN ([0],[1],[2],[3],[4],[5],[6],[7],[8],[9],[10])
    		) AS PT

What I would like to do is include a range in the FOR/IN clause of the statement, something like [&lt;0], [&gt;10], or [10-20]. I've only seen this mentioned in one blog (that I cannot now find) using the ""-"" for range as well as *OVER* and *UNDER* and a value. I consistently get this error ""The incorrect value ""10-20"" is supplied in the PIVOT operator."" so I'm assuming that the blog I saw didn't apply to MS SQL.

The SP will update without error, but not execute.

I've tried several syntax alterations (throwing crap at the wall), including changing type of AgeYears to varchar. (That column is a varchar in the original table data, I convert it to int when dumping into #Ages.)

Is what I'm trying out of the scope of the PIVOT operator? If so I can think of a few workarounds, but they will be a pain. I truncated the IN list for this example but my actual data set will involve 100 pivot columns.",,False,self,t5_2qp8q,False,,,True,t3_1jg2h3,http://www.reddit.com/r/SQL/comments/1jg2h3/ms_sql_pivot_for_a_range_of_data/,
1375151492.0,7,self.SQL,1jbllk,Weird Schema [MY SQL],Better-reddits,10,3,4,http://www.reddit.com/r/SQL/comments/1jbllk/weird_schema_my_sql/,"OK, here's two tables, employer and officer. The officer represents 3 different corp officers for each employer. The kind is represented by the type column: 'F' for CFO, 'E' for CEO, and 'O' for COO. I'll put the schema and sql to populate below. Now, it is easy to query for the employers and their CFO's:

select e.name,o.name from employer e, officer o where e.id = o.emp_id and o.type='F'

But what I need is a join of some kind that gives me the employer and all three officers in the same row. Actually, the query is used within an insert, into a table like:

    create table corp_officers (
    name VARCHAR(80),
    ceo_name VARCHAR(80),
    cfo_name VARCHAR(80),
    coo_name VARCHAR(80)
    )

But I'm just trying to create a query to return all those 4 things in a row. CROSS JOIN? INNER JOIN? CROSS APPLY? 

Can you help me out?

    create table employer (
    id IDENTITY,
    name VARCHAR(80)
    );

    create table officer (
    id IDENTITY,
    type CHAR,
    emp_id INT,
    name VARCHAR(80),
    FOREIGN KEY (emp_id) REFERENCES employer(id)
    );

    insert into employer (name) values ('Yahoo');
    insert into employer (name) values ('Google');

    insert into officer (name, type, emp_id) values ('Marissa Mayer', 'E', 0);
    insert into officer (name, type, emp_id) values ('Henrique De Castro', 'O', 0);
    insert into officer (name, type, emp_id) values ('Ken Goldman', 'F', 0);

    insert into officer (name, type, emp_id) values ('Larry Page', 'E', 1);
    insert into officer (name, type, emp_id) values ('Patrick Pichette', 'F', 1);
    insert into officer (name, type, emp_id) values ('Nobody', 'O', 1);",,False,self,t5_2qp8q,False,,,True,t3_1jbllk,http://www.reddit.com/r/SQL/comments/1jbllk/weird_schema_my_sql/,
1375112026.0,7,self.SQL,1ja4li,Sorting a table by the end characters.. example provided.,wolfman3127,7,0,10,http://www.reddit.com/r/SQL/comments/1ja4li/sorting_a_table_by_the_end_characters_example/,"Say I have a table and I want to create a query to sort these properly.. example is  

Orange Tomatoes 
Yellow Tomatoes  
Green Bananas    
Blue Grapes  
Green Grapes  
Red Tomatoes  
Purple Tomatoes  
Grey Grapes  


And I want to group these items by the last 6 characters, which would group tomatoes together, and grapes together and Bananas together, I am unsure about how to do this.. any help would be amazing.


  

[SOLVED]

  select fruitname
    , right (fruitname,6) as fruitsort
from table 
order by right(fruitname, 6) asc;


  Worked perfectly.",,False,self,t5_2qp8q,1375127556.0,,,True,t3_1ja4li,http://www.reddit.com/r/SQL/comments/1ja4li/sorting_a_table_by_the_end_characters_example/,
1370617009.0,9,self.SQL,1fv4tx,New to SQL. How do I practice?,tatvamasi88,12,3,21,http://www.reddit.com/r/SQL/comments/1fv4tx/new_to_sql_how_do_i_practice/,"I am learning SQL and I would like to practice the statements I am learning.  I am wondering if 
1) there are any free platforms I can use (I'm operating off of a mac btw).  I assume that Oracle and Microsoft SQL server either cost money or don't work on my MacBook.  Could I use Access?
2)I would like some sample data sets with which I can practice.  ",,False,self,t5_2qp8q,False,,,True,t3_1fv4tx,http://www.reddit.com/r/SQL/comments/1fv4tx/new_to_sql_how_do_i_practice/,
1366813634.0,7,self.SQL,1d0e8e,Question concerning MSSQL replication,whoisearth,8,1,7,http://www.reddit.com/r/SQL/comments/1d0e8e/question_concerning_mssql_replication/,"We have a database that is actively being written to with various SELECT/UPDATE/DELETE/ETC statements.  This Database, let's call it ""DATAA"" has a purge run daily to remove anything over x days old.

What I'd like to do is setup a copy of this Database, let's call it ""DATAB"" which will be a read-only copy of ""DATAA"" but also sync once a day to include any new data contained within the database (I do not want to update with the deleted data).

How is this done within MSSQL?

tl'dr - 2 databases A and B.  Want to sync A -&gt; B daily but add new rows to B without deleting the old rows.",,False,self,t5_2qp8q,False,,,True,t3_1d0e8e,http://www.reddit.com/r/SQL/comments/1d0e8e/question_concerning_mssql_replication/,
1364683975.0,8,self.SQL,1bbrtl,[MySQL] Queries to queue up music,,8,0,6,http://www.reddit.com/r/SQL/comments/1bbrtl/mysql_queries_to_queue_up_music/,"I'm looking to have a bit of fun with a large music collection to see if it's possible to create a radio like experience with queries on a library. Lots of audio managers have some sort of smart playlists, but they are just crippled sql builders. My personal use case is a streaming radio with my home library (mpd+httpd) so I don't have to pick out tracks/albums, just hit a button and enjoy. I have a working demo to queue up music from PDO-sqlite queries to mpd and stream (my rhythmbox xml db is converted to sqlite).

I'm curious to see if there is interest in this and if anyone wants to contribute, agree on a common schema, and swap queries to enjoy different tastes in music.

Example Radio Station:
            
    SELECT * FROM library WHERE 
    UPPER(artist) LIKE ""%RAILROAD EARTH%"" 
    OR UPPER(artist) LIKE ""%OLD CROW%"" 
    OR UPPER(artist) LIKE ""%YONDER%"" 
    OR UPPER(artist) LIKE ""%FLECK%"" 
    OR UPPER(artist) LIKE ""%TRAMPLED%"" 
    OR UPPER(artist) LIKE ""%CHEESE%"" 
    ORDER BY RANDOM() LIMIT 50
    

We could swap queries by RSS and discover new music to add to personal collections to enjoy other ""stations"".


Proposed schema:
http://pastebin.com/mGE8HYZF

Demo Layout:
http://i.imgur.com/ZlRQWlp.png
http://i.imgur.com/rahYn8p.png

My demo is currently written with FuelPHP as the framework, I'll post it if this gains some traction.  I'd like to set up the demo app so that RSS feeds could be consumed between different instances to share.  MPD integration is done with the PHP PEAR MPD library.  Rhythmbox and itunes xml conversion to sqlite is working.  Would like to get some cron scripts written to keep the stored library up to date from the various library locations.",,False,self,t5_2qp8q,1364743462.0,,,True,t3_1bbrtl,http://www.reddit.com/r/SQL/comments/1bbrtl/mysql_queries_to_queue_up_music/,
1364599104.0,7,self.SQL,1b9t9y,Connecting Web Services to SQL and then SQL to Cognos Framework,270,7,0,6,http://www.reddit.com/r/SQL/comments/1b9t9y/connecting_web_services_to_sql_and_then_sql_to/,"Hello!
 I current have 2 data sources that I do not own the intellectual property of the data on the servers they are stored on. When speaking with the companies who do own the servers, the gave me the option to get to the data through Web Services.
 I have read little on this and was curious if there is anyone here that can help me with first hand experience.
 My goal is to connect web services to SQL Server, so I can then connect SQL Server to Cognos Framework like normal.
 Has anyone done this (Connected Web Services to SQL Server)? What would be my first step in connecting Web Services to SQL Server?
 Thank you",,False,self,t5_2qp8q,False,,,True,t3_1b9t9y,http://www.reddit.com/r/SQL/comments/1b9t9y/connecting_web_services_to_sql_and_then_sql_to/,
1363385866.0,7,self.SQL,1adkh4,Is this possible?,StuckHereWithYou,10,3,5,http://www.reddit.com/r/SQL/comments/1adkh4/is_this_possible/,"saw this on my facebook feed. tried searching reddit but couldn't find any reference.
edit. ooops link got lost.
http://gizmodo.com/5498412/sql-injection-license-plate-hopes-to-foil-euro-traffic-cameras",,False,self,t5_2qp8q,False,,,True,t3_1adkh4,http://www.reddit.com/r/SQL/comments/1adkh4/is_this_possible/,
1362490178.0,7,self.SQL,19pe7r,Optimizing query [MS SQL],volric,8,1,35,http://www.reddit.com/r/SQL/comments/19pe7r/optimizing_query_ms_sql/,"Have an update query that is filling tempdb (over 30gigs), and is failing.

Only run once a year, it is for financial balances, and ran fine last year.

    /** CLOSING BALANCE **/
    update BALANCE
    set BALANCE.CB = SCHEDULE.sum_AMOUNT
    from BALANCE inner join
    (
        select STNO,year.year, sum(AMOUNT) as sum_AMOUNT
    from SCHEDULE, dbo.year
    where SCHEDULE.YEAR &lt;= YEAR.YEAR
    group by STNO, year.year
    ) as SCHEDULE
    on BALANCE.STNO = SCHEDULE.STNO
    and balANCE.year = schedule.year
  

Also have tried 'with'

    WITH t2 (stno,year, sum_amount) AS
    (
    select schedule.STNO,year.year, sum(AMOUNT)
    from dbo.SCHEDULE, dbo.year,dbo.balance
    where SCHEDULE.YEAR &lt;= YEAR.YEAR
    and BALANCE.STNO = SCHEDULE.STNO
    and balANCE.year = schedule.year
    group by schedule.STNO, year.year
    )
    UPDATE balance SET balance.cb = t2.sum_amount
       FROM balance
          INNER JOIN t2 ON BALANCE.STNO = t2.STNO
    and balance.year = t2.year


Any suggestions on how to improve the query?

We normally do simple/basic queries so this is above our level :/


EDIT: Thanks all for your comments and suggestions. I'm going to try the following:

* create a separate temp table with the aggregate calculation and use it to update the BALANCE table
* do it year by year (limit quantity of rows being updated)
* learn how to use indexes
* try and not use outdated syntax/language

",,False,self,t5_2qp8q,1362557056.0,,,True,t3_19pe7r,http://www.reddit.com/r/SQL/comments/19pe7r/optimizing_query_ms_sql/,
1361984581.0,5,self.SQL,19c3lu,Understanding Data Warehouses,learningsql,8,3,27,http://www.reddit.com/r/SQL/comments/19c3lu/understanding_data_warehouses/,"I'm having a fairly hard time understanding some of the more meta-level setups, configurations, and technologies in the SQL world. I work in a contact center (most inbound customer support work) and  I'm always looking for ways to be smarter about how we store and report on the data.

Our business is fairly small and we've not yet developed really good policies or procedures for SQL type stuff - we don't even employ a full-time DBA. All our SQL stuff is handled by a team of about ten who each sorta do their own thing for their own work.

I would like to get organized. Part of my investigation as of late has been around data warehousing but I can't seem to wrap my little brain around the concept. So a few questions: What is a data warehouse? When would it make sense to avoid a data warehouse and when would it make sense to utilize one? What about more than one? Is a data warehouse always a secondary database where the data is simply a denormalized version of a normalized source DB?",,False,self,t5_2qp8q,False,,,True,t3_19c3lu,http://www.reddit.com/r/SQL/comments/19c3lu/understanding_data_warehouses/,
1361368967.0,8,self.SQL,18vw5z,Can someone help me write this SQL stored procedure? It was asked in an interview.,,12,4,23,http://www.reddit.com/r/SQL/comments/18vw5z/can_someone_help_me_write_this_sql_stored/,"Given a table ""ShopsBranches"" with columns: latitude and longitude.

Write a SQL stored procedure that takes a ""lat"" and a ""long"" from the user and then returns the branches in the table sorted by distance from user's input.

You will have to populate the table with enough data to test your ""nearest points"" algorithm.",,False,self,t5_2qp8q,False,,,True,t3_18vw5z,http://www.reddit.com/r/SQL/comments/18vw5z/can_someone_help_me_write_this_sql_stored/,
1359241807.0,6,red-gate.com,17c7w5,Statistics in Oracle and SQL Server (recorded webinar with Johnathan Lewis and Grant Fritchey),MeGustaDerp,8,2,0,http://www.reddit.com/r/SQL/comments/17c7w5/statistics_in_oracle_and_sql_server_recorded/,,,False,http://d.thumbs.redditmedia.com/lQY6j0Sgk-Ckrkzu.jpg,t5_2qp8q,False,,,False,t3_17c7w5,http://www.red-gate.com/products/oracle-development/deployment-suite-for-oracle/education/webinars/webinar-statistics-oracle-sql-server-jonathan-lewis,
1358805050.0,9,self.SQL,170i8b,[MS SQL 2008] Attempting to convert vertical data to horizontal.,aburger,9,0,11,http://www.reddit.com/r/SQL/comments/170i8b/ms_sql_2008_attempting_to_convert_vertical_data/,"[ Solved, thanks to [/u/utexaspunk](http://www.reddit.com/user/utexaspunk)! ]
  
  
-----------------------------------------------------------------------------
  
  
Context: I'm using a table to, basically, fill in a template for video encoding. This table has three fields (id, attribute, and value). Profile 1 could, for example, be concerned with 5 attributes, while profile 2 uses 10 attributes -- making a hard number of JOINS (almost) an impossibility. (My first instinct was to join the table to itself a few times but, with an unknown total number of possible values, this is pretty tough.)
  
  
Problem: I'm trying to convert this to something where a user could basically:
  
    SELECT [profiles.id] WHERE [attribute] = [value]
  
  Basically, the users want to see all of the profiles where profile.attr=Resolution_X has a profile.value of ""1080"", etc. Ideally they'd be able to do something along the lines of:
  
    WHERE ResX='1080' AND ResY='1920' AND ColorSpace='RGB'
  
  --and ResX, ResY, ColorSpace, etc, are all values of profiles.attr
  
  
  The more I dig into this, the more *possible* routes I find to *sort of* accomplish it, and I feel like there's a simple way to do this without reinventing the wheel. I realize that I'm probably doing a horrible job of explaining this, and I apologize for that. I hope it makes sense.
  
  
  Help me, r/SQL, you're my only hope.",,False,self,t5_2qp8q,1358810194.0,,,True,t3_170i8b,http://www.reddit.com/r/SQL/comments/170i8b/ms_sql_2008_attempting_to_convert_vertical_data/,
1355320455.0,7,self.SQL,14q3ly,"[MySQL] noob design question - avoiding cheating with ""arrays""",njtrafficsignshopper,9,2,18,http://www.reddit.com/r/SQL/comments/14q3ly/mysql_noob_design_question_avoiding_cheating_with/,"I haven't touched a database in a while but I am curious about this topic. Say you have a table that needs to store a person's name (one per person), their favorite foods (any number per person), and an intro (one per person).  

e.g.

    name     foods     intro

    David    pizza     Hi I'm David, I work in a clothing shop etc. etc.
             oranges
             cake
    Amanda   pork      Greetings everyone, pleased to meet you etc. etc.

It's tempting to just use one row per person and make the foods column store multiple values by separating them with a comma or some other trick.

However, I know that this is bad, because it doesn't take advantage of the db's strengths. But I forgot what the solution is. Do you just make multiple entries for David and take the intro from the first one?

Edit after more thought. 

Problems I see with this:

* Don't you risk having multiple intros for David when there should only be one? (Probably it's smarter to use an id field as an incrementor rather than the person's name, right?)
* Also, if you *do* add multiple rows for david, and you use an incrementing unique id, won't you end up with a lot of junk uids? As in, uid 1 would be David, pizza, and the intro text. uid 2 would be David, oranges, and no intro text. 
* * Amanda would be uid 4, which would be non-consecutive (I guess just don't worry about this if you don't have to?) 
* Is there a better solution?",,False,self,t5_2qp8q,1355321611.0,,,True,t3_14q3ly,http://www.reddit.com/r/SQL/comments/14q3ly/mysql_noob_design_question_avoiding_cheating_with/,
1355028888.0,8,self.SQL,14j8ub,"Excluding wildcards from a ""Like"" query",Bloghairy,9,1,8,http://www.reddit.com/r/SQL/comments/14j8ub/excluding_wildcards_from_a_like_query/,"I know how to escape individual wildcard characters when doing a search using 'like'. I need to search a column in a table using a string that is input from the user that may contain one or many wildcard characters.

Other than surrounding the incoming string with Replace commands for each possible wildcard, is there an easier way to do this?
",,False,self,t5_2qp8q,False,,,True,t3_14j8ub,http://www.reddit.com/r/SQL/comments/14j8ub/excluding_wildcards_from_a_like_query/,
1354891752.0,7,self.SQL,14g1ie,[MS SQL] Difference between &lt;&gt; and !=,rcsAlex,10,3,9,http://www.reddit.com/r/SQL/comments/14g1ie/ms_sql_difference_between_and/,"Is there any difference between using &lt;&gt; and != in MS SQL? In the office I see people using both, and was wondering if there is any underlying reason to have two functions for ""not equal to"".",,False,self,t5_2qp8q,False,,,True,t3_14g1ie,http://www.reddit.com/r/SQL/comments/14g1ie/ms_sql_difference_between_and/,
1353185697.0,9,nuodb.com,13d7ot,NuoDB elastically scalable NewSQL database releases RC1,gnurizen,10,1,0,http://www.reddit.com/r/SQL/comments/13d7ot/nuodb_elastically_scalable_newsql_database/,,,False,default,t5_2qp8q,False,,,False,t3_13d7ot,http://nuodb.com/,
1352228430.0,6,self.SQL,12qs5j,"Cannot create SSPI context in SSMS, *can* telnet to 1433, *can* connect with SSMS using the IP",Tofinochris,8,2,10,http://www.reddit.com/r/SQL/comments/12qs5j/cannot_create_sspi_context_in_ssms_can_telnet_to/,"So I'm getting the old ""Cannot create SSPI context"" error which I am quite bad at debugging, as networking stuff gives me a headache, but I'm trying.

Trying to connect to a new server using SSMS gives me ""Cannot create SSPI context"".  I know from past experience that this has something to do with Kerberos so I checked the SQL log and found that the SPN was successfully registered.  I did a bit of random poking at it and found:

1. I can ping the server from the machine running SSMS, using the server name.

2. I can telnet to 1433 on the server from the machine running SSMS, using the server name.

3. I can connect to the server from SSMS if I supply the IP instead of the name.

#3 makes me suspect some DNS issue of course, but what have I even identified here?

Any help would be appreciated.  I hate this problem :)

Relevant log bit:

The SQL Server Network Interface library successfully registered the Service Principal Name (SPN) [ MSSQLSvc/herp.derp.org ] for the SQL Server service. 

The SQL Server Network Interface library successfully registered the Service Principal Name (SPN) [ MSSQLSvc/herp.derp.org:1433 ] for the SQL Server service. ",,False,self,t5_2qp8q,False,,,True,t3_12qs5j,http://www.reddit.com/r/SQL/comments/12qs5j/cannot_create_sspi_context_in_ssms_can_telnet_to/,
1351567460.0,7,self.SQL,12bie5,Oracle Help - trying to automate a short program,mcdougan,7,0,7,http://www.reddit.com/r/SQL/comments/12bie5/oracle_help_trying_to_automate_a_short_program/,"I just started work two weeks ago and part of my job includes using sql for an oracle server using SQL Navigtor. 

I wrote a code that was supposed to be automated last week but took the lazy route and used trunc(sysdate-1) as the method of pulling the previous days record. 


As I ran the code this morning to send out reports I realized that this will not work on mondays. Is there a way to set a parameter that will change depending on the day?

I was thinking a case statement but it kind of fell apart when I tried to write the code all out.

Thanks!
",,False,self,t5_2qp8q,False,,,True,t3_12bie5,http://www.reddit.com/r/SQL/comments/12bie5/oracle_help_trying_to_automate_a_short_program/,
1346580970.0,7,dbadiaries.com,z84iq,DBA Diaries - informative posts from a DBA working with SQL Server and MySQL technology,compchess,8,1,0,http://www.reddit.com/r/SQL/comments/z84iq/dba_diaries_informative_posts_from_a_dba_working/,,,False,http://f.thumbs.redditmedia.com/jbgfBILzG3G4P-FS.jpg,t5_2qp8q,False,,,False,t3_z84iq,http://www.dbadiaries.com,
1344488648.0,6,self.SQL,xxauu,Should I learn SQL?,brewsteal,12,6,29,http://www.reddit.com/r/SQL/comments/xxauu/should_i_learn_sql/,"I have pretty good skills in MS Excel, and want to get into analyst type positions, possibly in tech or financials. 

There have been quite a few job positions that require SQL, or at least a basic understanding of SQL. But in my understanding SQL is a little dated. Of course a lot of big companies use it, but are they moving in a new direction? If you had the time, would you start learning an alternative?

(From Wiki) A distinction should be made between alternatives to relational query languages and alternatives to SQL. Below are proposed relational alternatives to SQL. See navigational database and NoSQL for alternatives to relational:
.QL - object-oriented Datalog
4D Query Language (4D QL)
Datalog
HTSQL - URL based query method
IBM Business System 12 (IBM BS12) - one of the first fully relational database management systems, introduced in 1982
ISBL
Java Persistence Query Language (JPQL) - The query language used by the Java Persistence API and Hibernate persistence library
JoSQL[33] - Runs SQL statements written as Strings to query collections from inside Java code.
LINQ - Runs SQL statements written like language constructs to query collections directly from inside .Net code.
Object Query Language
QBE (Query By Example) created by Moshè Zloof, IBM 1977
Quel introduced in 1974 by the U.C. Berkeley Ingres project.
Tutorial D
SBQL - the Stack Based Query Language (SBQL)
UnQL - the Unstructured Query Language, a functional superset of SQL, developed by the authors of SQLite and CouchDB
XQuery",,False,self,t5_2qp8q,False,,,True,t3_xxauu,http://www.reddit.com/r/SQL/comments/xxauu/should_i_learn_sql/,
1335834453.0,9,self.SQL,t0r48,(Beginner Question),derikd,9,0,4,http://www.reddit.com/r/SQL/comments/t0r48/beginner_question/,I'm really struggling understanding functional dependencies and also the three(four) forms of normalization of databases. Anyone have a good video or can explain this to me? I'm getting extremely frustrated.,,False,self,t5_2qp8q,False,,,True,t3_t0r48,http://www.reddit.com/r/SQL/comments/t0r48/beginner_question/,
1334555816.0,7,self.SQL,sc0f0,Help: How to set up a database of drug characteristics? Is it possible to have nested tables?,MSBSpectator,7,0,4,http://www.reddit.com/r/SQL/comments/sc0f0/help_how_to_set_up_a_database_of_drug/,"Hello all, I am entirely new to SQL so please bear with me!

I'm trying to create a database of drug characteristics such as onset of action, duration, drug mechanism, side effects, indications for use, contraindications, etc. This will then be part of a searchable web database, hopefully with capability of adding additional drugs via an online form. 

For most of the characteristics, it's easy to put them as columns and then have the individual drugs as rows in a table. However, some of the characteristics, such as side effects, will be tables in their own right because for each side effect, there needs to be a description of the side effect and what to do if it occurs. 

I was initially thinking of using JOIN to link a side effects table with the medications, but I think that will make adding additional drugs harder as multiple drugs may have the same side effect. At the moment I'm thinking of creating a separate database for each individual drug, but I think that will make creating a search function more difficult. I'd appreciate any help in organizing this SQL database(s?)!",,False,self,t5_2qp8q,False,,,True,t3_sc0f0,http://www.reddit.com/r/SQL/comments/sc0f0/help_how_to_set_up_a_database_of_drug/,
1331591195.0,7,self.SQL,qtkuz,I broke my brain and can't figure this out (grouping),gadorp,10,3,14,http://www.reddit.com/r/SQL/comments/qtkuz/i_broke_my_brain_and_cant_figure_this_out_grouping/,"I've got a stored proc and I need to group cases together by client:

     select name, caseid, date, description
     from case c
     left join descriptions d
     on c.caseid = d.caseid
     where date between @var1 and @var2
     and clientid = @var3

The clients will often have several ""descriptions"" under a single case, and right now I'm returning a new row for each description, but I need to return one row per client and separate the descriptions by comma.

For some stupid reason I have spent 3 hours on this and cannot get recall what exactly I need to do here.",,False,self,t5_2qp8q,False,,,True,t3_qtkuz,http://www.reddit.com/r/SQL/comments/qtkuz/i_broke_my_brain_and_cant_figure_this_out_grouping/,
1328558427.0,6,self.SQL,pdkii,Making null fields into empty fields in bulk insert?,gadorp,7,1,6,http://www.reddit.com/r/SQL/comments/pdkii/making_null_fields_into_empty_fields_in_bulk/,"For some reason I can't seem to get my empty fields to import as anything but NULL when doing a bulk insert from csv into MS SQL 2008. The column defaults are all (''), nulls-allowed.

I'm sure I'm missing something incredibly simple/stupid.",,False,self,t5_2qp8q,False,,,True,t3_pdkii,http://www.reddit.com/r/SQL/comments/pdkii/making_null_fields_into_empty_fields_in_bulk/,
1324306115.0,8,self.SQL,niima,Best way to learn T-SQL for MS SQL Server?,seiken,10,2,5,http://www.reddit.com/r/SQL/comments/niima/best_way_to_learn_tsql_for_ms_sql_server/,"Hello Everyone,

At work, I've been getting more involved with hosting and database stuff. I currently do some very minor admin work with my limited SQL knowledge from college 11 years ago, but I'd like to expand my abilities in this area. It's all Microsoft SQL Server, so apparently it's Transact-SQL.

As someone who went to school for programming, but never ended up working as a programmer, what books or web sites would you recommend for me to get acquainted with T-SQL? I'm looking for more of an introductory-level resource, which can prepare me for something more advanced once I'm comfortable. To give you an idea of my current knowledge and understanding, I struggle with understanding JOINs, and wouldn't be able to write my own stored procedure.

Thanks very much.",,False,self,t5_2qp8q,False,,,True,t3_niima,http://www.reddit.com/r/SQL/comments/niima/best_way_to_learn_tsql_for_ms_sql_server/,
1319081565.0,9,self.SQL,lib3e,What are some great ideas for sql sample code?,thehof,10,1,5,http://www.reddit.com/r/SQL/comments/lib3e/what_are_some_great_ideas_for_sql_sample_code/,"I have to provide some sample code and am fairly unwilling to pull just random code I've written while employed because I don't own it... and I think it communicates the wrong message to my interviewer if I do so!

What are some good random ideas for sample code? Give me some ideas, Reddit, and I'll spit back code for you (and me). 

I'm applying for a Microsoft Sql Server position, so tsql is the language you'll get back. ",,False,self,t5_2qp8q,False,,,True,t3_lib3e,http://www.reddit.com/r/SQL/comments/lib3e/what_are_some_great_ideas_for_sql_sample_code/,
1316113878.0,5,self.SQL,kgt34,Query Help (JOIN ahead),gunkabilly,7,2,5,http://www.reddit.com/r/SQL/comments/kgt34/query_help_join_ahead/,"For the sake of argument, let's say I've got a database of instruction manuals (that's the easiest way to explain these, and that's sort of what they are).

The information for these manuals is stored in 2 tables:

manual_index, which has information about which manuals are assigned to which client, and an 'ordinal' column for what order to display them in

and

manual_content, which has a row for each page in every manual, with the manual's id (primary key from manual_index), a page index, the actual page content, and a title.

So I've made a big nasty SQL INNER JOIN query to return all the pages for just the first manual for a specific client:

SELECT CONVERT(TEXT,content),title FROM manual_content INNER JOIN manual_index ON manual_index.id=manual_content.field_id WHERE manual_index.client_id = _the client ID number_ AND manual_index.ordinal = 0 ORDER BY manual_content.page_index ASC

What's giving me trouble, however, is that manual_index.ordinal = 0 - because unfortunately the first manual's ordinal isn't _always_ 0 (look, I just work here, alright?). Is there any way to make this query do ""manual_index.ordinal = (just the lowest one)""? Or do I need to break this into two queries - one on the manual_index that JUST returns the first row ORDERed BY ordinal ASC, then run the second query off the id I get from that (which would probably work, but is using two queries for something I bet can be done with one)?

I don't know how to describe this concisely enough to Google, so I really appreciate any help or advice.

edit: Typo",,False,self,t5_2qp8q,True,,,True,t3_kgt34,http://www.reddit.com/r/SQL/comments/kgt34/query_help_join_ahead/,
1303840996.0,8,self.SQL,gxxta,Which is a better join method?,Hactococcus,8,0,9,http://www.reddit.com/r/SQL/comments/gxxta/which_is_a_better_join_method/,"So I was wondering which is a better syntax.  Let's say I have Table1 which has a single key and Table2 &amp; Table3 which have multiple keys for each.  All tables share PKey.

So my Select starts off like this:

    Select t1.PKey, t1.Col1, t1.Col2...
    From Table1 t1, Table2 t2, Table3 t3

Normally I would write the join as such:

    Where
        t1.Key = t2.Key
        t1.Key = t3.Key
        other criteria....

The other day I ran across:

    Where
        t1.Key = t2.Key
        t2.Key = t3.Key
        other criteria...

I'm no expert but I would think creating a many-to-many join would have more processing overhead than two one-to-many joins.

Any opinions?",,False,self,t5_2qp8q,False,,,True,t3_gxxta,http://www.reddit.com/r/SQL/comments/gxxta/which_is_a_better_join_method/,
1299043951.0,8,self.SQL,fvlfs,Alternate column alias syntax?,tclas,8,0,19,http://www.reddit.com/r/SQL/comments/fvlfs/alternate_column_alias_syntax/,"Somewhere along the line I picked up this habit for aliasing my column names but I can't seem to find it documented anywhere. I'm worried it might be doing more than just aliasing my columns. Anyone know?

SELECT
   'Total Rows' = COUNT(*)
FROM Table",,False,self,t5_2qp8q,False,,,True,t3_fvlfs,http://www.reddit.com/r/SQL/comments/fvlfs/alternate_column_alias_syntax/,
1298487649.0,6,codinghorror.com,fr7z2,A handy graphical explanation of SQL joins ,expertvoice,13,7,1,http://www.reddit.com/r/SQL/comments/fr7z2/a_handy_graphical_explanation_of_sql_joins/,,,False,http://thumbs.reddit.com/t3_fr7z2.png,t5_2qp8q,False,,,False,t3_fr7z2,http://www.codinghorror.com/blog/2007/10/a-visual-explanation-of-sql-joins.html,
1290105859.0,8,self.SQL,e887e,Looking for feedback regarding my ridiculous project,Abstrct,9,1,3,http://www.reddit.com/r/SQL/comments/e887e/looking_for_feedback_regarding_my_ridiculous/,"So a couple years back I found a neat game called the mysqlgame (www.mysqlgame.com). At least the concept was neat, but I felt a bit cheated to see that it was really just putting values into forms and no SQL was needed. Since I had also wanted a project to learn more about Postgres, I set out to see if I could pull off the same concept while giving the players direct access to the database server. 

Thus, The Schemaverse was started. It is a multi-player space battle game written (almost) entirely in SQL and PL/pgSQL.

After about a year of working on it on and off, I finally have it at a stage where it is at least something to talk about. I admit, it may not be completely playable at this point (it needs a fair bit of testing), but I would love to hear everybody's thoughts on my ridiculous project. 

The projects main site is http://www.schemaverse.com
Documentation can be found on the wiki: http://github.com/Abstrct/Schemaverse/wiki

Anybody who has ever written a proper SQL statement will likely cringe when they see a lot of the code as it is all FAR from optimized. This is because I want to work on optimization after it is stable and then compare results so I can learn more about how Postgres handles different scenarios.
",,False,self,t5_2qp8q,False,,,True,t3_e887e,http://www.reddit.com/r/SQL/comments/e887e/looking_for_feedback_regarding_my_ridiculous/,
1376793135.0,7,self.SQL,1kl2a0,Got an interview coming up. What's a good resource to brush up on T-SQL?,Ein_Bear,7,0,9,http://www.reddit.com/r/SQL/comments/1kl2a0/got_an_interview_coming_up_whats_a_good_resource/,"I'm not exactly sure what it will cover, but it probably won't be anything heavy (entry level job). ",,False,self,t5_2qp8q,False,,,True,t3_1kl2a0,http://www.reddit.com/r/SQL/comments/1kl2a0/got_an_interview_coming_up_whats_a_good_resource/,
1376639035.0,6,self.SQL,1kh5ql,Help for a complete noob to look better at work?,Aztec_Mayan,8,2,4,http://www.reddit.com/r/SQL/comments/1kh5ql/help_for_a_complete_noob_to_look_better_at_work/,"Hey guys. So at work the data team uses SQL. They are not currently here and I urgently need to pull some stuff from a client. Basically I know how to open the program, export results to Excel, and that’s about it. So I am a completely clueless noob, ashamed to come here asking for help but it was my best shot at getting this done.

I a table called dbo.Cube with millions of rows. One of the columns is called “agent_name” of which there are something like 37,000 different names.


On another table called dbo.Agents are the 37,000 names grouped in categories. A column “LEVEL 1” has ~100 names and a column called “agent_name” with the 37,000 names. So all of the 37,000 fit into one of the 100. One of those ~100 is called “United”
What I need to do is from dbo.Cube get all the entries where the “agent_name” would fall into the “United” group of dbo.Agents column “LEVEL 1”

Any suggestion? I can imagine that this would be a super basic thing… I am just not knowledgeable at all at this stuff!

Thanks in advance and sorry for being an annoying noob =(
",,False,self,t5_2qp8q,False,,,True,t3_1kh5ql,http://www.reddit.com/r/SQL/comments/1kh5ql/help_for_a_complete_noob_to_look_better_at_work/,
1375721901.0,6,self.SQL,1jqzw0,[OBIEE] - Splitting rows into columns?,daniebanes13,7,1,14,http://www.reddit.com/r/SQL/comments/1jqzw0/obiee_splitting_rows_into_columns/,"Hi, 

My original data set looks like this: 

First Name | Last Name  |  System    |  Start Date  |    Role

Mark		Smith	             DOS	      04/13/2010	Admin
Mark		Smith	           Windows	     04/13/2010	Admin
Sarah		Cape	            MAC          05/22/2013	Senior
Sam		Hart	           Windows	    06/21/2012	Admin
Sam		Hart	            MAC	    06/21/2012	Admin

Is it possible to take the multiple rows of data (each system) and place them into columns like such: 
First Name | Last Name  |  System1 |  System2| System3|  Start Dat
Mark		    Smith	       DOS	    Windows		         2010	
Sarah		    Cape				             MAC	
Sam		    Hart		            Windows     MAC	

I am trying to avoid multiple lines of data. Can anyone help me with the coding? 
Thanks 
D
",,False,self,t5_2qp8q,False,,,True,t3_1jqzw0,http://www.reddit.com/r/SQL/comments/1jqzw0/obiee_splitting_rows_into_columns/,
1375416947.0,6,self.SQL,1jjmdl,Books/resources for just learning queries?,shinja59,8,2,6,http://www.reddit.com/r/SQL/comments/1jjmdl/booksresources_for_just_learning_queries/,"So I'm a 2012 college grad who has been working at a market research firm for the last year. I've recently decided to switch paths to being a Business Analyst/Data Analyst, which usually involves having a decent knowledge of SQL. However, as far as I know it doesn't really require knowing how to design/create databases, just the nitty gritty of how to manipulate existing ones, so that's what I'd like to really zero in on and become good at.

I've had some exposure to Microsoft Access which I've heard is essentially SQL on training wheels, but aside from the sheerest of basics I am pretty much a blank slate. Any recommendations for what books/resources/exercises would best set me on my way?",,False,self,t5_2qp8q,False,,,True,t3_1jjmdl,http://www.reddit.com/r/SQL/comments/1jjmdl/booksresources_for_just_learning_queries/,
1374820212.0,7,self.SQL,1j2zxf,Need help deciphering date/time format,TurdMurder,8,1,4,http://www.reddit.com/r/SQL/comments/1j2zxf/need_help_deciphering_datetime_format/,"Hi all, I have zero experience with SQL so hopefully someone can guide me in the right direction.

I just got an Android log app for my phone. Inputting two years of logs on my phone is far too tedious so I found the database file it stores the logs in and loaded up in SQLite on my computer. 

All the data is straightforward, except for the date and time. This is what it has:

1320125460758 = 10/31/2011, 10:31:00 PM

1322202480556 = 11/02/2011, 10:28:00 PM

1320734040589 = 11/07/2011, 10:34:00 PM

Does anyone have any idea how the date/time is being formatted? Thanks.
",,False,self,t5_2qp8q,False,,,True,t3_1j2zxf,http://www.reddit.com/r/SQL/comments/1j2zxf/need_help_deciphering_datetime_format/,
1374683564.0,6,self.SQL,1iyqad,Finding duplicate (aside from one field) records and selecting the appropriate,Grachuus,7,1,12,http://www.reddit.com/r/SQL/comments/1iyqad/finding_duplicate_aside_from_one_field_records/,"I am using a temp table to reduce issues with another SQL statement and in this temp table I'm getting shipping times for various objects.  Sometimes individual objects have multiple ship times.  I only care about the latest date.  How can I ensure my temp table only shows one ship time per object?  In the data sample I get ~106,000 lines at the moment and about ~12-1,600 have a duplication at the moment which then cascades into another report output as additional objects.",,False,self,t5_2qp8q,False,,,True,t3_1iyqad,http://www.reddit.com/r/SQL/comments/1iyqad/finding_duplicate_aside_from_one_field_records/,
1373729808.0,7,garysieling.com,1i7yvw,SQL Execution Plans In Javascript,gmsieling,10,3,0,http://www.reddit.com/r/SQL/comments/1i7yvw/sql_execution_plans_in_javascript/,,,False,http://c.thumbs.redditmedia.com/Bfo56Qdlx13RY1zn.jpg,t5_2qp8q,False,,,False,t3_1i7yvw,http://garysieling.com/blog/sql-execution-plans-in-javascript,
1373481750.0,6,self.SQL,1i0wf3,Double at (@@) weirdness in SQL*Plus,oddtimed,9,3,2,http://www.reddit.com/r/SQL/comments/1i0wf3/double_at_weirdness_in_sqlplus/,"Hi guys,

Today i was trying to deploy some code into QA using HP DMA. My master script ""A"" was calling other master scripts located in subdirectories which were calling script in other sub directories and I encountered some @@ weirdness.
The folder structure was like this:

    Folder-A
    |
    |___Master-A.sql
    |___Folder-B
          |___Master-B.sql 
          |___B.sql
          |___Folder-C
                |___one.sql
                |___two.sql
    
Master-A.sql

    @@FolderB/Master-B.sql

Master-B.sql

    @@B.sql
    @@Folder-C/one.sql
    @@Folder-C/two.sql

When I exe'd Master-A.sql, I was expecting all the *.sql's to be executed, but only Master-B.sql and B.sql got executed and I got a SQL*Plus error that it ""could not find one.sql and two.sql""

When I changed Master-B.sql to:

    @@B.sql
    @@Folder-B/Folder-C/one.sql
    @@Folder-B/Folder-C/two.sql

it could find all the scripts. I have no clue why this happened and have a couple questions

1. Is there any difference in execution between:

        @@FolderB/Master-B.sql 
and

        @@./FolderB/Master-B.sql

2. Master-B.sql could find B.sql, then why did it not find one.sql and two.sql. If @@ means Folder-A (I'm assuming so, because Master-A.sql was the first one to be called) then B.sql should also have not been found. Only on adding Folder-B to the paths of Master-B.sql, one.sql and two.sql were executed. Why did it find only B.sql and not one.sql and two.sql?

Looking forward to your help and wisdom on this one.",,False,self,t5_2qp8q,1373741242.0,,,True,t3_1i0wf3,http://www.reddit.com/r/SQL/comments/1i0wf3/double_at_weirdness_in_sqlplus/,
1372782640.0,5,self.SQL,1hi73q,[MS SQL]Return all records that had taken place within 14 days of the previous at any point in time.,newdaydre,9,4,6,http://www.reddit.com/r/SQL/comments/1hi73q/ms_sqlreturn_all_records_that_had_taken_place/,"Greetings and thanks for any assistance.  I'm trying to figure out how to return records for any individual vehicles that took place within 14 days of the previous event for the vehicle.  It is a bit confusing to explain so here is the code.

    SELECT Encounter01.EncounterID, Encounter01.VehicleID, Encounter01.CheckInDate, Encounter01.CheckOutDate, Encounter02.CheckInDate AS NextCheckInDate
    FROM RecordsDB.dbo.Encounter AS Encounter01
    INNER JOIN RecordsDB.dbo.Encounter AS Encounter02 
    ON Encounter01.VehicleID = Encounter02.VehicleID AND Encounter02.CheckOutDate BETWEEN (Encounter01.CheckOutDate) AND DATEADD(d,14, Encounter01.CheckOutDate) AND Encounter01.EncounterID &lt;&gt; Encounter02.EncounterID
    ORDER BY VehicleID, Encounter01.CheckinDate

I don't think it is returning information properly since it seems to me to be returning duplicates or something.

EDIT: Actually I think it is working.  I added Encounter02.EncounterID to the SELECT and it is showing unique EncounterID for each time the overlap occurs.",,False,self,t5_2qp8q,1372783109.0,,,True,t3_1hi73q,http://www.reddit.com/r/SQL/comments/1hi73q/ms_sqlreturn_all_records_that_had_taken_place/,
1372729290.0,7,self.SQL,1hgup2,[MS ACCESS] How do you use an aggregation in a calculated field?,Jolly_Wally,8,1,2,http://www.reddit.com/r/SQL/comments/1hgup2/ms_access_how_do_you_use_an_aggregation_in_a/,"Hi guys, SQL newcomer here so apologies if this is a stupid question. I have a table akin to the following:


| ID         | Field1      | Value        |
|:-----------|------------:|:------------:|
| A          |1            |  10 
| B          |2            |  20
| C          |2            |  20   
| D          |3            |  30     

I am aggregating on Field1 with the following sort of query:

SELECT Field1, MAX(Value) GROUP BY Field1

Producing a recordset such as:

| Field1     | Value       |
|:-----------|------------:|
| 1          |10  
| 2          |20        
| 3          |30  


I would like to extend the query to include a third, calculated field involving an aggregation of the Value field:


| Field1        | Value       | Calculation  |
|:-----------|------------:|:------------:|
| 1          |10           |  Value/SUM(Value)
| 2          |20           |  Value/SUM(Value)
| 3          |30           |  Value/SUM(Value)   

Yielding:

| Field1        | Value       | Calculation  |
|:-----------|------------:|:------------:|
| 1          |10           |  10/60
| 2          |20           |  20/60
| 3          |30           |  30/60    

Is this possible in a single query?

EDIT: Corrected table headers",,False,self,t5_2qp8q,1372738158.0,,,True,t3_1hgup2,http://www.reddit.com/r/SQL/comments/1hgup2/ms_access_how_do_you_use_an_aggregation_in_a/,
1372277821.0,7,self.SQL,1h4qd0,"getting error "" Can not divide by 0""",fa2442,8,1,15,http://www.reddit.com/r/SQL/comments/1h4qd0/getting_error_can_not_divide_by_0/,"I am trying to create a field in SQL by diving two of the fields in two different tables

It looks like

TableA.Balance/TableB.Total Revenue

however, in Table B total Rev is 0 for some of the customers.  this prevents me from running the query as i get am error ""can not divide by 0""

Suggestions on how to resolve this?",,False,self,t5_2qp8q,False,,,True,t3_1h4qd0,http://www.reddit.com/r/SQL/comments/1h4qd0/getting_error_can_not_divide_by_0/,
1371986255.0,5,self.SQL,1gwk5d,[MS SQL] How to open job,brochaos,6,1,4,http://www.reddit.com/r/SQL/comments/1gwk5d/ms_sql_how_to_open_job/,"Hey guys, this is a really basic question, but if I have a saved .sql file that is supposed to be a 'job', how do I open that with SSMS so it goes under the jobs folder (so I can edit the steps and then run).  When I open it now, it just opens like a regular query.  Thanks!",,False,self,t5_2qp8q,False,,,True,t3_1gwk5d,http://www.reddit.com/r/SQL/comments/1gwk5d/ms_sql_how_to_open_job/,
1370803117.0,4,self.SQL,1fzsbl,"Book to learn stored procedures, functions and transactions from",damnated,9,5,2,http://www.reddit.com/r/SQL/comments/1fzsbl/book_to_learn_stored_procedures_functions_and/,"Hi, I'm searching for a book (or online resource, video tutorial etc.) that would thoroughly explain stored procedures, functions, cursors, transactions and everything related. 

I don't have a specific database in mind, and I don't know if I should. Are Oracle's, MS SQL's, MySQL's etc stored procedures/transactions very different, or are they roughly the same?",,False,self,t5_2qp8q,False,,,True,t3_1fzsbl,http://www.reddit.com/r/SQL/comments/1fzsbl/book_to_learn_stored_procedures_functions_and/,
1370714266.0,5,self.SQL,1fxpm2,[MS SQL] 2012 performance with spatial queries,p2501,9,4,11,http://www.reddit.com/r/SQL/comments/1fxpm2/ms_sql_2012_performance_with_spatial_queries/,"We're pushing the boundaries of what our current configuration can handle with respect to SQL spatial joins and ""windowing"". I've reduced the pagefile size to alleviate some of the sluggishness of interacting with the server via Management Studio and RDP, but at the expense of processing speed. Queries that took 10 hours bumped up to 18 hours.

We're completely virtualized.

Backend:

* VMware vSphere 5.1 U1
* NetApp FAS2240 for storage using NFS

VM:

* MS Windows Server 2008 R2 Standard (8 CPU, 32 GB RAM)
* MS SQL Server 2012 Standard
* 8 TB storage
* Databases live on SAS 15K disks, but IOPS doesn't seem to be the issue since our NetApp is hitting 96%+ cache.

Examples of resource hogs:

* CPU - spatial join of 11 million blocks' relation to nearby points of interest, chunked per state. We are using spatial indexes.

* RAM - 130 GB table (half is indexes), 196 million rows. There's a couple hundred windowing functions finding a few thousand medians.

We're about to purchase Windows Server 2012 Standard since they've increased the amount of RAM allowed. We're also about to purchase SQL Server 2012 Enterprise so we can utilize the Resource Governor. I don't think there's a way to do active/active MS SQL clustering without doing read-only databases and a lot of headaches.

Something I'll be testing with the new purchases is putting our database volumes directly on the NetApp's CIFS shares, alleviating usage of vmdk's and the 2 TB limit and removing a layer of abstraction.

Is there something better that isn't Oracle (money reasons)? Or any SQL optimization tweaks that you've come across in your travels that could possibly increase performance?
",,False,self,t5_2qp8q,False,,,True,t3_1fxpm2,http://www.reddit.com/r/SQL/comments/1fxpm2/ms_sql_2012_performance_with_spatial_queries/,
1370640218.0,6,self.SQL,1fw0i0,Suggest SQL Classes?,ryanmcstylin,8,2,5,http://www.reddit.com/r/SQL/comments/1fw0i0/suggest_sql_classes/,"Hey everybody,
I am starting to work with SQL at my job and want to accelerate my learning.  My company has tuition reimbursement (does not have to be university), and I was wondering if anybody had experience with any courses and wanted to recommend a couple.  I am out of Chicago, but feel free to recommend for any city as it will help to see what a good course looks like on paper.

",,False,self,t5_2qp8q,False,,,True,t3_1fw0i0,http://www.reddit.com/r/SQL/comments/1fw0i0/suggest_sql_classes/,
1370564170.0,7,self.SQL,1ftv42,Interview Questions for a Jr. Level SSRS Report Developer,iDrinan,9,2,6,http://www.reddit.com/r/SQL/comments/1ftv42/interview_questions_for_a_jr_level_ssrs_report/,"Hey guys! Next Wednesday I have an interview for a junior level SSRS job, and I was curious if anyone has been in my shoes with such an interview.  I will be interviewing with the project manager and a SQL developer, and this will be my first technical interview I have ever had. I nailed the phone interview (~25min conversation) with confidence and ease, and I know I'll be able to build up a personal rapport as I'm all around a great interviewee. Right now, though, I'm primarily concerned with the possible questions they may ask. 

I have over a year and a half experience in creating SSRS reports and writing complex stored procedures, and I am very confident in my skills and abilities (I have singlehandedly developed the entire report catalogue my current company uses, and it employs 200+ complex statistical and auditing reports), but I am worried that I will not be able to articulate when they ask particular questions. I am very much so a hands on person, and I know incredibly well how to DO the tasks and I can work my way around SSMS and BIDS fluently. However, I can't help but worry I'll fumble over my words and not seem as knowledgeable as I really am, or that they'll ask a very simple question and I'll just be dumbfounded while I know the intricacies when it's in front of me.

So, is there anyone out there that has interviewed for a Jr. SSRS developer position or someone versed in the interview process that can offer me some tips for the technical interview? What exactly should I expect?

Also, should I print out a few of the reports I have created and bring them to the interview as examples, or should I can that idea?

Thanks everyone!",,False,self,t5_2qp8q,False,,,True,t3_1ftv42,http://www.reddit.com/r/SQL/comments/1ftv42/interview_questions_for_a_jr_level_ssrs_report/,
1370550817.0,6,imgur.com,1ftd54,[MS Sql] [EF] Good or bad design?,sevenalive,8,2,3,http://www.reddit.com/r/SQL/comments/1ftd54/ms_sql_ef_good_or_bad_design/,,,False,http://c.thumbs.redditmedia.com/qdfXs_jUNY-CcH_z.jpg,t5_2qp8q,False,,,False,t3_1ftd54,http://imgur.com/Mvk1Kgz.jpg,
1369098053.0,6,self.SQL,1eqes1,Looking for a SQL tutorial for programmers,Shyntzyne,7,1,12,http://www.reddit.com/r/SQL/comments/1eqes1/looking_for_a_sql_tutorial_for_programmers/,"I already know how to code in various languages (mainly Java and Python) and feel pretty competent in both the coding itself and the computer science algorithms behind the languages.

I'm looking to learn SQL for my new job. I've never worked with databases before although I feel very comfortable manipulating data and storing in various abstract structures.

Any suggestions?",,False,self,t5_2qp8q,False,,,True,t3_1eqes1,http://www.reddit.com/r/SQL/comments/1eqes1/looking_for_a_sql_tutorial_for_programmers/,
1367352995.0,6,self.SQL,1dfm6b,"I need help removing an entry from my Music Library's .db file, as the entry causes my computer to crash when launching the application. Details inside!",Darkness12,7,1,14,http://www.reddit.com/r/SQL/comments/1dfm6b/i_need_help_removing_an_entry_from_my_music/,"Hi there /r/SQL!

Let me preface by saying I do not know SQL language at all, but I did find and open the .DB file with SQLite. I was able to find the exact line as seen [HERE](http://i.imgur.com/n4hpoZg.png). The names of all the songs were very very long and contained unrecognizable characters, thus leading to the crash. I am unable to open the program and remove the entry so I have resorted to doing it the hard way, which is where I need your help!

That little ""Delete Record"" button in the corner does nothing, and I do not know the language well enough to execute an SQL command. How can I go about removing the ""Big Black Delta"" entry entirely? 

If it would be easier done by one of you hands-on redditors, I would be happy to upload the file and send you a link via PM, but I didn't want to put it up on here as it may contain info that I do not wish to necessarily share :)

Thank you so much for any advice!!

**UPDATE**

I was able to resolve my problem using the following line

     UPDATE Songs SET SongTitle = """" WHERE IDAlbum = 1997

in order to remove the title. I figured out that the problem with the methods that you kind redditors were suggesting was the fact that the Collate for this particular program doesn't work with most SQL readers. This made it so I was unable to DELETE, however UPDATE worked flawlessly.

Thank you all again for the help!",,False,self,t5_2qp8q,1367365516.0,,,True,t3_1dfm6b,http://www.reddit.com/r/SQL/comments/1dfm6b/i_need_help_removing_an_entry_from_my_music/,
1366140929.0,7,self.SQL,1chbh7,Is there a postgresql to mysql syntax converter? or can some one help me?,helpprogram2,10,3,2,http://www.reddit.com/r/SQL/comments/1chbh7/is_there_a_postgresql_to_mysql_syntax_converter/,I have this public [script](https://gist.github.com/sephto/5398895) in postGREsql but it needs to be in my sql. I don't really have too much SQQL background and i'm having trouble changing the syntax,,False,self,t5_2qp8q,False,,,True,t3_1chbh7,http://www.reddit.com/r/SQL/comments/1chbh7/is_there_a_postgresql_to_mysql_syntax_converter/,
1365462142.0,8,self.SQL,1by84l,[T-SQL] Creating dummy date values in reporting table,randomperson24,8,0,7,http://www.reddit.com/r/SQL/comments/1by84l/tsql_creating_dummy_date_values_in_reporting_table/,"Currently I have my table listed as the doctor, month of the year the visit took place, and the matching year.  Such as:
[Here](http://postimg.org/image/xnudgkwu9/)
Based on this example, doctor smith had at least one visit in Jan, Feb, Mar, July, Aug, Oct 2012 according to the visit’s datetime() value from the original table.  The datetime value was then split apart into the values above through DatePart(year, column) and DatePart(month, column).
The issue I am running into, is if there was no visits for that particular month such as in the case above Apr, May, Jun, Sep, Nov, Dec 2012, than there will be no rows for my reporting table.  Is there a way to create a row for a provider which would create a year and month when there is none present?  I have been trying ISNULL but am having a problem of coming up with a way to use it correctly.
Currently I have
SELECT
	Provider,
Datepart(year, service date),
Datepart(month, service date)
INTO #temp
FROM
	Visit table
GROUP BY 
Provider,
Datepart(year, service date),
Datepart(month, servicedate)
",,False,self,t5_2qp8q,False,,,True,t3_1by84l,http://www.reddit.com/r/SQL/comments/1by84l/tsql_creating_dummy_date_values_in_reporting_table/,
1364235244.0,5,self.SQL,1azj65,Invalid Syntax issue with a DB query,lonerangers,7,2,6,http://www.reddit.com/r/SQL/comments/1azj65/invalid_syntax_issue_with_a_db_query/,"SQL is not even in my skill set. I am helping a client who has an ecommerce platofrm(volusion). They tell me how to do everything [here](http://support.volusion.com/article/export-google-merchant-center).

When I run the query, I get told ""Your SQL is invalid: Incorrect syntax near '.'""

My guess is that the lines I copy out of there have a comma at the begining of it and there are no ; at the end of lines.

How would I know which lines to end with the syntax?

Sorry for the very basic question. I looked for a volusion subreddit, but I couldn't find one.
",,False,self,t5_2qp8q,False,,,True,t3_1azj65,http://www.reddit.com/r/SQL/comments/1azj65/invalid_syntax_issue_with_a_db_query/,
1362854447.0,6,self.SQL,19zc48,Assistance with T-SQL JOIN?,statuek,7,1,5,http://www.reddit.com/r/SQL/comments/19zc48/assistance_with_tsql_join/,"Right now I have two tables, call them Singles and Averages.

Singles is:
    
    PersonID (PK)
    EventID (FK)
    best
    worldRank

Averages is:

    PersonID (PK)
    EventID (FK)
    best
    worldRank

I'm trying to combine these two tables.
Basically, the resulting table should be:

""Merge is:

    PersonID (PK)
    EventID(FK)
    bestSingle ('best' from Singles)
    bestAverage ('best' from Averages)
    worldRankSingle ('worldRank' from Singles)
    worldRankAverage ('worldRank' from Averages)""

Here's what I have right now.

    SELECT  RanksAverage.[personId],
	RanksAverage.[eventId],
	RanksAverage.[best] AS 'averageBest',
	RanksAverage.[worldRank] AS 'averageRank',
	RanksSingle.best AS 'singleBest',
	RanksSingle.worldRank AS 'singleRank'

    FROM [cubing].[dbo].[WCA_export_RanksSingle] AS RanksSingle

    JOIN [cubing].[dbo].[WCA_export_RanksAverage] AS RanksAverage
	ON RanksAverage.personId = RanksSingle.personId


I'm using SQL Server 2012, by the way.",,False,self,t5_2qp8q,False,,,True,t3_19zc48,http://www.reddit.com/r/SQL/comments/19zc48/assistance_with_tsql_join/,
1362598956.0,6,self.SQL,19sklx,[MySQL] Walk me through this SQLZoo problem?,nakedbitches,6,0,13,http://www.reddit.com/r/SQL/comments/19sklx/mysql_walk_me_through_this_sqlzoo_problem/,"I'm currently stuck on Question 16 [here](http://sqlzoo.net/wiki/More_JOIN_operations).

You may want to read more about the database via the link at the top. Here's the question:

&gt;List all the people who have worked with 'Art Garfunkel'.

Here's the correct query from the answer key:

    SELECT DISTINCT a.name

    FROM actor a JOIN casting b ON (a.id=b.actorid)

        JOIN casting c ON (b.movieid=c.movieid)

        JOIN actor d ON (c.actorid=d.id

            AND d.name = 'Art Garfunkel')

        WHERE d.id &lt;&gt; a.id

I'm just not able to wrap my head around the need for the extra joins or what exactly they're doing. Here was my (failed) attempt at the problem:

    SELECT name FROM actor,casting

        WHERE movieid IN (SELECT movieid FROM actor,casting

            WHERE name='Art Garfunkel' AND actor.id=actorid)   

        AND name &lt;&gt; 'Art Garfunkel'

        AND actor.id=actorid

This query fails to run at all.

PS - For those who are interested I've found SQLZoo very useful, though it certainly doesn't hold your hand. I've found that by sticking with the difficult ones I've eventually been able to solve them and it's like a little part of your brain opens up. Unfortunately I can't seem to conceptualize this one.",,False,self,t5_2qp8q,1362599497.0,,,True,t3_19sklx,http://www.reddit.com/r/SQL/comments/19sklx/mysql_walk_me_through_this_sqlzoo_problem/,
1360700463.0,7,self.SQL,18eajs,[MySQL] How to join these,pandamaja,7,0,6,http://www.reddit.com/r/SQL/comments/18eajs/mysql_how_to_join_these/,"I'm working with a very old mysql 4.0 database.   tableA has two numeric fields 'Num1', 'Num2' that map to a single look up field in tableB, text.   

One of the dev's informed that to get 'Num1' you must query tableB as:

    SELECT tableB.text
    from tableB
    where tableB.id = '1'
    and tableB.status = 'A""
    and tableB.value = 'tableA.Num1'

Similarly 'Num2' can be retrieved with an almost identical query by changing the tableid  value

    SELECT tableB.text
    from tableB
    where tableB.id = '26'
    and tableB.status = 'A""
    and tableB.value = 'tableA.Num2'

Is there a way I can return the text definitions for both Num1 and Num2 within a single query? thanks!

*edit - sorry for the crappy non descriptive title.


Solution :


    SELECT b1.text as 'Num1'
          ,b2.text as 'Num2'
    FROM tableB b1 
       join tableA a on b1.value = a.Num1
       join tableB b2 on b2.value = a.Num2
    WHERE 
       b1.id = ""1""
    AND 
       b1.status = ""A""
       and a.acct = 'abcdefg'  (table a key)
    
Thanks again for your help!",,False,self,t5_2qp8q,1360704218.0,,,True,t3_18eajs,http://www.reddit.com/r/SQL/comments/18eajs/mysql_how_to_join_these/,
1360436578.0,6,firebirdnews.org,187d5m,SplendidCRM on FirebirdSQL demo page and database structure,mariuz,7,1,0,http://www.reddit.com/r/SQL/comments/187d5m/splendidcrm_on_firebirdsql_demo_page_and_database/,,,False,default,t5_2qp8q,False,,,False,t3_187d5m,http://www.firebirdnews.org/?p=8296,
1357132508.0,5,self.SQL,15todi,Are recursive queries actually used in data warehousing or large coorporations?,igotocollege,9,4,21,http://www.reddit.com/r/SQL/comments/15todi/are_recursive_queries_actually_used_in_data/,"I'm a senior master industrial engineer computer science student and i was wondering, one of our topics is now recursive sql which stands for 60% of database course points.
I would like to know how this is used in real life or is it just another academical waste of time?",,False,self,t5_2qp8q,False,,,True,t3_15todi,http://www.reddit.com/r/SQL/comments/15todi/are_recursive_queries_actually_used_in_data/,
1354726657.0,6,self.SQL,14bvc1,"Using Case When and Getdate Function(), where to place parentheses?",randomperson24,6,0,12,http://www.reddit.com/r/SQL/comments/14bvc1/using_case_when_and_getdate_function_where_to/,"I'm trying to figure out what is incorrect with the following statement for T-SQL:

SELECT

	#Client_Diagnosis.""Client_ID"",

CASE WHEN #Client_Diagnosis.""Birth_Date"" &lt; GETDATE()-2189 THEN '0-5'

	WHEN #Client_Diagnosis.""Birth_Date"" BETWEEN GETDATE()-2190 AND GETDATE()-4379 THEN '6-11'

	WHEN #_Client_Diagnosis.""Birth_Date"" BETWEEN GETDATE()-4380 AND GETDATE()-6569 THEN '12-17'

	ELSE 'Older than 18' END AS 'Age_Group',

	#Client_Diagnosis.""Diagnosis""

FROM 

	#Client_Diagnosis

When I run this script I get only 0-5 and Older than 18; '6-11' and '12-17' are not present in the final table.  However, there should be results for the groups '6-11' and '12-17' should be.  I believe I need parentheses but do not know where to place them in the 'Case When' part of the statement.",,False,self,t5_2qp8q,1354727773.0,,,True,t3_14bvc1,http://www.reddit.com/r/SQL/comments/14bvc1/using_case_when_and_getdate_function_where_to/,
1351796093.0,6,self.SQL,12gz0i,Poor C# developer needs some mad SQL skilled help.,AbstractLogic,9,3,9,http://www.reddit.com/r/SQL/comments/12gz0i/poor_c_developer_needs_some_mad_sql_skilled_help/,"Problem. At some point some one or SQL created a .ndf file. Then al shitton of tables had their storage mapped to this .ndf file. Now my company would like me to delete this .ndf file. 

To do so I see that I should run DBCC SHRINKFILE('USERGROUP1',EMPTYFILE)

However this command will only move between files in the same file group. Currently my .ndf and .mdf are in separate file groups. 

Any clues on how to move all the data from the .ndf to the .mdf when they are in different file groups?",,False,self,t5_2qp8q,False,,,True,t3_12gz0i,http://www.reddit.com/r/SQL/comments/12gz0i/poor_c_developer_needs_some_mad_sql_skilled_help/,
1351284577.0,6,self.SQL,1255q1,Data from XML,Dylan_Ram_Brick,8,2,9,http://www.reddit.com/r/SQL/comments/1255q1/data_from_xml/,"I have a database that stores a large chunk of XML containing information about installations our companies products. There is no schema defined for the XML and no one has a list of all potential tags.

Each record has hundreds of structures like this:
array type=""DWORD"" name=""m_somesetting.SMTPPorts"" size=""5""&gt; &lt;set&gt;19&lt;/set&gt; &lt;set&gt;1D0&lt;/set&gt; &lt;set&gt;14B&lt;/set&gt; &lt;/array&gt;

I have been asked to create a table showing each possible tag a value and a count of how many of our tens of thousands of records have that particular setting. 

Does anyone know how I might automate this? I have a reasonable understanding of how to do queries against XML but I need some way to first get each tag that exists and then get each unique value that exists and finally a count of records that contain that value. 

Any ideas of how to do this short of hand coding each possible tag into a query?",,False,self,t5_2qp8q,False,,,True,t3_1255q1,http://www.reddit.com/r/SQL/comments/1255q1/data_from_xml/,
1350566200.0,5,self.SQL,11or7g,"Help me /r/sql, you're my only hope!",Jayzar,8,3,27,http://www.reddit.com/r/SQL/comments/11or7g/help_me_rsql_youre_my_only_hope/,"Hi

Am really stuck on a project at the moment and would very much appreciate your help!

I am using SQL Server 2008

I have a table that has a primary key on a uniqueidentifier (no good for clustered indexing then)

I have a clustered index on a column ""CreationDate"" which is a datetime2(7) and has a default value of sysdatetime().


Am getting ""Cannot insert duplicate key row in object"" errors when trying to insert multiple items at once using c#.  They are in the same transaction though, could this be why?

Completely stuck by this and google has been no help at all so far :(


EDIT: When I say ""at once"" I mean in a linear order but one straight after another.

EDIT2: Thank you to everyone who's posted here. I've learned a new thing!  Mission successful :)
",,False,self,t5_2qp8q,1350633094.0,,,True,t3_11or7g,http://www.reddit.com/r/SQL/comments/11or7g/help_me_rsql_youre_my_only_hope/,
1350432471.0,7,self.SQL,11lmga,"Given no budget constraints, why would I choose mirroring over clustering (MSSQL 2008)",Tofinochris,8,1,6,http://www.reddit.com/r/SQL/comments/11lmga/given_no_budget_constraints_why_would_i_choose/,"I'm currently doing a pros/cons grid for a couple of managers on a few high availability solutions.  I've done something similar a few years back and I remember that most of the cons of clustering were budget -- you needed Enterprise/Datacenter edition of Windows, you needed whizzier hardware and network.  In this situation, we've got as whizzy a VM as they want to have, unlimited Enterprise licenses, and a great network, and the customers have a big budget and don't care at all about anything but giant numbers at this point.

The general need from the folks we're supplying the HA solution to is for automatic failover, near-instantaneous (&lt;1m at the worst) recovery time, no data loss (barring transactions/connections at time of failure).

I'm having problems finding any reason not just to replace my grid with a giant ""Screw it, we're going with a cluster"" in 72 point green type.  What am I missing here?  With the restrictions of budget removed so that we don't care about extra hardware or software cost, mirroring actually seems like a *bigger* pain because we need a third SQL instance for the witness.
",,False,self,t5_2qp8q,False,,,True,t3_11lmga,http://www.reddit.com/r/SQL/comments/11lmga/given_no_budget_constraints_why_would_i_choose/,
1350405729.0,7,self.SQL,11ksbk,"open source, cross platform data flow diagramming software?",ashtray_nuke,8,1,6,http://www.reddit.com/r/SQL/comments/11ksbk/open_source_cross_platform_data_flow_diagramming/,"I am looking for a decent data flow modeling tool, it must be freeware or open source and cross platform (windows and linux) so that I can use it collaboratively with a few other students at my uni. Any suggestions? I've seen dia but my professor doesn't seem to like it for some raisins.",,False,self,t5_2qp8q,False,,,True,t3_11ksbk,http://www.reddit.com/r/SQL/comments/11ksbk/open_source_cross_platform_data_flow_diagramming/,
1350397461.0,6,self.SQL,11kk37,Pull unique records from 2 tables?,jp_pennypacker,7,1,15,http://www.reddit.com/r/SQL/comments/11kk37/pull_unique_records_from_2_tables/,"Pretty new to sql and i am having problems figuring out this query, lets say i have 2 tables:
table 1
part number
price
quantity
table 2
part number 
price

I would like to see what part numbers in table 2 are not in table 1?  I've tried using DISTINCT but i'm sure i'm using it wrong as it returns the full runout of parts from table 1 instead of table 2.

Any help is GREATLY appreciated thanks guys!",,False,self,t5_2qp8q,False,,,True,t3_11kk37,http://www.reddit.com/r/SQL/comments/11kk37/pull_unique_records_from_2_tables/,
1349662160.0,6,self.SQL,1147o7,Interview tomorrow. Writing questions to test knowledge before interview and writing queries. Mind taking a look and see where I'm failing?,loki0wn,6,0,5,http://www.reddit.com/r/SQL/comments/1147o7/interview_tomorrow_writing_questions_to_test/,"Question:
Top 30 product groups, showing the product name, revenue for each product, in a shipped to a given zip code.

Query:

SELECT pi.ProductName, pi.productgroup, revenue

FROM

(SELECT pi.productname, pi.productgroup, revenue, RANK() OVER 
(PARTITION BY product group ORDER BY revenue DESC) as rank)

FROM

(SELECT pi.productname, pi.productgroup, SUM(o.qty * o.price) OVER 
(PARITION BY o.productid) as revenue)

FROM

orders o JOIN productinfo pi ON o.productid = pi.productid

JOIN

ShipToInfo Ship

ON

o.customerid = ship.customerid

GROUP BY pi.productgroup

WHERE ShipToInfo.zipcode = ""44444"" AND rank &lt;= 30

Question 2:

Customers often buy a product and an accessory. However, not everyone who buys an accessory bought the product. How many are there who have bought the product without the accessory, bought the product and accessory, and only the accessory. Return in a single query.
SELECT 

sum(CASE WHEN o1.productid = ""Product"" THEN 1 ELSE 0 END), 

sum(CASE WHEN o1.productid = ""Product AND o2.productid = ""Accessory"" THEN 1 ELSE 0 END), 

sum(CASE WHEN o2.productid = ""Accessory"" THEN 1 ELSE 0 END)

FROM

orders o1 RIGHT JOIN orders o2 ON o1.customerid = o2.customerid


Anyone else have questions that could possibly be related to this that I could try?

THANKS!

",,False,self,t5_2qp8q,False,,,True,t3_1147o7,http://www.reddit.com/r/SQL/comments/1147o7/interview_tomorrow_writing_questions_to_test/,
1347172295.0,6,ledgersmbdev.blogspot.com,zlczj,"MySQL v. PostgreSQL, an apples to oranges comparison",einhverfr,7,1,0,http://www.reddit.com/r/SQL/comments/zlczj/mysql_v_postgresql_an_apples_to_oranges_comparison/,,,False,default,t5_2qp8q,False,,,False,t3_zlczj,http://ledgersmbdev.blogspot.com/2012/09/or-modelling-interlude-postgresql-vs.html,
1345877878.0,4,self.SQL,ysq4m,SQL Questions (Beginner here),SQLLEARNERRR,8,4,12,http://www.reddit.com/r/SQL/comments/ysq4m/sql_questions_beginner_here/,"Studying book on SQL and comparing to actual code I am seeing and wtf I have tons of questions. Let's take the following code for example:
( case when (select  w.PRIMARY_ASSIGNMENT_FK from worker_edition w where v.WORKER_EDITION_ID = w.WORKER_EDITION_ID) = WORK_ORDER_ASSIGNMENT_NUMBER then 'Y' else 'N' end)

why do some of the column names have ""w"" and then there are floating w's, then some column names have v. in front of them. What does that mean or do exactly? Haven't been able to find it.

This is form an Oracle db.",,False,self,t5_2qp8q,False,,,True,t3_ysq4m,http://www.reddit.com/r/SQL/comments/ysq4m/sql_questions_beginner_here/,
1344262749.0,5,i.imgur.com,xrl5m,"It's not that complicated Google, it's only SQL..",imdsm,20,15,6,http://www.reddit.com/r/SQL/comments/xrl5m/its_not_that_complicated_google_its_only_sql/,,,False,http://b.thumbs.redditmedia.com/XYW3WXZh-1Dzv_1I.jpg,t5_2qp8q,False,,,False,t3_xrl5m,http://i.imgur.com/PVIWv.png,
1340910442.0,4,self.SQL,vr6zg,I need a crash course in the basics of SQL database management before an interview Monday,Esparno,17,13,23,http://www.reddit.com/r/SQL/comments/vr6zg/i_need_a_crash_course_in_the_basics_of_sql/,"I have an interview for a tier 1 support position working with SQL databases and need some recommended reading/viewing to cram with or at least learn some basic syntax.

They do in-house training and I intend on using the almighty google to look myself, but am interested in what reddit has to say.

Any help would be appreciated.

EDIT: Derp I am now reading the stuff on the sidebar.",,False,self,t5_2qp8q,1340910855.0,,,True,t3_vr6zg,http://www.reddit.com/r/SQL/comments/vr6zg/i_need_a_crash_course_in_the_basics_of_sql/,
1339587179.0,7,syntaxwarriors.com,uznv6,MSSQL Table Variable vs. Temporary Table.. Nerdyness at its best :),wokawaka,7,0,7,http://www.reddit.com/r/SQL/comments/uznv6/mssql_table_variable_vs_temporary_table_nerdyness/,,,False,default,t5_2qp8q,False,,,False,t3_uznv6,http://www.syntaxwarriors.com/2012/t-sql-table-variable-vs-temporary-table/,
1339451141.0,7,self.SQL,uwtlm,MSSQL Junior BI Developer Interview on Friday. What should I be reading up on?,chainofoli,7,0,12,http://www.reddit.com/r/SQL/comments/uwtlm/mssql_junior_bi_developer_interview_on_friday/,"So I have an interview for a junior BI developer position on Friday. I've been working as a trainee dba for 6 months for a company that does everything wrong when it comes to database administration/development (not the DBA's fault, more so the way the company operates).

I'd say I'm competent with my query knowledge for 6 months experience (selects, joins, grouping functions, sub-queries). I have a little knowledge in transactions, stored procedures, XML and I'm studying towards taking my MCTS exam. I have never used SSIS or SSAS but know my way around SSRS. The company takes the Kimball approach to data warehousing and although I understand the concept I haven't worked with a data warehouse before. BI is the path I want to go down and this job will give me a massive amount of valuable experience.

So Reddit, help me out. What do I need to read up on to show them that I'm switched on and eager to learn? Interview is Friday morning (GMT).",,False,self,t5_2qp8q,False,,,True,t3_uwtlm,http://www.reddit.com/r/SQL/comments/uwtlm/mssql_junior_bi_developer_interview_on_friday/,
1334990758.0,7,pixelstech.net,sl05m,Never ever touch a programmer,Andrey_Karpov_N,10,3,2,http://www.reddit.com/r/SQL/comments/sl05m/never_ever_touch_a_programmer/,,,False,http://c.thumbs.redditmedia.com/ey1gKNaShYQ587C8.jpg,t5_2qp8q,False,,,False,t3_sl05m,http://pixelstech.net/article/index.php?id=1334985588,
1332270770.0,5,self.SQL,r5hdn,[Access] Question on filtering Query results,NkafKe,6,1,4,http://www.reddit.com/r/SQL/comments/r5hdn/access_question_on_filtering_query_results/,"I have 3 tables involved (Leads, Agents, and Applications) but it's primarily one that is giving me trouble.  

The Leads table consists of five columns: Agent_ID (which corresponds to the Agent table), Num_Leads, Received_Date (date leads were given out), and End_Date (not used here).  There's also Lead_ID which is used for the Primary Key, but not much else.

An agent is given X amount of leads every X amount of days, and is logged appropriately.  I need to bring up the most recent Received_Date for every agent (that is listed in the Leads table) as well as the corresponding Num_Leads for that date.  

I can bring up just the most recent dates, but when I add Num_Leads it brings up any most-recent 'unique' combination of Date and Num_Leads.

Later I run this through another query which pulls up Application data based on the Received_Date, so having multiple Received_Dates for each agent won't give me the results I need.

I have a basic understanding of databases, but never got into SQL much (more of a VB/C++ kind of guy).  But I'm sure I could follow SQL to a degree, which I'm thinking is my best option for this.

Any help is greatly appreciated.",,False,self,t5_2qp8q,False,,,True,t3_r5hdn,http://www.reddit.com/r/SQL/comments/r5hdn/access_question_on_filtering_query_results/,
1329491414.0,7,arlocarreon.com,ptxbx,1million records of Spatial Data with Postgre and PostGIS,mexitek,7,0,2,http://www.reddit.com/r/SQL/comments/ptxbx/1million_records_of_spatial_data_with_postgre_and/,,,False,http://d.thumbs.redditmedia.com/qqsPvqmVMTQfbXuc.jpg,t5_2qp8q,False,,,False,t3_ptxbx,http://www.arlocarreon.com/blog/postgis/postgre-function-for-generating-postgis-spatial-data/,
1329232034.0,6,self.SQL,pp59n,MS-Access SQL : multiple where statements,KingZing,7,1,6,http://www.reddit.com/r/SQL/comments/pp59n/msaccess_sql_multiple_where_statements/,"Quick question as I'm fairly new to using SQL.

I want to show results that do not meet critiera, based on another criteria. How would I code this or put it in the design view ?
For example (would be 9 or 10 of these)

* If field1 = 1000 and field 3 &lt;&gt; 302000123 then report result


* If field1 = 2000 and field 3 &lt;&gt; 230300030 then report result


* If field1 = 2500 and field 3 &lt;&gt; 002390400 then report result

**EDIT**
Awesome, after talking through some private messages, and these comments I found a solution.

it ended up being multiple nested iif statements as access didn't allow case statements.

Thanks again for the help",,False,self,t5_2qp8q,True,,,True,t3_pp59n,http://www.reddit.com/r/SQL/comments/pp59n/msaccess_sql_multiple_where_statements/,
1313509905.0,6,self.SQL,jkk45,SQL Server - Is it possible to view/modify a SP from TSQL? ,xstockix,6,0,3,http://www.reddit.com/r/SQL/comments/jkk45/sql_server_is_it_possible_to_viewmodify_a_sp_from/,"I am responsible for a single DB on an instance with several DB's. My security access prevents me from seeing anything in the Object Explorer. I need to make a small syntax change to a stored procedure. I'm wondering if it's possible to pull up the Modify SP script using TSQL. 

Thanks in advance!",,False,self,t5_2qp8q,True,,,True,t3_jkk45,http://www.reddit.com/r/SQL/comments/jkk45/sql_server_is_it_possible_to_viewmodify_a_sp_from/,
1294585714.0,6,self.SQL,eyz99,Good SQL learning materials?,,6,0,5,http://www.reddit.com/r/SQL/comments/eyz99/good_sql_learning_materials/,I want to learn SQL. I know a little about databases but would like to get some SQL learning in. Should I work on DBs then move to SQL?,,False,self,t5_2qp8q,False,,,True,t3_eyz99,http://www.reddit.com/r/SQL/comments/eyz99/good_sql_learning_materials/,
1291785427.0,6,self.SQL,ei3r0,New SQL Dev - struggling with larger queries,sqldev34,6,0,13,http://www.reddit.com/r/SQL/comments/ei3r0/new_sql_dev_struggling_with_larger_queries/,"Hi all,

I've recently started my first SQL programming job, doing reporting with Reporting Services.

One of my first tasks has been to fix a report which has a query with approximately 10 joins, and aliases on each table. I struggled with this one for the majority of the workday today, and didn't get much closer to comprehending the query. I've tried stepping-through and paraphrasing each join, and imagining the result set at each of the joins, however once I get past four or five, I lose it. 

Surely there has to be a better way to understanding how a query works than stepping through TABLE1 INNER JOIN TABLE 2 ON TABLE1.PK= TABLE2.FK INNER JOIN TABLE3 AS TABLEX ON TABLE2.PK=TABLE3.FK INNER JOIN TABLE4 ON TABLE3.PK=TABLE4.FK etc.?

Does anyone have any advice on how to picture/comprehend the result-set (tablespace) for a larger query? How do people who write queries with ~10 joins and large numbers of aliases comprehend what they're doing?

I'm thinking it could require a higher cognitive or IQ aptitude than I possess, and that's got me a little scared.

For reference, I'm straight out of Polytech/College, and am competent with doing smaller SQL reports, but the work I'm being given feels like it's going to be very difficult for me to achieve. 

My manager's in meetings most of the day, and my collegues are all busy with their own work, I don't know who to ask for help, and feel scared to admit that I can't do this work at the moment. I've let my manager know I'm having trouble.

I know what each join is, and I can mostly understand the corporate field-naming system, so it's not specific to this workplace.

Does anyone have any advice on how I can get to grips with larger SQL queries (with subqueries), or information that could help? ",,False,self,t5_2qp8q,False,,,True,t3_ei3r0,http://www.reddit.com/r/SQL/comments/ei3r0/new_sql_dev_struggling_with_larger_queries/,
1273850239.0,6,mysqlperformanceblog.com,c43su,Checking for a live database connection considered harmful,Samus_,6,0,0,http://www.reddit.com/r/SQL/comments/c43su/checking_for_a_live_database_connection/,,,False,http://thumbs.reddit.com/t3_c43su.png,t5_2qp8q,False,,,False,t3_c43su,http://www.mysqlperformanceblog.com/2010/05/05/checking-for-a-live-database-connection-considered-harmful/,
1265930041.0,7,brentozar.com,b11a5,Top 10 Reasons Why Access Still Doesn't Rock,cruise02,7,0,5,http://www.reddit.com/r/SQL/comments/b11a5/top_10_reasons_why_access_still_doesnt_rock/,,,False,http://thumbs.reddit.com/t3_b11a5.png,t5_2qp8q,False,,,False,t3_b11a5,http://www.brentozar.com/archive/2010/02/top-10-reasons-why-access-still-doesnt-rock/,
1255540673.0,7,sqlite.org,9u108,SQLite Foreign Key Support,,8,1,0,http://www.reddit.com/r/SQL/comments/9u108/sqlite_foreign_key_support/,,,False,default,t5_2qp8q,False,,,False,t3_9u108,http://www.sqlite.org/draft/foreignkeys.html,
1376959055.0,5,self.SQL,1kp9tq,is it possible to query 2 separate items in 1 query?,whoisearth,6,1,6,http://www.reddit.com/r/SQL/comments/1kp9tq/is_it_possible_to_query_2_separate_items_in_1/,"I'm trying to figure out how to do this.

Basically what I have is a database where some items drill down 3 levels.

Think of it like so - 

ID  prntid Name  DateTime
23452 NULL Item1 Time
23456 23452 Item2 Time
23459 23456 Item3 Time

What I want to do is give me the info for Item1  with the Time from Item3.

Unfortunately you can't do something like - 

SELECT ID, Name, (SELECT DateTime from TableA where ID = (SELECT prntID FROM TableA where ID = (SELECT prntID FROM TableA where ID = 23456)) FROM TableA

If that makes sense, are there any ways to do this?  I can't do a temp table (that I know of) because the query for the Time will always involve the 3rd level of the ID not the associated prntID of the prntID.

I know it could be done by selecting the time and associating it with the prntID as the ID and then doing it again associating the time with the prntID again (to get to the top level) but then I'm making 3 temp tables just to get the data I want into one table.  PITA but it works.",,False,self,t5_2qp8q,False,,,True,t3_1kp9tq,http://www.reddit.com/r/SQL/comments/1kp9tq/is_it_possible_to_query_2_separate_items_in_1/,
1375801592.0,5,self.SQL,1jtc71,[MS SQL] Where 'last week',YouGiveSOJ,7,2,5,http://www.reddit.com/r/SQL/comments/1jtc71/ms_sql_where_last_week/,"I have a where clause here which returns all BLANK with a date within last week. It works, but I want to understand how it works. When I first searched the web I found this solution, but the local SQL developer initially thought it wouldn't be possible. Then I showed him this, he looked at it for a few seconds, then said, 'yea that will work actually'.

Does anyone want to take a crack at explaining how?

    WHERE 
       ReturnDate &gt;= dateadd(day,1, datediff(day,0,dateadd(day,-1*datepart(weekday,getdate())+1,dateadd(week,-1,getdate()))))
    AND ReturnDate &lt; dateadd(day,2, datediff(day,0,dateadd(day,7,dateadd(day,-1*datepart(weekday,getdate()),dateadd(week,-1,getdate())))))",,False,self,t5_2qp8q,False,,,True,t3_1jtc71,http://www.reddit.com/r/SQL/comments/1jtc71/ms_sql_where_last_week/,
1375668968.0,4,self.SQL,1jpr55,I'm moving from MySQL to PostgreSQL with PHP as a backend. I need a little direction.,Tcullen1121,6,2,2,http://www.reddit.com/r/SQL/comments/1jpr55/im_moving_from_mysql_to_postgresql_with_php_as_a/,"I'm making the move to cut the cost of distribution as low as possible on my web application. I'm still learning quite a bit as a programmer and don't really have a full grasp on everything to begin with as I have just been having to pick up learning so much so fast at this point with only 5 months of development and a full time job, the application is pretty much ready to go after this migration.

I was using mysqli prepared statements and I'm looking for the closest equivalent in pgsql. Is PDO using prepared statements my only option? I'd like to avoid escape strings as well.

If PDO is my only option where is the best place to get started aside from php.net?",,False,self,t5_2qp8q,False,,,True,t3_1jpr55,http://www.reddit.com/r/SQL/comments/1jpr55/im_moving_from_mysql_to_postgresql_with_php_as_a/,
1375241288.0,4,self.SQL,1jeby6,"[MS SQL] Need help turning rows of varchar data into columns (similar to PIVOT, but with text)",ITAndrew,5,1,4,http://www.reddit.com/r/SQL/comments/1jeby6/ms_sql_need_help_turning_rows_of_varchar_data/,"I am trying to write a query using the table below - this table comes from a vendor supplied system, so I can't modify it:

    Item_ID, Tag
    ITEM1, Blue
    ITEM1, Warm
    ITEM2, Green
    ITEM3, Coarse
    ITEM2, Fine

There is a maximum of four Tag records for one Item. I want to get the result set below:

    Item_ID, TAG1, TAG2, TAG3, TAG4
    ITEM1, Blue, Warm, NULL, NULL
    ITEM2, Green, Fine, NULL, NULL
    ITEM3, Coarse, NULL, NULL

I have done this previously by creating a temp table with an ID column and the structure of the second table, inserting the select distinct Item_IDs, then using a while loop to iterate through the first table, updating the rows in the second where the second table's Item_ID matches the first's, but there isn't an existing Tag field with the value for that Item_ID.

The problem with this solution is it means looping through the first table, then inside of that loop, looping through the second and updating where needed, which is very resource intensive. I've looked at the PIVOT command, but I can't find any samples with varchar values (the samples I've seen all have some sort of aggregation/count which I can't see how to adapt).

Does anyone know any more efficient ways of doing the above transformation?",,False,self,t5_2qp8q,False,,,True,t3_1jeby6,http://www.reddit.com/r/SQL/comments/1jeby6/ms_sql_need_help_turning_rows_of_varchar_data/,
1374878553.0,4,self.SQL,1j4lkc,08 R2 Query index fragmentation with names,killer833,6,2,5,http://www.reddit.com/r/SQL/comments/1j4lkc/08_r2_query_index_fragmentation_with_names/,"Ok, so i can successfully run the following against my DB, but i would like to know if there is a way to return the names of the index itself and the associated table. thanks.

&gt;

SELECT object_id AS ObjectID,

  index_id AS IndexID,

  avg_fragmentation_in_percent AS PercentFragment,

  fragment_count AS TotalFrags,

  avg_fragment_size_in_pages AS PagesPerFrag,

  page_count AS NumPages
   

FROM sys.dm_db_index_physical_stats(DB_ID(N'DatabaseName'),

  NULL, NULL, NULL , 'DETAILED')

WHERE avg_fragmentation_in_percent &gt; 20

ORDER BY PercentFragment, ObjectID, IndexID",,False,self,t5_2qp8q,False,,,True,t3_1j4lkc,http://www.reddit.com/r/SQL/comments/1j4lkc/08_r2_query_index_fragmentation_with_names/,
1374253984.0,4,self.SQL,1in4vh,help running querie off of linked tables,fareaf3,6,2,7,http://www.reddit.com/r/SQL/comments/1in4vh/help_running_querie_off_of_linked_tables/,"ok.... I have two tables and I need to create a join between the two based on Reference Numbers.

however, the reference numbers in table A are in text format.

the reference numbers in table B are in number format.

I get a type mismatch expression when i try to run this query in access.

these tables are linked from other databases and i do not have access to go in and modify the table paramaters.

is there any way around this rather than making a copy of one of the tables every single time i run this query, so i can change the reference number paramater to text for both tables?

",,False,self,t5_2qp8q,False,,,True,t3_1in4vh,http://www.reddit.com/r/SQL/comments/1in4vh/help_running_querie_off_of_linked_tables/,
1373821570.0,5,self.SQL,1ia7u1,Looking for pl/sql practice,mrdedwardel,9,4,3,http://www.reddit.com/r/SQL/comments/1ia7u1/looking_for_plsql_practice/,"This sub has helped me once before and I hope to contribute in a meaningful way in the future but for now I come seeking answers.  Here goes, I am working in my MIS, and I just finished and intro db class.  I did well enough with select queries to end up with a b in the class, but stored procedures and triggers have caused me problems.  Are there any programs where I can work in a db environment, create and execute triggers just to keep practicing?  I will still be able to access the server used in class until mid August but after that nothing.  I am using oracle client and sql tools.  Any help is greatly appreciated!
",,False,self,t5_2qp8q,False,,,True,t3_1ia7u1,http://www.reddit.com/r/SQL/comments/1ia7u1/looking_for_plsql_practice/,
1373390945.0,5,self.SQL,1hy3c1,[MSAccess] Can anyone help with my code?,daniebanes13,7,2,5,http://www.reddit.com/r/SQL/comments/1hy3c1/msaccess_can_anyone_help_with_my_code/,"I am dealing with 3 dates - If date1 is null use date 2, if date 1 and date 2 are null use date 3 ELSE use dat2 1. The first part is working but the second IF statement is not displaying results. My code is below: Dates: IIf([MILESTONES]![Date1] Is Null,[MILESTONES]![Date2], IIf([MILESTONES]![Date2] Is Null AND [MILESTONES]![Date1] Is NULL, [MILESTONES]![Date3],[MILESTONES]![Date1])) 

Thanks in advance",,False,self,t5_2qp8q,False,,,True,t3_1hy3c1,http://www.reddit.com/r/SQL/comments/1hy3c1/msaccess_can_anyone_help_with_my_code/,
1371866876.0,6,self.SQL,1gu18w,Using SQL in econometric analysis,Loonga,6,0,3,http://www.reddit.com/r/SQL/comments/1gu18w/using_sql_in_econometric_analysis/,"Hi, I am a graduate student studying Economics, and I was hoping to get some experience using SQL. I was hoping I could use it in an applicable way for this project I am working on. Is there any way I could use SQL to query data from the ST. Louis Fed's website? Is there any way I could use SQL to query any financial or economic data from the internet?

Thanks a million",,False,self,t5_2qp8q,False,,,True,t3_1gu18w,http://www.reddit.com/r/SQL/comments/1gu18w/using_sql_in_econometric_analysis/,
1371085238.0,5,self.SQL,1g8j3m,"Looking to learn, didn't know if you guys had any links or a wiki provided for resources...",mistawac,10,5,8,http://www.reddit.com/r/SQL/comments/1g8j3m/looking_to_learn_didnt_know_if_you_guys_had_any/,"As the title says, I kind of thrust myself into a ""junior"" DBA position and learned what I needed as the time came.  I'm now looking for a more formalized, informative introduction and education on SQL and DBMS's in general.  I'm talking ground up to fill in the blanks.

Any recommendations?",,False,self,t5_2qp8q,False,,,True,t3_1g8j3m,http://www.reddit.com/r/SQL/comments/1g8j3m/looking_to_learn_didnt_know_if_you_guys_had_any/,
1370249224.0,4,self.SQL,1fkklq,I'm looking for a SQL PL tutor,xCHRISTIANx,6,2,4,http://www.reddit.com/r/SQL/comments/1fkklq/im_looking_for_a_sql_pl_tutor/,"Hello, I'm a college student looking to graduate this month if I can pass this class. I'm taking an advanced database management class and I'm struggling. I really, really need help. Can anyone help me or point me in the right direction please? Thank you.",,False,self,t5_2qp8q,False,,,True,t3_1fkklq,http://www.reddit.com/r/SQL/comments/1fkklq/im_looking_for_a_sql_pl_tutor/,
1369922990.0,5,self.SQL,1fc4uw,[MySQL] Help with calculating totals and ordering in a single query,Dicko21,5,0,7,http://www.reddit.com/r/SQL/comments/1fc4uw/mysql_help_with_calculating_totals_and_ordering/,"Hi all,

I've created [this](http://i.imgur.com/nG8JRhe.png) picture to better demonstrate my point as I probably can't word too good after spending hours with this problem. The gist of it is that I have 4 (3?) tables that I need to join with each other in order to gather a total to sort by, allowing me to place the most voted for at the top of the table/least voted for at the bottom.

Any help would be hugely appreciated - if you need any more info from me please let me know.

Cheers!",,False,self,t5_2qp8q,False,,,True,t3_1fc4uw,http://www.reddit.com/r/SQL/comments/1fc4uw/mysql_help_with_calculating_totals_and_ordering/,
1369869074.0,6,self.SQL,1fau1f,Calculate Mortgage Payment (SQL Server 2008),kci-04,6,0,1,http://www.reddit.com/r/SQL/comments/1fau1f/calculate_mortgage_payment_sql_server_2008/,"Hi SQL Guru's... For my job I have been assigned the task of converting a legacy program/report from SAS into our SQL Server environment. I've been successful thus far, however there is a function in SAS (mort) that will calculate a missing variable, in this case payment, if provided 3 of the 4 variables. Is there a way to accomplish this using SQL?
Below is a sample from the SAS documentation:

&gt;In the following statement, an amount of $50,000 is borrowed for 30 years at an annual interest rate of 10 percent compounded monthly. The monthly payment can be expressed as follows:
    payment=mort(50000, . , .10/12,30*12);
The value that is returned is 438.79 (rounded). The second argument has been set to missing, which indicates that the periodic payment is to be calculated. The 10 percent nominal annual rate has been converted to a monthly rate of 0.10/12. The rate is the fractional (not the percentage) interest rate per compounding period. The 30 years are converted to 360 months.

Syntax
MORT(a,**p**,r,n) - the period(.) in sas is the same as NULL.
Arguments
a=is numeric, and specifies the initial amount.
p=is numeric, and specifies the periodic payment.
r=is numeric, and specifies the periodic interest rate that is expressed as a fraction.
n=is an integer, and specifies the number of compounding periods.

Any thoughts? 
",,False,self,t5_2qp8q,False,,,True,t3_1fau1f,http://www.reddit.com/r/SQL/comments/1fau1f/calculate_mortgage_payment_sql_server_2008/,
1369830687.0,6,self.SQL,1f9ja4,"SQL string help, oh masters of the database!",shemp5150,6,0,10,http://www.reddit.com/r/SQL/comments/1f9ja4/sql_string_help_oh_masters_of_the_database/,"I'm still learning sql, and what I do know is all self taught.  I was wondering if anyone out there might be able to help me with a script I'm working on.  

I'm trying to remove 3 characters from a column within a table.   The three characters are all the same, ""ESQ"".  There are about 100,000 records to go through, so I'd like to automate it instead of manually doing it. Any help with this would be immensely appreciated!

*edit* Also, just saw on the sidebar that I was supposed to put this [MS SQL] in the title.  Sorry about that!",,False,self,t5_2qp8q,False,,,True,t3_1f9ja4,http://www.reddit.com/r/SQL/comments/1f9ja4/sql_string_help_oh_masters_of_the_database/,
1369487546.0,5,self.SQL,1f10dc,[Oracle] Joins question,almost665evil,5,0,6,http://www.reddit.com/r/SQL/comments/1f10dc/oracle_joins_question/,"I am still new to SQL. I am using the SQL Developer to query Banner, and I get stuck when I am using joins. If I am outer joining multiple tables, how do I recognize what condition to join them on? For instance.

If I am joining Table A with Table B and then also with Table C, would my on conditions be Table A_ID=Table B_ID for the first join and Table A_ID=Table C_ID for the second? ",,False,self,t5_2qp8q,False,,,True,t3_1f10dc,http://www.reddit.com/r/SQL/comments/1f10dc/oracle_joins_question/,
1369261788.0,6,self.SQL,1ev54k,What is the easiest way to transfer Excel data to MS SQL Server?,yellising,6,0,27,http://www.reddit.com/r/SQL/comments/1ev54k/what_is_the_easiest_way_to_transfer_excel_data_to/,"Seeing as they are both MS products, I'm hoping that Excel does have a feature to easily import data to MS SQL Server. I would like to try and migrate my existing project (in excel) to SQL as my data is getting bigger and bigger. 

Thanks, r/sql!",,False,self,t5_2qp8q,False,,,True,t3_1ev54k,http://www.reddit.com/r/SQL/comments/1ev54k/what_is_the_easiest_way_to_transfer_excel_data_to/,
1368906925.0,6,ideone.com,1elbwq,An online tool to build simple tables and test SQL statements,kuszi,6,0,2,http://www.reddit.com/r/SQL/comments/1elbwq/an_online_tool_to_build_simple_tables_and_test/,,,False,http://f.thumbs.redditmedia.com/Feuqi2qnkrtPU7FG.jpg,t5_2qp8q,False,,,False,t3_1elbwq,http://ideone.com/clone/W4ePc,
1368332695.0,7,self.SQL,1e6258,[MS SQL] Need help optimizing a SELECT query that pulls from some huge tables.,mcraamu,7,0,12,http://www.reddit.com/r/SQL/comments/1e6258/ms_sql_need_help_optimizing_a_select_query_that/,"SQL 2005. 

Almost every one of the tables called has more than 20 million rows in each table. All of the columns referenced have some sort of index on them. 

This query takes hours to run. I'm hoping to improve the run time to &lt;1 hours rather than 5+. Any advice would be appreciated, and sorry for the shitty formatting. Thanks.

    SELECT DISTINCT
    LBTS.LoadNum AS LoadNum,
    LBTS.StopSeqNum AS StopSeqNum,
    LBT.CustomerCode AS CustomerCode,
    C.Name AS CustomerName
    FROM
    dbo.LoadBillToStops LBTS(NOLOCK) --55 million rows
    INNER JOIN
    dbo.LoadBillTos LBT (NOLOCK) ON LBTS.LoadNum= LBT.LoadNum AND LBTS.BillToSeqNum = LBT.SequenceNum --24 million rows
    LEFT OUTER JOIN
    dbo.Stops ST(NOLOCK) ON LBTS.LoadNum= ST.LoadNum AND LBTS.StopSeqNum = ST.SeqNum --50 million rows
    INNER JOIN
    dbo.Warehouses WA (NOLOCK) ON ST.WarehouseCode = WA.CompanyCode -- 6 million rows 
    INNER JOIN
    dbo.Customers C (NOLOCK) ON C.CompanyCode= LBT.CustomerCode -- 850K rows
    INNER JOIN
    dbo.LoadMatch LM(NOLOCK) ON LBTS.LoadNum= LM.LoadNum -- 20 million rows
    INNER JOIN 
    dbo.Loads LD(NOLOCK) ON LM.LoadNum= LD.LoadNum -- 21 million rows
    INNER JOIN
    dbo.PBBARegion PBAR (NOLOCK) ON -- 0 rows
    (LM.CustomerBranch = PBAR.BranchNumber
    OR
    LM.CarrierBranch = PBAR.BranchNumber
    OR
    LD.ControlBranchCode = PBAR.BranchNumber)
    INNER JOIN
    dbo.PBBADateRange PBADR (NOLOCK) ON -- 1 row
    (LD.EnteredDate BETWEEN
    PBADR.StartDate AND
    PBADR.EndDate
    OR
    LD.UpdatedDate BETWEEN
    PBADR.StartDate AND
    PBADR.EndDate
    OR
    C.UpdatedDate BETWEEN
    PBADR.StartDate AND
    PBADR.EndDate
    OR
    WA.UpdatedDate BETWEEN 
    PBADR.StartDate AND
    PBADR.EndDate)
    AND
    LM.LoadStatus = 90
    AND
    LM.Condition &lt;&gt; 'X'
    AND
    LM.Condition = 'F'
    ",,False,self,t5_2qp8q,False,,,True,t3_1e6258,http://www.reddit.com/r/SQL/comments/1e6258/ms_sql_need_help_optimizing_a_select_query_that/,
1368129785.0,3,self.SQL,1e0t30,"Is it possible to make this query? Seems simple, but I can not figure it out.",BusinessBoy38,5,2,12,http://www.reddit.com/r/SQL/comments/1e0t30/is_it_possible_to_make_this_query_seems_simple/,"
Two tables

Table  (A) has three fields- (1) Billing Item  (2) Fee  (3) Status(Price or Tax)

 Billing item shows up twice. Once with a Tax Status and once with a Price Status.  


Table (B) has two fields. (1) Billing Code. (2) Fee

This billing code matches the billing code from Table (A).  However, the billing code may show up HUNDREDS of times.  One for each FEE.  

The Fee in table A was a grand total of every product bought.  And the Fee in table B is a single products price which is always different.

I want to make a query that looks like this

Billing Code------Sum Table A FEE--------- Sum Table B Fee


the two fee columns should sum to 0.

I will be doing more than this at the end, but this is just to get started.  Can you guys help? Would save me 1 hour of copy paste a day lol",,False,self,t5_2qp8q,False,,,True,t3_1e0t30,http://www.reddit.com/r/SQL/comments/1e0t30/is_it_possible_to_make_this_query_seems_simple/,
1367112973.0,5,self.SQL,1d8ys8,[Oracle] Getting multiple errors. Any kind of help would be greatly appreciated.,Windrider,5,0,5,http://www.reddit.com/r/SQL/comments/1d8ys8/oracle_getting_multiple_errors_any_kind_of_help/,"I'm trying to use a subquery to join two tables. I think that it's the last part of the subquery where I'm getting all of my errors. I want to be able to find out if the current date is 14+ days past the date recorded in the ""BILL_DATE"" column. I'm pretty new at this so all of this could be completely wrong. Anything would be appreciated.    

The code that I have:    
      
    UPDATE CUSTOMER    
    SET CUS_STATUS = 'INACTIVE'    
    WHERE CUS_ID IN(    
                    SELECT CUS_ID    
                    FROM BILLING    
                    WHERE BILL_STATUS = 'OPEN'    
                    AND SYSDATE() &gt;= DATEADD(day 14, BILL_DATE))
);    
Edit: Using Oracle Database 10g Express Edition.
            ",,False,self,t5_2qp8q,1367116461.0,,,True,t3_1d8ys8,http://www.reddit.com/r/SQL/comments/1d8ys8/oracle_getting_multiple_errors_any_kind_of_help/,
1366826435.0,5,self.SQL,1d0v5f,SSIS - help passing date parameters to SQL Task,mmohon,6,1,6,http://www.reddit.com/r/SQL/comments/1d0v5f/ssis_help_passing_date_parameters_to_sql_task/,"I'm about to beat my head up against the wall over this, and I've followed several guides I've found off google.  So I'm turning to reddit.

I've got an Insert query I need to run to update a table, it has a Where DDATE Between @StartDate And @EndDate.

My connection type in SSIS is an OLE DB.
I have both variables mapped to DATE type parameters called 0 &amp; 1, size -1 for both.

In my query I've tried:

WHERE DDATE Between ? AND ?;

I've also tried:

Declare @StartDate Date

Declare @EndDate Date 

Set @StartDate = ?

Set @EndDate = ?

WHERE DDATE Between @StartDate AND @EndDate;

I keep getting parse errors, the query runs great when not using parameters.",,False,self,t5_2qp8q,False,,,True,t3_1d0v5f,http://www.reddit.com/r/SQL/comments/1d0v5f/ssis_help_passing_date_parameters_to_sql_task/,
1365631039.0,6,self.SQL,1c3cft,[MS SQL] Beginner COUNT question,lazerus,7,1,7,http://www.reddit.com/r/SQL/comments/1c3cft/ms_sql_beginner_count_question/,"So I'm just starting to learn and am having some trouble coming up with some totals. I have a Table Main with columns for TaskID, ModuleID, and Priority. I want to result a table grouped by ModuleID that lists the Total number of Tasks per ModuleID and the Total number of a specific priority per Module ID. I can get total Tasks per Module or Total Priority by Module, but not both. Any ideas? Thanks for helping a rookie out!

    SELECT ModuleID, COUNT(TaskID) as 'Total Tasks'
    FROM AmsTaskMain
    WHERE Priority = 'U'
    GROUP BY ModuleID
    ORDER BY 'Total Tasks' desc
",,False,self,t5_2qp8q,False,,,True,t3_1c3cft,http://www.reddit.com/r/SQL/comments/1c3cft/ms_sql_beginner_count_question/,
1365608544.0,3,self.SQL,1c2h1r,Displaying all stores that have above the average amount of employees?,S-Q-L,6,3,14,http://www.reddit.com/r/SQL/comments/1c2h1r/displaying_all_stores_that_have_above_the_average/,"I am new to SQL so I apologize ahead of time if there is a simple answer to this. We have been discussing functions in class, and were given practice problems based on fake data about toy stores.  One problem in particular has me stumped. As the title implies, the output has to display all toy stores that have above the average amount of employees (displaying all of the columns of the Store table).

There are two tables involved: Employee and Store. Employee has within it the store ID. What I had in mind was this:

SELECT *

FROM Store, (SELECT e_sid, COUNT(*) AS Count FROM Employee GROUP BY e_sid)

WHERE Count &gt; (SELECT AVG(Count));

I know this is wrong, but every other method I think of always concludes with that last line. Any input/advice?",,False,self,t5_2qp8q,1365610612.0,,,True,t3_1c2h1r,http://www.reddit.com/r/SQL/comments/1c2h1r/displaying_all_stores_that_have_above_the_average/,
1365533307.0,5,self.SQL,1c08s6,Question about splitting SQL,CodingCarpenter,6,1,6,http://www.reddit.com/r/SQL/comments/1c08s6/question_about_splitting_sql/,"Hello everyone, Ive been trying to import a database at Bluehost and its been just awful. I first tried simply gzipping the thing that timed out obviously. I tried using ssh and the server drops me after a few minutes.

So finally we come to splitting the file. I used a program to hack it down to roughly 15MB files the original being 178MB. I start importing them but its saying I have duplicate entries on every single one I try to upload.

Is there a better way to split these files up? Or a program a bit better at its job than sql_splitter? I just need this database up and running...",,False,self,t5_2qp8q,False,,,True,t3_1c08s6,http://www.reddit.com/r/SQL/comments/1c08s6/question_about_splitting_sql/,
1365458313.0,4,self.SQL,1by2va,Conversion Failed[MS SQL],tedistkrieg,5,1,5,http://www.reddit.com/r/SQL/comments/1by2va/conversion_failedms_sql/,"I have an automated sql reporting server report that runs Monday-Friday.  It has worked fine until today. I ran the SQL script and I keep getting this error     

    Conversion failed when converting the varchar value '5,235' to 
    data type int.

Nothing has changed from Friday to Today so I have no idea why its doing that. Any ideas?",,False,self,t5_2qp8q,False,,,True,t3_1by2va,http://www.reddit.com/r/SQL/comments/1by2va/conversion_failedms_sql/,
1365034410.0,5,self.SQL,1bmjr3,How to use IS NOT in a join?,ExceptionallyStrange,6,1,15,http://www.reddit.com/r/SQL/comments/1bmjr3/how_to_use_is_not_in_a_join/,"For this problem I have 2 tables I'm using. This query needs to use SELECT to find any auctions that didn't receive any bids. 

The tables and columns used for this query are ""AUCTION_ITEM"" with the columns ""itemName"" and ""itemDescription"" and table ""BID"" using column ""bidAmount""

The tables are joined via the key column ""itemID""

This is what I have tried:

SELECT AUCTION_ITEM.itemName, AUCTION_ITEM.itemDescription, BID.amount

FROM AUCTION_ITEM 

JOIN BID
ON AUCTION_ITEM.itemID=BID.itemID

WHERE AUCTION_ITEM.itemID NOT IN BID.itemID

GROUP BY itemName, itemDescription


//My understanding for this query to work, It needs to identify the itemID that is in the table AUCTION_ITEM, but not in table BID as it didn't receive any bids.

Can anyone tell me what I'm doing wrong?",,False,self,t5_2qp8q,False,,,True,t3_1bmjr3,http://www.reddit.com/r/SQL/comments/1bmjr3/how_to_use_is_not_in_a_join/,
1364403899.0,5,self.SQL,1b4bf1,Lost in Integers - DATETIME and Latitude/Longitude,I_637261636b_bits,5,0,7,http://www.reddit.com/r/SQL/comments/1b4bf1/lost_in_integers_datetime_and_latitudelongitude/,"Ok Reddit, I really hope you can help me with this. I have NO experience whatsoever in SQL, but I am working with a database at my worksite. Mostly keeping to the web interface, but we have some text files that need to be imported that aren't in the SQL import format.  
  
I am building a down and dirty OpenOffice Calc operation in order to quickly convert the text files into a SQL INSERT line.  
However, my problem comes from converting a time (HH:MM:SS) into the SQL integer, and converting a Latitude or Longitude (HHMMSS) into a SQL integer.  
  
I don't need/want to know how to do this via SQL, I would like to know HOW SQL does the math conversion, so I can write the appropriate formula.  
  
Here are some examples:  
**SQL Value : Text Field**  
1359014801 : 08:06:41  
1359014886 : 08:08:06  
  
13993000 : 353131N  
126044000 : 0350044E  
  
  
ANY and ALL help is appreciated. I apologize if I didn't use the proper terminology, I've been Googling^TM all over, and haven't been able to find a good guide on the math involved.",,False,self,t5_2qp8q,False,,,True,t3_1b4bf1,http://www.reddit.com/r/SQL/comments/1b4bf1/lost_in_integers_datetime_and_latitudelongitude/,
1364225222.0,5,self.SQL,1az6m0,[MS SQL] collapsing multiple records into one,pennywaltz,5,0,7,http://www.reddit.com/r/SQL/comments/1az6m0/ms_sql_collapsing_multiple_records_into_one/,"I am very new and inexperience with SQL. I need help!   So I have appointment data and I have counted all my appointments for each person and created a table.

    id	type		count
    
    1	canceled	55
    
    1	no show		10
    
    1	show		5
    
    2	canceled	40
    
    2	no show		15
    
    2	show		22

So with this table above, I am hoping to have the following table: 

    id	canceled	noshow		show
    
    1	55			10			5
    
    2	40			15			22

At first, I was thinking, if I transpose it, it would work, but it didn't. I am unsure how would I do this. I am thinking perhaps merging it a few times by each appointment type. BUt I am not sure.

I am hoping someone can provide me some guidance!


    ",,False,self,t5_2qp8q,1364244040.0,,,True,t3_1az6m0,http://www.reddit.com/r/SQL/comments/1az6m0/ms_sql_collapsing_multiple_records_into_one/,
1364154679.0,6,self.SQL,1axg7s,[SQLITE] Creating new databases,iarcfsil,6,0,1,http://www.reddit.com/r/SQL/comments/1axg7s/sqlite_creating_new_databases/,"Hey folks, I'm trying to go through the LearnSQLTheHardWay book online and am a bit confused by it. The book is a bit confusing and pretty vageu on lots of instructions, which explains why it's still in alpha mode.

Anyways, I installed sqlite3 and created a database `ex1`

But when I try to run the command `ex1.db &lt; ex1.sql` I get an error saying that `ex1.sql is not a file in the directory`

I'm confused as to how to create the `.sql` file since it's never explained in the introduction or the [first lesson](http://sql.learncodethehardway.org/book/ex1.html). 

Any help would be appreciated.

Also, are there any recommended online resources for learning SQL? I've tried using sqlzoo.net but it's not very good; it jumps around in the material without explaining or mentioning it. I know of [http://www.learn-sql-tutorial.com] (http://www.learn-sql-tutorial.com) and [http://www.sqlcourse.com/intro.html](http://www.sqlcourse.com/intro.html) but haven't tried either of them since I've been trying to use LearnSQLTheHardWay.",,False,self,t5_2qp8q,False,,,True,t3_1axg7s,http://www.reddit.com/r/SQL/comments/1axg7s/sqlite_creating_new_databases/,
1363817473.0,5,self.SQL,1aoxd7,[MSSQL] Just a bit of bother with a Query ,SeniorNoob,5,0,4,http://www.reddit.com/r/SQL/comments/1aoxd7/mssql_just_a_bit_of_bother_with_a_query/,"Just a Query that I have been stuck with for the past couple of hours.
I am using MS Access at the minute to do my sql queries in if that makes a difference.

Here is a picture of the table Im doing :- [Table](http://i.imgur.com/ZQQJslF.png)



So what I have to do is use select statements to show each unique album name, how many tracks that album has and to work out the total run time of each album. I have been able to get the first two done but when it comes to the last one with finding the runtime of each album I cannot work out. I have posted the code I have so far below :- 

    SELECT AlbumName, COUNT(AlbumName) AS NumberOfTracks
    FROM Tracklists
    GROUP BY AlbumName;

So I know this may be a rookie question but any help will be greatly appreciated. ",,False,self,t5_2qp8q,False,,,True,t3_1aoxd7,http://www.reddit.com/r/SQL/comments/1aoxd7/mssql_just_a_bit_of_bother_with_a_query/,
1363810868.0,5,self.SQL,1aooe1,[MS SQL] Need some help on a query...,tehxeno,8,3,3,http://www.reddit.com/r/SQL/comments/1aooe1/ms_sql_need_some_help_on_a_query/,"I have two tables:

    Appointments 	(CustomerID,AppointmentID,SalesRepID,Status,AppointmentDate)

    ResultedSales	(CustomerID,AppointmentID,ResultedDate)

I am looking for records in Appointments where:

1. 	The status is resulted(As opposed to pending, canceled, open, etc)
2. 	The Customer has been sold to previously (CustomerID in ResultedSales)
3. 	The Appointment was not resulted as a sale (AppointmentID not in ResultedSales)
4. 	The Appointment occurs after the first time the customer was sold to  
(AppointmentDate &gt; AppointmentDate of the smallest AppointmentID record in ResultedSales for that CustomerID)
5. 	The SalesRep who was assigned to the appointment is the same as the previous sale  
(SalesRepID = SalesRepID of any AppointmentID record in ResultedSales for that CustomerID)

The first three are achieved with 

    Select Distinct .AppointmentID from Appointments A
        join ResultedSales RS on A.CustomerID=RS.CustomerID
	Where A.StatusID='resulted'
	And A.CustomerID in (Select CustomerIDfrom ResultedSales)
	And A.AppointmentID Not in (select AppointmentID from ResultedSales)


But I cannot figure out how to achieve #4 and #5

Any help/tips?
",,False,self,t5_2qp8q,1363812461.0,,,True,t3_1aooe1,http://www.reddit.com/r/SQL/comments/1aooe1/ms_sql_need_some_help_on_a_query/,
1363708553.0,6,self.SQL,1aljqi,[IDE Suggestions] Switching from Rapid SQL,TurboGranny,9,3,30,http://www.reddit.com/r/SQL/comments/1aljqi/ide_suggestions_switching_from_rapid_sql/,"We have been using Embarcadero Rapid SQL and Embarcadero DB Artisan for several years at my company, but the program seems to get less stable and slower with each update.  They don't support 64 bit environments, and their wonky DRM makes it a pain to setup in a VDI.  One of our LAN Admins suggested PrimalSQL as an alternative, but I wanted to ask SQL developers and DB Admins what they use.  We have the full range of DB types which include MS SQL 2001-2008 R2, Oracle 9i - 11g, MYSQL, Access, and Excel, but only Oracle and MSSQL are of serious consequence.

We are a free hand SQL shop, but by schema asset browsing, import/export tools, and function/procedure editing are a must.  Code hinting, code generators, and live table editors are appreciated.",,False,self,t5_2qp8q,False,,,True,t3_1aljqi,http://www.reddit.com/r/SQL/comments/1aljqi/ide_suggestions_switching_from_rapid_sql/,
1363374070.0,5,self.SQL,1ad643,[PostgreSQL] COALESCE with GROUP BY?,PavementBlues,5,0,5,http://www.reddit.com/r/SQL/comments/1ad643/postgresql_coalesce_with_group_by/,"Hi all. I was wondering if anyone else has encountered issues with using COALESCE in a grouping statement.

Here is what I'm working with:

    SELECT 'Controlled - HbA1c &lt; 7' AS group_name,
        coalesce(round(avg(v19_g1_rate) *100, 1), 0) AS percentage,
        coalesce(to_char(sum(v19_g1_count), 'FM9,999,999,999'), '0') as formatted_count,
        1 as order_id
    FROM hca.v19_org_grouped_data
    JOIN kali.dat_date AS start_date
          ON start_date.dat_uid = v19_dat_uid_start
    JOIN kali.dat_date AS end_date
          ON end_date.dat_uid = v19_dat_uid_end
    WHERE /* Lots of irrelevant stuff */
    GROUP BY v19_dat_uid_start
    ORDER BY v19_dat_uid_start desc
    LIMIT 1

My problem is the no data condition. When I run this without the GROUP BY, the COALESCE works fine and I get a single row with the zeros that I was looking for. However, when I try grouping, the COALESCE is rendered ineffectual.

Does anyone know how to get around this? Thanks!",,False,self,t5_2qp8q,False,,,True,t3_1ad643,http://www.reddit.com/r/SQL/comments/1ad643/postgresql_coalesce_with_group_by/,
1362523141.0,5,i.imgur.com,19qib3,MIN is actually giving me MAX?? help ,sports89,5,0,8,http://www.reddit.com/r/SQL/comments/19qib3/min_is_actually_giving_me_max_help/,,,False,default,t5_2qp8q,False,,,False,t3_19qib3,http://i.imgur.com/lys2twx.png?1,
1359270184.0,5,self.SQL,17cykk,SQL on mac OS,uptothetop,7,2,6,http://www.reddit.com/r/SQL/comments/17cykk/sql_on_mac_os/,"Hi,

I currently use sql fairly often at work and I am looking to improve my skills.  I often result to writing simple queries and then performing the rest of the analysis in excel.  I would like to try to avoid some of this by doing more with sql.

**QUESTION**:

Is there any type of software that I can use on **MAC OS**?  Something that I can:
1.  Make my own database/schema with my own play data
2.  Run queries and the like on this data that I can add/edit/delete

My knowledge is not the best but I feel I have a solid foundation and in order to get better I would need hands on experience.  Thanks",,False,self,t5_2qp8q,False,,,True,t3_17cykk,http://www.reddit.com/r/SQL/comments/17cykk/sql_on_mac_os/,
1357592229.0,6,self.SQL,1651s2,[MSSQL] How do I select rows where multiple items of a list are present?,black27696,6,0,9,http://www.reddit.com/r/SQL/comments/1651s2/mssql_how_do_i_select_rows_where_multiple_items/,"Database containing sales for stores. I need to know every ticket where at least two of the items in {1, 2, 3, 4, 5, 6, 7, 8} are connected to it.

I'll figure out the structure, but if I'm understanding what they're asking me, if a customer purchases at least two items in the list then that's a special deal, so I need to know every time that at least two items in my list have appeared.

I'm just not well versed enough in sql to know how to set up a clause that translates to ""at least two of these""",,False,self,t5_2qp8q,False,,,True,t3_1651s2,http://www.reddit.com/r/SQL/comments/1651s2/mssql_how_do_i_select_rows_where_multiple_items/,
1356934457.0,5,self.SQL,15pnk8,Looking for a prof online SQL class that goes at your own pace. ,lksdford,8,3,3,http://www.reddit.com/r/SQL/comments/15pnk8/looking_for_a_prof_online_sql_class_that_goes_at/,My work has $1250 that I can use until 12/31/12 for a SQL class that would need to start by that day. Any ideas for online classes that I could start on 12/31/12?,,False,self,t5_2qp8q,False,,,True,t3_15pnk8,http://www.reddit.com/r/SQL/comments/15pnk8/looking_for_a_prof_online_sql_class_that_goes_at/,
1356375220.0,4,self.SQL,15duw3,"Certified peoples of sql, how hard was it for you?",LeTroniz,9,5,18,http://www.reddit.com/r/SQL/comments/15duw3/certified_peoples_of_sql_how_hard_was_it_for_you/,"This is always a curios thing for me, but i don't really have that many people around me that have been certified in MSSQL. 

How hard is say, mySql or whatever the oracle certs are? Did experience help you or did you read a book for awhile? ",,False,self,t5_2qp8q,False,,,True,t3_15duw3,http://www.reddit.com/r/SQL/comments/15duw3/certified_peoples_of_sql_how_hard_was_it_for_you/,
1356315365.0,6,self.SQL,15cq49,[MS SQL] - Some newbie questions regarding SQL 2008R2 views,DickPuncht,7,1,6,http://www.reddit.com/r/SQL/comments/15cq49/ms_sql_some_newbie_questions_regarding_sql_2008r2/,"I've been tasked to do a development project which requires me to learn SQL in a very short time on a tight schedule.   What I'm trying to do is create a View which will display a subset of data from a table.

The table contains a foreign key which references an ID of a user from another 'users' table.   My question is, how do I make this view display the users name instead of their foreign key, while allowing the view to 'edit' the referenced user id and not actually change the stored name of the user being referenced.

This is hard for me to describe so please let me know if you need clarification on this question.",,False,self,t5_2qp8q,False,,,True,t3_15cq49,http://www.reddit.com/r/SQL/comments/15cq49/ms_sql_some_newbie_questions_regarding_sql_2008r2/,
1356034436.0,4,self.SQL,156nk4,"[Oracle] to [MS SQL] trigger question.
",sqlta,5,1,10,http://www.reddit.com/r/SQL/comments/156nk4/oracle_to_ms_sql_trigger_question/,"I am trying to write a trigger in MS SQL that will populate the empty date field with the current date when the rest of the record is inserted. I would do something like this in oracle.

    BEGIN
       -- Update create_date field to current system date
       :new.create_date := sysdate;

__________________________________________

This is what I have for MS SQL but it is updating other rows that were already in the table too. 

    Update R0_J
    Set InDate = DATEADD(dd, 0, DATEDIFF(dd, 0, GETDATE()))
    FROM R0_J  join inserted 
    on R0_J.NAME = inserted.NAME
",,False,self,t5_2qp8q,1356037054.0,,,True,t3_156nk4,http://www.reddit.com/r/SQL/comments/156nk4/oracle_to_ms_sql_trigger_question/,
1355957742.0,5,self.SQL,154unz,Line length issues for SQL 2012,jennym123,6,1,12,http://www.reddit.com/r/SQL/comments/154unz/line_length_issues_for_sql_2012/,"I'm trying to learn SQL Server 2012 by doing a little project involving creating a database for monsters from the d&amp;d monster manual. 

I set up the same thing in MySQL but I'm having some troubles with length allowed by the individual columns. 

One of the columns is supposed to be a short description of the monster in question. To compensate for this I made the character limit 1000 characters. 

I get the whole thing set up and the one issue I'm having is that SQL Server has imposed it's own length of 128 characters. 

I know how to change the character limit to higher but I'd like to know is if it'll work. If it doesn't work, is there another solution?

EDIT&gt;&gt; For those of you who wanted to see what I used to set up the table:

CREATE  TABLE rawmonsters (

  Name varchar(50) NOT NULL ,

  CR DECIMAL(10,0) NULL ,

  xp DECIMAL(10,0) NULL ,

  race VARCHAR(max) NULL ,

  class VARCHAR(max) NULL ,

  monsterSource VARCHAR(max) NULL ,

  alignment VARCHAR(max) NULL ,

  size VARCHAR(max) NULL ,

  aType VARCHAR(max) NULL ,

  Subtype VARCHAR(max) NULL ,

  aInit DECIMAL(10,0) NULL ,

  Sense VARCHAR(max) NULL ,

  Aura VARCHAR(max) NULL ,

  AC DECIMAL(10,0) NULL ,

  AcMods DECIMAL(10,0) NULL ,

  HP DECIMAL(10,0) NULL ,

  HD DECIMAL(10,0) NULL ,

  HpMods VARCHAR(max) NULL ,

  Saves VARCHAR(max) NULL ,

  Fort DECIMAL(10,0) NULL ,

  Ref DECIMAL(10,0) NULL ,

  Will VARCHAR(max) NULL ,

  SaveMods VARCHAR(max) NULL ,

  DefensiveAbility VARCHAR(max) NULL ,

  DR VARCHAR(max) NULL ,

  Immune VARCHAR(max) NULL ,

  Resist VARCHAR(max) NULL ,

  SR VARCHAR(max) NULL ,

  Weakness VARCHAR(max) NULL ,

  Speed VARCHAR(max) NULL ,

  SpeedMod VARCHAR(max) NULL ,

  Melee VARCHAR(max) NULL ,

  Ranged VARCHAR(max) NULL ,

  aSpace VARCHAR(max) NULL ,


  Reach VARCHAR(max) NULL ,

    PRIMARY KEY (Name) )


",,False,self,t5_2qp8q,1356062567.0,,,True,t3_154unz,http://www.reddit.com/r/SQL/comments/154unz/line_length_issues_for_sql_2012/,
1355858629.0,4,self.SQL,152d3z,[MySQL] Learning MySQL: Need some advice on practice,phamilyy,5,1,2,http://www.reddit.com/r/SQL/comments/152d3z/mysql_learning_mysql_need_some_advice_on_practice/,I just recently started learning mysql. I have had a little experience prior when I was still in school but am looking up to sharpen my skills for a job.  I setup ubuntu and installed mysql server/mysql workbench and have loaded up sakila sample database.  Does anybody know where there are sample questions that uses the sakila sample database as a basis?  Questions that will test me on my knowledge of sql.  Any help will be appreciated.,,False,self,t5_2qp8q,False,,,True,t3_152d3z,http://www.reddit.com/r/SQL/comments/152d3z/mysql_learning_mysql_need_some_advice_on_practice/,
1355759397.0,5,self.SQL,14zwhw,[MS SQL] need help selecting certain records on a SELECT statement,Geig,8,3,11,http://www.reddit.com/r/SQL/comments/14zwhw/ms_sql_need_help_selecting_certain_records_on_a/,"so,

i am a newbie with SQL,  my company is running several instances of various MS sql servers, the one i am dealing with is server 2008r2

i am trying to use a current table in our SQL server, to keep another database up to date(built in access)

for some reason, the company that built the database that i am selecting from, made the employee Number field a text field.

is there a way to only select employee numbers that are &lt;700 and &gt;2500??

",,False,self,t5_2qp8q,False,,,True,t3_14zwhw,http://www.reddit.com/r/SQL/comments/14zwhw/ms_sql_need_help_selecting_certain_records_on_a/,
1355507280.0,6,self.SQL,14uogy,[TSQL] question with SSRS reports,randomperson24,6,0,8,http://www.reddit.com/r/SQL/comments/14uogy/tsql_question_with_ssrs_reports/,"Does anyone know if it is possible to view a SSRS report outside a network, such as via an internet browser on an iphone assuming the user logs in in correctly?",,False,self,t5_2qp8q,False,,,True,t3_14uogy,http://www.reddit.com/r/SQL/comments/14uogy/tsql_question_with_ssrs_reports/,
1355378968.0,7,self.SQL,14rttx,"[MSSQL] Questions about ""Exam 70-461:
Querying Microsoft SQL Server 2012"" Certification",bautofdi,8,1,7,http://www.reddit.com/r/SQL/comments/14rttx/mssql_questions_about_exam_70461_querying/,"I don't have much if any MSSQL experience, but I want to get the MCSA: SQL Server Solutions Associate certification. 

There's no guidance for prep on the Microsoft website except for the ""10774: Querying Microsoft SQL Server 2012"" course which costs upwards of $2,500 dollars. I can't afford that at this point. Is taking that class a necessity? and are there any resources that people can point me to where I can sign up to sit for an exam and prep on my own via online tutorials and textbooks?

Sorry if I'm posting incorrectly.

Thank!",,False,self,t5_2qp8q,False,,,True,t3_14rttx,http://www.reddit.com/r/SQL/comments/14rttx/mssql_questions_about_exam_70461_querying/,
1354803336.0,5,self.SQL,14dtmu,[Oracle] join where only multiple matches exist,borensoren,5,0,5,http://www.reddit.com/r/SQL/comments/14dtmu/oracle_join_where_only_multiple_matches_exist/,"(I'm exactly a week into a new job working with Oracle, bear with me here plz)

I'm trying to compare two tables and get back the unique identifiers of accounts that only have one valid email.  The end goal is to update JM_DUMMY_120512 with those emails.

Here's as far as I've been able to get:

    SELECT COUNT(A.EMAIL) AS EMAIL_COUNT, B.PID
    FROM PBANIEWICZ.AIEMAIL A
    JOIN 
    JM_DUMMY_120512 B PARTITION BY (B.PID)
    ON A.PID = B.PID
    AND A.EMAILVALID = 'VALID'
    AND A.UNSUBSCRIBED = 'N'
    GROUP BY B.PID
    ORDER BY EMAIL_COUNT",,False,self,t5_2qp8q,False,,,True,t3_14dtmu,http://www.reddit.com/r/SQL/comments/14dtmu/oracle_join_where_only_multiple_matches_exist/,
1353638280.0,4,self.SQL,13nd33,"Oracle, need help with outer join.",cowkingslayer,5,1,6,http://www.reddit.com/r/SQL/comments/13nd33/oracle_need_help_with_outer_join/,"I'm supposed to have it display the zipcodes in Flushing, NY and the number of students living in each zipcode. But if no students live in the zipcode it should display a 0, that is where my problem is. It doesn't show the zipcode that has 0 students living there.

    SELECT z.zip,
        COUNT(DISTINCT s.student_id) as Students
    FROM enrollment e,
        student s RIGHT OUTER JOIN zipcode z
    ON (z.zip = s.zip)
    WHERE e.student_id = s.student_id
    AND z.state = 'NY'
    AND z.city = 'Flushing'
    GROUP BY z.zip;

edit: got it work thanks for helping this is now the code:

    SELECT z.zip, 
        COUNT(DISTINCT s.student_id) AS students
    FROM student s JOIN enrollment e
    ON (s.student_id = e.student_id) RIGHT JOIN zipcode z
    ON (z.zip = s.zip)
    WHERE z.state = 'NY'
    AND z.city = 'Flushing'
    GROUP BY z.zip
    ORDER BY z.zip;",,False,self,t5_2qp8q,1353650934.0,,,True,t3_13nd33,http://www.reddit.com/r/SQL/comments/13nd33/oracle_need_help_with_outer_join/,
1353033129.0,4,self.SQL,139yz7,[MSSQL] MERGE vs TRUNCATE and INSERT,Mizue,5,1,5,http://www.reddit.com/r/SQL/comments/139yz7/mssql_merge_vs_truncate_and_insert/,"I recently upgraded to MSSQL 2008 R2 and was wondering whether or not the ""new"" Merge function was more efficient/faster than Truncating and Inserting for updating tables given each table has millions (~40 million) of rows. If anyone could provide some data of their performance, that would be great, but any explanation would be helpful!",,False,self,t5_2qp8q,False,,,True,t3_139yz7,http://www.reddit.com/r/SQL/comments/139yz7/mssql_merge_vs_truncate_and_insert/,
1352414164.0,5,self.SQL,12vqim,[MS SQL] Replication between Microsoft SQL versions - 2008R2 and 2012,Kalypso_,5,0,8,http://www.reddit.com/r/SQL/comments/12vqim/ms_sql_replication_between_microsoft_sql_versions/,"I am wondering if anyone has gotten replication running between 2008R2 and 2012. The publisher would be the 2008R2 and the distributor/subscriber is 2012. 

From what I was able to find (not much), it seems that this isn't possible. However, I've been put into a difficult place and I need to see if there is any way to rig this. 

I know I was able to get a 2005 publisher running with a 2008 distributor/subscriber but even that was little fight. 

Please help me.. my google fu can only do so much.

Thank you!",,False,self,t5_2qp8q,False,,,True,t3_12vqim,http://www.reddit.com/r/SQL/comments/12vqim/ms_sql_replication_between_microsoft_sql_versions/,
1351255246.0,3,self.SQL,124col,Selecting first record in a group,oldfoxpro,5,2,18,http://www.reddit.com/r/SQL/comments/124col/selecting_first_record_in_a_group/,"I have a table of doctor billings. For each patient visit, there are several fees submitted, typically there are four fees for a single visit (professional and technical component). There is a unique patient id number, a visit date. The problem is counting the visits and physician type. Each visit record is duplicated in full 4 times, I only want to count one visit for each  set of associated fees, and extract other data from the record. It would work if I could group by the patient id and visit date, and took the first record only in that group, how is this done is MS SQL? Thanks",,False,self,t5_2qp8q,False,,,True,t3_124col,http://www.reddit.com/r/SQL/comments/124col/selecting_first_record_in_a_group/,
1351032450.0,4,self.SQL,11z198,Anyone wanna give me a second set of eyes on this issue. Haven't been working with SQL for very long so this could just be me being stupid.,Deli1181,6,2,3,http://www.reddit.com/r/SQL/comments/11z198/anyone_wanna_give_me_a_second_set_of_eyes_on_this/,"Is there a way to return a list of entries in Column A (some sort of ID number, not unique) where Column B in one entry matches Column C in a different entry (sharing the same value for Column A). Using SQL Server 2008.

For example, a case that has this:

    A    B    C

    1    X    Z
    1    X    Y
    1    Z    Y
    2    X    Z

I'm just trying to return ""1"". Sorry for it being so vague, can't really use real example. And sorry for the presentation, I'm a very visual learner and probably couldn't describe it in words even if I tried.",,False,self,t5_2qp8q,1351041862.0,,,True,t3_11z198,http://www.reddit.com/r/SQL/comments/11z198/anyone_wanna_give_me_a_second_set_of_eyes_on_this/,
1351011690.0,6,self.SQL,11ydbz,[Oracle] Help with something either very trivial (and I'm a dumbass) or not.,_Old_Greg,7,1,11,http://www.reddit.com/r/SQL/comments/11ydbz/oracle_help_with_something_either_very_trivial/,"The following code is probably self explanatory


-- Lists number of active subscribers 1st of june
select count(subscribers) as activesubscribers
from subscriberlist sub
where to_date('2012-06', 'yyyy-mm') between sub.firstDayOfSubscription and sub.lastDayOfSubscription


But if I want to get the number of subscribers in the beginning of every month the past year, what could I do (besides changing the date in the query and repeating).

I will genuinely appreciate any help. Thank you! :)",,False,self,t5_2qp8q,False,,,True,t3_11ydbz,http://www.reddit.com/r/SQL/comments/11ydbz/oracle_help_with_something_either_very_trivial/,
1350508021.0,4,self.SQL,11ngag,"[SQLite] Learning SQLite, need help with triggers/checks",bzjones,5,1,2,http://www.reddit.com/r/SQL/comments/11ngag/sqlite_learning_sqlite_need_help_with/,"So I have to write a webapp for a UI class, and for that I have to teach myself some SQL.

So I have a table Players, which contains three columns, a GameID, a PlayerID, and a TargetID. 

gameID is a foreign key for Game.GameID, and PlayerID and TargetID are foreign keys for the User.UserID

Essentially the player and target should form a circularly linked list, so for example 

    SELECT GameID, PlayerID, TargetID from Players where GameID = 1; 

would result in:

    1|1|2

    1|2|3

    1|3|4

    1|4|1

(player 1's target is p2, p3 targets p3, etc)

I'd like to impose restraints onto this table, such that a row cannot be inserted if its TargetID does not exist in Players for that GameID.

Is there a way I can enforce this? I thought about a Check with a select inside it (not actually sure if that legally works) but it doesn't work because then there's no way to add an first user, before any valid targets exist.",,False,self,t5_2qp8q,False,,,True,t3_11ngag,http://www.reddit.com/r/SQL/comments/11ngag/sqlite_learning_sqlite_need_help_with/,
1350435391.0,5,self.SQL,11lpll,"[MySQL] select 10 rows, then another 10....",Tikuf,5,0,9,http://www.reddit.com/r/SQL/comments/11lpll/mysql_select_10_rows_then_another_10/,"So after a bit of googling and asking a few people I still don't have a real answer, or if it even possible. 
I want to make a procedure that I could select 10 rows from say a 20k row table, then be able to call it again and get the next 10 rows and so on.

I have no real concept of how to implement this.",,False,self,t5_2qp8q,False,,,True,t3_11lpll,http://www.reddit.com/r/SQL/comments/11lpll/mysql_select_10_rows_then_another_10/,
1350416947.0,7,self.SQL,11l4of,[MS SQL] Hypothetical question regarding mirroring with a witness.,soyjesus,8,1,7,http://www.reddit.com/r/SQL/comments/11l4of/ms_sql_hypothetical_question_regarding_mirroring/,"Say I have the following setup:

Primary DB Server (site 1)
Secondary DB Server (site 2)
Witness Server (site 1)

The 3 are mirroring a single database. The primary database being the live copy, obviously.

The primary server and witness server are destroyed by a combined nuclear explosion, godzilla attack, meteor strike trifecta. 

Does the database failover to Secondary DB server on its own? Can it be forced? What happen? 

Thanks!",,False,self,t5_2qp8q,False,,,True,t3_11l4of,http://www.reddit.com/r/SQL/comments/11l4of/ms_sql_hypothetical_question_regarding_mirroring/,
1346938815.0,5,self.SQL,zg5vz,Conditional Joins,Sotall,7,2,21,http://www.reddit.com/r/SQL/comments/zg5vz/conditional_joins/,"So, imagine you have two lists of email addresses, both formatted as such:

    rownum email
    1      hello@123.com
    2      hola@345.com      

One of these lists is 400,000 records and the other is 400,115.  These lists are the exact same except for the 115 records extra in list two.  Assume it is ordered alphabetically via emailaddress. 

I need to find those 115 records, but it isnt as simple as using a NOT EXISTS or something similar, because there are duplicates of almost every email address on the list, so outer joining them on email address returns no results where either email address is null. 

Thoughts? 

EDIT: This is T-SQL. 

EDIT2:  Got something that works, thanks to a bunch of ya. Here is what finally gave me the results set I needed:

    with sendTable 
    as
    (
    select
    		COUNT(*) sendcount
    	,	m.emailaddr_  sendemail
    	from stats.[Send] s (nolock) 
    	join Members_ m
    	on m.MemberID_ = s.SubscriberID 
    	where s.JobID = 13659916 
    	group by m.emailaddr_ 
    	
    )
    , DETable 
    as
    (
    	select 
        COUNT(*) decount
    	,	 Email deemail
    	from c172300.[2012-08-30 Payment not Received - wave2] (nolock) 
    
    	group by EMAIL 
    )
    select * from DETable 
    except 
    select * from sendtable
",,False,self,t5_2qp8q,1346965106.0,,,True,t3_zg5vz,http://www.reddit.com/r/SQL/comments/zg5vz/conditional_joins/,
1346106482.0,4,self.SQL,yxeux,[MS SQL] Need to figure out a good way to have a weekly database backup/restore between a dev and test system,panda_foo,6,2,7,http://www.reddit.com/r/SQL/comments/yxeux/ms_sql_need_to_figure_out_a_good_way_to_have_a/,"Im new to this, so I apologize if I sounds like an idiot....

So right now I have two identical win2008 R2sp1 boxes running with SQL2008 on both. They are duplicate images/builds of each other. Currently we will manually backup our test system and restore to dev every so often when asked to do so. I would like to find a way to automate this. 
I need to be able to do a full backup of a database on ServerA and then be able to restore that backup to ServerB without keeping the database on ServerB in recovery mode. At first I thought about having a backup script run on ServerA then have a job that copies the .bak file over to ServerB and the restores, only I dont want to depend on one script. Let me know if more info is needed. Again, Im new to this :/",,False,self,t5_2qp8q,False,,,True,t3_yxeux,http://www.reddit.com/r/SQL/comments/yxeux/ms_sql_need_to_figure_out_a_good_way_to_have_a/,
1345700886.0,5,self.SQL,yokxy,"Just starting to learn how to run queries, would like some help with a task.",DangJuice,6,1,13,http://www.reddit.com/r/SQL/comments/yokxy/just_starting_to_learn_how_to_run_queries_would/,"I just started a new job and I have to use MAccess, I've never used MAccess before so I'd like an answer to do a relatively simple task. I have a large amount of tables with a lot of data. What I'd like to do is check if one field will match another field. I have to check hundreds of fields to ensure they match, if they don't then I'd like to know which ones did not match. So far I have the tables imported in Access and I have a relationship added between the lists desired to match. I have 3 tables per workbook, workbooks per system. I have 3 systems and so I end up having 27 tables. 

I drew a picture in case my text was a little confusing.
http://imgur.com/EgKDh

I say relatively simple because if this was MatLab, I'd just write a script asking if [a b c]=[x y z]. I'd like to know how I should set up this query and if my relationships are correct.",,False,self,t5_2qp8q,False,,,True,t3_yokxy,http://www.reddit.com/r/SQL/comments/yokxy/just_starting_to_learn_how_to_run_queries_would/,
1340806964.0,4,self.SQL,vooyd,Column Aware Query,CompEngCraft,8,4,6,http://www.reddit.com/r/SQL/comments/vooyd/column_aware_query/,"This one has had me stuck for about 24 hours now. Im sure it is obvious but I am just missing something, or something isnt clicking.

Basically I need to do a single query on 2 tables. The tables are related by a row name (its basically a huge number). Table A has a timestamp and Table B has a timestamp (both tables obviously have more data than that but irrelevant).

The problem is that Table A can have multiple entries for 1 name with different timestamps and unfortunately I need to get rows that contain the following format

    A.Name | A.Time | B.*

The hard part being that the times listed in B are just slightly later than A so I need to do a small comparison. My understanding is that I need to somehow pick A row based on the closest one to a given B row (by time) and return in a table... does this make sense? I'm stumped. I think it needs to somehow be aware of the already returned columns from the other table.",,False,self,t5_2qp8q,False,,,True,t3_vooyd,http://www.reddit.com/r/SQL/comments/vooyd/column_aware_query/,
1339628644.0,5,self.SQL,v0nqb,[tsql] reddit gifts programming challenge,joshuaerda,5,0,9,http://www.reddit.com/r/SQL/comments/v0nqb/tsql_reddit_gifts_programming_challenge/,"Just for giggles, I decided to see if I could build something to satisfy the requirements of the [redditgifts job posting](http://blog.reddit.com/2012/06/reddit-is-hiring-positions-redditgifts.html) in tsql. 

I realize SQL really isn't the best tool to accomplish a task of this nature (at least the matching part, extracting the dataset from the provided data was simple), but I'm curious as to how others might approach this if SQL were your only option. Someone said earlier this week 'if your only tool is a hammer...' 

Thoughts?",,False,self,t5_2qp8q,False,,,True,t3_v0nqb,http://www.reddit.com/r/SQL/comments/v0nqb/tsql_reddit_gifts_programming_challenge/,
1339526482.0,5,explainextended.com,uycz6,How to draw a snowflake. Using [PostgreSQL]. (Not my blog),,5,0,4,http://www.reddit.com/r/SQL/comments/uycz6/how_to_draw_a_snowflake_using_postgresql_not_my/,,,False,http://e.thumbs.redditmedia.com/xFIM-mtHEry6bPaF.jpg,t5_2qp8q,False,,,False,t3_uycz6,http://explainextended.com/2011/12/31/happy-new-year-3/,
1338577028.0,3,self.SQL,ug0kb,Made a typo and instantly thought of this...,R-P-2008,13,10,5,http://www.reddit.com/r/SQL/comments/ug0kb/made_a_typo_and_instantly_thought_of_this/,"begin tranny
update man
set genitalia = 'VAGINA'
where genitalia = 'PENIS'
and wants_sex_change = 'Y'
commit",,False,self,t5_2qp8q,False,,,True,t3_ug0kb,http://www.reddit.com/r/SQL/comments/ug0kb/made_a_typo_and_instantly_thought_of_this/,
1337977905.0,7,self.SQL,u504x,Reference books,ectoplasm,9,2,9,http://www.reddit.com/r/SQL/comments/u504x/reference_books/,Hey Guys I am looking for a good reference book for sql. Know of any good ones?,,False,self,t5_2qp8q,False,,,True,t3_u504x,http://www.reddit.com/r/SQL/comments/u504x/reference_books/,
1335358895.0,4,self.SQL,sronz,Entity-Relationship Diagram,captshady,7,3,2,http://www.reddit.com/r/SQL/comments/sronz/entityrelationship_diagram/,"It was so easy to get to in SQL 2000.  I've been using access, just so I can get a visual representation of my db as it's being developed.  What am I missing in 2005/2008?  Where the heck is it?",,False,self,t5_2qp8q,False,,,True,t3_sronz,http://www.reddit.com/r/SQL/comments/sronz/entityrelationship_diagram/,
1335207626.0,5,self.SQL,soktt,[MySQL] Will I need to autoincrement respective foreign keys?,redelman431,5,0,2,http://www.reddit.com/r/SQL/comments/soktt/mysql_will_i_need_to_autoincrement_respective/,"Right now I was instructed to make both primary and foreign keys in integers. I know it's good practice to autoincrement primary keys, however will I have to autoincrement foreign keys or will the parent primary key automatically determine the foreign key's number? ",,False,self,t5_2qp8q,False,,,True,t3_soktt,http://www.reddit.com/r/SQL/comments/soktt/mysql_will_i_need_to_autoincrement_respective/,
1334941739.0,6,self.SQL,sjxvm,[MS SQL] Restoring permissions in a database,dfl2m,7,1,7,http://www.reddit.com/r/SQL/comments/sjxvm/ms_sql_restoring_permissions_in_a_database/,"I am not a DBA of any sort, but I have been asked by my supervisor to see if there is a way to restore permissions in a database without affecting the data.  We are running SQL Server 2005 on Windows Server 2003.  If you need any more details, please let me know, and I will edit the post.

Thanks!",,False,self,t5_2qp8q,False,,,True,t3_sjxvm,http://www.reddit.com/r/SQL/comments/sjxvm/ms_sql_restoring_permissions_in_a_database/,
1334795387.0,7,self.SQL,sgyzi,Minimum skill set to be a Jr. DBA,SQL_opportunity,10,3,13,http://www.reddit.com/r/SQL/comments/sgyzi/minimum_skill_set_to_be_a_jr_dba/,"Hi All,

I've been trolling Google and reading a bunch of blogs on how to become a SQL Server DBA. It seems a majority of the people looking to break into the field come from development &amp; BI backgrounds or have an IT degree of some sort. I have a job where I work with SQL in a basic capacity, I'm spending my free time getting to know more (currently learning about indexes).

In my current job I:
* Install SQL Server
* Manage automated backups
* Perform database restores
* Query data using T-SQL 101 skills (basic SELECT statements with JOINS, the occasional CASE logic, and UPDATEs)
* I've done some role based security administration

I'm wondering, based off that list of skills, what should I focus on learning in an effort to get my foot in the door as a Jr. DBA?",,False,self,t5_2qp8q,False,,,True,t3_sgyzi,http://www.reddit.com/r/SQL/comments/sgyzi/minimum_skill_set_to_be_a_jr_dba/,
1333471743.0,5,self.SQL,rrdwp,[MS SQL] (2008) UpdateTimeStamps on dimension tables.,legohax,5,0,6,http://www.reddit.com/r/SQL/comments/rrdwp/ms_sql_2008_updatetimestamps_on_dimension_tables/,"Hey reddit!  I am developing a new application with multiple dimension tables (mapping).  I have columns called: InsertTimeStamp datetime, UpdateTimeStamp datetime, UpdateUser varchar(100).  The InsertTimeStamp will default to GETDATE(), which is fine.  The UpdateTimeStamp and UpdateUser columns need to be updated everytime the record is updated.  In another application, there are triggers AFTER UPDATE that update those columns whenever any of the other columns change.  The problem is that the triggers say:

WHERE Inserted.Column1 &lt;&gt; Deleted.Column1
	OR Inserted.Column2 &lt;&gt; Deleted.Column2
	etc...
	etc...

When new columns are added to the tables, our developers keep forgetting to add another 'OR Inserted.NewColumn &lt;&gt; Deleted.NewColumn' to the trigger.  There has GOT to be a better way to do this than a manual trigger, any ideas?
",,False,self,t5_2qp8q,False,,,True,t3_rrdwp,http://www.reddit.com/r/SQL/comments/rrdwp/ms_sql_2008_updatetimestamps_on_dimension_tables/,
1330440151.0,5,self.SQL,q9pn9,Problem inserting 2.8 million rows in MySQL on Windows but not Mac?,TinyLebowski,5,0,9,http://www.reddit.com/r/SQL/comments/q9pn9/problem_inserting_28_million_rows_in_mysql_on/,"Hi guys,

I'm just getting started with SQL and for practice purposes I downloaded a huge database from [MaxMind](http://www.maxmind.com/app/worldcities) containing all the world's cities, their co-ordinates and so on (almost 2.8 million cities out there!).

The file is written in comma separated values so I wrote a Java program that creates the schema and table and inserts the values in their proper columns.

The weird thing is that it works fine on both my Macs but my friend's Windows laptop stops importing after about 71.000 rows with no error messages. He wrote a different version of Java code with exactly the same result.

What could be wrong?

**EDIT**

It turned out to be a problem with text encoding. Who knew there were different versions of Latin1? I didn't. It's all smooth sailing now that I forced Java to use the correct charset.
Thanks for the comments guys!",,False,self,t5_2qp8q,True,,,True,t3_q9pn9,http://www.reddit.com/r/SQL/comments/q9pn9/problem_inserting_28_million_rows_in_mysql_on/,
1329764520.0,6,self.SQL,py466,Need help with a subselect and max value,whitedonkey,6,0,8,http://www.reddit.com/r/SQL/comments/py466/need_help_with_a_subselect_and_max_value/,"Alright, I've been trying to conceptualize this for a better part of the afternoon and still cannot figure out how to structure this subselect.

The data that I need to report are ages for a given student major grouped by the past 3 fiscal years. Each fiscal year has 3 semesters (summer, fall, spring). I need to have my query grouped on the fiscalyear and agerange fields and then count the distinct student id's. 

I currently have this for my SQL statement:



&gt; Select COUNT(distinct StuID), AgeRange, FiscalYear
&gt;
&gt; from tblStatic 
&gt; 
&gt; where Campus like 'World%' and (enrl_act like 'REG%' or enrl_act like 'SCH%')
&gt; and StuMaj = 'LAWSC' and FiscalYear IN ('09/10', '10/11', '11/12')
&gt; 
&gt; group by FiscalYear, AgeRange
&gt; 
&gt; order by FiscalYear, AgeRange




So this is all fine and dandy except it doesn't match my headcount of students for the fiscalyear. The reason being, that people may cross over in the age ranges during the fiscal year and is adding them to my count twice.


How can I use a subselect to resolve this duplicate entry? The field I have been trying to get working is my semester field and using a max to find the max semester during a fiscalyear that the student was enrolled in class.",,False,self,t5_2qp8q,True,,,True,t3_py466,http://www.reddit.com/r/SQL/comments/py466/need_help_with_a_subselect_and_max_value/,
1328114611.0,5,self.SQL,p6aa8,Easiest way to learn SQL?,somenerdyguy,6,1,14,http://www.reddit.com/r/SQL/comments/p6aa8/easiest_way_to_learn_sql/,"I'm a health researcher who uses SAS for statistical analyses. While the majority of the data manipulations I can do in SAS, there are a few that I would need to learn SQL for. Overall, I would like to learn it since we do use SQL server. I was wondering what is the easiest way to learn SQL? did you learn it via a book (if so what book)? or a course? ",,False,self,t5_2qp8q,False,,,True,t3_p6aa8,http://www.reddit.com/r/SQL/comments/p6aa8/easiest_way_to_learn_sql/,
1324661863.0,4,self.SQL,no3qx,Need help excluding numbers with decimal places (supern00b),d3adbor3d2,5,1,5,http://www.reddit.com/r/SQL/comments/no3qx/need_help_excluding_numbers_with_decimal_places/,"This is my query

from am_jobs
where job_status = 'ABORTED'
order by job_started

Within am_jobs there's a 'job_id' column. Job IDs are listed in numbers with a max of 2 decimal places. I want to create a table that ONLY lists the job IDs without decimals in it (ex. 312555 will be in the table, 312555.01 will not). Right now I get all the jobs I query for a given day. So my query is listing almost all of what I need, I just need it to list the ones that have decimal values in them. 

I apologize if I've missed a sql term or twelve. I will try to give more info. THANK YOU",,False,self,t5_2qp8q,False,,,True,t3_no3qx,http://www.reddit.com/r/SQL/comments/no3qx/need_help_excluding_numbers_with_decimal_places/,
1321710893.0,4,olex.openlogic.com,mi14l,"""Window functions"" are standard since SQL:2003, widely implemented, not well-known, but hugely useful:  they make departmental budget subtotals, for example, an easy one-liner",claird,7,3,3,http://www.reddit.com/r/SQL/comments/mi14l/window_functions_are_standard_since_sql2003/,,,False,http://b.thumbs.redditmedia.com/rSf2xtX3VIxbiQWC.jpg,t5_2qp8q,False,,,False,t3_mi14l,http://olex.openlogic.com/wazi/2011/window-functions-postgresqls-best-kept-secret/,
1318053905.0,4,self.SQL,l4wyf,Microsoft SQL Compact Databases for experimenting,ElvisLikeBear,5,1,3,http://www.reddit.com/r/SQL/comments/l4wyf/microsoft_sql_compact_databases_for_experimenting/,Fairly simple question - I'm brushing up on my SQL knowledge after not utilizing it very well for a few years. I was wondering if anybody knew where I can get a Microsoft SQL Compact database pre-made with data for experimenting with?,,False,self,t5_2qp8q,False,,,True,t3_l4wyf,http://www.reddit.com/r/SQL/comments/l4wyf/microsoft_sql_compact_databases_for_experimenting/,
1318019871.0,4,imgur.com,l4hyd,"Need advice on SQL 2008 Maintenance plans, I've attached what is running on mine and would really like advice on which ones need to be ran. (xpost from r/sysadmin)",binarycontrol,5,1,5,http://www.reddit.com/r/SQL/comments/l4hyd/need_advice_on_sql_2008_maintenance_plans_ive/,,,False,http://thumbs.reddit.com/t3_l4hyd.png,t5_2qp8q,False,,,False,t3_l4hyd,http://imgur.com/UlE0m,
1317965340.0,5,self.SQL,l3uug,Database structure question,matty348,7,2,4,http://www.reddit.com/r/SQL/comments/l3uug/database_structure_question/,"I am developing a website to track stats for my board game group and am using mysql to keep track of the data. The way I currently have my database set up is a table for each game which uses the player id and game session number as the primary key. Each board game has a different set of stats that I would like to keep track of (points, sheep, ships destroyed ect.) which I would keep track of for each player however some games also have some general gamestate things I would like to record that would be the same regardless of the player. I think I am going to have to create  a separate table to track these gamestate stats in a separate table.

 What I am wondering is if there is any better way of organizing this even if it means restructuring everything.",,False,self,t5_2qp8q,False,,,True,t3_l3uug,http://www.reddit.com/r/SQL/comments/l3uug/database_structure_question/,
1317944106.0,6,self.SQL,l3jt5,"Wierd SQL issue, I'm totally stumped!",moc_tidder,6,0,1,http://www.reddit.com/r/SQL/comments/l3jt5/wierd_sql_issue_im_totally_stumped/,"Hi Guys, 

I have been working on a SP that takes in a user id with some parameters and passes me a recursive list of users that are being managed. This was originally a function but was too slow, made it faster by using temporary tables but can't use a function any more, Hence the SP. 

Here is where the issue is, If I execute the SP it takes more than a minute but if I breakdown the SP by running all the scripts manually, I get the same result in 1 sec. Yes! 1 second. I've never had come across this issue before, hoping to get some help here. 
Thanks,

EDIT: Got solution! sunovavich parameter sniffing! [Interesting Read] (http://www.sqlpointers.com/2006/11/parameter-sniffing-stored-procedures.html)
 

",,False,self,t5_2qp8q,True,,,True,t3_l3jt5,http://www.reddit.com/r/SQL/comments/l3jt5/wierd_sql_issue_im_totally_stumped/,
1313762596.0,5,self.SQL,jnv33,Question about using COUNT(*) multiple times in a query,Javadocs,5,0,12,http://www.reddit.com/r/SQL/comments/jnv33/question_about_using_count_multiple_times_in_a/,"I'm trying to optimize this query, and I recently read that COUNT( * ) has to do a full table scan to get the number of rows of a table. If this is true, does calling Count( * ) again do another full table scan, or does it know from the last time COUNT( * ) was called.

Example query below. Let me know if anything I said above is wrong. Thanks!

    SELECT
    ColumnA,
    ColumnB,
    ColumnC,
    ColumnD = COUNT(*),
    ColumnE = SUM(COLUMN1),
    ColumnF = SUM(COLUMN2) / COUNT(*),
    ColumnG = SUM(COLUMN3),
    ColumnH = SUM(COLUMN3) / COUNT(*),
    ColumnI = SUM(COLUMN4),
    ColumnJ = SUM(COLUMN4)/ COUNT(*)
    FROM SomeTable
    WHERE etc...

EDIT: Put spaces in COUNT( * )'s because of formatting",,False,self,t5_2qp8q,False,,,True,t3_jnv33,http://www.reddit.com/r/SQL/comments/jnv33/question_about_using_count_multiple_times_in_a/,
1311701788.0,5,self.SQL,j0c2u,Need help with SQL command,Concordiaa,6,1,8,http://www.reddit.com/r/SQL/comments/j0c2u/need_help_with_sql_command/,"Hi r/sql, I'm not very advanced at MySQL, and I was hoping you might be able to help me write a command.

I have this table ""attendance"" that has a primary, auto-incremented key named ""id"", an integer ""event_id"" that corresponds to the id of a certain event from another table, an integer ""person_id"" that corresponds to the id of a certain person from another table, and a bool ""attended"" that has either 0 if person_id did not attend event_id or 1 if person_id did attend event_id

So if I have 3 people and 4 events, the table might look like

    id         event_id   person_id  attended
    1             1              1             0
    2             1              2             1
    3             1              3             1
    4             1              4             0
    5             2              1             1
...etc.

Now I want to write a command that will return the person_id's of people who have attended event_id 95, 96, 97.  That is to say, if person_id 42 has attended=1 in the entries for 95, 96, and 97 I want his or her person_id to be retrieved, but if he or she has attended=0 for at least one of those entries I don't want it to appear.

Can I do that in one SQL command or do I have to write a few lines of PHP to do it?

Thanks!",,False,self,t5_2qp8q,True,,,True,t3_j0c2u,http://www.reddit.com/r/SQL/comments/j0c2u/need_help_with_sql_command/,
1311003827.0,5,self.SQL,isvv5,Using MSSQL how can I count the frequency of a record being greater than a certain value during a given time?,topazsparrow,5,0,4,http://www.reddit.com/r/SQL/comments/isvv5/using_mssql_how_can_i_count_the_frequency_of_a/,"&gt;""a report that shows trending on packet loss or the number of times packet loss has occurred may be useful showing a troublesome circuit that has issues popping up from time to time""

~ My boss.

I'm not a huge SQL expert so I'm a bit stumped on this one. If anyone could get me pointed in the right direction it would be much appreciated. Thanks!",,False,self,t5_2qp8q,False,,,True,t3_isvv5,http://www.reddit.com/r/SQL/comments/isvv5/using_mssql_how_can_i_count_the_frequency_of_a/,
1310543116.0,5,microsoft.com,io92d,MS SQL 2008 R2 Service Pack 1 Released,jacobmross,5,0,0,http://www.reddit.com/r/SQL/comments/io92d/ms_sql_2008_r2_service_pack_1_released/,,,False,default,t5_2qp8q,False,,,False,t3_io92d,http://www.microsoft.com/download/en/details.aspx?id=26727,
1310226932.0,3,gigaom.com,iky91,Facebook trapped in MySQL ‘fate worse than death’,,11,8,5,http://www.reddit.com/r/SQL/comments/iky91/facebook_trapped_in_mysql_fate_worse_than_death/,,,False,http://thumbs.reddit.com/t3_iky91.png,t5_2qp8q,False,,,False,t3_iky91,http://gigaom.com/cloud/facebook-trapped-in-mysql-fate-worse-than-death/,
1308871174.0,5,self.SQL,i7m2h,Question - How to limit access to a SQL database through lots of hoops,Uphoria,6,1,3,http://www.reddit.com/r/SQL/comments/i7m2h/question_how_to_limit_access_to_a_sql_database/,"Ok, so it seems convoluted but...

I am trying to do these: I want to limit access to an SQL database to specific users in an Active Directory AND to a specific application, so that only specific users who run an app after logging in to their account can see it.

Also need to keep open a back door for superadmin groups.

I am at a loss and googling it out but nothing I can find seems to fit right. Does anyone know the quick answer to this? if so, thank you!",,False,self,t5_2qp8q,False,,,True,t3_i7m2h,http://www.reddit.com/r/SQL/comments/i7m2h/question_how_to_limit_access_to_a_sql_database/,
1308242924.0,4,self.SQL,i1ck4,SQL Help. Challenge: Difficult.,rikrokola,9,5,13,http://www.reddit.com/r/SQL/comments/i1ck4/sql_help_challenge_difficult/,"I am not an admin of a DB nor do I have a lot of permissions on our servers, but I need to create and update tables on a daily basis for reporting. I have installed a SQL server on my own machine, but this was a breach of protocol and will be removed shortly. Right now I have a .bat file in place of store procedures. 

However, I can't work with temporary tables going forward. For instance, I need to keep a staffing table and movement is very fluid in my company - thus the birth of the need to have a historical staffing table. IT does not want to create another SQL table due to some vague reasons. 

Right now I have this ran as a .bat appending to a .csv of the fields and information. That's great, except that I need to query it for join purposes. What can you suggest I do? I need to be able to maintain a ever changing table that has a relationship with a non-historical staffing table. Any suggestions are welcomed other than ""LOL /quit""",,False,self,t5_2qp8q,False,,,True,t3_i1ck4,http://www.reddit.com/r/SQL/comments/i1ck4/sql_help_challenge_difficult/,
1307645219.0,6,self.SQL,hvqbd,SQL Server - Is it possible to sneak multiple GO statements into a single stored procedure by using dynamic sql?,xstockix,6,0,5,http://www.reddit.com/r/SQL/comments/hvqbd/sql_server_is_it_possible_to_sneak_multiple_go/,"I've got a nightly stored procedure that is deadlocking. It's joining 30+ views together to perform some tough calculations and dump them into a table that gets recreated each time it runs. To fix this I've broken it into a bunch of smaller batches. I'd like to keep them together, separated by GO statements, in a single SP. Is it possible to get away with this by doing it all inside a dynamic SQL script? ",,False,self,t5_2qp8q,False,,,True,t3_hvqbd,http://www.reddit.com/r/SQL/comments/hvqbd/sql_server_is_it_possible_to_sneak_multiple_go/,
1297979022.0,6,stev.org,fngyk,MS SQL - convert ip addresses to int,mistralol,6,0,1,http://www.reddit.com/r/SQL/comments/fngyk/ms_sql_convert_ip_addresses_to_int/,,,False,default,t5_2qp8q,False,,,False,t3_fngyk,http://www.stev.org/post/2011/02/17/MSSQL-Convert-IP-To-big-int.aspx,
1297702889.0,5,self.SQL,fl7kp,SQL n00b needs help with a query! ,UNHDude,7,2,9,http://www.reddit.com/r/SQL/comments/fl7kp/sql_n00b_needs_help_with_a_query/,"I don't really have much experience with SQL or programming or anything, and am kind of learning as I go along at my family business.


I have a report that's supposed to look at the statuses of mailboxes that our software processes. Unfortunately the database right now only provides a number for the status. Is there a way to make a temporary table or something that would look like this:

2 = started, 3 = stopped, 4 = completed, 5 = erred, 6 = deleted.

I've never done temporary tables or anything like that. In the past I've just done an IIF expression in the layout for the report, but apparently that's a lot slower.

Any help would be greatly appreciated!",,False,self,t5_2qp8q,False,,,True,t3_fl7kp,http://www.reddit.com/r/SQL/comments/fl7kp/sql_n00b_needs_help_with_a_query/,
1294863408.0,5,self.SQL,f13d1,SQL monitoring tools. Recommendations?,nonrate,6,1,6,http://www.reddit.com/r/SQL/comments/f13d1/sql_monitoring_tools_recommendations/,"Hi SQL experts,

I am looking to trial a few different products that can help monitor performance of a SQL server and also guide in the troubleshooting of database problems that may affect application performance.

I am looking for either commercial or open source options.

The servers I will be testing with would be Microsoft SQL server and Oracle 11g, and possibly some earlier Oracle variants. Any recommendations? Thanks for your help!",,False,self,t5_2qp8q,False,,,True,t3_f13d1,http://www.reddit.com/r/SQL/comments/f13d1/sql_monitoring_tools_recommendations/,
1287806002.0,5,self.SQL,dv6w6,How much is the real cost of MySQL/Postgress? ,amaxen,5,0,15,http://www.reddit.com/r/SQL/comments/dv6w6/how_much_is_the_real_cost_of_mysqlpostgress/,"So, I work in an outfit that is mostly MS technology, including MS SQL.   I occasionally get harassed by management to switch to MySQL and/or Postgress because it's 'free'.    Can anyone (preferablly someone working in a real, for-profit business and responsible for database systems) give me an idea what the real cost to a business would be per server?  We use mostly standard servers - 4 proc/4 gig ram, etc.   

Assume that we can magically retrain everyone on one of these techs with no cost. 

",,False,self,t5_2qp8q,False,,,True,t3_dv6w6,http://www.reddit.com/r/SQL/comments/dv6w6/how_much_is_the_real_cost_of_mysqlpostgress/,
1287553312.0,5,self.SQL,dtp9v,"How are things like upvotes or ""likes"" stored?",mysticrudnin,5,0,5,http://www.reddit.com/r/SQL/comments/dtp9v/how_are_things_like_upvotes_or_likes_stored/,"I'm not that great with SQL. I do stuff occasionally for some storage, but nothing fancy.

But I can't imagine how things like upvotes on here, or thumbs ups on youtube, or likes on facebook would be stored. Are the databases just huge and who cares? The only thing I would know how to do is a table for ""likes"" with the user who liked something and the id of the thing they liked (and probably for speed, storing the number of times liked in the ""comment"" table)

But this seems unlikely, especially with how fast facebook is able to find all 100 people who likes something (Unless, that's just the speed of databases?)

I feel bad for being so clueless, but it's been bugging me. I like to know how things work.",,False,self,t5_2qp8q,False,,,True,t3_dtp9v,http://www.reddit.com/r/SQL/comments/dtp9v/how_are_things_like_upvotes_or_likes_stored/,
1283888461.0,5,self.SQL,dar3d,Equation from two cells in the same table.,Smotpoker,5,0,10,http://www.reddit.com/r/SQL/comments/dar3d/equation_from_two_cells_in_the_same_table/,"I have two similar part numbers item1 and item1rebate. I need to subtract item1rebate.cost from item1.cost.

The problem is I have lots of parts and not all the parts have an associated rebate.

So I guess I need to run an if/then statement. If there is a part number like item1 with the suffix ""rebate"" then subtract item1rebate.cost from item1.cost.

I've managed to assign a variable to item1rebate.itemno or item1rebate.cost, but without an array I'm kind of lost on how to get it to cycle through the whole list of part numbers.

table headers:

items.itemno, items.category, items.descript, items.cost

All of the rebate itemno's are all in the same category (which is not the same category as the standard itemno's)

Any tips on how to get this working would be much appreciated! Let me know if you need more information. 

",,False,self,t5_2qp8q,False,,,True,t3_dar3d,http://www.reddit.com/r/SQL/comments/dar3d/equation_from_two_cells_in_the_same_table/,
1283025965.0,6,self.SQL,d6ngw,"Need SQL advice... You're my greatest hope, /r/sql",FrankReynolds,7,1,4,http://www.reddit.com/r/SQL/comments/d6ngw/need_sql_advice_youre_my_greatest_hope_rsql/,"Basically I have time values in a field and they're stored as 24-hour format, and I need to update a new field with the same data, but in 12-hour format.

I have tried everything at my disposal and I can't seem to get it to work.

Any advice?",,False,self,t5_2qp8q,False,,,True,t3_d6ngw,http://www.reddit.com/r/SQL/comments/d6ngw/need_sql_advice_youre_my_greatest_hope_rsql/,
1272391354.0,4,forums.thedailywtf.com,bwus8,The I-Hate-Oracle Club,amaxen,7,3,1,http://www.reddit.com/r/SQL/comments/bwus8/the_ihateoracle_club/,,,False,http://thumbs.reddit.com/t3_bwus8.png,t5_2qp8q,False,,,False,t3_bwus8,http://forums.thedailywtf.com/forums/t/1142.aspx,
1255540751.0,5,sqlite.org,9u10v,SQLite Release 3.6.19 On 2009 Oct 14 (3.6.19),,5,0,0,http://www.reddit.com/r/SQL/comments/9u10v/sqlite_release_3619_on_2009_oct_14_3619/,,,False,default,t5_2qp8q,False,,,False,t3_9u10v,http://www.sqlite.org/draft/releaselog/3_6_19.html,
1376939191.0,4,self.SQL,1kok4t,Identifying entries that don't match both of two attributes,CWSwapigans,5,1,12,http://www.reddit.com/r/SQL/comments/1kok4t/identifying_entries_that_dont_match_both_of_two/,"I've got two tables and I need the first one to tell me which entries aren't in the second one. They're roughly as follows:

**Table 1** (generated by a query mashing together parts of a few different tables)

[SalesmanID] [CustID] [Date]

**Table 2**

[CustID] [Date] [Amt]

I'm looking to add a column to Table 1 that indicates whether the specific combination of *CustID* and *Date* exists in Table 2. Any given *CustId* or *Date* is, individually, going to appear in Table 2 many times.

Seems like I could use some sort of ""case when"" here, but I'm fairly new to SQL and am having trouble visualizing how this would work.

Thanks for any help!",,False,self,t5_2qp8q,False,,,True,t3_1kok4t,http://www.reddit.com/r/SQL/comments/1kok4t/identifying_entries_that_dont_match_both_of_two/,
1376745318.0,3,self.SQL,1kjqjm,A beginner's question!,AerialBreakfast,4,1,4,http://www.reddit.com/r/SQL/comments/1kjqjm/a_beginners_question/,"Assume we have a database of tennis matches:

PlayerID | MatchID | SetsWon | SetsLost
:--|:--|:--|:--
... | ... | 2 | 1
... | ... | 0 | 2

Starting with this, I have to make a list that shows the outcome of the match:

PlayerID | MatchID | SetsWon | SetsLost | Outcome
:--|:--|:--|:--|:--
... | ... | 2 | 1 | Win
... | ... | 0 | 2 | Loss

So basically Outcome is:

* Win - if SetsWon &gt; SetsLost

* Loss - if SetsWon &lt; SetsLost

I'm still learning SQL but I got stuck with this problem! Does SQL have something like if...else in other programming languages?


This is what I have so far: (not much I know)

    SELECT PlayerID, MatchID, SetsWon, SetsLost
    FROM matches
    ...",,False,self,t5_2qp8q,False,,,True,t3_1kjqjm,http://www.reddit.com/r/SQL/comments/1kjqjm/a_beginners_question/,
1376355142.0,4,self.SQL,1k8v4u,Trying to land my first job.,ronpaulreuben,6,2,16,http://www.reddit.com/r/SQL/comments/1k8v4u/trying_to_land_my_first_job/,"Being self taught in SQL, I'm interviewing with a recruiter this week. What are some Q and A's i should be ready for?",,False,self,t5_2qp8q,False,,,True,t3_1k8v4u,http://www.reddit.com/r/SQL/comments/1k8v4u/trying_to_land_my_first_job/,
1376085348.0,4,self.SQL,1k1y3j,[MS SQL] Shifting Data,tedistkrieg,4,0,6,http://www.reddit.com/r/SQL/comments/1k1y3j/ms_sql_shifting_data/,"So I have a simple query 
  
    SELECT MachineNumber,lastname,firstname 
    FROM machines

The results are like this

    3   Simpson Homer
    7   Simpson Bart
    15  Simpson Lisa

and so on. Is there a way I could shift the names up or down. For example if I want it up:

    15 Simpson Homer
    3  Simpson Bart
    7  Simpson Lisa

",,False,self,t5_2qp8q,False,,,True,t3_1k1y3j,http://www.reddit.com/r/SQL/comments/1k1y3j/ms_sql_shifting_data/,
1376059937.0,4,self.SQL,1k10w9,Need some help I am a noob! syntax error,Crazii-P,7,3,10,http://www.reddit.com/r/SQL/comments/1k10w9/need_some_help_i_am_a_noob_syntax_error/,"select dem.last_name, dem.first_name, ra.service_date from demographic dem join radetail ra on dem.hin=ra.hin where service_code='E140A' join dxresearch dx on dem.demographic_no=dx.demographic_no where dx.dxresearch_code=""364"";

Error 1064 (42000)",,False,self,t5_2qp8q,False,,,True,t3_1k10w9,http://www.reddit.com/r/SQL/comments/1k10w9/need_some_help_i_am_a_noob_syntax_error/,
1376008500.0,5,self.SQL,1jzt9d,[MS SQL] Anyone know of a good crash course for the Microsoft Sequel Server level 1 certification?,strikethat_reverseit,7,2,3,http://www.reddit.com/r/SQL/comments/1jzt9d/ms_sql_anyone_know_of_a_good_crash_course_for_the/,"I need to learn enough to pass the course within the next week.  I've gone through SQLzoo.net but I was wondering if anyone knew of any Microsoft specific training.  

Any help is appreciated!",,False,self,t5_2qp8q,False,,,True,t3_1jzt9d,http://www.reddit.com/r/SQL/comments/1jzt9d/ms_sql_anyone_know_of_a_good_crash_course_for_the/,
1375827921.0,5,blog.metricadb.com,1jucef,Metrica - SQL Case Study: Removing bias from customer analysis (x-post from r/analytics),getmetrica,6,1,0,http://www.reddit.com/r/SQL/comments/1jucef/metrica_sql_case_study_removing_bias_from/,,,False,http://b.thumbs.redditmedia.com/y3pImqYu4UAU7n7g.jpg,t5_2qp8q,False,,,False,t3_1jucef,http://blog.metricadb.com/post/57372266272/sql-case-study-removing-bias-from-customer-analysis,
1375632402.0,4,self.SQL,1jonm0,Can anyone explain the APPLY statement?,Trek7553,4,0,7,http://www.reddit.com/r/SQL/comments/1jonm0/can_anyone_explain_the_apply_statement/,"I'm learning about it in a book I'm reading and it just isn't clicking for me. I've read some online articles and nothing has helped. Any tips?

Edit: T-SQL",,False,self,t5_2qp8q,False,,,True,t3_1jonm0,http://www.reddit.com/r/SQL/comments/1jonm0/can_anyone_explain_the_apply_statement/,
1373677294.0,3,self.SQL,1i6xk8,"[MS SQL] Looking to optimize a basic query, insert with a 'not exists' select",Sphexi,4,1,10,http://www.reddit.com/r/SQL/comments/1i6xk8/ms_sql_looking_to_optimize_a_basic_query_insert/,"I essentially have about 85k rows of data, if I just push it in using INSERT commands (I'm looping through btw, so one row at a time) it takes about 3 minutes.  What I've done is build in a check to see if the last time that I put that specific row in (checking a combination of fields) and if the 'status' matches then I don't insert, if it's different then I insert.  This way I only have new data, and not 85k rows of junk each time.

Problem is this takes about 35-40 minutes each time to run and destroys my CPU on my VM server.

    INSERT INTO events.dbo.eventLog     (eventId,worldId,mapId,state,dateTimeStamp)
     SELECT 'D20268C3-301F-4DD5-930D-2417B356EE05',
     '1016',
     '23',
     'Preparation',
     '2013-07-09 16:35:31.000'
     WHERE not exists (SELECT TOP 1 state FROM events.dbo.eventLog     
    WHERE eventId='D20268C3-301F-4DD5-930D-2417B356EE05' 
     AND worldId='1016' AND mapId='23' AND state = 'Preparation'     
    ORDER BY datetimestamp DESC)


Any ideas to how to optimize this a bit?  This is running in a vbs file locally on the server, parsing through the data and then locally hitting SQL 2012, if it's easier I can move the data all into a SP and let it parse through and loop through the data, haven't gotten there yet but if it's faster internally with SQL then I may go that way.

Thanks!",,False,self,t5_2qp8q,False,,,True,t3_1i6xk8,http://www.reddit.com/r/SQL/comments/1i6xk8/ms_sql_looking_to_optimize_a_basic_query_insert/,
1373323723.0,2,self.SQL,1hw9bq,[MS SQL] SQL Report Building cutting off columns,tedistkrieg,6,4,2,http://www.reddit.com/r/SQL/comments/1hw9bq/ms_sql_sql_report_building_cutting_off_columns/,"I am trying to figure out why it keeps cutting off a little bit on the right hand side of the columns.

Its a matrix, changing the width of the column makes no difference.  I am not very experienced in SQL Report builder layout functions so Im hoping for some help!
Example:
http://i.imgur.com/sZW1NMq.png",,False,self,t5_2qp8q,False,,,True,t3_1hw9bq,http://www.reddit.com/r/SQL/comments/1hw9bq/ms_sql_sql_report_building_cutting_off_columns/,
1373029183.0,4,self.SQL,1hosq7,"[MySQL] Trying to SUM transactions in 30 day ""buckets"" - Goal is to reduce # of records returned",Jason_SM,6,2,13,http://www.reddit.com/r/SQL/comments/1hosq7/mysql_trying_to_sum_transactions_in_30_day/,"**EDIT** - It is MS SQL not MYSQL. 

I'll start by saying I have a little SQL experience and typically pull information from our database with the excel query wizard. That said, I pre-apologize for any poorly stated SQL terminology!

My challenge is that when I need to pull records over a span of time, I end up with so much information, I have to break it into several smaller data pulls. I then pivot the data out to get summary level results, copy and paste into another workbook so that it's not an enormous file.

My goal is to modify the SQL statement so that the summary level results are what is returned. Then I can just refresh my query to update my values.

Here is my current SQL statement:

SELECT TRANS.Client_ID, TRANS.Account_ID,TRANS.Post_Date,     TRANS.Transaction_Amount, ACCOUNT_SELFPAY.Assigned_Date

FROM DataRepository.dbo.ACCOUNT_SELFPAY ACCOUNT_SELFPAY, DataRepository.dbo.TRANS TRANS

WHERE ACCOUNT_SELFPAY.Account_ID = TRANS.Account_ID AND ((TRANS.Client_ID='STRIPCLUB01') AND (ACCOUNT_SELFPAY.Assigned_Date Between {ts '2012-01-01 00:00:00'} And {ts '2012-03-31 00:00:00'}) AND (TRANS.Transaction_Code In (1,2)))


Perfect world, the query should return the client ID, Assigned Month, Sum of transactions that posted the same month as the assigned month, sum of transactions that posted the following month and so on for 4 months. 

I hope that makes sense. Any thoughts or suggestions are greatly appreciated!

Thanks in advance
Jason",,False,self,t5_2qp8q,1373335849.0,,,True,t3_1hosq7,http://www.reddit.com/r/SQL/comments/1hosq7/mysql_trying_to_sum_transactions_in_30_day/,
1373009351.0,5,udemy.com,1hoi5d,[MSSQL] Learn Practical SQL Skills course just $1 for /r/sql readers,garyk1968,13,8,5,http://www.reddit.com/r/SQL/comments/1hoi5d/mssql_learn_practical_sql_skills_course_just_1/,,,False,http://d.thumbs.redditmedia.com/1AnB8Nh_LM7M2awc.jpg,t5_2qp8q,False,,,False,t3_1hoi5d,https://www.udemy.com/practical-sql-skills-from-beginner-to-intermediate/?couponCode=REDDIT74,
1372894662.0,5,self.SQL,1hln3q,"[MySQL] Lost all data, but still have the .frm files. How do i fix this?",GiantGerman,8,3,5,http://www.reddit.com/r/SQL/comments/1hln3q/mysql_lost_all_data_but_still_have_the_frm_files/,"I just recently had an issue with my MySQL database and i had to rebuild my whole server after finding many other issues that was making the situation worse. I wasn't able to export my database into a .sql to import later, the best i got was the .frm files. I've searched google to find out how to recover based on those files, and i've had no luck. 

I need help and i need it desperately. Theres an awful lot of data stored in the files that i need.

(I know i should do regular backups, and i will do so this time around once everything is setup as it should be. This is one roadblock i need to get around)",,False,self,t5_2qp8q,False,,,True,t3_1hln3q,http://www.reddit.com/r/SQL/comments/1hln3q/mysql_lost_all_data_but_still_have_the_frm_files/,
1372860542.0,5,self.SQL,1hkfge,Is WAITFOR DELAY possible in a single query?,Pulch,6,1,6,http://www.reddit.com/r/SQL/comments/1hkfge/is_waitfor_delay_possible_in_a_single_query/,"Is it possible to use a WAITFOR command but get the results in a single query? I'm trying to find an easy way to see if the count of a table is changing in a single query.

e.g. 
SELECT Count(table)
FROM   [database]

WAITFOR delay '00:00:15'

SELECT Count(table)
FROM   [database]  ",,False,self,t5_2qp8q,False,,,True,t3_1hkfge,http://www.reddit.com/r/SQL/comments/1hkfge/is_waitfor_delay_possible_in_a_single_query/,
1372364625.0,4,self.SQL,1h79ut,[Oracle] conditional limiting of displayed rows,just_dig_in_work,6,2,9,http://www.reddit.com/r/SQL/comments/1h79ut/oracle_conditional_limiting_of_displayed_rows/,"Give a table t1 that has any number of columns but includes a status_code where it is 'O' for Open and 'C' for Closed and a date column, can I show all Open records and only the latest 10 closed records without using a union? I know I can do something like:

    select * 
      from t1 
    where status_code = 'O'
     Union
    (select * 
       from (
     select
      from t1 
    where status_code = 'C'
     order by t1date desc)
       where rownum &lt;= 10);

I was looking for something like:

    decode(status_code, 'O', 0, 'C', rownum, 0) &lt;= 10

The problem with that is that the rownum values are &gt; 10 if there are 10 open records for example. 

Any help would be greatly appreciated.

Thanks in advance!

Edit: Formatting didn't come through as expected so tweaked it.",,False,self,t5_2qp8q,1372365232.0,,,True,t3_1h79ut,http://www.reddit.com/r/SQL/comments/1h79ut/oracle_conditional_limiting_of_displayed_rows/,
1372352832.0,5,self.SQL,1h6td5,[SQL Server 2008] Is there a way to do this?,lekua47,7,2,11,http://www.reddit.com/r/SQL/comments/1h6td5/sql_server_2008_is_there_a_way_to_do_this/,"I have two tables, master and collection1. Master has column 'collection1quantity' and collection1 has column 'Quantity' How can I set it up so that when I add to 'collection1quantity' in table 'master', 'Quantity' automatically updates? I looked into computed columns and creating a user defined function but I was not able to figure it out.",,False,self,t5_2qp8q,False,,,True,t3_1h6td5,http://www.reddit.com/r/SQL/comments/1h6td5/sql_server_2008_is_there_a_way_to_do_this/,
1372347849.0,4,self.SQL,1h6mrr,[MS Access] Basic SQL query syntax help,Jenako,5,1,3,http://www.reddit.com/r/SQL/comments/1h6mrr/ms_access_basic_sql_query_syntax_help/,"Hello /r/SQL,

I'd appreciate it if someone could help me out with making this simple query. Here is an image with the Table I'm working with: http://imgur.com/P7bIfHT

I'd like to make a query to SELECT all RuleIDs and Rules FROM RulesTable (table shown in image) WHERE Auditable = -1 (checked) and Status = -1 (checked) and ExpenseType = (something I select from a drop box in a form). 

In addition, I'd also like to select 4 columns from another table (DetailTable): Pass, Fail, NA, Exception.

I know this is pretty simple, but I don't have much experience with SQL so any help/direction is appreciated.",,False,self,t5_2qp8q,False,,,True,t3_1h6mrr,http://www.reddit.com/r/SQL/comments/1h6mrr/ms_access_basic_sql_query_syntax_help/,
1372256992.0,4,self.SQL,1h3xyx,[sql server] Pivot Table how to?,_ralph_,7,3,13,http://www.reddit.com/r/SQL/comments/1h3xyx/sql_server_pivot_table_how_to/,"i have a table consisting of  datetime and value (and a few other fields, but those i do not need)

now i want to make a pivot table where the rows are the time and the columns are the days

would be nice if anybody could tell me how to build that statement.",,False,self,t5_2qp8q,False,,,True,t3_1h3xyx,http://www.reddit.com/r/SQL/comments/1h3xyx/sql_server_pivot_table_how_to/,
1372205906.0,4,self.SQL,1h2p7m,Contains text query,Krainz,5,1,13,http://www.reddit.com/r/SQL/comments/1h2p7m/contains_text_query/,"Hello, I have this SQL query:

    SELECT Loteamentos.Nome, Documentos.Codigo, Documentos.Documento, Documentos.Arquivo_presente, Documentos.Data_entrada, Documentos.Pessoa_entrada, Documentos.Data_retirada, Documentos.Pessoa_retirou, Documentos.Entidade_cobrar, Documentos.Data1. _cobranca, Documentos.Parecer, Loteamentos.Andamento
    FROM Loteamentos INNER JOIN Documentos ON Loteamentos.[Cod_lot] = Documentos.[Lot_pertence];

And I'd like to make three new queries based on this:

    
1. First would show only Documentos.Documento that have 'Protocol' in its name, like 'Protocol 1', 'Protocol 2' and 'Protocol 3'
2. Second would show only Documentos.Documento that have '(' in its name, like '(2) to-do list' and '(3) building project'
3. Third would show only Loteamentos.Nome that have 'Project' in its name, like 'Project in San Diego', 'Project in Los Angeles', 'Project in Chicago', etc.

Is it possible?",,False,self,t5_2qp8q,False,,,True,t3_1h2p7m,http://www.reddit.com/r/SQL/comments/1h2p7m/contains_text_query/,
1372204886.0,5,self.SQL,1h2nzm,[MS SQL] Help with MERGE to avoid duplicate entries,dreadpiratetyge,7,2,4,http://www.reddit.com/r/SQL/comments/1h2nzm/ms_sql_help_with_merge_to_avoid_duplicate_entries/,"I'm hoping to find some help with the MERGE statement in T-SQL.  I'm using MS SQL Server 2008 R2, if it matters.

The gist of it is: I have 2 tables, the first (tableA) contains existing data, the second (tableB) contains what *should be* new data. If by some chance the same data already exists in the first table across all fields, I'd like to skip that record in the second table.  I figure it would be sloppy of me to just do an INSERT INTO statement and hope for the best.

Here's what I have so far:

Tables A and B have the same fields:

    codeID  int,
    docID int,
    codeTypeID int

The MERGE code would look something like this:

    MERGE tableA AS a
    USING  tableB AS b
        ON a.codeID = b.codeID AND a.docID = b.docID AND a.codeTypeID = b.codeTypeID

    WHEN MATCHED THEN
          &lt;what do I do here?  I want it to ignore/skip the record.  I don't need to update anything&gt;
    WHEN NOT MATCHED THEN
        INSERT (codeID, docID, codeTypeID)
        VALUES (b.codeID, b.docID, b.codeTypeID);

My questions are:

* Is MERGE the right statement to use and if not, what is the right way of doing it?
* What should I put under the WHEN MATCHED THEN line?
* Am I able to use 3 comparisons in the ON statement?

Any help would be appreciated.  I'll be offline for an hour or two, but back on to answer additional questions afterwards.

Thanks in advance!",,False,self,t5_2qp8q,False,,,True,t3_1h2nzm,http://www.reddit.com/r/SQL/comments/1h2nzm/ms_sql_help_with_merge_to_avoid_duplicate_entries/,
1372027300.0,5,self.SQL,1gxld4,Been on Reddit a while...,mrdedwardel,10,5,7,http://www.reddit.com/r/SQL/comments/1gxld4/been_on_reddit_a_while/,"Created my account just for help with SQL.  So first post ever and I'm asking for help.  So anyway, learning SQL and I am having an issue with dates.  The code below show the results I am looking for but it puts a minus sign in the table, I am just trying to figure out how to subtract two dates and get the positive number of days.
SELECT pat_id AS ""patron"", book_num AS ""Book"",
To_Char (Check_out_date - CHECK_in_date, '99') AS ""days kept""
FROM checkout;


Using oracle and sql tools, any help for my very basic problem is appreciated.

EDIT - Thanks for the help on this one, problem solved.
",,False,self,t5_2qp8q,1372034104.0,,,True,t3_1gxld4,http://www.reddit.com/r/SQL/comments/1gxld4/been_on_reddit_a_while/,
1371149865.0,4,self.SQL,1gaar9,[MS SQL] Need a somewhat complicated script..,fresheggroll,8,4,6,http://www.reddit.com/r/SQL/comments/1gaar9/ms_sql_need_a_somewhat_complicated_script/,"I need a script to update a customers value based on a change log. The change log lets us know what was changed in the past. The problem is, I need to update the customers where the change log shows the LAST change. 

Is there a way to select the last change in a table based on changetime and change type - then update the customer table based on that?

edit: some more info

the change log has columns (customernumber, change type, change date)
I need to select the latest row based on change date, for a certain type, PER customer... Then I will update the customer table based on that. I can get a script for updating the customers, but if there are multiple entries for the same customer, it will want to update the same account multiple times... Any help?",,False,self,t5_2qp8q,1371150519.0,,,True,t3_1gaar9,http://www.reddit.com/r/SQL/comments/1gaar9/ms_sql_need_a_somewhat_complicated_script/,
1370188850.0,4,self.SQL,1fiurr,[PL/SQL] variables aren't declared .. but they are?,s1mpd1ddy,6,2,2,http://www.reddit.com/r/SQL/comments/1fiurr/plsql_variables_arent_declared_but_they_are/,"I'm starting the journey into PL/SQL, and I'm trying to solve a problem. The syntax looks correct to me, but I'm still getting errors. What am I doing wrong? 

here is the code and errors generated:

    CREATE OR REPLACE create_new_emp(	e_name emp.ename%TYPE,
									j_ob emp.job%TYPE, 
									m_anager emp.mgr%TYPE, 
									d_no emp.deptno%TYPE)
    IS
	    e_no emp.empno%TYPE;
	    hire_date emp.hiredate%TYPE;
	    salary emp.sal%TYPE;
	    commission emp.comm%TYPE;
    BEGIN
	    SELECT MAX(empno) + 5, AVG(sal) * 1.1, AVG(comm) * 1.05
	    INTO e_no, salary, commission
	    FROM emp;
	
	    SELECT sysdate
	    INTO hire_date
	    FROM dual;
	
	    INSERT INTO emp(empno, ename, job, mgr, hiredate, sal, comm, deptno)
	    VALUES(e_no, e_name, j_ob, m_anager, hire_date, salary, commission, d_no);
	
	COMMIT;
    END;

Errors:

ERROR at line 3:

ORA-06550: line 3, column 7: 

PLS-00201: identifier 'E_NO' must be declared 

ORA-06550: line 4, column 2: 

PL/SQL: ORA-00904: : invalid identifier 

ORA-06550: line 2, column 2: 

PL/SQL: SQL Statement ignored 

ORA-06550: line 7, column 7: 

PLS-00201: identifier 'HIRE_DATE' must be declared 

ORA-06550: line 8, column 2: 

PL/SQL: ORA-00904: : invalid identifier 

ORA-06550: line 6, column 2: 

PL/SQL: SQL Statement ignored 

ORA-06550: line 11, column 70: 

PL/SQL: ORA-00984: column not allowed here 

ORA-06550: line 10, column 2: 

PL/SQL: SQL Statement ignored 
",,False,self,t5_2qp8q,False,,,True,t3_1fiurr,http://www.reddit.com/r/SQL/comments/1fiurr/plsql_variables_arent_declared_but_they_are/,
1369772437.0,3,self.SQL,1f7yv2,[MSSQL]I'm looking for some for some better resources for writing and troubleshooting queries.,KilledByDeath,4,1,8,http://www.reddit.com/r/SQL/comments/1f7yv2/mssqlim_looking_for_some_for_some_better/,"Basically, I'm looking for some problems or scenarios to help with learning to write better queries. The problems and scenarios in the book(training kit 70-461) I'm using aren't really that great and there is only one or two per chapter. I was kind of hoping that someone may know of a resource that may have more 'real world' scenarios. Thanks! ",,False,self,t5_2qp8q,False,,,True,t3_1f7yv2,http://www.reddit.com/r/SQL/comments/1f7yv2/mssqlim_looking_for_some_for_some_better/,
1369761365.0,4,self.SQL,1f7ju1,how to search LIKE where a character appears more than once?,whoisearth,5,1,15,http://www.reddit.com/r/SQL/comments/1f7ju1/how_to_search_like_where_a_character_appears_more/,"I have a column that has variations of the following - 

YNNNN
NNYNN
NYYYN
NYYNN
etc.

I want to be able to search only when the column contains 1 'Y' how would I do this?",,False,self,t5_2qp8q,False,,,True,t3_1f7ju1,http://www.reddit.com/r/SQL/comments/1f7ju1/how_to_search_like_where_a_character_appears_more/,
1369498549.0,4,self.SQL,1f18xc,[MS SQL] Anyone got a suggestion on how to speed up a date range query for a large table?,chapmjw,6,2,22,http://www.reddit.com/r/SQL/comments/1f18xc/ms_sql_anyone_got_a_suggestion_on_how_to_speed_up/,"I've got a table that collects data from equipment throughout the plant. This table has around 20 million records and is setup something like this.

Id, TimeStamp,Data1,Data2,,,,,,,,,,

My problem is if I need to see what happened over some given time span many months ago, it takes quite a while to retrieve that data and slows as the table grows. Is there a trick to make this faster?

I have to display the last 24 hours at all time and to speed that query I use something like this.

-- from memory not tested.
Select * from 
(Select top 10000 * from Table1) as T1
where TimeStamp &gt; '5-24-13'
order by Id desc


Thanks to all that helped.

Indexing the timestamp drops the time from a 20 seconds query to less than 1s. I didn't realize I could index anything other than the primary key.",,False,self,t5_2qp8q,1369512451.0,,,True,t3_1f18xc,http://www.reddit.com/r/SQL/comments/1f18xc/ms_sql_anyone_got_a_suggestion_on_how_to_speed_up/,
1369448201.0,3,self.SQL,1f0cbe,"[MySQL] How to get ""recommended"" items based on euclidean function and something like that?",101008,4,1,7,http://www.reddit.com/r/SQL/comments/1f0cbe/mysql_how_to_get_recommended_items_based_on/,"I started to read this book:

http://shop.oreilly.com/product/9780596529321.do

(Intelligence Collective, O'Reilly), which talks about AI in websites, such like Products Suggestions from Amazon, Music Recomendation of Last.fm, etc. I have a strong background in Math, so I understand (and a few I already knew) examples, etc.

The book also has code implementing the algorithms, which I am doing in PHP (which I use), but they are with an array with 5 elements.

The example used is an array with critics, and the score to each movie.

Then a function (using the euclidean metric) gives a score between two persons, and with that, you can compare to everyone and then order by higher score and voilè, you got the most similar reviewer.

My question is... this example is with 5 elements in an array.

How do you implement this in MySQL?

For example, I could have the next tables:


    - Critics
    -- id
    -- person


    - Movies
    -- id
    -- title


    - Scores
    -- critic_id
    -- movie_id
    -- score

How do you involve all the euclidean logic and everything in a query? Is that possible? I know SQL, joins and everything, but I can't figure out (maybe creating functions in SQL?)

Thank you :)

PS: English isn't my natural language, don't be too hard about that :)",,False,self,t5_2qp8q,False,,,True,t3_1f0cbe,http://www.reddit.com/r/SQL/comments/1f0cbe/mysql_how_to_get_recommended_items_based_on/,
1368582254.0,5,self.SQL,1ect9t,[Oracle] What's the best free sql editor for new SQL devs?,ora408,5,0,11,http://www.reddit.com/r/SQL/comments/1ect9t/oracle_whats_the_best_free_sql_editor_for_new_sql/,"What's the best light, free sql editor for new SQL devs? I want to install it on my laptop and be able to practice queries, making/removing tables and indexes, etc with my sample databases. I've tried SQL developer. Are there any lighter ones?",,False,self,t5_2qp8q,False,,,True,t3_1ect9t,http://www.reddit.com/r/SQL/comments/1ect9t/oracle_whats_the_best_free_sql_editor_for_new_sql/,
1368206356.0,4,self.SQL,1e2v0h,"What is ""DEV instance""? [TSQL]",randomperson24,5,1,6,http://www.reddit.com/r/SQL/comments/1e2v0h/what_is_dev_instance_tsql/,"I'm pretty new to QAT, UAT, and Production environments. I put in a table for reporting for another analyst and they have asked me ""Is there a DEV instance and database"" specifically.  I am not too sure what that means nor can I find a definition on the web. ",,False,self,t5_2qp8q,False,,,True,t3_1e2v0h,http://www.reddit.com/r/SQL/comments/1e2v0h/what_is_dev_instance_tsql/,
1367867332.0,6,self.SQL,1dt55p,Select multiple occurrences from a distinct range of values,airtrixxx1080,6,0,7,http://www.reddit.com/r/SQL/comments/1dt55p/select_multiple_occurrences_from_a_distinct_range/,"In some cases, multiple vendors may share the same mailing address. I want to get a count of instances where one address is shared by multiple vendors.  For example, if I query the following table:

V001 | 123 Main St  
V001 | 123 Main St  
V002 | 24 Broadway  
X051 | East 90th St  
R032 | 123 Main St  

I would want my report to say:  
V001 | 123 Main St  
R032 | 123 Main St

*Things to consider:*  
1) The report would **not** show ""V001"" **more than** once, since it is a duplicate (when considering both Vendor *and* Address).  
2) The report would **not** show ""V002"" or ""X051"" since their addresses only occur once.

Thanks for your help!",,False,self,t5_2qp8q,False,,,True,t3_1dt55p,http://www.reddit.com/r/SQL/comments/1dt55p/select_multiple_occurrences_from_a_distinct_range/,
1367510559.0,2,self.SQL,1dk2n7,[MS SQL] How to list prior value for a column?,twonx,5,3,4,http://www.reddit.com/r/SQL/comments/1dk2n7/ms_sql_how_to_list_prior_value_for_a_column/,"I have a table like this:

Name|Year|Sequence|Amount
--:|--:|--:|--:
John|2007|1|$300
John|2008|2|$400
Mary|2005|1|$100
Mary|2005|2|$200

What's the best code to use if I need to list create a 'PriorAmount' column that lists the person's previous amount, using their sequence number. Like for sequence 2, the 'PriorAmount' for John is $300 and $100 for Mary.

Thanks!",,False,self,t5_2qp8q,False,,,True,t3_1dk2n7,http://www.reddit.com/r/SQL/comments/1dk2n7/ms_sql_how_to_list_prior_value_for_a_column/,
1366959693.0,4,self.SQL,1d52q1,Access SQL nested IIF with DateAdd problem...,redditaccount1975,4,0,3,http://www.reddit.com/r/SQL/comments/1d52q1/access_sql_nested_iif_with_dateadd_problem/,"ok this works fine with numbers in the inner IIF:

     IIf(IsNull(RR.RexpirationDate),RR.ExpirationDate,Iif(IsNull(RStartDate),9999,1)) AS EndDate,   

When I put in my Date calc function, it breaks...Any suggestions?  Errors are 'too many arguments' or 'missing operator' Maybe its choking on the commas/parentheses in the DateAdd??  I tried putting just one DateAdd back in and it throws the same error.

     IIf(IsNull(RR.RexpirationDate),RR.ExpirationDate,Iif(IsNull(RStartDate),DateAdd(""m"",[RR].[RexpirationDate]+[RR].[StartDate]),DateAdd(""m"",[RR].[RexpirationDate]+[RR].[RStartDate] -2,[OAProperty].[AnalysisStart]))) AS EndDate, ",,False,self,t5_2qp8q,1366960240.0,,,True,t3_1d52q1,http://www.reddit.com/r/SQL/comments/1d52q1/access_sql_nested_iif_with_dateadd_problem/,
1366906542.0,3,self.SQL,1d39ic,Update: Displaying all stores that have above the average amount of employees?,S-Q-L,4,1,4,http://www.reddit.com/r/SQL/comments/1d39ic/update_displaying_all_stores_that_have_above_the/,"This is an update to [this](http://www.reddit.com/r/SQL/comments/1c2h1r/displaying_all_stores_that_have_above_the_average/) post and I just wanted to provide the solution my professor gave us.

    SELECT * 
        FROM Store 
        WHERE s_id IN 
        (SELECT e_sid FROM Employee GROUP BY e_sid HAVING COUNT(*) &gt; 
            (SELECT AVG(e_count) FROM (SELECT COUNT(*) AS e_count FROM Employee GROUP BY e_sid)));

Thanks again to those who helped.

Edit: ~~Whoops didn't realize the asterisks would screw it up. I put a period where there should be an asterisk since there is no way to turn that off.~~ Thanks for the correction!",,False,self,t5_2qp8q,1366923232.0,,,True,t3_1d39ic,http://www.reddit.com/r/SQL/comments/1d39ic/update_displaying_all_stores_that_have_above_the/,
1366727805.0,4,self.SQL,1cxr4j,MSSQL - Win Serv - iSCI - Best Practices,pmpjr6465,4,0,3,http://www.reddit.com/r/SQL/comments/1cxr4j/mssql_win_serv_isci_best_practices/,"Hi

Need some help, whose running SQL on SAN and what can you tell me about setting up SQL 2005/2008 and what config should I be setting up on my server for iSCI connections.  Right now I have two one gigabyte cat lines running to two differnet switches hooked up to my SAN via 10gig.  In the OS I have MPIO enabled and I have my volumes mounted.  

So far the only tweak I've made, other than update my NIC drives, is to increase the size of the receiver buffers.  

I am going to also disable the File/Printer Sharing for MS Networks for the iSCI NICs.  

Where should I go from here?  If this is the wrong sub please let me know.  Many thanks :)",,False,self,t5_2qp8q,False,,,True,t3_1cxr4j,http://www.reddit.com/r/SQL/comments/1cxr4j/mssql_win_serv_isci_best_practices/,
1366381781.0,3,self.SQL,1coeru,When is it a good idea to mix RIGHT and LEFT outer joins?,MeGustaDerp,5,2,21,http://www.reddit.com/r/SQL/comments/1coeru/when_is_it_a_good_idea_to_mix_right_and_left/,"I just had to navigate a nasty mess of LEFT and RIGHT OUTER joins. Similar to this. *(The objects have been changed to protect the not so innocent)*

&gt;SELECT 'yada yada yada'				 
&gt;FROM Table1 INNER JOIN
&gt;                      Table2 ON Table1.aID = Table2.aID 
&gt;	RIGHT OUTER JOIN
&gt;                      Table3 ON Table2.bID = Table3.bID LEFT OUTER JOIN
&gt;                      Table4 ON Table3.cID = Table4.cID LEFT OUTER JOIN
&gt;                      Table5 ON Table3.dID = Table5.dID	

I tend to stick with left joins when I need one or the other. When is it a good idea to mix left and right joins?",,False,self,t5_2qp8q,False,,,True,t3_1coeru,http://www.reddit.com/r/SQL/comments/1coeru/when_is_it_a_good_idea_to_mix_right_and_left/,
1366225610.0,4,self.SQL,1cjv07,Help with SQL Tutorial Question,i_have_a_gub,5,1,3,http://www.reddit.com/r/SQL/comments/1cjv07/help_with_sql_tutorial_question/,"I'm a complete SQL novice and am having trouble figuring out Question 13 on this [SQLZoo Tutorial](http://sqlzoo.net/wiki/The_JOIN_operation).  Obviously, I need to use the count function (I think), but I can't seem to get it to work.  Can anyone provide the answer?  Thanks. ",,False,self,t5_2qp8q,False,,,True,t3_1cjv07,http://www.reddit.com/r/SQL/comments/1cjv07/help_with_sql_tutorial_question/,
1364960318.0,2,self.SQL,1bkddu,Help! Advanced sql question (or maybe I'm just not getting it?),takemeanywhere,4,2,9,http://www.reddit.com/r/SQL/comments/1bkddu/help_advanced_sql_question_or_maybe_im_just_not/,"I have a table B with a foreign key to another table A (so table B has a column a_id).

Table B also has some data. I want to get all records from table A that has each one of its foreign records in B match some criteria. 

Maybe a concrete example Mary. Say table A is User and table B is Phone number. I want to get all users that ONLY have phone numbers in a list of known numbers.

So known phone numbers are [1,2,3,4,5]

User Mary has the numbers 1, 2, 4. So she should be returned.
User Fred has the numbers 3, 7. He shouldn't be returned because 7 is not in the list of known numbers. 

I've thought of finding the users that have a number outside that list and then getting the users that aren't in that list. But that seems slow.

Maybe a left join?

Any help would be greatly appreciated! Thanks",,False,self,t5_2qp8q,1364970381.0,,,True,t3_1bkddu,http://www.reddit.com/r/SQL/comments/1bkddu/help_advanced_sql_question_or_maybe_im_just_not/,
1364928947.0,3,blog.jackdb.com,1bj6s0,Introducing the JackDB Heroku Plugin - Database Development in the Cloud,jackdb,5,2,1,http://www.reddit.com/r/SQL/comments/1bj6s0/introducing_the_jackdb_heroku_plugin_database/,,,False,http://d.thumbs.redditmedia.com/yWhZclpdfhDNBvZo.jpg,t5_2qp8q,False,,,False,t3_1bj6s0,http://blog.jackdb.com/post/46946675257/jackdb-heroku-plugin,
1364505402.0,5,reddit.com,1b7961,How do you evolve your schemas? [x-post /r/SQLServer],kaaskop42,6,1,0,http://www.reddit.com/r/SQL/comments/1b7961/how_do_you_evolve_your_schemas_xpost_rsqlserver/,,,False,default,t5_2qp8q,False,,,False,t3_1b7961,http://www.reddit.com/r/SQLServer/comments/1b78go/how_do_you_evolve_your_schemas/,
1364487463.0,5,self.SQL,1b6mwx,"[MS SQL] Selecting 5 columns, only want distinct on 4",OrinMacGregor,6,1,8,http://www.reddit.com/r/SQL/comments/1b6mwx/ms_sql_selecting_5_columns_only_want_distinct_on_4/,"I have the following code where I want all but DestinationName to be distinct. As it stands right now I get some duplicates because for some places it will have an entry for 'Blah door 1' and 'Blah door 2', but since it's all one shipment the weights get skewed when I add them later since they're showing up twice.

    SELECT
     e.Arrival,  
     c.SupplierName,  
     f.DestinationName,  
     a.ControlNumber AS [SID],  
     a.GrossWeight
    FROM ManualAsnMaster a  
     INNER JOIN plants b on a.plantid = b.plantid    
     LEFT  JOIN suppliers c on a.supplierid = c.supplierid    
     INNER JOIN destinations f on f.plantid = a.plantid    
     INNER JOIN plantrouting d on f.destinationid = d.plantid and a.receivedwid = d.warehouseid    
     INNER JOIN trailers e on a.trailerid = e.trailerid    
    WHERE arrival &lt; @EndDate and arrival &gt;= @StartDate AND e.WarehouseID = @WarehouseID",,False,self,t5_2qp8q,False,,,True,t3_1b6mwx,http://www.reddit.com/r/SQL/comments/1b6mwx/ms_sql_selecting_5_columns_only_want_distinct_on_4/,
1364401806.0,4,self.SQL,1b48sh,Modify column data type which contains data,een54,4,0,7,http://www.reddit.com/r/SQL/comments/1b48sh/modify_column_data_type_which_contains_data/,"Hi

Is it possible to modify the data type of a column from DateTime to vchar even when data exists on the table?

I have tried the following with no luck:
 ALTER TABLE dbo.ScanData
  ALTER COLUMN ScanDate
    nvarchar(50)
GO

Any advice would be great!",,False,self,t5_2qp8q,False,,,True,t3_1b48sh,http://www.reddit.com/r/SQL/comments/1b48sh/modify_column_data_type_which_contains_data/,
1363879788.0,3,self.SQL,1aqilk,Help a newbie fix his 5hour+ CROSS JOIN query,wallyflops,4,1,26,http://www.reddit.com/r/SQL/comments/1aqilk/help_a_newbie_fix_his_5hour_cross_join_query/,"
Hey,

So I have two tables, one contains stores, and one contains every postcode in the UK.
I want to use SQL servers GEOGRAPHY data type, to calculate what postcodes are within a 15 miles radius of my stores.

The code below should be fairly self explanitory, but can anyone think of a better way of doing this?

Thanks for your help.




    ---THIS QUERY WILL TAKE HOURS
    --Now compare distance between #cinemas &amp; #OAData
    SELECT
      c.*,
      pc.OA_Code AS OA_Code_PC, -- Tag Cinema data with postcode/OA
      c.GeoLoc.STDistance(pc.GeoLoc) AS DistanceApart
    INTO #output
    FROM #Cinemas c
    	JOIN #OAData pc ON (C.GeoLoc.STDistance(pc.GeoLoc) &lt;= 24140.16) -- 24,140.16 is 15miles in meters.",,False,self,t5_2qp8q,False,,,True,t3_1aqilk,http://www.reddit.com/r/SQL/comments/1aqilk/help_a_newbie_fix_his_5hour_cross_join_query/,
1363471458.0,4,self.SQL,1afixk,SQL 2008 Linked to FirebirdDB configuration question,StrangeCaptain,5,1,23,http://www.reddit.com/r/SQL/comments/1afixk/sql_2008_linked_to_firebirddb_configuration/,"Howdy,

We use FishBowl Inventory (don't get me started), for those of you lucky enough to not know what that is it runs on a Firebird Database.

The included reporting functionality is lacking, and I've had great success Querying the FireBirdDB via the custom ODBC driver (custom for FishBowl, as opposed to the standard FireBird Driver ) in Access as well as JasperServer.


I am currently in the process of connecting the FishBowl Data Base to SharePoint as an external data source (don’t get me started), and the only success I’ve had is by setting up the FishBowl database as a Linked Server in SQL 2008.  


I was able to get some success connecting sharepoint to the linked server, but I get much better results by creating a SQL table from the linked server, however my skills are quite limited and I don’t know how to make the SQL Table update from the Linked server.


TLDR
I’m looking for a way to update SQL Tables from a Linked Firebird database, as well as looking for suggestions for an easier way to what I’m trying to do.
",,False,self,t5_2qp8q,False,,,True,t3_1afixk,http://www.reddit.com/r/SQL/comments/1afixk/sql_2008_linked_to_firebirddb_configuration/,
1363218714.0,2,self.SQL,1a91dq,Annoying (apparent) lack of a feature in SQl Server 2012,mentalorigami,6,4,19,http://www.reddit.com/r/SQL/comments/1a91dq/annoying_apparent_lack_of_a_feature_in_sql_server/,"The feature in question is creating a copy of a table's structure without using:

    select * 
    into NewTable
    from OldTable
    where 1 = 2;


I'm a bit of an SQL noob so maybe I'm just missing something, but this seems slightly ridiculous. Is there a better way to do this or did microsoft really just leave this so klunky? I know it makes sense, but the lack of a keyword or built in function makes me angry for some reason.",,False,self,t5_2qp8q,False,,,True,t3_1a91dq,http://www.reddit.com/r/SQL/comments/1a91dq/annoying_apparent_lack_of_a_feature_in_sql_server/,
1363216044.0,4,self.SQL,1a8y0v,First and Last day of prior month &amp; year (ms sql),tedistkrieg,5,1,12,http://www.reddit.com/r/SQL/comments/1a8y0v/first_and_last_day_of_prior_month_year_ms_sql/,"I know these get me the first and last days of the prior month

    DATEADD(month, DATEDIFF(month, 0, GETDATE())-1, 0)    
    DATEADD(dd,-(DAY(getdate())),getdate())

But I cant seem to figure out how to get the first and last days of the previous month and year. For example, how would I get 02-01-2012 and 02-29-2012?

EDIT: was able to get 2-12-2012, now just trying to get 2-29-2012

    DATEADD(mm,DATEDIFF(MM,0,DATEADD(mm,-1,DATEADD(YY,-1,GETDATE()))),0)

",,False,self,t5_2qp8q,1363217170.0,,,True,t3_1a8y0v,http://www.reddit.com/r/SQL/comments/1a8y0v/first_and_last_day_of_prior_month_year_ms_sql/,
1362843980.0,3,self.SQL,19z264,[ACCESS] Help with query,vinsite,4,1,9,http://www.reddit.com/r/SQL/comments/19z264/access_help_with_query/,"This is probably easy but you know sometimes you just can't figure it out. I have a small DB with a transaction table and a referList table. What I want to do is get the count of each referListID that appears in the transaction table. ex. Lets say there is 30 transactions this month. I want to know the total of each referral. There were 15 transactions that came from the internet. 5 came from radio. 10 came from friends.

I could do this by creating individual recordsets with a where clause but that is not efficient. This code returns the correct number, but is for just one referListID. ""SELECT COUNT(referID) AS testrefer FROM transaction WHERE referID =8""
any ideas? Thanks guys",,False,self,t5_2qp8q,False,,,True,t3_19z264,http://www.reddit.com/r/SQL/comments/19z264/access_help_with_query/,
1362777560.0,3,self.SQL,19xncg,[MS SQL] Please help me find a way to deal with effective dates.,twonx,5,2,15,http://www.reddit.com/r/SQL/comments/19xncg/ms_sql_please_help_me_find_a_way_to_deal_with/,"So I have a table of something like below:


|State  |Effective  |Rate  |
|-------|-----------|------|
|AK      |1/15/2011  |1.3    |
|AK      |3/31/2012  |1.5    |
|KY      |4/1/2010    |1.2    |
|KY      |7/1/2011    |1.4    |


Say I want to join a table with the value AK and the date is 1/19/2011, it should join with the 1.3 like above. What is the best method to do this? Should I create a table with every single day?",,False,self,t5_2qp8q,False,,,True,t3_19xncg,http://www.reddit.com/r/SQL/comments/19xncg/ms_sql_please_help_me_find_a_way_to_deal_with/,
1362589039.0,3,self.SQL,19s7rk,[MS SQL] A tip to help improve performance,nycgags,5,2,5,http://www.reddit.com/r/SQL/comments/19s7rk/ms_sql_a_tip_to_help_improve_performance/,"I'm not sure if this is the best way to solve this problem but I have used it a number of times to much success.

I do a lot of back testing of financial data often touching tables with millions of rows.  There are times when I will hit a wall and cannot seem to optimize my code through indexes or other means.  So I have come up with this process which seems to work pretty effectively.  (It's pretty similar to picking a minimum ID and looping through to perform the update statement which I have also done, but this seems to be even better since you are looping through and updating up 10 rows at a time instead of just 1)

-- depending on what you are updating and the performance 
-- gains you want to use, you can vary this from 10000 to 10

    set rowcount 10 
    select 1    
    while @@rowcount &gt; 0
    
    update u    
    set [...]    
    ,updCode = 1    
    from [table] u    
    [joins...]    
    where    
    [where clauses...]    
    and u.updCode != 1
    
    set rowcount 0

The key is to also update the updCode column I created and to filter against it in the where clause to avoid any infinite loops (once the row is updated it is removed from a possible row to update).",,False,self,t5_2qp8q,False,,,True,t3_19s7rk,http://www.reddit.com/r/SQL/comments/19s7rk/ms_sql_a_tip_to_help_improve_performance/,
1362168874.0,5,self.SQL,19hct6,How to get date fields to group by month,JCollierDavis,5,0,13,http://www.reddit.com/r/SQL/comments/19hct6/how_to_get_date_fields_to_group_by_month/,"I'm working on the following query to run in an Oracle Db.

    SELECT support_uic, proj_cd, TO_CHAR(compl_dt, 'MON-YYYY')date_completed, COUNT(won) close_count

    FROM 
	mgt0.V_WON_R_VIEW_ALL		

    WHERE 
    support_uic IN
    ('big_list')

    AND TO_CHAR(compl_dt, 'MON-YYYY') IN ('OCT-2012', 'NOV-2012', 'DEC-2012', 'JAN-2013', 'FEB-2013')
    AND compl_dt IS NULL

    GROUP BY support_uic, proj_cd, compl_dt, TO_CHAR(compl_dt, 'MON-YYYY')
    ORDER BY support_uic, proj_cd, compl_dt, TO_CHAR(compl_dt, 'MON-YYYY')

The results end up similar to what I'm looking for except the GROUP_BY still uses the actual date 'DD/MM/YYY HH:MM:SS' instead of just 'MON-YYYY' like I'd want.

Any suggestions?  


I'd really like to lean how to work with dates, especially how to convert them into different looking formats without having to use TO_CHAR.
",,False,self,t5_2qp8q,False,,,True,t3_19hct6,http://www.reddit.com/r/SQL/comments/19hct6/how_to_get_date_fields_to_group_by_month/,
1362080325.0,6,self.SQL,19ew9d,"[MS SQL]multiple columns, multiple WHERE.",yellising,7,1,17,http://www.reddit.com/r/SQL/comments/19ew9d/ms_sqlmultiple_columns_multiple_where/,"Spam filter ate my original post twice, since that has a vague title, I'm recreating my post here.


Is there a way to generate two columns using 2 different WHERE clause? 

I'd like to seperate yearly stats per column.

Something like:

    Select
        Branch
        ,avg(score) WHERE year=2010 as '2010 stats'
        ,avg(score) WHERE year=2011 as '2011 stats'
        ,avg(score) WHERE year=2012 as '2012 stats'
    From allScores
    Group By Branch

I know the code above won't work, I'm looking for something with a similar effect.


Thank you!",,False,self,t5_2qp8q,False,,,True,t3_19ew9d,http://www.reddit.com/r/SQL/comments/19ew9d/ms_sqlmultiple_columns_multiple_where/,
1362006552.0,4,self.SQL,19cwy8,[MySQL] Comparing entries against entries with adjacent dates,boiling_penis,5,1,7,http://www.reddit.com/r/SQL/comments/19cwy8/mysql_comparing_entries_against_entries_with/,"I have a table with three (relevant) columns: application_id, date, and rank.  What I'd like to do is to select * from the table where the rank on any given date is different from the preceding date.  I don't really know how to do that.  Can anybody help?",,False,self,t5_2qp8q,False,,,True,t3_19cwy8,http://www.reddit.com/r/SQL/comments/19cwy8/mysql_comparing_entries_against_entries_with/,
1361198561.0,5,self.SQL,18r2h6,Replicating data intensive IO on SQL Server database? HELP?,amsterDerp,5,0,10,http://www.reddit.com/r/SQL/comments/18r2h6/replicating_data_intensive_io_on_sql_server/,"I have set up a database on Sql Server 2012 which has multiple relational tables and one main table consisting of about 2500 entries. 

My end aim from all of this is to monitor system performance of different environments (for example Virtual Machines environments vs. physical servers). What type of query(s) should I be executing to put my hardware under heavy constant load? Should I be selecting and updating in a loop constantly?

Any help would be great as I'm quite the novice. 

Thanks! 

[Link to DB code if needed](http://pastebin.com/0uN519YK)",,False,self,t5_2qp8q,False,,,True,t3_18r2h6,http://www.reddit.com/r/SQL/comments/18r2h6/replicating_data_intensive_io_on_sql_server/,
1361081341.0,4,self.SQL,18oihw,[Oracle] Sql query problem,too_kind,4,0,12,http://www.reddit.com/r/SQL/comments/18oihw/oracle_sql_query_problem/,"Appreciate your help in forming the following query.

I have tables TAB A and TAB B. TAB A is related to TAB B with 1 to many relationship. TAB B has a column B.X which can have 3 possible values; Apple, Orange and Peach.

Queries that I want to form:

1) Count number of records in TAB A that has a mix of Apple and Orange, Apple and Peach, Orange and Peach (so 3 numbers)

2) Count number of records in TAB A that has a mix of Apple, Orange and Peach (so 1 number)

3) Count number of records in TAB A that has only Apple, Orange or Peach (3 numbers)
",,False,self,t5_2qp8q,False,,,True,t3_18oihw,http://www.reddit.com/r/SQL/comments/18oihw/oracle_sql_query_problem/,
1360951864.0,4,self.SQL,18lb3x,"[Generic SQL] 2 questions: Add 1 literal line header, multiple table XML style output.",ImHighCurrently,4,0,5,http://www.reddit.com/r/SQL/comments/18lb3x/generic_sql_2_questions_add_1_literal_line_header/,"Greetings mighty SQL people,  I've got two questions that I'm having a bit of a time solving.  Technically this is for MSSQL Server 2008.

Question #1: I want to stick a header on my table output.  Any clues how to?

    This is my header
    t1.f1, t1.f2
    t1.f1, t1.f2


Question #2: Can a nested XML style output be done?

    FileHeaderTable.f1, FileHeaderTable.f2
      ParentObjectHeaderTable.f1, ParentObjectHeaderTable.f2
        ChildObjectValue.f1, ChildObjectValue.f2
        ChildObjectValue.f1, ChildObjectValue.f2
      ParentObjectFooter.f1, ParentObjectFooter.f2
      ParentObjectHeaderTable.f1, ParentObjectHeaderTable.f2
        ChildObjectValue.f1, ChildObjectValue.f2
        ChildObjectValue.f1, ChildObjectValue.f2
      ParentObjectFooter.f1, ParentObjectFooter.f2
    FileFooterTable.f1, FileFooterTable.f2


Happy Friday and a preemptive thank you very much for being awesome.


",,False,self,t5_2qp8q,False,,,True,t3_18lb3x,http://www.reddit.com/r/SQL/comments/18lb3x/generic_sql_2_questions_add_1_literal_line_header/,
1360039548.0,5,self.SQL,17wz92,Ask /r/SQL: Would it be beneficial to understand mathematical statistics in order to understand the concepts behind index statistics in databases?,MeGustaDerp,5,0,10,http://www.reddit.com/r/SQL/comments/17wz92/ask_rsql_would_it_be_beneficial_to_understand/,"I'm pretty much a self taught a database developer. For career and personal development, I am looking to study the theory behind databases in order to better understand what I am doing. I have been wondering if it would be beneficial to get a firm grasp of mathematical statistics in order for me to understand the statistics that are associated with indexes in SQL Server and Oracle. Does anyone have any feed back on this?",,False,self,t5_2qp8q,False,,,True,t3_17wz92,http://www.reddit.com/r/SQL/comments/17wz92/ask_rsql_would_it_be_beneficial_to_understand/,
1358970925.0,4,self.SQL,1752r6,Group By Select Query is close but I need to make it slightly more unique,macness234,7,3,14,http://www.reddit.com/r/SQL/comments/1752r6/group_by_select_query_is_close_but_i_need_to_make/,"**EDIT SOLUTION BELOW**

SQL Sever 2000. I'm trying to make this query slightly more unique.

*Any help you guys can provide... I've been struggling with this for 2 days now...*

The Query:

    USE MyDatabase
    GO
    
    SELECT MAX(x.provider_entry_id) as provider_entry_id,  -- this ID is the PK
         x.provider_entry_type_id, -- the entry for the specific provider type (the ID)
         x.provider_entry, -- the actual provider entry (the ID)
         x.provider_entry_visit_dt -- the date the entry was created
    FROM tbl_claimant_provider_entry x
    JOIN (SELECT p.provider_entry_type_id,
                 p.provider_entry,
                 MAX(provider_entry_visit_dt) AS max_date
            FROM tbl_claimant_provider_entry p
            WHERE provider_entry_clmnt = 4963 -- change this for you user 
            GROUP BY p.provider_entry_type_id, p.provider_entry) y ON y.provider_entry_type_id = x.provider_entry_type_id
                              AND y.max_date = x.provider_entry_visit_dt
    GROUP BY x.provider_entry_type_id, x.provider_entry, x.provider_entry_visit_dt

returns:

    provider_entry_id   provider_entry_type_id  provider_entry  provider_entry_visit_dt
    1052                109                     1088            2013-01-22 00:00:00.000
    1051                109                     1665            2013-01-23 00:00:00.000
    1049                130                     264             2013-01-01 00:00:00.000
    1050                130                     1126            2013-01-02 00:00:00.000
    1045                132                     NULL            2013-01-22 00:00:00.000
    1047                132                     260             2013-01-22 00:00:00.000
    1044                132                     1115            2013-01-10 00:00:00.000
    1048                132                     1130            2013-01-22 00:00:00.000
    1043                142                     1356            2013-01-10 00:00:00.000
I'm looking to narrow this list to show me only one instance of each unique provider_entry_type_id based on the most recent     provider_entry_visit_dt

So the results would be (keep in mind that there will not need to be a need for tie breakers for the provider_entry_visit_dt, that's just an error on my part):

    provider_entry_id   provider_entry_type_id  provider_entry  provider_entry_visit_dt
    1051                109                     1665            2013-01-23 00:00:00.000
    1050                130                     1126            2013-01-02 00:00:00.000
    1048                132                     1130            2013-01-22 00:00:00.000
    1043                142                     1356            2013-01-10 00:00:00.000

**SOLUTION**

        SELECT  b.*
        FROM    dbo.tbl_claimant_provider_entry AS b 
        INNER JOIN
                    (SELECT provider_entry_type_id, MAX(provider_entry_visit_dt) AS maxdate
                                    FROM    dbo.tbl_claimant_provider_entry
                                    GROUP BY provider_entry_type_id) AS m ON b.provider_entry_type_id = m.provider_entry_type_id AND b.provider_entry_visit_dt = m.maxdate
        WHERE   (b.provider_entry_clmnt = 4963)",,False,self,t5_2qp8q,1358978525.0,,,True,t3_1752r6,http://www.reddit.com/r/SQL/comments/1752r6/group_by_select_query_is_close_but_i_need_to_make/,
1358804461.0,3,self.SQL,170hg7,UK Qualifications?,pix1985,6,3,7,http://www.reddit.com/r/SQL/comments/170hg7/uk_qualifications/,"I've been working with MS SQL for a couple of years and have recently become a junior DBA. My work has said for me to look into some courses. I'm not sure how much they're willing to pay yet, but what would you recommend that would get me a good recognised certification?",,False,self,t5_2qp8q,False,,,True,t3_170hg7,http://www.reddit.com/r/SQL/comments/170hg7/uk_qualifications/,
1358542243.0,3,self.SQL,16u5s0,natural keys in fact table: Pros and Cons,Q7guy,5,2,5,http://www.reddit.com/r/SQL/comments/16u5s0/natural_keys_in_fact_table_pros_and_cons/,"Is it acceptable to use natural keys (composite) in a fact table? There are instances, when I only join to the dimension to get a text description ie, full name or serial number etc... My reporting environment is Cognos with sql driven reports...no cubes. 
Example:
SELECT  
   s1.field_SK,
   s1.status_sk,
   s2.status_name,
   s1.status_value,
   s1.status_COUNT
   FROM FACT_STATUS s1, dimstatus s2
where s1.status_sk = s2.status_sk

",,False,self,t5_2qp8q,False,,,True,t3_16u5s0,http://www.reddit.com/r/SQL/comments/16u5s0/natural_keys_in_fact_table_pros_and_cons/,
1358362234.0,2,self.SQL,16p5vb,[MS SQL 2008] Question about page splitting in indexes,chafe,4,2,5,http://www.reddit.com/r/SQL/comments/16p5vb/ms_sql_2008_question_about_page_splitting_in/,"Hey guys, I just found this subreddit and so far it's awesome. I've checked out some great posts with great information. I'm currently studying for the 70-432 and had a question regarding indexes.

The way page splitting happens as described in my self paced training kit book, is in this way:

&gt;"" ...two additional pages are allocated to the index in a process called page splitting. The existing root page is pushed down the structure to become a leaf-level page. **SQL Server takes half of the data on the index page and moves it to one of the newly allocated pages.** The other new page is allocated at the top of the index structure to become the new root page...""

Now, I'm imagining the data the index points to is sorted by the primary key. I'm also assuming that the data is ordered without any gaps (for example, let's say the primary key is the Order Number column, starting with 00001, and there are orders all the way through 50000). So if the page fills up with data being entered, sorted by the Order Number column, and the last row is Order Number 50000, then according to the above, when the page split occurs, one of the leaf-level pages will have orders 00001 - 25000, and the other will have 25001 -  50000.

So since orders are being placed sequentially, the first leaf-level page will only contain half of its quota, since more data won't be indexed there (since everything is ordered, which is how an index works, right?). The second leaf will fill up twice as fast (since it only has 25000 free spaces instead of 50000 like the original root page did) causing another page split, and so on and so forth. This seems very strange and inefficient. Do I not understand this properly, or is this really how it works??",,False,self,t5_2qp8q,False,,,True,t3_16p5vb,http://www.reddit.com/r/SQL/comments/16p5vb/ms_sql_2008_question_about_page_splitting_in/,
1358349271.0,5,self.SQL,16or1i,[TSQL] Need help creating a Trigger with a cURL command to post a text file to a webpage. ,e13ct,5,0,10,http://www.reddit.com/r/SQL/comments/16or1i/tsql_need_help_creating_a_trigger_with_a_curl/,"Hey everybody, let me say thanks to you guys for all the help you have been providing on this sub. So great, but I have an issue. 

I have an academic web application that can be programmatically updated using the cURL command. I have some syntax for the curl command, but what I need more is a trigger on the databases so that every time they have a data change they send an update to the web app. 

I guess this would be similar to EPL which I haven't done much of, but I have done less with triggers. 

Has anyone ever done something like this before?

TL;DR Need help creating a trigger to send a plaintext file update to an URL. 
",,False,self,t5_2qp8q,False,,,True,t3_16or1i,http://www.reddit.com/r/SQL/comments/16or1i/tsql_need_help_creating_a_trigger_with_a_curl/,
1357282763.0,5,pgxn.org,15xtm6,[PostgreSQL] pg_message_queue 0.2.0: A simple LISTEN/NOTIFY message queue with payload tables,einhverfr,5,0,0,http://www.reddit.com/r/SQL/comments/15xtm6/postgresql_pg_message_queue_020_a_simple/,,,False,http://c.thumbs.redditmedia.com/Az2aTQmHQHfnGUlV.jpg,t5_2qp8q,False,,,False,t3_15xtm6,http://www.pgxn.org/dist/pg_message_queue/0.2.0/,
1356470256.0,4,self.SQL,15fotj,Need help to solve DateDiff function,Hakiki1,6,2,9,http://www.reddit.com/r/SQL/comments/15fotj/need_help_to_solve_datediff_function/,"I am currently working on simple library database (in MS Access) and cannot figure out a query which should show all book lenders who have returned their books on time (in 15 days).

I have a table in which all records of lending are kept (Times) and another table with all lenders of the library (Lenders). 

The code currently looks like this:

    SELECT COUNT(DateDiff (""d"",t.[Date of Lending],t.[Date of Return])) AS ReturnNo, t.Lender_ID, l.[First Name], l.[Last Name], l.[Contact Number], l.[Email]
    FROM Times AS t, Lender AS l
    WHERE l.Lender_ID=[t].[Lender_ID] AND DateDiff (""d"",t.[Date of Lending],t.[Date of Return]) IS NOT NULL
    GROUP BY DateDiff (""d"",t.[Date of Lending],t.[Date of Return]) &lt;= ""15"", t.Lender_ID, l.[First Name], l.[Last Name], l.[Contact Number], l.[Email]
    ORDER BY t.[Lender_ID];

The current query gives me separate results, for example, one lender has returned 3 books in due time, but the query gives me one row with 2 books and another row with 1 book counted.

If you could help out, tell me if I'm maybe doing it totally the wrong way or if it needs some tweaking I would very appreciate it.",,False,self,t5_2qp8q,False,,,True,t3_15fotj,http://www.reddit.com/r/SQL/comments/15fotj/need_help_to_solve_datediff_function/,
1355260592.0,4,self.SQL,14ooei,[MS SQL] How to conditionally remove rows between two other rows in sorted result?,THLycanthrope,4,0,12,http://www.reddit.com/r/SQL/comments/14ooei/ms_sql_how_to_conditionally_remove_rows_between/,"Also posted in /r/SQLServer  using 2008  
A massive simplification of my problem, but I think this is the sticking point:  
I have a date SORTED list of events of 3 types (0,1,2).  
If any number of 0 are between a 1 and 2, then they should be   excluded.  
1 will always be followed by a 2, but 2 may not have a 1  
    Jan 0  
    Feb 2  
    Mar 1  
    Apr 2  
    May 0  
    Jun 1  
    Jul 0  
    Aug 2  
    Sep 0  
    Oct 1  
    Nov 2  
    Dec 0  
Jan and Jul should not be in my result set.  
.  
**EDIT: Thank you everyone for the help.  They adjusted the requirements and I don't think I need this anymore.  I'm going to have to write a StoredProc.  
My goal was to calculate the days between events (0), but I should ignore anything that happened between when it went OnHold (1) and when it came OffHold(2).  
The new requirements are that all events should be considered but I should not add days when the Case was OnHold.  I think I need to traverse two cursors to pull it off.**",,False,self,t5_2qp8q,1355343562.0,,,True,t3_14ooei,http://www.reddit.com/r/SQL/comments/14ooei/ms_sql_how_to_conditionally_remove_rows_between/,
1355176066.0,4,self.SQL,14mkkd,VBA &amp; ADODB connection to execute stored procedure is extremely slow. Any ideas?,d1sturbdapeace,4,0,9,http://www.reddit.com/r/SQL/comments/14mkkd/vba_adodb_connection_to_execute_stored_procedure/,"I created a new ADODB connection in VBA with Excel 2007 to execute a stored procedure on SQL Server 2005 which creates a recordset of about 10 columns by 40K rows. It takes about one minute to deposit that into a range when kicking off the macro.

However, if I create a table which is 10 columns by 40K rows and link it to the same stored procedure using OLEDB, it only take about 5 seconds to refresh.

Is there a way to make this query faster without having a table in my workbook?
Thanks!",,False,self,t5_2qp8q,False,,,True,t3_14mkkd,http://www.reddit.com/r/SQL/comments/14mkkd/vba_adodb_connection_to_execute_stored_procedure/,
1354719398.0,3,self.SQL,14bofh,How do i go about developing a user interface so a non-technical user can add to the database which will then be shown on a website? [MySQL],Tobias4rmT,6,3,7,http://www.reddit.com/r/SQL/comments/14bofh/how_do_i_go_about_developing_a_user_interface_so/,Hope this is in the right place but it will be using mysql so thought i would post it here.,,False,self,t5_2qp8q,False,,,True,t3_14bofh,http://www.reddit.com/r/SQL/comments/14bofh/how_do_i_go_about_developing_a_user_interface_so/,
1354655552.0,3,self.SQL,14a5ni,[MS SQL] How do I search for double-quotes?,sql_no_run,5,2,5,http://www.reddit.com/r/SQL/comments/14a5ni/ms_sql_how_do_i_search_for_doublequotes/,"I need to fix double-quotes in a field so they are single quotes, but I want to see how many fields I will be updating before I execute an UPDATE statement.
I've done:
    select * from tbl
        where person_data like '%""%'

and
    select * from tbl
        where patindex('""',person_data) &gt; 0
and the execute does not find anything, when in reality, there are about 15,000 records to find.
Thanks!",,False,self,t5_2qp8q,False,,,True,t3_14a5ni,http://www.reddit.com/r/SQL/comments/14a5ni/ms_sql_how_do_i_search_for_doublequotes/,
1354295688.0,4,self.SQL,14250c,How can I filter bad fields before math function?,ImHighCurrently,4,0,3,http://www.reddit.com/r/SQL/comments/14250c/how_can_i_filter_bad_fields_before_math_function/,"**UPDATE: SOLVED**
    
    isnumeric(MyField) = 1 

Thank you!!



Hi /sql!  I've got a horrid DB that can not be modified:

MyTable.MyField should be numeric but it is actually a varchar and it has old records with non numeric values.  Specifically, several records have a question mark in the value: Rather than '123', it will have '?123'.

Now I want to 

     SELECT MyField 
     FROM MyTable 
     WHERE MyField &gt; 10

But this will crash because of the old garbage records.  

So, is there any way to filter out the old garbage records, then run my simple query?  I tried 

    SELECT MyField 
    FROM (
        SELECT MyField 
        FROM MyTable 
        WHERE NOT (MyField LIKE '%?%')
        )  AS MyTable2
    WHERE MyField &gt; 10

But that doesn't work, it claims to be still picking up the garbage records.

MSSQL if it matters.

PS: Before you ask, the DB is full of medical records and can not be modified, so no, and I can't update the table to fix the records.  =/

PPS: Happy Friday.

",,False,self,t5_2qp8q,1354298958.0,,,True,t3_14250c,http://www.reddit.com/r/SQL/comments/14250c/how_can_i_filter_bad_fields_before_math_function/,
1353436526.0,4,self.SQL,13ir8o,General SQL Question,A_Nearby_Tree,7,3,7,http://www.reddit.com/r/SQL/comments/13ir8o/general_sql_question/,"First off I'm sorry i know nothing about SQL.

I'm currently an accounting student and one of the programs we use is microsoft dynamics. Dynamics needs SQL to work properly.

My question is the disc i've been given contains SQL 2005. 2005 is not compatible with windows 8, so would i be ok downloading the trial version of 2008 or 2012 and be able to run dynamics the same way?

This is a mid level course that deals with general accounting for a company. I've never used Dynamics or SQL before and this is the first semester they are doing this so i feel they are falling through it.

Any help or suggestions is greatly appreciated. Thanks!",,False,self,t5_2qp8q,False,,,True,t3_13ir8o,http://www.reddit.com/r/SQL/comments/13ir8o/general_sql_question/,
1353018717.0,4,self.SQL,139j5n,[SQL Server] Parallel execution of a complex job,LyndsySimon,5,1,6,http://www.reddit.com/r/SQL/comments/139j5n/sql_server_parallel_execution_of_a_complex_job/,"Say I have a complex job, which executes a number of stored procedures. Some of these must be run in series, while others may be run in parallel. Is there a way to do this in a single agent step or execution batch?

The flow:

1. Execute A
2. Execute B1, B2, and B3.
3. When B1, B2, and B3 are complete, execute C

In my case B1, B2, and B3 are I/O bound (I'm pulling data over the network), and take about 10-15 minutes each. Doing them in series takes about 40 minutes; opening 3 sessions and executing them simultaneously by hand takes about 15. Executing them in parallel like this - but in an automated way - is the only way I'll be able to scale my project.

Note also that B1, B2, and B3 do not perform operations on the same table, so there shouldn't be an issue with them locking each other out.",,False,self,t5_2qp8q,False,,,True,t3_139j5n,http://www.reddit.com/r/SQL/comments/139j5n/sql_server_parallel_execution_of_a_complex_job/,
1351540708.0,3,self.SQL,12aks3,Terrible performance from SQL view,mark8cato,5,2,8,http://www.reddit.com/r/SQL/comments/12aks3/terrible_performance_from_sql_view/,"For my job I've written a fairly simple view (with my limited SQL knowledge):

    
    CREATE OR REPLACE VIEW SYSAUDIT_V AS
    (
    SELECT date, time, bgroup, user, session, ORA_ROWSCN  FROM (
    SELECT DISTINCT date, time, bgroup, user, session, ORA_ROWSCN, Rank() Over (Partition BY session Order By ROWID ) As minRow
    FROM SYSAUDIT
    )
    WHERE minRow = 1
    );

As you can see, it is just a view on a table, with a little bit of logic for getting only the first item (by rowid) for each lot of rows with the same session number. This works fine.

The problem is that performance is terrible. The underlying table has a HUGE number of records, with no index. I cannot change the underlying table.

Can anyone with more knowledge of SQL tell me how this could be improved please? I imagine that Rank() &amp; Partition By bit is not as efficient as possible, but I don't know how to improve it.",,False,self,t5_2qp8q,False,,,True,t3_12aks3,http://www.reddit.com/r/SQL/comments/12aks3/terrible_performance_from_sql_view/,
1350664404.0,4,self.SQL,11r5jx,[Foxpro SQL] Help with Self-Select,oldfoxpro,5,1,5,http://www.reddit.com/r/SQL/comments/11r5jx/foxpro_sql_help_with_selfselect/,"I still use VFP, but it's standard sql question. Have a table of hospital admissions for 5 year, many repeat admissions. I want to only count those admissions that are over 28 days. If a patient returns within 28 days with the same problem, we count is as one occurance, the 'index case'. Basically, I need to transpose a list to a single record for each unique patient with as many date fields as there are admissions. Once I get the table in that format, I can evaluate the dates, that's the easier part. I tried an inner join on 140,000 records, got over 900,000. Each patient has a unique patient id number.
My code so far is:

SELECT a.ptid, a.admitdate, b.admitdate, a.diagnosis, b.diagnosis FROM patients a;
INNER JOIN patients b ON (a.ptid=b.ptid) AND (a.diagnosis=b.diagnosis) AND (a.admitdate&lt;&gt;b.admitdate)

I am also doing this in Access, so code access or general code for sql to help would be great, really stuck here, thanks.

EDIT: Also, a patient can be admitted 10 times or more for the same problem, so the record has to include 10 or more admit dates, and the dates have to be evaluated in sequence in sets of two, ie 1, 2, 3, 4, 5 admit dates requires a check of 2-1, 3-2, 4-3, 5-4, if any of these are &lt;=28, then the second admit record is not counted. Fun eh?",,False,self,t5_2qp8q,1350668775.0,,,True,t3_11r5jx,http://www.reddit.com/r/SQL/comments/11r5jx/foxpro_sql_help_with_selfselect/,
1350639478.0,4,self.SQL,11qntk,"[MS SQL] Finding duplicates, but leave out first one ",Unomagan,5,1,8,http://www.reddit.com/r/SQL/comments/11qntk/ms_sql_finding_duplicates_but_leave_out_first_one/,"Hello guys,

Iam really a noob in MS SQL. And I need your held.

I got a table with duplicates in it. It has no ID, but we have a UID column for it. I have no clue how to find duplicates and select only two instead of the three duplicates for example.

Example table:

UID VARCHAR(20)
COSTNR VARCHAR (20)
ACCNR VARCHAR (20)
DTYPE VARCHAR (20)

DTYPE is duplicated, while UID should be printed out.

Thank you for your help, and a nice weekend! 

EDIT: I dont want to get none duplicates.

For example:

UID: 100; DTYPE: 33; NR:1

UID: 101; DTYPE: 33; NR:2

UID: 102; DTYPE: 33; NR:1

UID: 103; DTYPE: 33; NR:3

should result in:

UID: 102

Not more. (The rest ignored)

EDIT TWO: If we got three duplicates, I need to get two of them.

EDIT THREE: I dont know how many duplicates we got...",,False,self,t5_2qp8q,1350649753.0,,,True,t3_11qntk,http://www.reddit.com/r/SQL/comments/11qntk/ms_sql_finding_duplicates_but_leave_out_first_one/,
1350536227.0,4,dreamincode.net,11oazx,My free ebook - A Primer on SQL,rbatra,7,3,0,http://www.reddit.com/r/SQL/comments/11oazx/my_free_ebook_a_primer_on_sql/,,,False,default,t5_2qp8q,False,,,False,t3_11oazx,http://www.dreamincode.net/forums/blog/48/entry-4251-my-free-ebook-a-primer-on-sql/,
1350373546.0,4,self.SQL,11k7fa,IDE for PROGRESS database(s)?,carlhunt3r,4,0,6,http://www.reddit.com/r/SQL/comments/11k7fa/ide_for_progress_databases/,"Hello /r/sql

One of the core systems which I support runs on a Progress database. I have an openEdge ODBC connection to access this data, however, I am finding it difficult to ""get at"" this data. I am more of a MS SQL kinda guy, and Management Studio is where I usually can be found. Is there an equvielent tool for PROGRESS? Can I connect my instance of Management Studio to the instance our instance of PROGRESS?

Any ideas would be superb guys.

For information, I have used MS Access to do basic querying, but the functionality is lacking, and it is not the ideal solution. It throws errors constantly and hangs, and also complains about too many indexes when linking to tables.",,False,self,t5_2qp8q,False,,,True,t3_11k7fa,http://www.reddit.com/r/SQL/comments/11k7fa/ide_for_progress_databases/,
1350327179.0,3,self.SQL,11iw5i,Need your opinion on the time and man power required for linking a phone or laptop to automatically input data into a SQL server based upon the user's input,,4,1,4,http://www.reddit.com/r/SQL/comments/11iw5i/need_your_opinion_on_the_time_and_man_power/,"Before I even propose this to my supervisor, I am wanting some feedback as I have no experience in anything like this before.  Currently we are trying to go paperless at my office and lessen the need of data entry.  We support field workers who fill out forms and another person data enters the forms. How complicated do you think it would be to develop an iphone app which directly inputs data into a SQL server?  We would contract someone externally to develop the app but I would help on any linking to the SQL database so that the data is automatically inputted and bypasses the need for a second party to data enter.  Do you think this is something one person could handle for the SQL linking into a database and how long do you think it would take?  
The other option is currently the field workers are using iphones, just for email, but they would like laptops.  The obstacles we run into here are we would additionally be paying for their on-the-go internet access and along with having to secure the data connecting to our network. Based upon the information I have given, what could you foresee as concerns I should consider?
",,False,self,t5_2qp8q,False,,,True,t3_11iw5i,http://www.reddit.com/r/SQL/comments/11iw5i/need_your_opinion_on_the_time_and_man_power/,
1350313380.0,4,simple-talk.com,11ihou,Tune Your Indexing Strategy with SQL Server DMVs,wordsmithie,7,3,1,http://www.reddit.com/r/SQL/comments/11ihou/tune_your_indexing_strategy_with_sql_server_dmvs/,,,False,http://c.thumbs.redditmedia.com/t__VgkHqOtWVcO6J.jpg,t5_2qp8q,False,,,False,t3_11ihou,http://www.simple-talk.com/sql/performance/tune-your-indexing-strategy-with-sql-server-dmvs/?utm_source=simpletalk&amp;utm_medium=email-main&amp;utm_content=indexingwithDMVs-20121015&amp;utm_campaign=SQL,
1350071352.0,4,self.SQL,11dqbj,Proper Case,Bandude,5,1,14,http://www.reddit.com/r/SQL/comments/11dqbj/proper_case/,"Is there an easy way to apply proper case to an address?

EX&gt; 

12345 ANY WOODS TRAIL

to

12345 Any Woods Trail


",,False,self,t5_2qp8q,False,,,True,t3_11dqbj,http://www.reddit.com/r/SQL/comments/11dqbj/proper_case/,
1349661032.0,2,self.SQL,1146lk,Hi r/SQL  - How much do you make?,Dicedvo,12,10,17,http://www.reddit.com/r/SQL/comments/1146lk/hi_rsql_how_much_do_you_make/,"I'm considering a new job offer, and I'm wondering how much you make:

**Job Title:**     

**Experience:**

**Salary:**

**Location:**",,False,self,t5_2qp8q,1349662348.0,,,True,t3_1146lk,http://www.reddit.com/r/SQL/comments/1146lk/hi_rsql_how_much_do_you_make/,
1349463909.0,3,self.SQL,1108d1,[SQL Server] Transpose Rows to Columns,zylo4747,4,1,20,http://www.reddit.com/r/SQL/comments/1108d1/sql_server_transpose_rows_to_columns/,"I am having a hellish time trying to figure out how to do this.  I have a table with about 20 columns and 3 columns that I need to transpose each row for into a column (so 3 columns per row).

I found this article (http://www.simple-talk.com/blogs/2007/09/14/pivots-with-dynamic-columns-in-sql-server-2005/) which does a pretty good job explaining how to dynamically transpose rows to columns which is what I need.  What I can't figure out is what to put in the pivot statement because it involves me pivoting 3 fields.

Here's a simplified example of what I mean:

    StudentID | StudentName | Question | Answer | Score
    1 | Bob | What is your name? | Bob | 10
    1 | Bob | What is your favorite color? | Blue | 15
    1 | Bob | What year were you born? | 1999 | 5
    2 | Mary | What is your name? | Mary | 10
    2 | Mary | What is your favorite color? | Green | 15
    2 | Mary | What year were you born? | 2001 | 5

I want the above to be transformed into this:

    StudentID | StudentName | Question1 | Answer1 | Score1 | Question2 | Answer2 | Score2 | Question3 | Answer3 | Score3
    1 | Bob | What is your name? | Bob | 10 | What is your favorite color? | Blue | 15 | What year were you born? | 1999 | 5
    2 | Mary | What is your name? | Mary | 10 | What is your favorite color? | Green | 15 | What year were you born? | 2001 | 5

Any help would be appreciated.  Hopefully using the dynamic method in the site mentioned above, but if a static example is provided I can work off of that too.

Thanks!",,False,self,t5_2qp8q,False,,,True,t3_1108d1,http://www.reddit.com/r/SQL/comments/1108d1/sql_server_transpose_rows_to_columns/,
1349232541.0,4,self.SQL,10urwp,32 Bit ODBC Connection Login Failure,PoglaTheGrate,4,0,9,http://www.reddit.com/r/SQL/comments/10urwp/32_bit_odbc_connection_login_failure/,"ENVIRONMENT: Windows Server 2008R2

Software: MS SQL SERVER 2008

Heya Peeps!

So I have a third party application that hangs off MS SQL SERVER 2008 and creates code etc.

All connections are done via ODBC, and due to the nature of the programme, it has to be the 32bit ODBC drivers, even though I'm on a 64bit system.

I'm having trouble getting a Windows User authenticated by the ODBC.  It is a windows user with the credentials of [Domain]\\[Sys-Account-Name].  I have added the user to the SQL Server instance - using Windows authentication, and it as db_datareader, db_datawriter, db_ddladmin on the database I'm trying to connect to.  The SQL Server instance has mixed authentication

When I try to use the third party application, it gives a vague login error.  When I try to specify the user in the ODBC connection, the error message states: 

Connection failed:

SQLState: '28000'

SQL Server Error: 18456

[Microsofto][SQL Server Native Client 10.0] [SQL Server] Login failed for user '[Domain]\\[SYS Account Name]'.

The Error log states:

Logon,Unknown,Login failed for user '[Domain]\\[SYS Account Name]'. Reason: Attempting to use an NT account name with SQL Server Authentication. [CLIENT: &lt;local machine&gt;]

Trying to find a solution just comes up with:

1. Make sure the instance has mixed authentication (it does)

2. Make sure the user is added to the logins (it is)

**edit** Fixed formatting

**edit, edit** I should point out that using the Sys account to open either SSMS, or the third party programme works fine.  I can update, edit and drop tables.",,False,self,t5_2qp8q,1349240047.0,,,True,t3_10urwp,http://www.reddit.com/r/SQL/comments/10urwp/32_bit_odbc_connection_login_failure/,
1348969136.0,5,alfredoalvarez.com,10oy8t,Finding All empty tables in MS SQL db ,theavatare,6,1,7,http://www.reddit.com/r/SQL/comments/10oy8t/finding_all_empty_tables_in_ms_sql_db/,,,False,default,t5_2qp8q,False,,,False,t3_10oy8t,http://alfredoalvarez.com/blog/?p=328,
1348839861.0,5,self.SQL,10m8zb,MS SQL 2008 R2: SSRS Reporting Services - Pagination Problems,AnonymooseRedditor,5,0,6,http://www.reddit.com/r/SQL/comments/10m8zb/ms_sql_2008_r2_ssrs_reporting_services_pagination/,"Hi All, I'm fighting with a reporting issue and was hoping somebody here might have some insight. 
I have a report that was developed in SSRS 2005. The report is used to print paperwork for tracking serialized items.  There are supposed to be 2 pages per serial #, but 2008 ignores page breaks in subreports?  Any ideas? ",,False,self,t5_2qp8q,False,,,True,t3_10m8zb,http://www.reddit.com/r/SQL/comments/10m8zb/ms_sql_2008_r2_ssrs_reporting_services_pagination/,
1348497883.0,4,self.SQL,10e6p7,[MS SQL] Need to compare two collumns. Help?,Riotreaver,5,1,9,http://www.reddit.com/r/SQL/comments/10e6p7/ms_sql_need_to_compare_two_collumns_help/,"I'm still fairly new to the SQL game so I was hoping Reddit can help me out!

I have two columns, column 1 has multiple unique values (123,124,125 etc). 2 Has repeated values (1,2,1,2).  Each value in C1 should ALWAYS have a value of 1 in C2.

I need to run a query that will return all values from C1 that DO NOT contain a value of 1 only.

Any help on this would be appreciated!",,False,self,t5_2qp8q,False,,,True,t3_10e6p7,http://www.reddit.com/r/SQL/comments/10e6p7/ms_sql_need_to_compare_two_collumns_help/,
1347651210.0,4,self.SQL,zw3vi,"Insert using Distinct, Max and one other column.",Dylan_Ram_Brick,4,0,7,http://www.reddit.com/r/SQL/comments/zw3vi/insert_using_distinct_max_and_one_other_column/,"I am trying to insert into a table using SQL server and SSMS using a select statement.

The table I am selecting from has three fields, date_created, serial_number and settings. What I want to do is get each serial number only once, the MAX date_created and the settings associated with that row.

I am saying:
INSERT INTO xActiveUser  (serial_number,x_date,settings)
SELECT DISTINCT serial_number,MAX([date]),settings
FROM xTempUser
GROUP BY serial_number,settings

But it always returns all the records, I assume because it is grouped by settings. But I can't use Distinct twice? So is there a way to do this in one query or do I need to select the date and serial number then do an update statement to get the settings?
",,False,self,t5_2qp8q,False,,,True,t3_zw3vi,http://www.reddit.com/r/SQL/comments/zw3vi/insert_using_distinct_max_and_one_other_column/,
1346155481.0,5,self.SQL,yyh2s,Declaring a variable using Sybase ,whipper515,5,0,6,http://www.reddit.com/r/SQL/comments/yyh2s/declaring_a_variable_using_sybase/,"I'm trying to declare a variable so I can recall a list of serial numbers multiple times within a query. For example, my where statements look like this

    where serial_no in ('3990004184','3990002745','3990004001')

I've got that a number of times in my query, but it needs to be updated periodically. Instead of changing every instance where I have that list of serial numbers, id like to change it to something like

    where serial_no in setofSERIALNUMBERS

setofSERIALNUMBERS being my variable that I declare, so I only have to update one list rather than many. I'm using Sybase/SQL Anywhere. Thanks. ",,False,self,t5_2qp8q,False,,,True,t3_yyh2s,http://www.reddit.com/r/SQL/comments/yyh2s/declaring_a_variable_using_sybase/,
1345337956.0,5,self.SQL,ygahy,"New to SQL, trying to choose a book or two to get me underway. ",jaroto,5,0,10,http://www.reddit.com/r/SQL/comments/ygahy/new_to_sql_trying_to_choose_a_book_or_two_to_get/,"A bit of background -- I'm a graduate student and will be working on studies involving genetic data this year. The professor I'm working with uses SQL to do data management/cleaning and recommended MySQL (because it's free).  I have experience using programs such as R, but no other computer programming language outside of statistical software.  

I'm considering three books (listed below) -- any recommendations among these books or others for someone in my position? Any input would be greatly appreciated. 

[Sams Teach Yourself SQL in 10 Minutes](http://www.amazon.com/gp/product/0672325675/ref=ox_sc_act_title_1?ie=UTF8&amp;smid=A1QJ4UH6FW3UH1)

[SQL Cookbook](http://www.amazon.com/gp/product/0596009763/ref=ox_sc_act_title_2?ie=UTF8&amp;smid=A18OZMH8UQINVM)

[SQL Queries for Mere Mortals: A Hands-On Guide to Data Manipulation in SQL](http://www.amazon.com/gp/product/0321444434/ref=ox_sc_act_title_3?ie=UTF8&amp;smid=ASWK2P83YYFWO)

**EDIT:** Thanks everyone for the comments/advice.  Based on what I've heard, I think I'll get Sams Teach Yourself SQL in 10 Minutes, because it appears to be useful and is cheap. I'll be looking at the other SQL books many of you mentioned for when I (hopefully) master the basics.  ",,False,self,t5_2qp8q,1345430297.0,,,True,t3_ygahy,http://www.reddit.com/r/SQL/comments/ygahy/new_to_sql_trying_to_choose_a_book_or_two_to_get/,
1344879515.0,5,self.SQL,y5jxi,[SQL] - Case Statement Help,SirCaptainMitch,5,0,10,http://www.reddit.com/r/SQL/comments/y5jxi/sql_case_statement_help/,"Trying to pass a variable before the actual Case statement, any tips? 

DECLARE @Item VARCHAR = ''


DECLARE @DataType VARCHAR = '' 




SELECT * 


FROM Employee e 


	 INNER JOIN PaymentCheck pc ON e.EmployeeGUID = pc.PayeeGUID 

	 INNER JOIN PaymentBatch pb ON pc.PaymentBatchGUID =   pc.PaymentBatchGUID 


WHERE @Item LIKE CASE WHEN @DataType = 'EmployeeID' 
				   THEN e.EmployeeID 


			  WHEN @DataType = 'CheckNumber' 
				 THEN pc.CheckNumber 

			  WHEN @DataType = 'Name' 
				 THEN '%' + e.LastName + '%'e.FirstName + '%'

EDIT: Is there a site for displaying this kind of stuff? Makes formatting easier.... ",,False,self,t5_2qp8q,1344880698.0,,,True,t3_y5jxi,http://www.reddit.com/r/SQL/comments/y5jxi/sql_case_statement_help/,
1343631876.0,2,javacodegeeks.com,xdqib,Database Abstraction and SQL Injection - How much prevention should be done at the database access layer?,lukaseder,5,3,6,http://www.reddit.com/r/SQL/comments/xdqib/database_abstraction_and_sql_injection_how_much/,,,False,http://b.thumbs.redditmedia.com/4nSpr9TuqEGBJOJ1.jpg,t5_2qp8q,False,,,False,t3_xdqib,http://www.javacodegeeks.com/2012/07/database-abstraction-and-sql-injection.html,
1343239818.0,3,self.SQL,x55fb,n00b Query question (displaying Y and N values),d3adbor3d2,5,2,7,http://www.reddit.com/r/SQL/comments/x55fb/n00b_query_question_displaying_y_and_n_values/,"This is my query: 

select count(active)
from am_modules
where ACTIVE = 'Y'

It lists the number of active jobs. I just want to include the number of inactives as well (active = N). I can run it on a separate query, but would prefer if I can consolidate it.  

 I use an app called Application Manager that does this so the query is not very straight on. I apologize for my lack of know-how. I'm not very well-versed in SQL and pretty much just go at it by process of deduction. Thank you in advance. ",,False,self,t5_2qp8q,False,,,True,t3_x55fb,http://www.reddit.com/r/SQL/comments/x55fb/n00b_query_question_displaying_y_and_n_values/,
1343237790.0,5,self.SQL,x5338,Single DB vs. Multiple smaller DB's,The14thScorpion,8,3,10,http://www.reddit.com/r/SQL/comments/x5338/single_db_vs_multiple_smaller_dbs/,"We are designing a comprehensive loan system and one of our ideas is to build the system in such a way that major functionalities/tools have their own database and front-end, and a Master DB that consolidates information from all these different DB's.


What are some of the pros and cons I should consider before implementing such a design?


Some of my thoughts are

**Pros:**

Smaller databases means smaller size and smaller Tx log

Greater Plug and Play possibilities

Lower possibility of bottlenecks as compared to a single DB structure



**Cons:**

More work in maintaining multiple systems

Possible data and structural redundancy 

Data concurrency and integrity challenges




Please help with your suggestions.",,False,self,t5_2qp8q,False,,,True,t3_x5338,http://www.reddit.com/r/SQL/comments/x5338/single_db_vs_multiple_smaller_dbs/,
1341946619.0,4,self.SQL,wcaxj,oracle syntax conversion to ms sql 2005,ectoplasm,8,4,7,http://www.reddit.com/r/SQL/comments/wcaxj/oracle_syntax_conversion_to_ms_sql_2005/,"here is the query, and here is my logic behind the query. As a product passes through a particular station it is given a timestamp. the people that will be looking at the report want the ability to look at any given time and see how many objects went through a certain station. or business starts making objects at 6am and stops at 10pm. I know that this query will work in an oracle db but i can't find the right syntax for the ms DB. 

Pretty complex query let me know if i need to clarify anything.

SELECT T3.PAYMENT_DATE, T3.""Hr"", T3.""Min"", (SELECT COUNT(*) FROM INVOICE_ARCHIVE T4 WHERE TO_NUMBER(TO_CHAR(T4.PAYMENT_DATE, 'MM')) &lt;= T3.""Hr"" AND TO_NUMBER(TO_CHAR(T4.PAYMENT_DATE, 'DD')) &lt;= T3.""Min"") AS ""NUM""
FROM(SELECT T1.PAYMENT_DATE, T2.""Hr"", T2.""Min""
FROM (
SELECT (FLOOR((LEVEL + 359)/60)) AS ""Hr"", MOD((LEVEL + 359), 60) AS ""Min""
FROM dual CONNECT BY LEVEL &lt;= 961) T2, INVOICE_ARCHIVE T1
ORDER BY T1.PAYMENT_DATE, T2.""Hr"", T2.""Min"") T3",,False,self,t5_2qp8q,False,,,True,t3_wcaxj,http://www.reddit.com/r/SQL/comments/wcaxj/oracle_syntax_conversion_to_ms_sql_2005/,
1340562807.0,6,self.SQL,vj74y,What is the best SQL server for a 512mb webserver?,zeal23,6,0,8,http://www.reddit.com/r/SQL/comments/vj74y/what_is_the_best_sql_server_for_a_512mb_webserver/,"I have a virtual server with 512mb ram. So far Ive determined that nginx is probably the best option for my webserver, but I am not sure which SQL variant would be best to pair with it.

This server will have a very light load. Just a portfolio site with blog. Also, I am running a ubuntu 12.04 server.",,False,self,t5_2qp8q,1340563006.0,,,True,t3_vj74y,http://www.reddit.com/r/SQL/comments/vj74y/what_is_the_best_sql_server_for_a_512mb_webserver/,
1340313871.0,4,sqldumpster.com,vehl8,Does anyone know where I can download database with towns and cities by location worldwide for free?,boy1ritchy,9,5,5,http://www.reddit.com/r/SQL/comments/vehl8/does_anyone_know_where_i_can_download_database/,,,False,default,t5_2qp8q,False,,,False,t3_vehl8,http://www.sqldumpster.com,
1339148395.0,6,self.SQL,urcrb,[MSSQL] Why is this query better?,DrTrunks,6,0,15,http://www.reddit.com/r/SQL/comments/urcrb/mssql_why_is_this_query_better/,"I've made a query to get the total amount of leave employees have left:

    SELECT [Employee No_],  
    SUM(CASE WHEN [Absence Type Code] LIKE 'Leave' THEN [Quantity Hour] ELSE 0 END) AS [Total Leave Left]  
    FROM dbo.[Company$Leave Entry]  
    GROUP BY [Employee No_]

Because this query took 'long' I tried to make it better:

    SELECT  [Employee No_],   
    SUM([Quantity Hour]) AS [Total Leave Left]  
    FROM dbo.[Company$Leave Entry]  
    where [Absence Type Code] LIKE 'Leave'  
    GROUP BY [Employee No_]

||Query||Client processing time||Total exec time||WAit time on server replies||  
||1||21.4||33.2||8||  
||2||52.5||66.5||14||  

So the second query is actually worse, but why? The thing I noticed is that the second query has two select statements. I can guess the performance comes from there, but how come?  
edit: i see the table didn't come out as expected...",,False,self,t5_2qp8q,1339148682.0,,,True,t3_urcrb,http://www.reddit.com/r/SQL/comments/urcrb/mssql_why_is_this_query_better/,
1337695736.0,4,self.SQL,tz92x,[Help request] Bulk loading every .txt file in a folder,j0llyllama,5,1,7,http://www.reddit.com/r/SQL/comments/tz92x/help_request_bulk_loading_every_txt_file_in_a/,"So I normally work with IIS, but one of my tasks is putting all the log data into a SQL database, and I'm not as familiar with SQL. I was able to configure the newly generated logs to go straight to SQL with ODBC connection, and am stuck working on the three years of backlogged data.

I have been able to clean out all of the tags that are generated so any individual file can be cleanly BULK inserted into a properly formatted DB, but I have over 1000 files for each of the 8 different websites. I tried using CMD prompts to pipe them all into a single .txt file to bulk load, but at 7 gigs it fails during the process- I think its too much to handle at once. Does anyone have advice on how to sequencially run through each file in a given folder and just repeat the simple insert procedure?

This is the script that works for inserting an individual file:

    BULK INSERT [dbo].[TABLENAME] FROM 'c:\File_Name.txt'
    WITH (
        FIELDTERMINATOR = ' ',
        ROWTERMINATOR = '\n'
    )

",,False,self,t5_2qp8q,False,,,True,t3_tz92x,http://www.reddit.com/r/SQL/comments/tz92x/help_request_bulk_loading_every_txt_file_in_a/,
1337339241.0,3,self.SQL,tt42s,[MS SQL] Need help with a sub query problem,handsome_devlin,5,2,6,http://www.reddit.com/r/SQL/comments/tt42s/ms_sql_need_help_with_a_sub_query_problem/,"Hey guys,
I'm having a problem running a query on a costume rental system that i'm working on.  What I want the query to display is the customer no, name, the number of rentals they have made and the total amount of money a customer has spent on their rentals.

So far I have it correctly displaying the Customer No, Name and No of Rentals but the total amount spent column is showing the total amount of money the business has made from all rentals and not the total from each customer.   
i.e. Customer 1 has 3 rentals and spent £296 but this shows as Customer 1 having 3 rentals and spending £6456 in the output of the query.        

I'm using a sub-query to calculate how much each customer has spent so can anyone out there tell me why this code won't work?

    Use RENTALS
    select c.customerno, forename + ' ' + surname as 'Name', COUNT(*) as [No of Rentals],
          (select SUM(daysrented*costperday) as [Total Spent] 
            from rentalitem ri inner join costume cm on ri.costumecode=cm.costumecode
            inner join rental r on ri.rentalno=r.rentalno
            inner join customers c on c.customerno=r.customerno
            where r.CustomerNo = c.CustomerNo) as [Total Spent]
    from customers c inner join rental r on c.customerno=r.customerno
    Group by c.customerno, forename, surname",,False,self,t5_2qp8q,False,,,True,t3_tt42s,http://www.reddit.com/r/SQL/comments/tt42s/ms_sql_need_help_with_a_sub_query_problem/,
1336622537.0,5,self.SQL,tfxu5,"[MSSQL] Processing 39+ million rows, more than I've ever done before, performance taking huge hit using currently known techniques.",realmkiller,6,1,13,http://www.reddit.com/r/SQL/comments/tfxu5/mssql_processing_39_million_rows_more_than_ive/,"I'm wondering if someone can point me in the right direction, or give me an idea of the best practices for processing this many rows. My current processes have worked for all our small time clients with only a few thousand rows.

Every row is different in many different ways, and as such i'm pretty sure every row will need to be processed individually, otherwise we're talking about writing over 800 different queries.

I have two tables, one called Calendar and History. My current process of moving items from Calendar to History is using a cursor or a while loop with temp table. This is the basis of both cursor or a while-loop style.

    grab all @CID(unique), @ctype, @cduration from Calendar
    start loop:
    BEGIN TRANSACTION
    
    process cduration and ctype in this area. the cduration is numeric and can be anything from 1 to max column size varchar(50)
    ctype could be one of 6 things, and depending on which one, there is a SET @variable = '1-char-here' for each one.
    
    INSERT INTO History (columns) SELECT (matching columns and certain set variables) FROM Calendar where cid = @cid
    if not exists (select 1 from History where hid = @cid)
    BEGIN
        RAISERROR('Insert failed, rolling back and stopping', 16, -1)
        ROLLBACK TRANSACTION
        BREAK
    END

    COMMIT TRANSACTION

    DELETE FROM Calendar WHERE CID = @cid
    end loop

That's the basic of what we currently have and use on small databases. It works without issue, but this database, they canceled the execution after 3 days.

Any tips/tricks..etc on executing such a thing?",,False,self,t5_2qp8q,False,,,True,t3_tfxu5,http://www.reddit.com/r/SQL/comments/tfxu5/mssql_processing_39_million_rows_more_than_ive/,
1335477673.0,4,self.SQL,su9ff,[Access SQL query] Comparing two text-based columns,KingZing,4,0,18,http://www.reddit.com/r/SQL/comments/su9ff/access_sql_query_comparing_two_textbased_columns/,"I am trying to compare two columns of data that contain product names.  I want to be able to see the differences between one name column and the next.
Ideally, when comparing Table 1, I should see Table2 as the result.

Thanks for the help.  You guys/gals have been great in the past.

    
    Example Table 1
    ProductIDA   ProductNameA ProductIDB   ProductNameB
    100   Jupiter VA     101   Jupiter VB
    200   Hercules VA    201 Hercules VB
    300   Orion BA     301 Ares VB
    
    
    Example Table 2
    ProductIDA   ProductNameA ProductIDB   ProductNameB
    100   A     101     B
    200   A    201    B
    300   Orion BA     301 Ares VB


Update:  Maybe it would be easier to start at the beginning. Maybe the Tables I ended up with made it harder than it is. (P.s. You guys have been very helpful and I've already learned some things even though they were not exactly helping )

**Breakdown:**

* I have a list of 10,000+ products with unique product numbers.
* Most of these comes in sets of three or four. for example: osiris a; osiris b; osiris c
* 
* There is one piece of logic built into our system where if the product type B variant is sold out, it automatically goes to product type A variant. (this is not part of the database and shouldn't be, it is done by an external system)
* 
* The main problem is that the field that drives the B to A transfer is manually entered.
* 
* The Osiris B should always go into the Osiris A but if someone misskeyed, it might roll into Hercules VA or any other product.
* 
* I thought it would be easy to run a query that listed all B products, then another query that ran the value from the field BtoA field and alligned it to the right of the B products.  This is how I ended up with Example Table1 above.  I thought it would be easy to eyeball it with columns next to each other, but there are too many records.
* 
* My next train of though was to somehow subtract one column from the other so that I only see the differences.  This would mean if the B to A was right, then I would only see the last digit most of the time.  If it was wrong, the difference column would show the long string.

Maybe there is an easier way if I modify it or run it differently from the beginning?
I thought maybe I could use the InstrRev function inside the select statement but I am completely new to this function.
[Instr Function](http://www.techonthenet.com/access/functions/string/instrrev.php)

I tried this, but it is crude and doesn't work all the time do to some variation in the fields.

        &lt;&gt;Left([TABLE1].[PRODUCTNAME],(InStrRev([TABLE1].[PRODUCTNAME],""A"")-1))

Maybe I could trim the right side of each string by a few letters then they would ""ideally"" match perfectly and I could use a not-equal-to?

Anyways.  Thanks again for all the help.  This is a great learning experience and I have really enjoyed this subreddit!",,False,self,t5_2qp8q,True,,,True,t3_su9ff,http://www.reddit.com/r/SQL/comments/su9ff/access_sql_query_comparing_two_textbased_columns/,
1334453371.0,5,self.SQL,sa8wx,[MS SQL] Beginner needing a little help with joining tables and and duplicate fields.,RobotRollCall24,7,2,5,http://www.reddit.com/r/SQL/comments/sa8wx/ms_sql_beginner_needing_a_little_help_with/,"I'm doing an assignment for my Database Programing class, and I am working on joining tables. I have four tables (ASSIGNMENT, DEPARTMENT, EMPLOYEE, and PROJECT). The question I am working on reads as follows (I find the wording slightly confusing):

""Who are the employees assigned to each project? Show ProjectID, ProjectName, and Department. Show EmployeeNumber, LastName, FirstName, and Phone.""

I have been trying to figure out the syntax for this SQL command but it has been driving me nuts. Could anyone give me a push in the right direction? Here are some screenshots of the tables if it helps (All info in the tables is just dummy info, obviously)

http://i.imgur.com/XyRXS.jpg
http://i.imgur.com/G7N3l.jpg
http://i.imgur.com/4s9av.jpg
http://i.imgur.com/5kfo5.jpg

Thanks in advance!
",,False,self,t5_2qp8q,False,,,True,t3_sa8wx,http://www.reddit.com/r/SQL/comments/sa8wx/ms_sql_beginner_needing_a_little_help_with/,
1333285464.0,4,self.SQL,rnvc6,HELP PLEASE.  I have a set of queries that i need help with.  ,athysrock,4,0,6,http://www.reddit.com/r/SQL/comments/rnvc6/help_please_i_have_a_set_of_queries_that_i_need/,"It includes listing, labeling lists, multiplies across tables, and a whole bunch of other things.  I only have 4 queries left out of 9 and it just got really complicated.  Here is the one that i am working on right now.

List the total income received by city.

http://i.imgur.com/6lqgu.png",,False,self,t5_2qp8q,False,,,True,t3_rnvc6,http://www.reddit.com/r/SQL/comments/rnvc6/help_please_i_have_a_set_of_queries_that_i_need/,
1333168263.0,5,wp.me,rm0fp,"Rocking ""Catalog Views"" in SQL Server 2012",janet1237,6,1,2,http://www.reddit.com/r/SQL/comments/rm0fp/rocking_catalog_views_in_sql_server_2012/,,,False,http://d.thumbs.redditmedia.com/Og7RW8BIYDl_yhJK.jpg,t5_2qp8q,False,,,False,t3_rm0fp,http://wp.me/p1GqSz-6E,
1332882769.0,3,self.SQL,rgftw,[Access] Building a query in VBA method 'execute' of object '_connection' failed,redditaccount1975,4,1,6,http://www.reddit.com/r/SQL/comments/rgftw/access_building_a_query_in_vba_method_execute_of/,"UPDATE: Looks like DateDiff and AddDate are reserved words (http://www.everythingaccess.com/tutorials.asp?ID=Problem-names-and-reserved-words#D)  

anyone know a way to get around this and perform the DateDiff and AddDate Functions?

googling leads me to believe I'm using a reserved word in the query somewhere.  Could it be the DateDiff function? thanks!


    Option Explicit
    Sub Access_Data()
     'Requires reference to Microsoft ActiveX Data Objects xx Library
    Dim Cn As ADODB.Connection, Rs As ADODB.Recordset
    Dim MyConn, sSQL As String
     
    Dim Rw As Long, Col As Long, c As Long
    Dim MyField, Location As Range
     
     'Set destination
    Set Location = [B2:c2]
     'Set source
    MyConn = ""C:\RealogicTools\TestDB_v14.mdb""
     'Create query
    sSQL = ""SELECT RR.TenantID, RR.Name, RR.Size, RR.Suite,"" &amp; _
            ""IIf(IsNull(RR.StartDate),DateAdd(""""m"""",[RR].[RStartDate],[OAProperty].[AnalysisStart]),RR.StartDate) AS LeaseStart,"" &amp; _
                ""IIf(IsNull(RR.RexpirationDate),0,RR.RexpirationDate)+IIf(IsNull(DateDiff(""""m"""",[OAProperty].[AnalysisStart],[RR].[ExpirationDate])),0,DateDiff(""""m"""",[OAProperty].[AnalysisStart],[RR].[ExpirationDate])) AS EndPeriod,"" &amp; _
            ""IIf(IsNull(RR.RexpirationDate),IIf(IsNull(RR.RexpirationDate),RR.ExpirationDate,0),DateAdd(""""m"""",[RR].[RexpirationDate],[OAProperty].[AnalysisStart])) AS EndDate, t3.Section "" &amp; _
            "" FROM OARentRoll AS RR, OAProperty, OAOutput AS t3"" &amp; vbCrLf

    sSQL = sSQL &amp; ""WHERE (((t3.Section)=""""Base Rent"""") AND ((OAProperty.PropID)=[RR].[PropID]) AND "" &amp; _
            ""((OAProperty.VersionID)=[RR].[VersionID]) AND ((RR.PropID)="""""" &amp; Range(""A1"") &amp; """""") AND ((RR.VersionID)="" &amp; Range(""b1"") &amp; "") AND "" &amp; _
            ""((t3.LineID)=[RR.TenantID]) AND ((t3.PropID)=[RR].[PropID]) AND ((t3.VersionID)=[RR].[VersionID]))""

    sSQL = sSQL &amp; "" ORDER BY IIf(IsNull(RR.RexpirationDate),IIf(IsNull(RR.RexpirationDate),RR.ExpirationDate,0),"" &amp; _
            ""DateAdd(""""m"""",[RR].[RexpirationDate],[OAProperty].[AnalysisStart]));""
    
     Debug.Print sSQL 'copy-paste to Access works great
  
     'Create RecordSet
    Set Cn = New ADODB.Connection
    With Cn
        .Provider = ""Microsoft.Jet.OLEDB.4.0""
        .Open MyConn
        Set Rs = .Execute(sSQL) 'error is here
       
    End With
     
     'Write RecordSet to results area
    Rw = Location.Row
    Col = Location.Column
    c = Col
    Do Until Rs.EOF
        For Each MyField In Rs.Fields
            Cells(Rw, c) = MyField
            c = c + 1
        Next MyField
        Rs.MoveNext
        Rw = Rw + 1
        c = Col
    Loop
    Set Location = Nothing
    Set Cn = Nothing
    End Sub",,False,self,t5_2qp8q,True,,,True,t3_rgftw,http://www.reddit.com/r/SQL/comments/rgftw/access_building_a_query_in_vba_method_execute_of/,
1332582087.0,5,self.SQL,rb90p,SQL Entity diagram,vixemp,5,0,4,http://www.reddit.com/r/SQL/comments/rb90p/sql_entity_diagram/,"I am looking for a program that can create a database in sql from an entity relationship diagram. I have found for example SQL creator, but are there better programs to use?",,False,self,t5_2qp8q,False,,,True,t3_rb90p,http://www.reddit.com/r/SQL/comments/rb90p/sql_entity_diagram/,
1331929017.0,5,self.SQL,qzuw9,[Oracle] Query Assistance,digitalnoise,5,0,7,http://www.reddit.com/r/SQL/comments/qzuw9/oracle_query_assistance/,"I've been struggling with trying to build this report for weeks, and I'm at my wits end. Maybe what I'm trying to do isn't possible (I doubt that), or I'm just not looking at it correctly. So I'm hoping perhaps you experts here could provide a fresh set of eyes:

I have a product sales report that, among other things, returns either a 1 or 0 for each set of products on an order. At first glance, the report I originally built worked just fine, until we discovered that Wash Sales were being counted as an actual sale. A wash sale is one that happens when a customer adds another product, and during the course of that transaction, an existing product gets changed - new price point, etc. - but the existing product itself is not truly added or removed. We use product codes to for each product and price point (not my design).

This first sub-select looks for any customer orders that have a product (a customer can have more than one product per order) that has a reporting center of 1, and returns a 1 if they do, and a 0 if they don't:

    NVL((SELECT 1 FROM IDST_RATE_REPORTING_CENTER RC INNER JOIN IDST_WIP_CUST_RATE WR ON RC.ACCTCORP=WR.ACCTCORP AND RC.DRATECODE=WR.RATECD
                   WHERE RC.ACCTCORP = 99999 AND WR.HOUSE=C.HOUSE AND WR.CUST=C.CUST AND WR.WPCNT=W.WPCNT AND WR.RATESIGN IN (' ','A')
                   AND (RCTR01 IN (' 1') OR RCTR02 IN (' 1') OR RCTR03 IN (' 1') OR RCTR04 IN (' 1') OR RCTR05 IN (' 1') OR RCTR06 IN (' 1')
                    OR RCTR07 IN (' 1') OR RCTR08 IN (' 1') OR RCTR09 IN (' 1') OR RCTR10 IN (' 1') OR RCTR11 IN (' 1') OR RCTR12 IN (' 1')
                    OR RCTR13 IN (' 1') OR RCTR14 IN (' 1') OR RCTR15 IN (' 1') OR RCTR16 IN (' 1') OR RCTR17 IN (' 1') OR RCTR18 IN (' 1')
                    OR RCTR19 IN (' 1') OR RCTR20 IN (' 1'))
                   AND ROWNUM = 1), 0) AS V

The ""WR.RATESIGN IN (' ','A')"" specifically looks for the product being added. If it's being removed, it has a different sign (either a '-' or 'J' depending on the type).

The problem for this particular select is that because it's looking at products (being the only way I can make this work at the moment), for orders where a customer is swapping one type of product for another (one V for another V; both having reporting center 1), it still counts the order - but we don't want that.

If the order has a net zero change in product, then we want to return a 0, because the sales person didn't actually sell a new product.

This sub select will give a -1 for order where the product is being removed (much like the one above where it's being added) - the only difference is the WR.RATESIGN argument:

    NVL((SELECT -1 FROM IDST_RATE_REPORTING_CENTER RC INNER JOIN IDST_WIP_CUST_RATE WR ON RC.ACCTCORP=WR.ACCTCORP AND RC.DRATECODE=WR.RATECD
                       WHERE RC.ACCTCORP = 99999 AND WR.HOUSE=C.HOUSE AND WR.CUST=C.CUST AND WR.WPCNT=W.WPCNT AND WR.RATESIGN IN ('-','J')
                       AND (RCTR01 IN (' 1') OR RCTR02 IN (' 1') OR RCTR03 IN (' 1') OR RCTR04 IN (' 1') OR RCTR05 IN (' 1') OR RCTR06 IN (' 1')
                        OR RCTR07 IN (' 1') OR RCTR08 IN (' 1') OR RCTR09 IN (' 1') OR RCTR10 IN (' 1') OR RCTR11 IN (' 1') OR RCTR12 IN (' 1')
                        OR RCTR13 IN (' 1') OR RCTR14 IN (' 1') OR RCTR15 IN (' 1') OR RCTR16 IN (' 1') OR RCTR17 IN (' 1') OR RCTR18 IN (' 1')
                        OR RCTR19 IN (' 1') OR RCTR20 IN (' 1'))
                       AND ROWNUM = 1), 0) AS V

What I've been struggling to do is find a way to combine both of these so that they return a 1 when it's a true add, and a 0 when either there's no add at all, or there's an add &amp; remove (a ""wash"").

I'm pretty sure there's a fairly simple solution to this problem, but I think I've been staring at it too long, so I'm hoping someone else may have some ideas.",,False,self,t5_2qp8q,False,,,True,t3_qzuw9,http://www.reddit.com/r/SQL/comments/qzuw9/oracle_query_assistance/,
1331434093.0,4,reddit.com,qr1wl,Help with a basic problem (if statement) X-post from r/learnprogramming,Moonj64,4,0,1,http://www.reddit.com/r/SQL/comments/qr1wl/help_with_a_basic_problem_if_statement_xpost_from/,,,False,default,t5_2qp8q,False,,,False,t3_qr1wl,http://www.reddit.com/r/learnprogramming/comments/qqxg2/sql_help_with_if_statement/,
1330712830.0,3,self.SQL,qerdl,[Oracle] Date Calculation for Report,digitalnoise,5,2,9,http://www.reddit.com/r/SQL/comments/qerdl/oracle_date_calculation_for_report/,"Quick background: My employer uses a rather odd (to others, it seems) date range for our Fiscal months - the 22nd to the 21st of each month. For example, Fiscal February runs 01.22.2012 to 02.21.2012.

Up until this point I've been able to use SYSDATE and simple functions to calculate dates in my reporting - they've just been the previous day, or previous 7 days, etc.

Now I need to work on reports that have this dynamic date range, and I'm not sure where to start.

What I'm looking for is something that will look at today's date (03.02.2012, for example), and logically determine that the current fiscal month (and thus date range for the report) is 02.22.2012 - 03.21.2012.  One of the nasty caveats to this is that on 03.22.2012, the report range needs to stay 02.22.2012 - 03.21.2012, and it's not until the 23rd that it would move on to the next fiscal month.

Is this even possible?",,False,self,t5_2qp8q,False,,,True,t3_qerdl,http://www.reddit.com/r/SQL/comments/qerdl/oracle_date_calculation_for_report/,
1328219005.0,4,self.SQL,p8a7e,"Continue learning, more complex stuff in SQL Server",captshady,4,0,8,http://www.reddit.com/r/SQL/comments/p8a7e/continue_learning_more_complex_stuff_in_sql_server/,"I know SQL fairly well, and do it often on my job.  Some of it seemingly complex.  I'm beyond that of w3 schools, but more and more, I'm coming across seriously complicated stuff (at least from a seasoned IT perspective - I assume a computer scientist wouldn't find much of it complex at all).  

So I need a book that delves into that subject.  Anything I can find covers basic inner joins, but not much covers system tables and such.  Can anyone recommend a book?
",,False,self,t5_2qp8q,False,,,True,t3_p8a7e,http://www.reddit.com/r/SQL/comments/p8a7e/continue_learning_more_complex_stuff_in_sql_server/,
1328108851.0,5,self.SQL,p666h,[MS SQL] Need Help - BULK INSERT with default values,PeppersMagik,6,1,4,http://www.reddit.com/r/SQL/comments/p666h/ms_sql_need_help_bulk_insert_with_default_values/,"I've been searching around for quite sometime and can't find much documentation on this, maybe I'm just not searching right but regardless I come in need of some advice or at least a kick in the right direction.

I'm trying to add email suppression files from multiple sites into one table:
Table is pretty straight forward:
ID,EMAIL,MD5,SOURCE

My main question is how to do a BULK INSERT from a file containing a list of just EMAILS and specify a value for SOURCE to be populated in for the entire file - sounds simple in my head and I feel like i'm missing something from sql 101...

Furthermore and this I've found a lot more documentation on this is populating the MD5 column automatically with the MD5 version of the email address.

Any help would be greatly appreciated even if that help is a 'why didn't you look in this place' answer.

**UPDATE:** First thanks for the help and advice. I ended up just writing a bash file to normalize the email, convert them to MD5, add a source column and spit it all out in a nice easy to import format. 

    #!/bin/bash
    echo File to process
    read infile
    echo What source name should be used?
    read source
    cat $infile | sed '/^$/d' | tr '[:blank:]' '\b' | tr 'A-Z' 'a-z' &gt; scraps.txt;
    cat scraps.txt | while read line
    do
    echo -n $line | md5sum | awk '{print $1}'
    done &gt; test.txt
    pr -m -t -s, scraps.txt test.txt | gawk '{print $1,$2}' &gt; scraps2.txt
    cat scraps2.txt | awk -v source=""$source"" '{ print $0 ""'"",$source""'"" }' | tr '[:blank:]' '\b' &gt; final.txt
    rm -f scraps.txt
    rm -f scraps2.txt

Doing everything in SQL would save a step in the long run but being that I'm pressed on time to get this in place it will have to be something I come back to at a later date.",,False,self,t5_2qp8q,True,,,True,t3_p666h,http://www.reddit.com/r/SQL/comments/p666h/ms_sql_need_help_bulk_insert_with_default_values/,
1328100929.0,4,self.SQL,p6283,[Access]Would appreciate some help with this query.,achillesminor,5,1,3,http://www.reddit.com/r/SQL/comments/p6283/accesswould_appreciate_some_help_with_this_query/,"So my boss wants me to do some reporting on a list of calls we're taken in our support desk.  
  
The list is contained in a single table in an Access(2003) file.  
  
Anyway, the table is called Sheet1 and the columns are as follows:  
ID(Int), CaseNum(VarChar), Status(VarChar), Customer(VarChar), AccountName(VarChar), EnteredBy(VarChar), DateCreated(Date), AssignedTo(VarChar)  
  
So I'm trying to get list of distinct AccountNames, the months they've logged calls in, and the number of calls logged in each month.  
  
So far, I've been able to get the first two items with the following query:  
  
    SELECT DISTINCT
        AccountName,
        INT(Left(DateCreated, Instr(DateCreated, '/') - 1)) as CallMonth
    FROM
        Sheet1
    WHERE
        AccountName &lt;&gt; null
    ORDER BY
        AccountName ASC, 2 ASC  
  
  
This produces a table like so:  
  
AccountName|Month  
-|- 
Account A|2.0  
Account A|4.0  
Account B|3.0  
Account B|6.0   
  
  
And I'm hoping to produces a table like so:  
  
AccountName|CallMonth|Calls  
-|-|-  
Account A|2.0|12  
Account A|4.0|45  
Account B|3.0|65  
Account B|6.0|34  
  
  
I've tried various queries to achieve it; this being the most recent attempt, which returns a *too few paramters* error:  
  
    SELECT DISTINCT
        AccountName,
        INT(Left(s1.DateCreated, Instr(s1.DateCreated, '/') - 1)) as CallMonth
        (SELECT
            Count(Int(Left(s2.DateCreated, Instr(s2.DateCreated, '/') - 1)))
            as tempDate
        FROM
            Sheet1 s2
        Where
            tempDate = CallMonth)
    FROM
        Sheet1 s1
    WHERE
        AccountName &lt;&gt; null
    ORDER BY
        AccountName ASC, 2 ASC  

Any ideas? I appreciate it!",,False,self,t5_2qp8q,True,,,True,t3_p6283,http://www.reddit.com/r/SQL/comments/p6283/accesswould_appreciate_some_help_with_this_query/,
1327754869.0,6,stev.org,p0ftn,Postgres Case sensitive issue anyone know a workaround?,mistralol,6,0,4,http://www.reddit.com/r/SQL/comments/p0ftn/postgres_case_sensitive_issue_anyone_know_a/,,,False,default,t5_2qp8q,False,,,False,t3_p0ftn,http://www.stev.org/post/2012/01/28/Postgres-pg_relation_size-is-broken.aspx,
1327697025.0,4,self.SQL,ozlhp,Need help on where I can find .... help with SQL/JBoss,KingZing,4,0,2,http://www.reddit.com/r/SQL/comments/ozlhp/need_help_on_where_i_can_find_help_with_sqljboss/,"Everything involving this new SQL project at work is really confusing and am trying to find some help, so I'll start off with what I know.


Platform1 has

subplatform PD and DM

each of these subplatforms each have 2 tables (x and Y)

Platform14 has

subplatform AB and PS

each of these subplatforms each have 2 tables (x and Y)



* I am using JBOSS database developement and teiid designer.  
* I have configured and deployed two data sources(platform 1 and 14) into one VDB
* I 'UNION ALL' all of the x tables across all subplatforms, and same for y tables.  So now i have a view that shows every value under table X no matter what platform/subplatform.
* I am trying to run a SQL query that will compare values across all subplatforms for a single value in one of the tables and if any of the values are different between the subplatforms, I want to report all the values.

For example if Platform1SubPD, Platform1SubDM, Platform14SubAB all have:

* Table X
* name = 1
* ssn = 200
* price = 100

And Platform14SubPS has

* Table X
* name = 1
* ssn = 200
* price = 120

then this difference(price) would be generated in my results containing the fields I specify from one of the tables.

**tl;dr
I am new to writing SQL queries against data sources with jboss/teiid.  I am unable to find a good resource for information about this.  Primarily I want to run a query that can show differences between the same tables across different systems by a unique qualifer**",,False,self,t5_2qp8q,True,,,True,t3_ozlhp,http://www.reddit.com/r/SQL/comments/ozlhp/need_help_on_where_i_can_find_help_with_sqljboss/,
1327445862.0,3,self.SQL,ov53g,"How to join products, categories, subcategories",Bit_Blitter,5,2,4,http://www.reddit.com/r/SQL/comments/ov53g/how_to_join_products_categories_subcategories/,"I tables that are structured like this:

    products
      product_id
    
    categories
      category_id
      parent_id
    
    products_categories
      product_id
      category_id


It's a fairly standard n-&gt;m relationship between products and categories. Categories have a parent_id which is the id of another category that is its parent. The parent_id is set to 0 if this is a top level category. Products can be linked to a top-level or a sub category.

I have a query that returns a list of only the categories that have products in them by doing an INNER JOIN between the tables above. However this does not return categories whose children have products, while they themselves do not. I'm sure this has been done before, how would I go about returning a list of all categories who are linked, or whose children are linked to products?

This is the query that returns all categories that have a product in them, I need to extend this to include the parent categories.

    SELECT *
    FROM categories
      INNER JOIN products_categories ON categories.category_id = products_categories.category_id
      INNER JOIN products ON products_categories.product_id = products.product_id


Any ideas?",,False,self,t5_2qp8q,False,,,True,t3_ov53g,http://www.reddit.com/r/SQL/comments/ov53g/how_to_join_products_categories_subcategories/,
1326835045.0,4,tombatron.com,old8f,Working with DATETIME boundaries. (SQL Server),tombatron,6,2,1,http://www.reddit.com/r/SQL/comments/old8f/working_with_datetime_boundaries_sql_server/,,,False,default,t5_2qp8q,False,,,False,t3_old8f,http://www.tombatron.com/post/SQL-Dates-and-Times-Oh-My,
1325651808.0,3,self.SQL,o22wd,"Looking for resources to improve my knowledge of 
transactions in RDBMS systems",everest5981,5,2,3,http://www.reddit.com/r/SQL/comments/o22wd/looking_for_resources_to_improve_my_knowledge_of/,"Hi all,

I am looking for books or comprehensive articles about transactions, how to use them, the suitability of different isolation levels for different scenarios, pitfalls, etc.

Anything you can recommend?",,False,self,t5_2qp8q,False,,,True,t3_o22wd,http://www.reddit.com/r/SQL/comments/o22wd/looking_for_resources_to_improve_my_knowledge_of/,
1325603670.0,4,self.SQL,o158m,"Oracle self-joins ""(+)"" inside OR loops",mpstein,4,0,16,http://www.reddit.com/r/SQL/comments/o158m/oracle_selfjoins_inside_or_loops/,"I am trying to modify a view to return a value if a entry isn't null, but if it is null it needs to to a join on a different table. I currently have

          (
            (
                TBL_TRANSACTIONS.EQUIPSVCSEQ IS NOT NULL
                and GREATEST(TBL_EQUIPANDSERVICES.DEINSTALLWORKORDERSEQ, TBL_EQUIPANDSERVICES.LASTWORKORDERSEQ) = TBL_WORKORDERS.WORKORDERSEQ (+)
            )
            OR
            (
                TBL_TRANSACTIONS.EQUIPSVCSEQ IS NULL
                
                and TBL_TRANSACTIONS.WORKORDERSEQ = TBL_WORKORDERS.WORKORDERSEQ (+)}
        )
      )    

Unfortunately, this gives an PS/SQL error ""ORA-01719: outer join operator (+) not allowed in operand of OR or IN""

Any suggestions?",,False,self,t5_2qp8q,False,,,True,t3_o158m,http://www.reddit.com/r/SQL/comments/o158m/oracle_selfjoins_inside_or_loops/,
1325094630.0,4,self.SQL,ntsey,Data Structures Question,SEA-Sysadmin,7,3,9,http://www.reddit.com/r/SQL/comments/ntsey/data_structures_question/,"Hi All,

I'm learning SQL as I go, and I've come upon an interesting problem...that I'm guessing has a really simple solution that I haven't dealt with yet.

Let me give you an example:
Let say you have a thousand families in a room, all mixed up.

You ask EVERY person in the room to list all members of their family.

What you end up with is totally redundant and overlapping arrays.

Now, in the actual situation, this would be easy to figure out.  But as a data structure, how is this kind of information typically worked with?  Is there a recommended structure for information like this?

Let's say I want to group every family into a logical unit.  What's the smartest way to handle this?

(now just replace families with hypervisors and  their guest virtual machines, and you have my actual scenario)

",,False,self,t5_2qp8q,False,,,True,t3_ntsey,http://www.reddit.com/r/SQL/comments/ntsey/data_structures_question/,
1321039451.0,4,firebirdnews.org,m900x,The first issue of the Firebird Project official newsletter,mariuz,4,0,0,http://www.reddit.com/r/SQL/comments/m900x/the_first_issue_of_the_firebird_project_official/,,,False,default,t5_2qp8q,False,,,False,t3_m900x,http://www.firebirdnews.org/?p=6437,
1320530450.0,4,self.SQL,m1s5o,String parsing help,Sotall,5,1,6,http://www.reddit.com/r/SQL/comments/m1s5o/string_parsing_help/,"Okay, here is the problem:

In the script I am writing for work, I have a varchar2 field with data organized as such:

30Y,95Square,I2Y,3SRegistered

Each comma-delimited element is a name-value pair. The first two characters of the element (in the example, '30,95,I2,3S') are the name, and the rest of the characters are the value (can be anywhere from 1 character to 255 characters)

I need to parse this string and dump out each element into records in a temp table with two fields (name and value). For the example above:

    name  value
    30    Y
    95    Square
    I2    Y
    3S    Registered

Any ideas? 

EDIT:
Thanks for all of the suggestions - it got me thinking in the right direction.

First, I realized that while i needed to parse out these values from the string, I didnt need a temp table - variables would work better.  

Here is what I ended up using, in case anyone is curious:

    --Take the length of the string containing the string to be parsed
	--and subtract the length of the same string, after using replace
	--to delete out the delimiter(in this case, a pipe
    v_n_oo := ((length(v_oo))-(LENGTH(REPLACE(v_oo,'|',''))))+1; 
	
	--v_n_oo now contains the number of iterations that i need for my loop
	while v_n_oo &gt; 0
        -- the first office_option_type_code is parsed into v_ootc.
            v_ootc := substr(v_oo, 1, 2);

            --if no pipes exist in v_oo(making it the last office_option in the string) ...
            if instr(v_oo, '|') = 0 then
        
             -- then assign v_oov the remainder of the string ...
            v_oov := substr(v_oo,3);
		    else
        
                --otherwise, only assign the portion of the string up to the next pipe.
                v_oov := substr(v_oo, 3, (instr(v_oo, '|')-3));

            end if;   
            --now that the office_option is loaded, delete it out of v_oo
            v_oo := substr(v_oo,(instr(v_oo, '|')+1));

			/* OPERATE ON VALUES HERE*/

            --decrement v_n_oo
            v_n_oo := v_n_oo - 1;
        
        end loop;",,False,self,t5_2qp8q,True,,,True,t3_m1s5o,http://www.reddit.com/r/SQL/comments/m1s5o/string_parsing_help/,
1320510193.0,5,self.SQL,m1hh4,Ram suggestion for ad hoc users,rikrokola,5,0,10,http://www.reddit.com/r/SQL/comments/m1hh4/ram_suggestion_for_ad_hoc_users/,My company uses mssql. What is the suggested ram for querying ~500k records. Is 2g of ram enough?,,False,self,t5_2qp8q,False,,,True,t3_m1hh4,http://www.reddit.com/r/SQL/comments/m1hh4/ram_suggestion_for_ad_hoc_users/,
1320165501.0,4,self.SQL,lwkek,"Help! How do I restore an sql database using phpmyadmin, online guides aren't helping.",,4,0,6,http://www.reddit.com/r/SQL/comments/lwkek/help_how_do_i_restore_an_sql_database_using/,"The guides online say to either do it under 'import' or 'sql' from phpmyadmin. 

From 'import' when I select my .sql file I get an error message saying that my database already exists, as if it wants to create a new database as opposed to restoring the old one.

And if I go to the 'sql' tab I see no one to select a file from my computer to upload.

Any help is appreciated thanks!",,False,self,t5_2qp8q,False,,,True,t3_lwkek,http://www.reddit.com/r/SQL/comments/lwkek/help_how_do_i_restore_an_sql_database_using/,
1316204359.0,4,self.SQL,ki0f4,Self-join Craziness: I can't tell whether the query I just wrote is clever or clunky.,cincodenada,5,1,6,http://www.reddit.com/r/SQL/comments/ki0f4/selfjoin_craziness_i_cant_tell_whether_the_query/,"So, I just wrote this query.  It does what I want, but as is expected, it's slow (but not unbearably so):
    
    SELECT s.*,prev.rank AS prevrank,prev.time_retrieved AS prev_time,prev.rank-s.rank AS moved
    FROM `serps` s 
    INNER JOIN serps prev 
        ON s.keyword_id=prev.keyword_id 
        AND s.search_engine_id=prev.search_engine_id 	
        AND s.time_retrieved &gt; prev.time_retrieved 
    WHERE s.search_engine_id IN(1,2)
    GROUP BY s.keyword_id,s.search_engine_id 
    ORDER BY s.time_retrieved,s1.time_retrieved DESC

`serps` is a table of search engine rankings, basically a list of dates and ranks for a bunch of keywords.  I want to get the two *most recent* rankings - the problem being, the data is sometimes spotty, so there are missing days and such.  So this is what I came up with, and it does the job - but as expected, it's pretty slow.  It'll have more WHERE clauses on it in actual use, but...is there a better way to do this?  I could also just loop through each keyword in the code and do a quick LIMIT 2 query - would that be significantly faster or slower?

This, btw, is the EXPLAIN for the beast:

|id|select_type|table|type|possible_keys|key|key_len|ref|rows|Extra|
|:---|:---|:---|:---|:---|:---|:---|:---|:---|:---|
|1|SIMPLE|s|ALL|engine,kw||||2727|Using where; Using temporary; Using filesort
|1|SIMPLE|prev|ref|engine,kw|engine|4|s.search_engine_id|12|Using where

",,False,self,t5_2qp8q,True,,,True,t3_ki0f4,http://www.reddit.com/r/SQL/comments/ki0f4/selfjoin_craziness_i_cant_tell_whether_the_query/,
1315422342.0,5,self.SQL,k7vxx,Returning the last inserted or updated row.,jimktrains,6,1,12,http://www.reddit.com/r/SQL/comments/k7vxx/returning_the_last_inserted_or_updated_row/,"Is there a way to return the last row, not just the id, inserted or updated without having to do a separate select query?  In my particular application I know that only one row will ever be updated or inserted at any given time.",,False,self,t5_2qp8q,False,,,True,t3_k7vxx,http://www.reddit.com/r/SQL/comments/k7vxx/returning_the_last_inserted_or_updated_row/,
1314109145.0,4,microsoft.com,jrp62,SQL Server 2008 SP2 is available for Download.,firepool,10,6,3,http://www.reddit.com/r/SQL/comments/jrp62/sql_server_2008_sp2_is_available_for_download/,,,False,default,t5_2qp8q,False,,,False,t3_jrp62,http://www.microsoft.com/download/en/details.aspx?displaylang=en&amp;id=12548,
1314036591.0,5,firebirdnews.org,jqsv0,"Migration from Firebird 1.5 to 2.5: 75Gb database, 564 tables, 5000+ procedures",mariuz,5,0,0,http://www.reddit.com/r/SQL/comments/jqsv0/migration_from_firebird_15_to_25_75gb_database/,,,False,default,t5_2qp8q,False,,,False,t3_jqsv0,http://www.firebirdnews.org/?p=6154,
1313873987.0,5,self.SQL,jp41v,Is there a way to do two queries in one?,twoqueries,6,1,14,http://www.reddit.com/r/SQL/comments/jp41v/is_there_a_way_to_do_two_queries_in_one/,"Hi, can't find an answer to this but is there a way I can search two tables with different search terms in one query?

Sort of:

SELECT * FROM cats WHERE cat = ""black""
AND
SELECT * FROM dogs WHERE dog = ""brown""

So that from the one database and one query I can get all the black cats and brown dogs?",,False,self,t5_2qp8q,False,,,True,t3_jp41v,http://www.reddit.com/r/SQL/comments/jp41v/is_there_a_way_to_do_two_queries_in_one/,
1312490116.0,4,self.SQL,j96ab,SQL Server 2008 Failover Cluster fails at install,BruisedGhost,4,0,1,http://www.reddit.com/r/SQL/comments/j96ab/sql_server_2008_failover_cluster_fails_at_install/,"So I have already configured MS Clustering services to work with my two nodes.  Everything checks out but when I attempt to install SQL Server it errors out telling me that ""The Path is malformed or not absolute"" has anyone ever come across this issue before?

",,False,self,t5_2qp8q,False,,,True,t3_j96ab,http://www.reddit.com/r/SQL/comments/j96ab/sql_server_2008_failover_cluster_fails_at_install/,
1312472653.0,3,self.SQL,j8w2d,[help] A complex query,codl,6,3,11,http://www.reddit.com/r/SQL/comments/j8w2d/help_a_complex_query/,"Hello /r/SQL, newbie here, please excuse the unimaginative title, I'm trying to make an autocomplete thing but I'm running into a problem.

I have a table of tags that can be synonyms (children) of other tags, and I need to return tags that match a string *but* children of a tag must only be returned if the parent tag does not match the string. They also must be sorted by their frequency in another table.

Note that a tag will not be a parent and a child at the same time, there are no chains

Here is my schema:

    CREATE TABLE tag (
        tag_id SERIAL PRIMARY KEY,
        name TEXT NOT NULL,
        synonym INTEGER -- tag_id of the tag's parent, or NULL if no parent
    );
    CREATE TABLE image (
        image_id SERIAL PRIMARY KEY,
        -- snip
    );
    CREATE TABLE tag_mapping (
        tag_id INTEGER NOT NULL,
        image_id INTEGER NOT NULL
    ) WITH OIDS;

And here is the query I've been using, it only returns one of a parent and its children, but there is no priority for the parent, and it feels really hacky:


    SELECT array_agg(t2.name), array_agg(t.name) FROM tag AS t
    INNER JOIN tag AS t2 ON t.tag_id = t2.synonym
        OR (t2.synonym ISNULL AND t.tag_id = t2.tag_id)
    INNER JOIN tag_mapping AS tm ON t.tag_id = tm.tag_id
    WHERE t2.name LIKE %s
    GROUP BY t.tag_id
    ORDER BY count(*) DESC
    LIMIT 7

Then I can get the first entry of each array to get the tag's name and its parent. It's not exactly what I want and it probably runs slower than it needs to.

Is there any way to do it in SQL entirely?

###Solved, thanks kyzen",,False,self,t5_2qp8q,True,,,True,t3_j8w2d,http://www.reddit.com/r/SQL/comments/j8w2d/help_a_complex_query/,
1311349936.0,6,ogrelabs.com,iww83,SQL Server Management Studio Tip: Comment block  ,choudeshell,7,1,3,http://www.reddit.com/r/SQL/comments/iww83/sql_server_management_studio_tip_comment_block/,,,False,http://thumbs.reddit.com/t3_iww83.png,t5_2qp8q,False,,,False,t3_iww83,http://ogrelabs.com/2011/07/22/sql-server-management-studio-tip-comment-block/,
1310757056.0,3,self.SQL,iqo3c,SQL Server 2005 - Views needing recompiling?,xstockix,4,1,4,http://www.reddit.com/r/SQL/comments/iqo3c/sql_server_2005_views_needing_recompiling/,"I found a strange problem on a SQL 2005 SP2 DB today, a view that wasn't up to date with its own definition. I got an email from a developer saying that his application was producing an error from an older bit of code:

    SELECT Column1, Column2, Column3, Column4, Column5 FROM View

This produced an error message saying Column4 and Column5 were invalid. Seeing this I did a quick:

    SELECT * FROM View

And got Column1, Column2, Column3. The other columns apparently didn't exist so I pull up the view code to add them when to my surprise I found:

    SELECT Column1, Column2, Column3, Column4, Column5 FROM Table

Total confusion on my end. I ended up just adding a space to the end of it (so it would detect a change and allow me to save it) and everything worked fine. It was like it just needed to be recompiled so to speak. 

I'm currently attributing this to ""ghosts in the schema"" but that's not a very satisfying answer. I would love to know what might have caused this. Anyone come across this before? Care to shine some light on it for me? Thanks!",,False,self,t5_2qp8q,False,,,True,t3_iqo3c,http://www.reddit.com/r/SQL/comments/iqo3c/sql_server_2005_views_needing_recompiling/,
1310526476.0,5,self.SQL,io2g5,[help request] Can I return what is missing from a table using a discrete WHERE IN list as the search criteria?,ravag3,5,0,9,http://www.reddit.com/r/SQL/comments/io2g5/help_request_can_i_return_what_is_missing_from_a/,"Hey guys,

I'm hoping one of you boffins might be able to answer my question.

If I have a table called BOOKS, a column called bookTitle and I had a discrete list of book names I wished to compare against this table... am I able to return on the book titles that I provided that DON'T exist in the table?

For example:

My table has three books that are titled :
- Harry Potter
- Ulysses
- A Hobbits Guide to Foot Grooming

and I want to compare a list I have against already existing entries to see if something in my list has not yet been created in the db, what sql statement could I use? I imagined something like the following:

select * from BOOKS where bookTitle does not exist in  ('Ulysses','Magician','Harry Potter')

I want to see only Magician as the output, and would like to avoid creating and dropping temporary tables.

Is this possible?",,False,self,t5_2qp8q,False,,,True,t3_io2g5,http://www.reddit.com/r/SQL/comments/io2g5/help_request_can_i_return_what_is_missing_from_a/,
1309484976.0,6,self.SQL,idtbe,Primary Keys: Surrogate &amp; Composite Keys,tkepongo,6,0,9,http://www.reddit.com/r/SQL/comments/idtbe/primary_keys_surrogate_composite_keys/,"When is it appropriate to use a surrogate vs a composite key? College taught us to use surrogate (SQL Server's identity) but while developing a database at work today (I just graduated), I learned that it is not good design to use surrogate keys. So can someone explain, in simple terms, when it is appropriate to use one or the other? THANKS!!!!",,False,self,t5_2qp8q,False,,,True,t3_idtbe,http://www.reddit.com/r/SQL/comments/idtbe/primary_keys_surrogate_composite_keys/,
1303930558.0,2,clickrex.wordpress.com,gylxn,"Introduction to Bitwise ""&amp;"" Operators in T-SQL",lukemerrett,5,3,3,http://www.reddit.com/r/SQL/comments/gylxn/introduction_to_bitwise_operators_in_tsql/,,,False,default,t5_2qp8q,False,,,False,t3_gylxn,http://clickrex.wordpress.com/2011/04/27/bitwise-operations-in-t-sql/,
1302733366.0,3,self.SQL,gpf6o,question about datetime operators,jawz101,4,1,12,http://www.reddit.com/r/SQL/comments/gpf6o/question_about_datetime_operators/,"If I have a MS SQL database with a table.timestamp where timestamp is a datetime field is it not acceptable to use
select * from table where timestamp &gt;= '2011' ?

Someone told me ""just don't"" and to at least write it out to '2011-01-01' or even further out to include milliseconds but I don't think it's necessary.  Just wanted to get a 3rd opinion.",,False,self,t5_2qp8q,True,,,True,t3_gpf6o,http://www.reddit.com/r/SQL/comments/gpf6o/question_about_datetime_operators/,
1297098541.0,4,imgur.com,fgy2x,Oracle 11g Grid Infrastructure...,BLUNTYEYEDFOOL,6,2,1,http://www.reddit.com/r/SQL/comments/fgy2x/oracle_11g_grid_infrastructure/,,,False,http://thumbs.reddit.com/t3_fgy2x.png,t5_2qp8q,False,,,False,t3_fgy2x,http://imgur.com/2TO6L,
1296308723.0,5,sql-performance-explained.com,fbbdy,SQL Performance Explained [xpost from /r/programming],,7,2,0,http://www.reddit.com/r/SQL/comments/fbbdy/sql_performance_explained_xpost_from_rprogramming/,,,False,default,t5_2qp8q,False,,,False,t3_fbbdy,http://sql-performance-explained.com/,
1295383746.0,5,self.SQL,f4njl,SQL-splitting program for Ubuntu,,5,0,3,http://www.reddit.com/r/SQL/comments/f4njl/sqlsplitting_program_for_ubuntu/,"hey guys, 

so I have a 12Mb text file full of SQL (2.4Mb when compressed in a zip). I need to upload this to phpMyAdmin (which only allows a max of 2Mb for any single uploaded file). No one is going to go into the php.ini to change any values so that I can upload more than 2Mb, so I need to split the SQL into smaller pieces, and insert them one by one. I'd rather not go through the SQL &amp; split it manually (it'd take way too long &amp; is much more error-prone). I know there are SQL-splitting tools on the Web, but I can't seem to find any for Ubuntu. Do you guys know of any?

thanks, 

--Jonathan",,False,self,t5_2qp8q,False,,,True,t3_f4njl,http://www.reddit.com/r/SQL/comments/f4njl/sqlsplitting_program_for_ubuntu/,
1295257250.0,5,self.SQL,f3psw,How to work with a large undocumented database?,sqlninja,6,1,10,http://www.reddit.com/r/SQL/comments/f3psw/how_to_work_with_a_large_undocumented_database/,"I have recently started working on a legacy project with a fairly large database schema that is not documented at all.

Table names are not carefully chosen and the schema seems to have a bad and unintuitive design.

Long story short: it's difficult for me to understand who's who in the system and as such, even when I want to implement something that seems trivial to me I face a lot of trouble.

Sometimes I have to guess things and implement stuff without confidence that what I am writing is correct, and it feels just so bad, frustrating, and painful.

Any ideas how I should familiarise myself with this database without asking my colleagues too many questions?",,False,self,t5_2qp8q,False,,,True,t3_f3psw,http://www.reddit.com/r/SQL/comments/f3psw/how_to_work_with_a_large_undocumented_database/,
1293562733.0,5,self.SQL,esnyw,SQL 2008R2 on a domain controller - no longer creates security group,,5,0,6,http://www.reddit.com/r/SQL/comments/esnyw/sql_2008r2_on_a_domain_controller_no_longer/,"Previous versions of SQL (2005, 2008) have created security groups during the install.  If you were to install on a DC the groups would show up in Active Directory.  08R2 SQL is different, those groups don't exist when you install on a DC now.  Long story short, I need a way to grant domain users full control of SQL databases as they're created or attached.  Used to be I could go to that security group and add domain users to that group.  
Any suggestions.  THANKS in advance!",,False,self,t5_2qp8q,False,,,True,t3_esnyw,http://www.reddit.com/r/SQL/comments/esnyw/sql_2008r2_on_a_domain_controller_no_longer/,
1376671697.0,3,self.SQL,1khwia,[ORACLE] Is there a way to add labels to your query outputs?,RawrBombz,3,0,4,http://www.reddit.com/r/SQL/comments/1khwia/oracle_is_there_a_way_to_add_labels_to_your_query/,"Ok, hopefully I'm asking this question correctly.  Obviously, I'm fairly new to SQL and just trying to learn as I go at work.  What I have is a query with lines that hit multiple tables (A, B, C):

    select W, count(W)
    from A
    where X is 'NULL' group by W;

    select Y, sum(Z)
    from B
    group by Y;

    etc.
    etc.

Is there a way to add a label that essentially just shows which Table each output comes from?  Like a **LABEL A,  LABLE B etc etc ** by each of the results?  I'm sorry if I'm not asking this correctly, I've tried googling and looking through W3 schools SQL Tutorial, but am having a hard time finding anything.  Thanks so much for your help.

",,False,self,t5_2qp8q,False,,,True,t3_1khwia,http://www.reddit.com/r/SQL/comments/1khwia/oracle_is_there_a_way_to_add_labels_to_your_query/,
1376649051.0,4,self.SQL,1khbbn,I have until monday to learn the basics of SQL...,AerialBreakfast,5,1,8,http://www.reddit.com/r/SQL/comments/1khbbn/i_have_until_monday_to_learn_the_basics_of_sql/,"Hey guys,

So as the title says, I have until monday to learn the basics of SQL. Do you have any good (online) guides or tutorials that might help me?

Thanks!",,False,self,t5_2qp8q,False,,,True,t3_1khbbn,http://www.reddit.com/r/SQL/comments/1khbbn/i_have_until_monday_to_learn_the_basics_of_sql/,
1376434608.0,3,self.SQL,1kb7ki,[MS SQL] Giving column two different names to be called by,citre,4,1,10,http://www.reddit.com/r/SQL/comments/1kb7ki/ms_sql_giving_column_two_different_names_to_be/,"At my current job, we have a lot of tables for different types of products, but they mostly follow a similar structure (name, thumbnail, color, etc).  The problem is a lot of these columns have a different name in each table.  Is there any way I can give a column an alternative name?  As of now, there's no way I could rename them properly and update it in the code without causing hell.

EDIT: Let me clarify a bit.  We have a lot of existing sites using column names like ""image"", ""imageMed"", ""image1"" for example.  For all of the future websites, I just want to use ""imageMed"" (these aren't the actual names, just an example), but I can't rename it in the table because it'll break the old sites.  Is there anyway I can just give this column a second name?",,False,self,t5_2qp8q,1376437951.0,,,True,t3_1kb7ki,http://www.reddit.com/r/SQL/comments/1kb7ki/ms_sql_giving_column_two_different_names_to_be/,
1376336487.0,3,self.SQL,1k86cb,[MS SQL] alphanumeric ordering,DoesntWearEnoughHats,4,1,6,http://www.reddit.com/r/SQL/comments/1k86cb/ms_sql_alphanumeric_ordering/,"I need a query that will order a single column alphanumerically in a way that will yield results that look something like this.

1

1a

2

3

3a

3b

...

10

11



Thanks in advance for the help. If it makes any difference, the value always begins with a digit.",,False,self,t5_2qp8q,False,,,True,t3_1k86cb,http://www.reddit.com/r/SQL/comments/1k86cb/ms_sql_alphanumeric_ordering/,
1376332689.0,3,self.SQL,1k813o,SQL/VBA Parse code - Showing comparisons between 2 fields of text/string,pole7979,4,1,9,http://www.reddit.com/r/SQL/comments/1k813o/sqlvba_parse_code_showing_comparisons_between_2/,"Hey all,
So I'm attempting to find out a way to automate underlining and strikethrough upon different sets of text.  

I work within a sql database but then dump the query into MS Access to develop pdf reports.  We do the underlining of any new text within field text 2 and strikethrough of what has been deleted within field text 1 via PDF pro.  However is there a way to complete this within SQL and dump those results into MS Access or can I complete this within VBA for MS Access?  If so at what level of efficiency/efficacy can this look upon output?

I'm seeking a way to make this an automated process.  I don't have the ability to update the text within SQL database (via code) but can of course create temp tables.  What sort of experiences have you all experienced.",,False,self,t5_2qp8q,1376332912.0,,,True,t3_1k813o,http://www.reddit.com/r/SQL/comments/1k813o/sqlvba_parse_code_showing_comparisons_between_2/,
1376258281.0,2,self.SQL,1k60xm,Quick question about password,01001000100001,7,5,2,http://www.reddit.com/r/SQL/comments/1k60xm/quick_question_about_password/,"Hello

I have a webform with a asp:login panel inside it. I made a method which links to a sql database with credentials and checks it against the username and password. To get the username and password, i do loginform.username and loginform.password as the passed in paramters. Is the a safe way to do it or is there a better way?",,False,self,t5_2qp8q,False,,,True,t3_1k60xm,http://www.reddit.com/r/SQL/comments/1k60xm/quick_question_about_password/,
1375885138.0,1,self.SQL,1jvu7p,SQL Script that creates databases...?,ShadowPh0enix,7,6,4,http://www.reddit.com/r/SQL/comments/1jvu7p/sql_script_that_creates_databases/,"I have a table titled ""DatabaseNames"" that contains several rows(300+) names of databases that I need to create. Is there a script that can loop through the table, read the value, and create a simple database using that value's name.

For example, if the first row's value is YIPPEE, the script will run a CREATE DATABASE YIPPEE statement. The second row's value is YAY, the script creates the YAY database, etc.

Thanks in advance to all contributors!",,False,self,t5_2qp8q,False,,,True,t3_1jvu7p,http://www.reddit.com/r/SQL/comments/1jvu7p/sql_script_that_creates_databases/,
1375373851.0,3,self.SQL,1ji2sl,copying results from columnX in TableA to ColumnX in TableB,whoisearth,6,3,15,http://www.reddit.com/r/SQL/comments/1ji2sl/copying_results_from_columnx_in_tablea_to_columnx/,"So what I want to do is take a query where I've done,

SELECT * FROM TableA

And insert that into an existing TableB

I just tried doing the following - 

Insert into TableB (columnx)

SELECT columnx FROM TableA

Problem is, it added it as new rows.  I want it to basically add it as a new column at the end keeping the same number of rows (the query is the same number of results as the number of results in the tableB.

I'm sure it's something simple but it's not coming to me.",,False,self,t5_2qp8q,False,,,True,t3_1ji2sl,http://www.reddit.com/r/SQL/comments/1ji2sl/copying_results_from_columnx_in_tablea_to_columnx/,
1375100148.0,4,self.SQL,1j9soz,[MySQL] SELECT multiple tables?,jamieshepherd,8,4,2,http://www.reddit.com/r/SQL/comments/1j9soz/mysql_select_multiple_tables/,"So I have the following (PHP) code in the header of every content generated page:

$db_query_games = mysqli_query($db, ""SELECT * FROM games WHERE game_id={$page_id}"");

$db_query_reviews = mysqli_query($db, ""SELECT * FROM reviews WHERE game_id={$page_id}"");

***

Basically: can I just do FROM games, reviews, etc. - and how do I format this so I can use the values from each table if I can?

***

For example, I currently use:

$db_games = mysqli_fetch_array($db_query_games);

So would I need to do something like

$db_games = mysqli_fetch_array($db_query[1]); or something?

I assume I should try to reduce the amount of queries I make? This is only an example and the way my little database is going I could require data from several different tables on page load, so I'm assuming there are more efficient ways to do this?

Any help would be much appreciated, thanks!",,False,self,t5_2qp8q,False,,,True,t3_1j9soz,http://www.reddit.com/r/SQL/comments/1j9soz/mysql_select_multiple_tables/,
1374795233.0,3,self.SQL,1j2951,How do I create a table in DB2 SQL PL?,xCHRISTIANx,4,1,4,http://www.reddit.com/r/SQL/comments/1j2951/how_do_i_create_a_table_in_db2_sql_pl/,"Hello, I'm looking for an example of how to create a table in DB2 SQL PL. Also, trying to figure out how to add data to the table once it's created. Any help would be really appreciated and if you could point me to any web resources that would be awesome too. Thank you.

Here's some data to use in your example, it's actually a section of my homework. Unfortunately my book doesn't really do me much good in trying to find an example and a description of everything in it.

http://i.imgur.com/OF0diam.png

Edit: Here's the code I have so far. I know it's wrong though.

http://i.imgur.com/ltOAD0F.png",,False,self,t5_2qp8q,1374795571.0,,,True,t3_1j2951,http://www.reddit.com/r/SQL/comments/1j2951/how_do_i_create_a_table_in_db2_sql_pl/,
1374144223.0,3,self.SQL,1ijuv1,I may need a hint on this one..,G-BuLleT,5,2,11,http://www.reddit.com/r/SQL/comments/1ijuv1/i_may_need_a_hint_on_this_one/,"Hi guys :)
I've got this project going on and I'm having trouble with a sql query.
I've got a table named Projects and it has these columns:

budget y1t,budget y2t.... budget y5t - each contains a certain year.

then I've got budget 1t,budget 2t,....budget 5t - where the amount of the budget is stored for that year.

What I need to do is loop through all of the budget yXt columns for a certain year, say 2014... and then display all the rows and in a different column to have the sum of all the projects/rows 2014 year.

How can I go about doing this?",,False,self,t5_2qp8q,False,,,True,t3_1ijuv1,http://www.reddit.com/r/SQL/comments/1ijuv1/i_may_need_a_hint_on_this_one/,
1374096739.0,3,self.SQL,1iij5f,[MSSQL] SSIS package erroring out when using Select into statement,KikoSoujirou,6,3,7,http://www.reddit.com/r/SQL/comments/1iij5f/mssql_ssis_package_erroring_out_when_using_select/,"I'm trying to setup an ssis package to export a file from a query a vendor sent me. The script they sent basically just says 

    SELECT aColumn, bColumn, cColumn into #tmp
    SELECT 'column headers' as columnheaders
    UNION ALL
    SELECT columnheaders from  #tmp
    DROP TABLE #tmp

Whenever I try to put this into the ssis package though using a dataflow ole db source and selecting query, I get an error saying invalid object name #tmp. I'm pretty sure the error is because the select into statement creates the table rather than normal create table syntax.

Do I need to create a table upfront with the same columns and then use the rest of their statement or is there a better way for me to approach this?  

Any help or insight is appreciated.

(using visual studio 2008 ver9 fyi)",,False,self,t5_2qp8q,False,,,True,t3_1iij5f,http://www.reddit.com/r/SQL/comments/1iij5f/mssql_ssis_package_erroring_out_when_using_select/,
1374038105.0,3,self.SQL,1igug5,"Help [2008 T-SQL], trying to Coalesce and Group By in same query",vanGogH20,4,1,15,http://www.reddit.com/r/SQL/comments/1igug5/help_2008_tsql_trying_to_coalesce_and_group_by_in/,"I have one table with two columns: (Item_No varchar, Date datetime).

For distinct Date within that table, I want to coalesce comma-delimited rows of Item_No (or basically concatenate the Item_No for that Date into one string), and return this into a new temp table with the same structure, except there will be distinct rows of Date with the corresponding concatenated Item_No.  

**Example**

Given:

CREATE TABLE #temp1(Item_No varchar(100), MyDate datetime)

INSERT INTO #temp1

VALUES ((20, 10 Jul 2013), (10, 10 Jul 2013), (5, 16 Aug 2013), (9, 16 Aug 2013))   

// I know that my syntax is bad, but those are the rows with two columns

Want:

[(20, 10),(10 Jul 2013)]

[(5, 9),(16 Aug 2013)]

//^ imagine you're looking at the resultant temp table with each column within parentheses 

http://imgur.com/pES1vGr

I've tried a combination of Group By, Coalesce, Distinct, multiple temp tables.  Maybe I'm just too tired, but I'm hitting a wall and any help would be greatly appreciated! ",,False,self,t5_2qp8q,1374038726.0,,,True,t3_1igug5,http://www.reddit.com/r/SQL/comments/1igug5/help_2008_tsql_trying_to_coalesce_and_group_by_in/,
1373668834.0,3,self.SQL,1i6o59,Help with a table update[Oracle],liquidDinner,3,0,4,http://www.reddit.com/r/SQL/comments/1i6o59/help_with_a_table_updateoracle/,"I have to generate a report of the number of users that come from each state. That part was easy to do with counting the users and grouping by the state they came from.

The problem is that the report only includes the states people came from. No users are from Vermont, so it's not on the list. I've been asked to include those states on the list as well, defaulted to zero, so when the report is sent out people can play with it in Excel without breaking things.

My current approach is to create (comp_states) a table with the states as one field, and a value for the count as the second.
___
***The Problem***
___

I want to update comp_states to set each state's value to whatever that state's count is in the earlier query, and to leave the rest as zero.

If there is another, easier way to do this I would be more than happy to try that route.

If I've worded anything stupidly I will answer questions and go back and clarify anything. 

***EDIT***

I can get the values that need to stay zero to stay zero. I have a WHERE in my UPDATE looking for 'ST' in a subquery looking for distinct state values.

However, the count that is being set is the total value of all users, not the users for the specific state.",,False,self,t5_2qp8q,1373669940.0,,,True,t3_1i6o59,http://www.reddit.com/r/SQL/comments/1i6o59/help_with_a_table_updateoracle/,
1372910356.0,3,self.SQL,1hm3lr,[MS SQL] Rebuilding 1.5TB of partitioned indexes in a production environment,beeeeeeeeks,5,2,7,http://www.reddit.com/r/SQL/comments/1hm3lr/ms_sql_rebuilding_15tb_of_partitioned_indexes_in/,"I have a SQL Server 2005 database with about 1.5TB of indexes partitioned many many times. I've run some queries that determined the fragmentation levels of these indexes to be 20-98% (inter office politics, no DBA's wanted to take ownership of this system.) It's not maintained. This is a highly accessed production environment. 

After scheduling a downtime for 48 hours I kicked off a query to rebuild or reorganize on everything, but failed when tempdb maxed out it's 500gb drive. We couldn't roll it back as the tlog drive filled up as well. We had to add 500GB to that logical drive to get everything to roll back.

My question is, what is best practice to go about such a huge index rebuild job in prod? Should I commit each partitioned index before moving on to the next?

Any tricks or tips for this task?
",,False,self,t5_2qp8q,1372911633.0,,,True,t3_1hm3lr,http://www.reddit.com/r/SQL/comments/1hm3lr/ms_sql_rebuilding_15tb_of_partitioned_indexes_in/,
1372305940.0,3,self.SQL,1h5ouq,[MS SQL Server] Should my query be taking this long?,SenseiCAY,4,1,12,http://www.reddit.com/r/SQL/comments/1h5ouq/ms_sql_server_should_my_query_be_taking_this_long/,"**EDIT:** I want to thank everyone for their help. I took some of your suggestions, but I also made a few changes to my query and broke it into little pieces. I got rid of the case statements, and turned them into their own queries with ""WHERE"" clauses that did the same thing as the case statement (for example, instead of:

    select ...
        [more variables]
        count(distinct(case when A = 3 then B.transaction_ID else 0 end)) as X
        count(distinct(case when A = 2 then B.transaction_ID else 0 end)) as Y
    from ...;

...I did this:

    select ...
        [other variables]
    from ...;

    select count(distinct(B.transaction_ID)) as X from ... where A = 3;
    select count(distinct(B.transaction_ID)) as Y from ... were A = 2;

Total run time on the query was 78 minutes.

-----------------------

Hi, y'all,

I had a query running a couple of nights ago. It left-joined eight tables, unindexed. The number of rows in the tables were:

* 25.2 million
* 3,195
* 8,282
* 16.7 million
* 22.7 million
* 267 million
* 1.57 billion
* 6.3 million (this table is being left-outer-joined to most of the other ones)

This query took 3 hours and 1 minute to finish. Now, I'm running the same query, except the tables have been updated and indexed on the join keys. In the same order, the number of rows in these tables is now:

* 26.0 million
* 3,227
* 8,283
* 22.7 million
* 45.6 million
* 267 million (exactly the same as before)
* 1.57 billion (exactly the same as before)
* 12.9 million

Most of the tables have slight increases in size compared to before. One table doubled in size, but the rest are close to the same size as before. This query has been running now for almost 6 hours. Does the increase in data size justify the amount of time that it's taking? Shouldn't the indexes help with that, especially since the indexes were created on the join keys?

Thanks in advance for any help and advice!

Edit: code is at http://pastebin.com/4DHHxw01.",,False,self,t5_2qp8q,1372430788.0,,,True,t3_1h5ouq,http://www.reddit.com/r/SQL/comments/1h5ouq/ms_sql_server_should_my_query_be_taking_this_long/,
1372226584.0,3,self.SQL,1h3btw,Need help with table/db design,davidintransit,4,1,2,http://www.reddit.com/r/SQL/comments/1h3btw/need_help_with_tabledb_design/,"Hello,

I am trying to design a database that would hold different types of items like a computer, monitor, printer etc. Each of these items have unique attributes (monitor:size of screen, computer:processor, printer:dpi etc...)


I need to have a single table called Component that would contain a list of each component. Now I could put everything in one table but I know it is bad design to put a bunch of columns on a single table that may or may not be used (depending on the type of item). So I designed child tables like shown below that would link/reference the parent Component table.


Component
-----------
PK_ID

Name

Description

FK_ComponentType 


.


Then I have the Component Type table:

.



ComponentType
----------------
PK_ID


TypeName


.



Then I have different tables for each of the components:


.




Computer
----------
PK_ID

Brand

CPU

Memory

FK_Component


etc....


.




Is this an okay or bad design?",,False,self,t5_2qp8q,1372227202.0,,,True,t3_1h3btw,http://www.reddit.com/r/SQL/comments/1h3btw/need_help_with_tabledb_design/,
1372180859.0,2,self.SQL,1h1rnr,Need help MSSQL table design please.,willamanjaro,6,4,7,http://www.reddit.com/r/SQL/comments/1h1rnr/need_help_mssql_table_design_please/,"Hi all, I am creating a database for a website and need some help with table design.

We have a customertable which will hold a record for each of our customers we have. Our customers will be given logins to the database for their users. Users records will reside in the usertable which will have a link to customer table through a customerid

I then have a client table which holds our customer's client records. 

The problem I'm having is that I want a clientstatus table which will hold default records  such as ""live"", ""dissolved"",""prospect"" etc that are available to all our customers, but I also want to allow our customers to create their own statuses. Any status a customer creates obviously should only be available to that customer and not others.

Where I am stuck is getting my head around how to design this. The easy route would be to have a customer id in the clientstatus table and repeat the default list for all customers and then allow them to add their own into this table with their customerid assigned to their created records. I really do not want to do this however as I don't want thousands of duplicated default statuses when we should only have one list of default statuses for all our customers to reference.

I thought about having a default clientstatus table and a custom default status table and having a defaultclientstatusid and customclientstatusid in the client table and only allowing one to be filled in at once however I feel that this is messy and bad design.

Any help would be much appreciated thanks.",,False,self,t5_2qp8q,False,,,True,t3_1h1rnr,http://www.reddit.com/r/SQL/comments/1h1rnr/need_help_mssql_table_design_please/,
1371848226.0,3,channel9.msdn.com,1gtgyr,Demo: A First Look at SQL Server Data Tools (Channel 9),alisa_anny,4,1,0,http://www.reddit.com/r/SQL/comments/1gtgyr/demo_a_first_look_at_sql_server_data_tools/,,,False,http://e.thumbs.redditmedia.com/VSW0Al7QviXPDHZX.jpg,t5_2qp8q,False,,,False,t3_1gtgyr,http://channel9.msdn.com/posts/SQL11UPD00-REC-02,
1371787047.0,1,self.SQL,1grw0y,How do I *install* Visual Studio 2010 so I can create a SQL database without errors during the creation.,jennym123,4,3,7,http://www.reddit.com/r/SQL/comments/1grw0y/how_do_i_install_visual_studio_2010_so_i_can/,"I've been banging my head against my computer for months to the point where I have honestly thought of giving up programming and database design all together. 

I've been trying to create a SQL database using Microsoft Visual Studio C# 2008/10 and I've been running into error message after error message. I've fixed nearly a dozen problems only be be received by another error message to the point where I don't even want to fix them anymore. 

So I'm going to start fresh and delete everything and pretend I've never set up Visual Studio or installed any SQL programs on m computer. 

How do install a copy of Microsoft Visual Studio 2010 (or even 2008) to be able to create a working SQL database without receiving an error in the creation- outside the normal kinds.

Seriously, people. Treat me like a simple minded person because that's how I feel right now.  ",,False,self,t5_2qp8q,False,,,True,t3_1grw0y,http://www.reddit.com/r/SQL/comments/1grw0y/how_do_i_install_visual_studio_2010_so_i_can/,
1371493985.0,4,self.SQL,1gj4jr,problem joining results of a query,whoisearth,5,1,16,http://www.reddit.com/r/SQL/comments/1gj4jr/problem_joining_results_of_a_query/,"I am querying the same table twice for 2 different sets of info.  Problem with the result is that I'm getting 2 rows per first_name.

first_name   runno   runyes

frank            0           4

frank            2           0

jim               0           4

sally             0           45

harry            23         0

I want the row frank to show as - 

frank            2           4

This is the query I'm using - I need those 2 joins to link the tables together so the query will work, but the actual data related to val1 and val2 are from the same column in the same table.

    SELECT first_name, COUNT(
    	CASE
    		WHEN run_val1 = 'N' THEN 'no'
    	END) runno,
    	COUNT(CASE
    			WHEN run_val1 = 'Y' THEN 'yes'
    	END) runyes
    FROM run
    	FULL JOIN mst ON (run.mst_id = mst.mst_id)
    	FULL JOIN owner ON (mst.mst_owner = owner.owner_id)
    WHERE run_date = '2013-06-01' AND run.mst_type &gt; 1
    	GROUP BY first_name, run.run_val1
    	ORDER BY first_name",,False,self,t5_2qp8q,False,,,True,t3_1gj4jr,http://www.reddit.com/r/SQL/comments/1gj4jr/problem_joining_results_of_a_query/,
1370995065.0,3,self.SQL,1g5s38,Learning SQL the HardWay Help: ex1.db &lt; ex1.sql,sonicace,6,3,5,http://www.reddit.com/r/SQL/comments/1g5s38/learning_sql_the_hardway_help_ex1db_ex1sql/,"In the What you should see section if you scroll down here: http://sql.learncodethehardway.org/book/ex1.html

It tells you to do this line of code ex1.db &lt; ex1.sql but whenever I do that it says ex1.sql: No such file or directory?
Im starting off doing sqlite3 ex1.db and then copying and pasting the code they gave and then .quit but the line of code they offer keeps giving that error?
Any Help? thanks",,False,self,t5_2qp8q,False,,,True,t3_1g5s38,http://www.reddit.com/r/SQL/comments/1g5s38/learning_sql_the_hardway_help_ex1db_ex1sql/,
1369989455.0,3,self.SQL,1fe73q,[MSSQL] Profiler Blocked Process Help,anon197812,4,1,2,http://www.reddit.com/r/SQL/comments/1fe73q/mssql_profiler_blocked_process_help/,"Hi All,

I'm struggling to understand why a process was blocked. The blocking process in on a completely seperate table to the blocked process. How can an unrelated table block another query?

    &gt;       
    &gt;    &lt;blocked-process-report&gt;
    &gt;     &lt;blocked-process&gt;
    &gt;      &lt;process id=""process4332988"" taskpriority=""0"" logused=""0"" waitresource=""KEY: 15:72057594355646464 (7651f42edda6)"" waittime=""9713"" ownerId=""192594018"" transactionname=""implicit_transaction"" lasttranstarted=""2013-05-30T09:25:02.730"" XDES=""0x17101b950"" lockMode=""RangeS-U"" schedulerid=""3"" kpid=""8872"" status=""suspended"" spid=""66"" sbid=""0"" ecid=""0"" priority=""0"" trancount=""1"" lastbatchstarted=""2013-05-30T09:25:02.730"" lastbatchcompleted=""2013-05-30T09:25:02.730"" lastattention=""2013-05-30T06:00:52.683"" clientapp=""Microsoft Dynamics NAV Classic client"" hostname=""ALERTSERVER"" hostpid=""11988"" loginname=""DOMAIN\ALERT"" isolationlevel=""serializable (4)"" xactid=""192594018"" currentdb=""15"" lockTimeout=""10000"" clientoption1=""671156320"" clientoption2=""128058""&gt;
    &gt;       &lt;executionStack&gt;
    &gt;        &lt;frame line=""1"" stmtstart=""26"" sqlhandle=""0x0200000079a05531a083a33a42ac02f684ea01a5cc6eaf3f""/&gt;
    &gt;        &lt;frame line=""1"" sqlhandle=""0x0400ff7fb925310a01000000000000000000000000000000""/&gt;
    &gt;       &lt;/executionStack&gt;
    &gt;       &lt;inputbuf&gt;
    &gt;    (@P1 tinyint)SELECT TOP 1 NULL FROM &amp;quot;DATABASE-LIVE&amp;quot;.&amp;quot;dbo&amp;quot;.&amp;quot;Outgoing Emails&amp;quot; WITH (UPDLOCK)   WHERE ((&amp;quot;Sent&amp;quot;=@P1))   &lt;/inputbuf&gt;
    &gt;      &lt;/process&gt;
    &gt;     &lt;/blocked-process&gt;
    &gt;     &lt;blocking-process&gt;
    &gt;      &lt;process status=""sleeping"" spid=""76"" sbid=""0"" ecid=""0"" priority=""0"" trancount=""1"" lastbatchstarted=""2013-05-30T09:24:20.267"" lastbatchcompleted=""2013-05-30T09:24:20.267"" lastattention=""2013-05-30T09:24:20.243"" clientapp=""Microsoft Dynamics NAV Classic client"" hostname=""CITRIX1"" hostpid=""10048"" loginname=""DOMAIN\AUSER"" isolationlevel=""serializable (4)"" xactid=""192587835"" currentdb=""15"" lockTimeout=""10000"" clientoption1=""671156320"" clientoption2=""128058""&gt;
    &gt;       &lt;executionStack/&gt;
    &gt;       &lt;inputbuf&gt;
    &gt;    (@P1 int,@P2 varchar(20),@P3 tinyint)SELECT  * FROM &amp;quot;DATABASE-LIVE&amp;quot;.&amp;quot;dbo&amp;quot;.&amp;quot;COMPANYNAME$Sales Line&amp;quot; WITH (READUNCOMMITTED)   WHERE ((&amp;quot;Document Type&amp;quot;=@P1)) AND ((&amp;quot;Document No_&amp;quot;=@P2)) AND ((&amp;quot;Erma Part&amp;quot;=@P3)) ORDER BY &amp;quot;Document Type&amp;quot;,&amp;quot;Document No_&amp;quot;,&amp;quot;Line No_&amp;quot; OPTION (OPTIMIZE FOR UNKNOWN)   &lt;/inputbuf&gt;
    &gt;      &lt;/process&gt;
    &gt;     &lt;/blocking-process&gt;
    &gt;    &lt;/blocked-process-report&gt;

Is it simply because they are both SERIALIZABLE, it won't run them simultaneously even though they're using different tables?


On a completely unrelated note, what else can I do with SQL/SSMS? I'm really enjoying fiddling about with it. I mainly develop our ERP solution and have very little knowledge of SQL. Nobody else here messes with SQL either.

So far I've had a play with SSRS, and now I'm getting my feet wet with the profiler and looking for expensive queries that I can speed up with more indexes.

Thanks all",,False,self,t5_2qp8q,False,,,True,t3_1fe73q,http://www.reddit.com/r/SQL/comments/1fe73q/mssql_profiler_blocked_process_help/,
1369843531.0,3,self.SQL,1f9wnl,[MSSQL] Help needed on a query between two tables,Shtevenen,3,0,9,http://www.reddit.com/r/SQL/comments/1f9wnl/mssql_help_needed_on_a_query_between_two_tables/,"So I have a database with hundreds of tables and I've narrowed it down to just the two that I need to work with.
I need to return only unique ID numbers when another column doesn't exist.
Table 1 and Table 2 have a common key, which is the patient ID. Table 1 has the patient name, and date of birth. Table 2 contains all the scanned documents that are in the patients charts. So table 2 might have 100 scanned documents for the same patient ID. Table 2 has a column for the title of the scanned documents. I need to select all the patient IDs that do not have a scanned document with a specific title. I can easily select all the patients who have a document with a specific title, but what I need is a way to exclude that patient ID if the title shows up.

Does this make sense and is it possible to do?",,False,self,t5_2qp8q,False,,,True,t3_1f9wnl,http://www.reddit.com/r/SQL/comments/1f9wnl/mssql_help_needed_on_a_query_between_two_tables/,
1369743082.0,3,jitbit.com,1f70t7,Our SQL interview questions,jitbit,5,2,1,http://www.reddit.com/r/SQL/comments/1f70t7/our_sql_interview_questions/,,,False,default,t5_2qp8q,False,,,False,t3_1f70t7,http://www.jitbit.com/news/181-jitbits-sql-interview-questions/,
1369704962.0,3,self.SQL,1f67yt,"[MS SQL] Which version to use, I feel very lost.",tallandgodless,4,1,3,http://www.reddit.com/r/SQL/comments/1f67yt/ms_sql_which_version_to_use_i_feel_very_lost/,"Hi there, I'm slowly wading my way into web with c# and I'm trying to figure out how to set up a database so that I can write c# programs that interact with it.

My question is which version of SQL server do I get?  I have a robust selection (pretty much any version) for free because of my school.  I have a book for 2008 but I'm hesitant to use that when 2012 is already out.

If you could please give me advice on how to proceed, it would be greatly appreciated, I have some experience using MySQL on a unix based server so I am not totally foreign to the idea of using a database.  But I have never set one up on my own machine for personal use.",,False,self,t5_2qp8q,False,,,True,t3_1f67yt,http://www.reddit.com/r/SQL/comments/1f67yt/ms_sql_which_version_to_use_i_feel_very_lost/,
1369292130.0,3,self.SQL,1ew2l5,"Hey r/SQL, what is the best software out there for beginners trying to learn SQL?",tarcoal,3,0,10,http://www.reddit.com/r/SQL/comments/1ew2l5/hey_rsql_what_is_the_best_software_out_there_for/,"As a student, I am luckily allowed to download free software through the Dreamspark program. The newest software I can download is Microsoft SQL Server 2012 Developer edition. 

Ultimately, I want to play/practice around, create new databases/tables and start practicing SQL commands. Would Microsoft SQL Server 2012 Developer be okay for this case?

Thanks for any help :)",,False,self,t5_2qp8q,False,,,True,t3_1ew2l5,http://www.reddit.com/r/SQL/comments/1ew2l5/hey_rsql_what_is_the_best_software_out_there_for/,
1369245674.0,3,self.SQL,1euj39,InnoDB support Spatial index (pure concept of it) ???,vipercvp,3,0,1,http://www.reddit.com/r/SQL/comments/1euj39/innodb_support_spatial_index_pure_concept_of_it/,"I saw something in the mysql docs but some where it says it has clustered index which is a spatial index , and in other docs says the only engine who does support it is MyISAM , help i'm kinda lost ????",,False,self,t5_2qp8q,False,,,True,t3_1euj39,http://www.reddit.com/r/SQL/comments/1euj39/innodb_support_spatial_index_pure_concept_of_it/,
1369231842.0,3,self.SQL,1eu1t6,[MS SQL] INSERT INTO probem,HeyJoshuah,3,0,10,http://www.reddit.com/r/SQL/comments/1eu1t6/ms_sql_insert_into_probem/,"    INSERT INTO ProductsPreferredLocations (ProductID, BranchID, WarehouseID, BinID)

    SELECT 180, BranchID, WarehouseID, BinID

    FROM ProductsPreferredLocations

    WHERE ProductID = 5407


___


Is it possible to select all ProductID's in the SELECT statement instead of having to just get each individual ID and then constantly run it?

Now that I think of it, would a wildcard work on this?",,False,self,t5_2qp8q,1369232700.0,,,True,t3_1eu1t6,http://www.reddit.com/r/SQL/comments/1eu1t6/ms_sql_insert_into_probem/,
1369159521.0,3,self.SQL,1es00k,Down What do I need to get started with SQL?,m0nkeybl1tz,3,0,11,http://www.reddit.com/r/SQL/comments/1es00k/down_what_do_i_need_to_get_started_with_sql/,"So I have some coding background, and I think I understand the basics of SQL, however I have no idea on how to... run it. I basically want to pull information from a publicly-accessible database, and transform the data into a sortable spreadsheet. Do I need to download software? Set up a server? I'm kind of lost here...",,False,self,t5_2qp8q,False,,,True,t3_1es00k,http://www.reddit.com/r/SQL/comments/1es00k/down_what_do_i_need_to_get_started_with_sql/,
1369158866.0,3,self.SQL,1erz6p,[LogiAnalytics] Dividing two sql queries,kenseihiko,3,0,11,http://www.reddit.com/r/SQL/comments/1erz6p/logianalytics_dividing_two_sql_queries/,"Hello everyone,

I'm having an issue with getting this code to work, and I was wondering if anyone could help me out.  I am using a BI platform called Logi Analytics  I'm trying to divide two sql queries.  I need to have the quotient grouped by another another collum, cell_extention.  Is there anyway to do this?  I've pasted my code below.  Any help you could provide would be appreciated.

Select a.Paid / b.Owing
From (Select d00_collect.debtor.de_cell_extension,
    Sum(d00_collect.de_transaction.tr_to_agency) As Paid
  From d00_collect.debtor
    Inner Join d00_collect.de_transaction On d00_collect.debtor.debtor_rowid =
      d00_collect.de_transaction.debtor_rowid
  Where d00_collect.debtor.de_cell_extension &lt;&gt; 'TEST' And
    d00_collect.de_transaction.tr_type &lt;&gt; '196' And
    d00_collect.de_transaction.tr_type &lt;&gt; '301' And
    d00_collect.de_transaction.tr_type &lt;&gt; '499'
  Group By d00_collect.debtor.de_cell_extension) a,
  (Select d00_collect.debtor.de_cell_extension,
    Sum(d00_collect.debtor.de_principal + d00_collect.debtor.de_interest +
    d00_collect.debtor.de_misc) As Owing
  From d00_collect.debtor
  Where d00_collect.debtor.de_principal &lt;&gt; 0
  Group By d00_collect.debtor.de_cell_extension) b",,False,self,t5_2qp8q,False,,,True,t3_1erz6p,http://www.reddit.com/r/SQL/comments/1erz6p/logianalytics_dividing_two_sql_queries/,
1368659361.0,3,gregorylane.com,1eeyi4,Does the code in this sample look fine before I try it?[TSQL],randomperson24,3,0,4,http://www.reddit.com/r/SQL/comments/1eeyi4/does_the_code_in_this_sample_look_fine_before_i/,,,False,default,t5_2qp8q,False,,,False,t3_1eeyi4,http://www.gregorylane.com/article.aspx?ID=9,
1368636537.0,3,self.SQL,1ee3p7,How do i add a default value to a Query?,SOLUNAR,4,1,27,http://www.reddit.com/r/SQL/comments/1ee3p7/how_do_i_add_a_default_value_to_a_query/,"
SELECT FedTracker.CEC, FedTracker.CourseID, AllReports.EnrollmentStatus, AllReports.CompletionDate
FROM FedTracker LEFT JOIN AllReports ON FedTracker.CEC = AllReports.CEC;


I want the field AllReports.EnrollmentStatus to have a default value of lets say ""Not Started"" if there is no record, currently if there is no record it displays an empty cell

What can i do?",,False,self,t5_2qp8q,False,,,True,t3_1ee3p7,http://www.reddit.com/r/SQL/comments/1ee3p7/how_do_i_add_a_default_value_to_a_query/,
1368579027.0,5,monkeyandcrow.com,1ecp8n,[Postgres] Modeling Hierarchies With Materialized Paths,netghost,6,1,2,http://www.reddit.com/r/SQL/comments/1ecp8n/postgres_modeling_hierarchies_with_materialized/,,,False,http://d.thumbs.redditmedia.com/V4PMNn4N8evF8x3u.jpg,t5_2qp8q,False,,,False,t3_1ecp8n,http://monkeyandcrow.com/blog/hierarchies_with_postgres/,
1368472018.0,3,self.SQL,1e9fgs,[MySQL] Selecting Dynamic Date Ranges?,Deanicus,3,0,4,http://www.reddit.com/r/SQL/comments/1e9fgs/mysql_selecting_dynamic_date_ranges/,"I searched around on the internet and had difficulty finding what I imagine to be a pretty simple process.

I'm running a report every 5 days with the same tables and data, I just need to update the date starting with &gt;= 5 days ago to &lt; today's date.

select *
from table
*where [Date]&gt;= '5/8/2013' and [Date] &lt; '5/13/2013'*",,False,self,t5_2qp8q,False,,,True,t3_1e9fgs,http://www.reddit.com/r/SQL/comments/1e9fgs/mysql_selecting_dynamic_date_ranges/,
1368459284.0,1,self.SQL,1e8yt6,"Just took the CIW 1DO-541 v5 and I failed, AMA",themickeynick,7,6,1,http://www.reddit.com/r/SQL/comments/1e8yt6/just_took_the_ciw_1do541_v5_and_i_failed_ama/,"I'm seriously pissed off by this test due to my course administrator not teaching me anything on this test, we learned basic database creation and covered a lot of SQL. I mean the whole class was the SQL course.",,False,self,t5_2qp8q,False,,,True,t3_1e8yt6,http://www.reddit.com/r/SQL/comments/1e8yt6/just_took_the_ciw_1do541_v5_and_i_failed_ama/,
1368209583.0,3,self.SQL,1e2yve,[ACCESS] SQL issue.,SOLUNAR,6,3,7,http://www.reddit.com/r/SQL/comments/1e2yve/access_sql_issue/,"http://i.imgur.com/T7Wth0p.png 

Im having a bit of trouble, a few brain farts for sure.

I want to update the yellow reports manually, and somehow have them update the AllReports form. What is the best way to do this? write a query to merge all reports?

Im a bit new so just trying to understand the best logic for this type of thing. I assume a SQL query to join left all of them? sorry just confused of the most efficient way.

",,False,self,t5_2qp8q,False,,,True,t3_1e2yve,http://www.reddit.com/r/SQL/comments/1e2yve/access_sql_issue/,
1368199425.0,3,self.SQL,1e2mp6,[SQLite] Brand-new to SQL. Can somebody help me out?,ansabhailte,3,0,8,http://www.reddit.com/r/SQL/comments/1e2mp6/sqlite_brandnew_to_sql_can_somebody_help_me_out/,"Hey guys,

I'm a command-line junkie Linux user, and have been making websites with HTML and CSS, but am now learning PHP and JS (""making websites""... lol) I am trying to make a website that interfaces with logs from a Windows application to make a ""dashboard"" page. That part is easy; lots of sed, grep, awk; and cron. However, I am thinking that the best way to store this data would be in a SQLite database. 

The current task I'm trying to accomplish is creating a set of information regarding tasks. It will include a task name, a resource, the schedule, the data source, and a description. I thought about just making basic multi-dimensional arrays, but I also want to link this data to a calendar on the same page, and associate it with other data for a historical system. I think SQLite will do fine.

My question, then, is how would SQLite store this data, and how could I write and access it?

Thank you all in advance. Please have patience with me :)",,False,self,t5_2qp8q,False,,,True,t3_1e2mp6,http://www.reddit.com/r/SQL/comments/1e2mp6/sqlite_brandnew_to_sql_can_somebody_help_me_out/,
1367765943.0,3,self.SQL,1dqeid,[MS SQL] Need some advice on calculating Exponential moving Average in SQL Server 2012,Effayy,4,1,11,http://www.reddit.com/r/SQL/comments/1dqeid/ms_sql_need_some_advice_on_calculating/,"I've been fiddling with a C# application in order to keep track of stock prices and track their SMA/EMA values over various periods to spot buy/sell signals.

in my DB is a ""Trades"" Table with the following Design:

    tradeID as Int (PK / Identity Auto-Increment)
    tradeDate as datetime
    amount as numeric
    price as numeric

Calculating the SMA (Simple moving Average) for this in a view was quite simple. I used the following query in a view:

    SELECT Maxgrouping.LastTradeID, MaxGrouping.TradeDayClose, Maxgrouping.price,
    AVG(Maxgrouping.price)OVER(ORDER BY MaxGrouping.TradeDayClose ROWS 89 PRECEDING) as SMA90DayPeriod,
    AVG(Maxgrouping.price)OVER(ORDER BY MaxGrouping.TradeDayClose ROWS 29 PRECEDING) as SMA30DayPeriod
    FROM (SELECT B.LastTradeID, B.TradeDayClose, A.price
       FROM dbo.Trades as A
       JOIN (SELECT max(tradeID) as LastTradeID,
       max([date]) as TradeDayClose
       FROM dbo.trades
       GROUP BY CAST([date] as date)) as B
    ON A.tradeID = B.LastTradeID) as MaxGrouping

This gives me accurate SMA values.  Now calculating the EMA is a different ball of wax.  The method of calculating the EMA is as follows:

    Yesterday's EMA + (2/(number of periods +1)) * (Today's price - Yesterday's EMA)

To quote another post I found somewhere that discusses how to seed this EMA:


&gt;    EMAs are initially seeded with SMA, simple moving averages. This means that if you want a 9-day EMA, you have to wait 9 days until you can have a 9-day SMA, and then the next day you will calculate the EMA using yesterday's SMA.


I've been wracking my head over this for hours.  Is there a way that I can use the same view above to also add EMA30Period and EMA90Period?  Unfortunately unlike the SMA where I used a different column to average (Price), I'll instead have to reference the same column (EMA) in my aggregate.

I was hoping to do this strictly within a view, but at this point I'm open to whatever needs to be done, I guess. :)",,False,self,t5_2qp8q,False,,,True,t3_1dqeid,http://www.reddit.com/r/SQL/comments/1dqeid/ms_sql_need_some_advice_on_calculating/,
1367325310.0,3,self.SQL,1dengk,[MS SQL] Why does my update trigger prevent the record from being changed?,Sybs,3,0,4,http://www.reddit.com/r/SQL/comments/1dengk/ms_sql_why_does_my_update_trigger_prevent_the/,"Hi folks, any help with this would be much appreciated. I have this trigger:

    DECLARE @AlertText AS NVARCHAR(MAX)
    
    SET @AlertText = (
    				SELECT 'App No: ' + CAST(I.APPLICATION_NO AS NVARCHAR(10)) + CHAR(13) + CHAR(10) + 
    					'Name: ' + I.SURNAME + ', ' + I.FORENAME + CHAR(13) + CHAR(10) + 
    					CHAR(13) + CHAR(10)
    				FROM INSERTED I WITH (NOLOCK)
    				INNER JOIN DELETED D WITH (NOLOCK) ON I.APPLICATION_NO = D.APPLICATION_NO
    				WHERE (I.COURSE_NO IS NULL AND D.COURSE_NO IS NOT NULL 0)
    				)
    
    IF @AlertText IS NOT NULL
    BEGIN
    
    	EXEC msdb.dbo.sp_send_dbmail
    		@profile_name = 'blah',
    		--@recipients = 'blah@blah.com',
    		@recipients = 'blah@blah.com',
    		@body = @AlertText,
    		@subject = 'blah';
    END        

It's basically to email somebody when the COURSE_NO field gets changed from something to NULL.

Only problem is that is it's preventing the users of the application from changing the field to null. It doesn't say what the error is, but I know it's the trigger doing it. The weird thing is that when the trigger is on, they can change the field to something else, just not to NULL.

Why is the trigger preventing this from happening?",,False,self,t5_2qp8q,False,,,True,t3_1dengk,http://www.reddit.com/r/SQL/comments/1dengk/ms_sql_why_does_my_update_trigger_prevent_the/,
1366995767.0,3,self.SQL,1d5wx7,How to list column values as columns? Basically transposing data sets.,twonx,4,1,7,http://www.reddit.com/r/SQL/comments/1d5wx7/how_to_list_column_values_as_columns_basically/,"Let's say the table is created like this:

YEAR|MONTH|ITEM|SALES
--:|--:|:--:|--:
2012|2|W01|830768
2012|9|W01|579341
2012|12|W01|621877
2011|2|W02|5286
2012|5|W02|8710
2012|12|W02|6378
2012|3|W03|7770.94
2012|6|W03|5568.01
2012|9|W03|5697.94
2012|12|W03|4563.99
2012|3|W05|3231.01
2012|6|W05|2593.99
2012|3|W06|-945.99
2012|6|W06|-555
2013|9|W06|-60
2012|3|W08|-24977.97
2012|6|W08|-19846.96
2012|10|W08|-29059.98
2012|7|W12|-1181.99
2013|10|W12|0


What would I have to do so that it lists the item elements as columns and the sales amount are the rows?

I'd like the output to be something like this:

W01|W02|W03|W05|W06|W08
--:|--:|--:|--:|--:|--:|
$Sales|$Sales|$Sales|$Sales|$Sales|$Sales|

Where year = 2012.


Thanks in advance!
",,False,self,t5_2qp8q,False,,,True,t3_1d5wx7,http://www.reddit.com/r/SQL/comments/1d5wx7/how_to_list_column_values_as_columns_basically/,
1366733242.0,3,self.SQL,1cxxz7,[MSSQL] Query to return records based on timestamp comparison of previous record (with other checks),The_Ombudsman,3,0,11,http://www.reddit.com/r/SQL/comments/1cxxz7/mssql_query_to_return_records_based_on_timestamp/,"I've got the following query that functions fine:

    SELECT t1.ID, t1.Timestamp, t1.Type
    FROM Table1 t1
    WHERE t1.OtherID = (one ID value)
    AND t1.Type = 1
    AND NOT EXISTS (
        SELECT t2.ID
        FROM	Table1 t2
        WHERE t2.OtherID = (same other ID value as above)
        AND t2.Type = 2
        AND t2.ID = t1.ID
    )

Basically I'm querying for all occurances in a given table for a given ID, also tagged with the ""other"" ID, where there is a Type value of 1 but not another record for that ID with a Type value of 2.

The query as above (edited for clarity and paranoia) works fine as far as that goes - but I need it to do something else, which is to add a time-based bent to it - I want to get all occurances of Type 1 records where there is no Type 2 record within, say, a 10 minute span.

Below is the data sample I'm working with: I've flagged the records I'm looking to get back with an  asterisk. They're all Type=1 with no Type=2 within the prev. 10 minutes. 

    ID 	 	Timestamp 	 	 	 	Type
    2879 	2013-04-22 10:03:30.107   	8
    2879 	2013-04-22 10:06:31.530   	2
    2879 	2013-04-22 10:06:40.343   	2
    2879 	2013-04-22 12:41:29.437   	2
    2879 	2013-04-22 12:41:35.843   	2
    2879 	2013-04-22 12:41:40.090   	2
    2879 	2013-04-22 13:55:32.107   	1 *
    2879 	2013-04-22 15:51:06.483   	2
    2879 	2013-04-22 15:52:08.607   	2
    2879 	2013-04-22 15:54:43.997   	2
    2879 	2013-04-22 15:55:42.717   	1
    2879 	2013-04-22 15:56:53.013   	2
    2879 	2013-04-22 16:38:37.467   	1 *
    2879 	2013-04-23 08:44:19.000   	1 *

I've tried adding in this line, within the not-exists area:

    AND DATEDIFF(minute, t1.Timestamp, t2.Timestamp) &lt; 10

but that's not doing the trick. I'm either getting back no records, or too many records, depending on how I flip the check.

I've also spent the last good while googling around, trying to find a workable solution for comparing the datetime values from one record to the next, thinking I should query on Type IN (1,2) and go that route. Most involve simpler queries with sequential row numbers and using those values as pointers to the next/previous record - my base query is too selective to work that way.

**Edit: Resolved,** thanks to /u/Konwayz!

The trick seemed to be handling the DATEDIFF as a BETWEEN instead of less-than. Just dropping that one line from his example (see his reply below for a link) worked great in my original syntax - but his modification of my original syntax runs a bit faster than my original syntax so I'm going with that.
",,False,self,t5_2qp8q,1366752907.0,,,True,t3_1cxxz7,http://www.reddit.com/r/SQL/comments/1cxxz7/mssql_query_to_return_records_based_on_timestamp/,
1366639291.0,3,self.SQL,1cv2xv,Little help with a union problem..,brolax420,3,0,5,http://www.reddit.com/r/SQL/comments/1cv2xv/little_help_with_a_union_problem/,"Here is the problem: 
List all students’ first, last names,activity names, costs (or fees), and student notes, format dollar amounts to two places, including dollar sign ($), order by student last name in descending order, use “activity fee” as the alias name for the activity fee.

Okay so I understand that in order to pull data from two different tables, I need to use a union... I have two tables, one for student and one for activity... but no idea how to write the SQL statement to answer this problem? I understand up to the union part.. so far I have this.. (I know the union is supposed to go in the space I just dont know what)...

select stu_fname, stu_lname, act_name,concat('$', format(act_fee,2)) as 'activity fee', stu_notes, 
from student

order by stu_lname desc;

Thanks for any help... 
",,False,self,t5_2qp8q,False,,,True,t3_1cv2xv,http://www.reddit.com/r/SQL/comments/1cv2xv/little_help_with_a_union_problem/,
1366202160.0,3,self.SQL,1cj1em,"I can't figure out what I'm doing wrong in this command, can someone help me please?",Novirtue,5,2,12,http://www.reddit.com/r/SQL/comments/1cj1em/i_cant_figure_out_what_im_doing_wrong_in_this/,"UPDATE RafSil_QuarterlyBonus2013

   SET Region = b.ID

FROM RafSil_QuarterlyBonus2013 a,RafSil_RegionLookup b
   
   WHERE a.Region = b.Region;


A couple things to note, I'm using MySQL 5.1, and this is the error message I get when I try to run it:

#1064 - You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'FROM RafSil_QuarterlyBonus2013 a, RafSil_RegionLookup b WHERE a.Region = b.Reg' at line 3

**edit:** figured it out!

UPDATE `RafSil_QuarterlyBonus2013` AS a, `RafSil_RegionLookup` AS b

SET a.Region = b.ID

WHERE a.Region = b.Region
",,False,self,t5_2qp8q,1366206859.0,,,True,t3_1cj1em,http://www.reddit.com/r/SQL/comments/1cj1em/i_cant_figure_out_what_im_doing_wrong_in_this/,
1366163748.0,3,self.SQL,1ci6l0,Novice looking for SQL guidance,OcciferGlass,3,0,17,http://www.reddit.com/r/SQL/comments/1ci6l0/novice_looking_for_sql_guidance/,"Evening everyone,

In short, I'm looking for good resources/stepping stones in order to strengthen my SQL coding for an Oracle database. 

I'm currently a data analyst and have created very trivial queries just for extracting minimal amounts of information from our database, but that's about the extent of my knowledge. However, I feel like if I want to grow in my position, I need to go more down a more developer-related route (EG: creating tables, complex queries, etc.). Any help will be much appreciated, thank you :).

Also, I apologize in advance for my ignorance and if this the wrong subreddit to post for advice.",,False,self,t5_2qp8q,False,,,True,t3_1ci6l0,http://www.reddit.com/r/SQL/comments/1ci6l0/novice_looking_for_sql_guidance/,
1365950427.0,3,self.SQL,1cbrfx,[MS SQL] How to calculate the nth root of a number,jgagnon_in_FL,3,0,2,http://www.reddit.com/r/SQL/comments/1cbrfx/ms_sql_how_to_calculate_the_nth_root_of_a_number/,"Example input = output

27^(-3) = 3

1.21550625^(-4) = 1.05 (5% interest compounded quarterly for 1 year)

14.974457839207^(-40) = 1.07 (7% interest compounded daily for 40 days)

I have played around with the POWER function to no avail

ETA: Given a return over a period, I am looking to calculate what the equivalent daily return should be.",,False,self,t5_2qp8q,1365950750.0,,,True,t3_1cbrfx,http://www.reddit.com/r/SQL/comments/1cbrfx/ms_sql_how_to_calculate_the_nth_root_of_a_number/,
1365945981.0,3,self.SQL,1cbo7s,"[MySQL] Trying to install, but failing at configuration",Henshin_A_JoJo,3,0,8,http://www.reddit.com/r/SQL/comments/1cbo7s/mysql_trying_to_install_but_failing_at/,"Hello all,

I'm trying to install MySQL for my database class. I accept terms, chose custom, click on what I need (server, client, workbench programs, no documentation or plugins etc), it installs, goes to configure and FAILS. This is the error I receive at configuration:




""Unable to connect to any of the specified MySQL hosts""




I have administrative privileges, firewall down. I've tried Google-fu-ing the problem, but it's all about database management within the client. All I want to do is run the command-line client, and may even start using the workbench...it's all I want to install...and I can't do ANYTHING because of this error.

Please /r/SQL ! Your my only hope!

Note: I realize this may be something really obvious and stupid, but i'm a beginner. Bare with me please",,False,self,t5_2qp8q,False,,,True,t3_1cbo7s,http://www.reddit.com/r/SQL/comments/1cbo7s/mysql_trying_to_install_but_failing_at/,
1365725379.0,3,self.SQL,1c67qs,[SQLiteman] Having some trouble with a basic query,Wockna,3,0,2,http://www.reddit.com/r/SQL/comments/1c67qs/sqliteman_having_some_trouble_with_a_basic_query/,"Ok so the query is to 'List the video id, video title of all videos that is stocked in only one format'. [VIDEO TABLE](http://i.imgur.com/Bb4hZKg.png) and the [VIDEO FORMAT TABLE](http://i.imgur.com/GVilKIe.png). I know this query has a pretty simple solution but it has been boggling my brain for the past few hours.

Help is appreciated, thankyou!",,False,self,t5_2qp8q,False,,,True,t3_1c67qs,http://www.reddit.com/r/SQL/comments/1c67qs/sqliteman_having_some_trouble_with_a_basic_query/,
1365684237.0,3,self.SQL,1c4q3l,[MS SQL] Inserting to multiple tables simulataneously and asp.net,qckslvr42,4,1,7,http://www.reddit.com/r/SQL/comments/1c4q3l/ms_sql_inserting_to_multiple_tables/,"Hello. Sorry, I know this has most likely been covered many many times, and I know there is a ton of information out there on stuff like this (because I've actually gone through most of it). But, I'm hoping for opinions on best practices as well as practical advice.

 

The basic premise is this: I've created a database to house all our keys for software. Even though it's going to be a pretty small database, I've decided to normalize to 3NF because, while I have a bit of experience with MySQL, I am doing this project so I can learn ASP.NET and SQL Server 2012. I've also never had a database in production, I've only ever done them in undergrad classes and instances needed for things like System Center (I have more sysadmin experience than DBA).


A basic overview of my tables, and is not complete:


**Publisher**

pub_id smallint PK identity    
pub_name varchar(50)    
pub_notes varchar(255)    

**Product**

pro_id smallint PK identity    
pub_id smallint FK      
pro_name varchar(50)    
pro_notes varchar(255)    




And so on, with a few bridge entities. [Here](https://dl.dropboxusercontent.com/u/3554092/SoftwareKeys.sql) is a script for my ddl if anyone is actually interested.


So, I first want to create an ASP.NET ""admin"" page with a combobox for Publisher, Product, Version, etc all the way down the line so a user can enter records in with dropdown or by typing in a new name if it doesn't exist. I figured I would create that first and actually populate my database using this method since it's so small. A button would fire a stored procedure that would then insert into publisher, select identity insert into product, select identity insert into version, etc. 


I see a lot of info online to use scope_identity, but that just grabs the last entry and has shown to grab the wrong identity at times. Another method is to use an output clause, but from what I'm understanding from the documentation, you can't use that in this scenario since I have an FK constraint on my identity column.


Any and all advice would be welcome. If you made it through all this text you have my thanks.


Edit: I have no clue why the formatting in this post is all messed up. 

",,False,self,t5_2qp8q,1365685119.0,,,True,t3_1c4q3l,http://www.reddit.com/r/SQL/comments/1c4q3l/ms_sql_inserting_to_multiple_tables/,
1365625205.0,3,self.SQL,1c341j,Getting a syntax error in the below good. (TSQL),e13ct,3,0,7,http://www.reddit.com/r/SQL/comments/1c341j/getting_a_syntax_error_in_the_below_good_tsql/,"I work for a small-ish university, and I am getting some strange errors on some TSql lines for an 08 instance. It is telling me that From has incorrect syntax near it, even then I am not sure the joins are correct to give me the information I want (Female Students that are registered). I have also double checked the column names, I have checked that the version of SqlServer can handle my join syntax (not 05 or 00 on any server) and I don't have any parenthes to misplace. &lt;All the things that Stackoverflow suggested.&gt; Any help?

    USE Enterprise_Test
    Go

    SET ANSI_NULLS ON GO
    SET QUOTED_IDENTIFIER ON GO
    SET ANSI_PADDING ON GO

    Select 
    Student1.FirstName, 
    Student1.MiddleInitial,  
    Student1.LastName, 
    Student1.StudentID, 
    Student1.StudentUID,
    StudentStatus.Campus,
    Demographics.StudentUID,
    Demographics.Gender, 
    StudentStatus.StudentUID,
    StudentStatus.StudentRegistered,
    StudentStatus.GPAGrouping,

    From Student as Student1 
	    Inner Join CAMS_StudentDemographics_View as Demographics
	    Inner Join CAMS_StudentStatus_View as StudentStatus
	    ON Student1.StudentUID=Demographics.StudentUID
	    Student1.StudentUID=StudentStatus.StudentUID
	   
 
    Where 
    Demographics.Gender = Female 
    and 
    StudentRegistered = YES 
    and 
    Campus = MAIN 


     Group by Student1.StudentID

Edit1: thanks to Konwayz for the extra comma after GPAGrouping. Win to you sir and/or madam. 

However, still throwing a syntax issue after ""Student as Student1"". Any thoughts?",,False,self,t5_2qp8q,1365626046.0,,,True,t3_1c341j,http://www.reddit.com/r/SQL/comments/1c341j/getting_a_syntax_error_in_the_below_good_tsql/,
1365563016.0,3,self.SQL,1c1e29,[MS SQL] GROUP BY issue column spaces,,4,1,4,http://www.reddit.com/r/SQL/comments/1c1e29/ms_sql_group_by_issue_column_spaces/,"Using SQL Express 2008 Windows Server 2008 R2

I am a novice at writing queries as I don't have to do it very often and when I do they are very simple but after spending a few hours trying to find a solution or workaround I have decided to ask for help from the pros.  
When using GROUP BY in my queries I normally have no issues as my queries are typically very simplistic in nature…that is until I had to deal with a table that has columns with spaces.  If I run my query on the SQL server in Management Studio it works just fine but if I use SQLCMD or access the data via PHP I keep getting the error ""Each GROUP BY expression must contain at least one column that is not an outer reference.""  I read up and tried to understand what this means but since the query works in Management Studio I don’t think I am doing anything wrong in my query (Please correct me if I am!).
For example, in this query GROUP BY works just great even if I use it through SQLCMD
    
    SELECT LastTemplateUsed as NAME, COUNT(*) [COUNT]
    FROM [DATA_Reports].[dbo].[Photo]
    GROUP BY LastTemplateUsed ORDER BY COUNT DESC

But this next query gives me the error I mentioned above if I use SQLCMD or PHP but works in Management Studio:

    SELECT ‘Branch ID’ as BRANCH, COUNT(*) [COUNT]
    FROM [DATA_Reports].[dbo].[Archival]
    GROUP BY ‘Branch ID’

If I remove the GROUP BY it works but obviously not as I would like it to.  As far as I can tell the only real difference here is the quotes I have to use because of the column name.  Something just isn’t working when I try to run this query remotely through sqlcmd.  I have tried double quotes just for grins but that doesn’t help.  
This is an example of how I run sqlcmd:

    ""C:\Program Files (x86)\Microsoft SQL Server\90\Tools\binn\sqlcmd” -U username -P password -S SERVERNAME\SQLEXPRESS -i count.sql -s "",""

Any help is appreciated!
",,False,self,t5_2qp8q,False,,,True,t3_1c1e29,http://www.reddit.com/r/SQL/comments/1c1e29/ms_sql_group_by_issue_column_spaces/,
1365408405.0,3,self.SQL,1bwn2d,How to do a conditional Sum by distinct id?,,3,0,19,http://www.reddit.com/r/SQL/comments/1bwn2d/how_to_do_a_conditional_sum_by_distinct_id/,"Suppose you have result set such as:

Items       |   OrderID  |   DeliveryFees

* ItemA     |       1       |       20   
* ItemB      |      1        |      20
* ItemC      |      2        |      20

I want to calculate the Sum of DeliveryFees grouped by Distinct OrderID. 
In the sql statement, the table that contains the Orders is called ""Orders"". I calculate the DeliveryFees from a joined table (called OrderFee) and I name the column ""DeliveryFees"". 


Now I need to calculate the Sum of ""DeliveryFees"" column by distinct OrderID. I want it to be a subquery inside the main query. The result should be 40.

I know it's a bit complicated and I can't explain it that well. But is there a way to make a conditional Sum based on a distinct ID?

Thanks in advance.
   
",,False,self,t5_2qp8q,1365408621.0,,,True,t3_1bwn2d,http://www.reddit.com/r/SQL/comments/1bwn2d/how_to_do_a_conditional_sum_by_distinct_id/,
1365014344.0,2,self.SQL,1blr6o,[MySQL] How do you join two tables using a third as an index?,guardianfx,4,2,6,http://www.reddit.com/r/SQL/comments/1blr6o/mysql_how_do_you_join_two_tables_using_a_third_as/,"I am trying to learn MySQL / PHP and I am attempting to set up a database for users and purchased products. I have 3 tables. 

    users
    * userid
    * fname
    * lname

    product
    * productid
    * title
    * price
    * description

    purchased
    * id
    * userid
    * productid

What I can't seem to figure out, is how to JOIN them so that I can select only the products that the user has purchased and display them. I have tried a couple of different things, but keep getting repeating tables which to me mean... not using the right kind of join....I think? Any help would be great. Been watching tutorials all day, can't quite get it right. 

EDIT: The query I have which I know is very wrong. 

    SELECT * FROM product
    JOIN purchased ON product.productid
    JOIN users ON purchased.userid
",,False,self,t5_2qp8q,1365015259.0,,,True,t3_1blr6o,http://www.reddit.com/r/SQL/comments/1blr6o/mysql_how_do_you_join_two_tables_using_a_third_as/,
1364308161.0,3,self.SQL,1b1j9r,Logic Death!,BLUNTYEYEDFOOL,4,1,11,http://www.reddit.com/r/SQL/comments/1b1j9r/logic_death/,"In my table, I have a column called ""opening_balance"" and all rows have 0 value for this column. Two other columns,  ""Movement"" and ""closing_balance"" have a range of values.

I want to exclude rows where all three are 0.

When I use this construct, I get zero rows back; NOTHING:    
AND		(  
		opening_balance &lt;&gt; 0 AND  
		movement &lt;&gt; 0 AND      
		closing_balance &lt;&gt; 0  
		)   
  
  
When I use this construct:  
AND		NOT (  
		opening_balance = 0 AND  
		movement = 0 AND   
		closing_balance = 0  
		)   
I get the right result, a few thousand rows.   

I can't explain this to myself, let alone my boss. Can anybody help?  ",,False,self,t5_2qp8q,False,,,True,t3_1b1j9r,http://www.reddit.com/r/SQL/comments/1b1j9r/logic_death/,
1364205942.0,3,self.SQL,1ayse2,"Management Studio Results to File, is it possible to not print the ""number of rows affected""",strama,4,1,5,http://www.reddit.com/r/SQL/comments/1ayse2/management_studio_results_to_file_is_it_possible/,"I have a looped query outputting a file. Can I set it on the options or config to NOT print ""number of rows affected"" into the file?",,False,self,t5_2qp8q,False,,,True,t3_1ayse2,http://www.reddit.com/r/SQL/comments/1ayse2/management_studio_results_to_file_is_it_possible/,
1361979943.0,3,self.SQL,19bxu0,Julian dates converting incorrectly when using TO_DATE,JCollierDavis,3,0,8,http://www.reddit.com/r/SQL/comments/19bxu0/julian_dates_converting_incorrectly_when_using_to/,"*edit:Working with an Oracle Db.*  I have the following piece of a query.

    TO_DATE(date_dol, 'YYDDD')

It finds 96130 and converts it to 5/9/2096 instead of 5/9/1996.  How can I force it to understand the correct year?

Have I discovered a Y2k bug 13 years late?",,False,self,t5_2qp8q,1361986104.0,,,True,t3_19bxu0,http://www.reddit.com/r/SQL/comments/19bxu0/julian_dates_converting_incorrectly_when_using_to/,
1361759043.0,3,self.SQL,19619y,"[MS SQL] Taking a databases/Access SQL class, exam coming up this week, I would appreciate any help on this practice problem!  (Aggregate function)",coll9947,6,3,8,http://www.reddit.com/r/SQL/comments/19619y/ms_sql_taking_a_databasesaccess_sql_class_exam/,"So here's my Table and attributes for this practice problem:

STUDENT  
stuid*  
stuname  
major  
credits  

The question is: Display all students (stuname) who have less than the average number of credits.

My idiot brain keeps wanting to:

SELECT stuname, AVG(credits)    
FROM student  
GROUP BY stuname  
HAVING AVG(credits) &gt; credits

This isn't returning correct results in my practice table in Access and I have no idea how to even approach this problem.

Any help would be greatly appreciated!  Thank you in advance!

*edited for formatting, fixed FROM statement as pointed out by woo545",,False,self,t5_2qp8q,1361760725.0,,,True,t3_19619y,http://www.reddit.com/r/SQL/comments/19619y/ms_sql_taking_a_databasesaccess_sql_class_exam/,
1361558984.0,3,self.SQL,1919x4,Calculate a column against itself.,yellising,5,2,6,http://www.reddit.com/r/SQL/comments/1919x4/calculate_a_column_against_itself/,"Sorry for the not so clear title, I can't really explain it any other way.

So I have a simple table with 2 columns.
AgentName and OVS.
Agentname is just the name of the agent and OVS is the score they receive from customers. OVS can only be 1 to 9.
To be counted as a good survey, OVS needs to be 8 or higher.
So I need to get the overall score of every agent where score=goodsurvey/totalsurvey

--how i get the count of goodsurvey

    select agentname, 
        count(ovs) as goodSurvey
    from tbl_qos
    where ovs &gt;= 8
    group by agentname

--how i get the count of totalsurvey per agent

    select agentname, 
        count(ovs) as totalSurvey
    from tbl_qos
    group by agentname


I'm thinking of using the 2 queries above as subqueries so I can calculate them against each other but I'm not really sure how. I'm kinda new to SQL. ",,False,self,t5_2qp8q,False,,,True,t3_1919x4,http://www.reddit.com/r/SQL/comments/1919x4/calculate_a_column_against_itself/,
1360375621.0,3,self.SQL,1864xk,[MySQL] Optimizing for huge tables,Fencepost,3,0,6,http://www.reddit.com/r/SQL/comments/1864xk/mysql_optimizing_for_huge_tables/,"I have an extremely large table that can't reasonably be split.
Here's a quick screenshot of the actual schema:

http://imgur.com/q8SOLbS

foreignKeys are implied by naming conventions in that screen cap

Now the dataset in ""runData"" contains close to 50Million rows.

When querying runData, I always have a WHERE clause that includes runId. This is because my data contains a large amount of redudancy in that column (1 unique runId per 2-5million rows).
Because of this, my original schema actually created a separate table for each runId and the runInfo table contained a field that was the table name. I refactored it to this schema because multiple tables seemed incredibly kludgy.

The problem is that some of my queries require simple search and that is incredibly painful on this table.
I'd like a way to tell MySQL that this table should be stored sorted on runId or something similar - ie tell it that this is essentially a bunch of separate tables.
I've tried adding an index (ind_on_runid) but it hasn't improved my performance much (and kinda degraded it but not by much). For example, the following query takes 47seconds with an index and 45 without:
    SELECT DISTINCT coordinateId FROM runData WHERE runData.runId=4;

What can I do? this is really multiple tables that share an identical schema, does MySQL support some kind of table partitioning based on a highly redundant column?
",,False,self,t5_2qp8q,False,,,True,t3_1864xk,http://www.reddit.com/r/SQL/comments/1864xk/mysql_optimizing_for_huge_tables/,
1359876863.0,3,self.SQL,17srev,[SQLITE] Convert MySQL to SQLite,rarisgod,4,1,13,http://www.reddit.com/r/SQL/comments/17srev/sqlite_convert_mysql_to_sqlite/,"I am currently using the database located [here](http://wing.comp.nus.edu.sg/SMSCorpus/) for a project. However, it is in MySQL format. I'm looking to get it into SQLite. I've searched and none of the methods (including [this script](https://gist.github.com/943776)) have worked for me, citing different errors which have had me remove the COMMENT lines from the original file, remove quotes where they aren't needed, etc. only to just end up with more errors.

Does anyone know of a clean, simpler way to go about this? I've linked to the site where you can get the file (though I didn't link DIRECTLY to the download page because for some reason it won't load for me today) so you can try it on your own if you feel like it.",,False,self,t5_2qp8q,False,,,True,t3_17srev,http://www.reddit.com/r/SQL/comments/17srev/sqlite_convert_mysql_to_sqlite/,
1359770905.0,3,self.SQL,17qdaz,[MS SQL] Can't log into server through mgmt studio,Liger86,4,1,3,http://www.reddit.com/r/SQL/comments/17qdaz/ms_sql_cant_log_into_server_through_mgmt_studio/,http://i.imgur.com/vYvpJYk.png does anyone know why this isn't working?,,False,self,t5_2qp8q,False,,,True,t3_17qdaz,http://www.reddit.com/r/SQL/comments/17qdaz/ms_sql_cant_log_into_server_through_mgmt_studio/,
1359602649.0,3,self.SQL,17luv3,Help with nested queries and multiple data sources (mySQL/msSQL),funky_mesopotamian,3,0,4,http://www.reddit.com/r/SQL/comments/17luv3/help_with_nested_queries_and_multiple_data/,"So I'm working on a little project and while I understand the big picture of what needs to be done, I've hit a wall.

I need to create a pass through query in MSAccess to query data in MySQL from two data sources.  While I know that nested queries are not the most efficient and there are likely better ways out there, for now nested queries are the way to go.  I have my ""inner-most"" query just fine, but the problems start when I attempt to nest it in a query that pulls from two data sources.  Here is what I have:

    **SELECT DISTINCT x1.PK,
                      tblPM.fieldMDPK, 
                      tblPM.fieldODPK, 
                      tblC.fieldC,
                      x1.fieldCC, 
                      x1.fieldFNK,
    FROM (tblPM INNER JOIN tblC 
    ON tblPM.fieldC = tblC.fieldC) 
    INNER JOIN**

    (SELECT tbl2.fieldPK,
                     tbl2.fieldCC, 
                     tbl2.fieldPT,
                     tbl2.fieldFNK,
                     tbl2.fieldM
    FROM tbl2
    AS mirror
    INNER JOIN tbl2 
    ON (tbl2.fieldM = mirror.fieldM) AND (tbl2.fieldFNK = mirror.fieldFNK) AND (tbl2.fieldPT = mirror.fieldPT) AND (tbl2.fieldCC = mirror.fieldCC)
    WHERE ((tbl2.fieldPK)&lt;&gt;(mirror.fieldPK)) AND ((tbl2.fieldCC)=102))
    AS x1;)

    **ON tblPM.fieldPK = x1.fieldPK);**

Bold is the outer query, regular text is the subquery.  When I execute I get a syntax error in that last bit 

    **(ON tblPM.fieldPK = x1.fieldPK);** 

but I can't figure out why.  I need to basically run the subquery and then have the outer query join that temporary table with 2 other tables to get my results.  From what I read on forums found through Googling, I think I have the nested Select statement correctly in the FROM clause, but I could be mistaken.

In addition, ""tbl2"" is on one data source and all others are on a second data source.  I know that this will be a problem even if I can get the nesting correct unless I insert an ODBC line (ODBC;DSN=xxx;Description=xxx on xxxx;UID=xxxxx;Trusted_Connection=Yes) but I don't know where to insert that command in the query, or in which query ""layer"" it should go.

Can anyone enlighten me?  I am very new to this and am learning by doing but I haven't been able to find an example of this online that has been helpful to me.  Can anyone out there help clear this up, or point me to a better source for figuring this out?

Edit: Formatting",,False,self,t5_2qp8q,1359643544.0,,,True,t3_17luv3,http://www.reddit.com/r/SQL/comments/17luv3/help_with_nested_queries_and_multiple_data/,
1359547904.0,3,self.SQL,17k2ta,[MS SQL] Help with stored procedure,jataja,4,1,5,http://www.reddit.com/r/SQL/comments/17k2ta/ms_sql_help_with_stored_procedure/,"Hello,

I'm stuck on these two stored procedure which are (at least I assume) similar. I have tables Tags and Products. One stored procedure receives string in format (Gaming, PC, Ubisoft), and search all tags with received parameters.
 Now I know I need to make comma separation and loop through each tag and select matching products in this case lets say Assassin's Creed and Assassin's Creed Brotherhood but I'm not very good with SQL queries and don't know how to write it.

Second is updating existing product, now also receiving tags and inserting those tags (which are in same format like first one) into table Tags for matching ProductID.
",,False,self,t5_2qp8q,False,,,True,t3_17k2ta,http://www.reddit.com/r/SQL/comments/17k2ta/ms_sql_help_with_stored_procedure/,
1359480985.0,3,self.SQL,17i7fj,translate an Access statement Iif into SQL select statement,randomperson24,3,0,16,http://www.reddit.com/r/SQL/comments/17i7fj/translate_an_access_statement_iif_into_sql_select/,"I’m trying to figure out how to translate an Access statement into SQl.  Below is iif’s statement which I cannot get to work in SQl.  I don’t believe I can use Case When because there is more than one column invovled.  Also when I change to the SQL view in Access, the syntax is the same and of couse does not work in SQL.  Any suggestions?

SELECT
IIf(Table1.”COLUMN1” Is Not Null,
Table1.”COLUMN1”,IIf(Table1.”COLUMN2” Is Not Null,
Table1.”COLUMN2”,
Table1.”COLUMN3”)) AS 'Source_ID'
FROM
Table1
",,False,self,t5_2qp8q,False,,,True,t3_17i7fj,http://www.reddit.com/r/SQL/comments/17i7fj/translate_an_access_statement_iif_into_sql_select/,
1359421629.0,3,self.SQL,17grrt,[MS SQL] Bubble up content,Dahey,3,0,9,http://www.reddit.com/r/SQL/comments/17grrt/ms_sql_bubble_up_content/,"I have the following data set

Source | ID | Property1 | Property 2 | Property3 | Property 4

1          | A1 | Null           | ABC           | Null          | Null

2          | A1 | XYZ           | Null            | AB1         | Null  

3          | A1 | Null           | Null            | OPQ        | Null


I have three data sources that have been merged into a single table. I want to create a new row in this table where content bubbles up per column.  Look at property 1, The only value not null is on source 2 so that is what we want on the new row. In property 2 the first row has the only value other than null so we want that on the new row.  On property 3 there are 2 values other than null so we want to select the one with the hightest source number. The end result should be a new row like this:


Source | ID | Property1 | Property 2 | Property3 | Property 4

4          | A1 | XYZ          | ABC            | OPQ          | Null

Any help or direction will be appreciated!

Thank you in advance!",,False,self,t5_2qp8q,False,,,True,t3_17grrt,http://www.reddit.com/r/SQL/comments/17grrt/ms_sql_bubble_up_content/,
1359295632.0,3,self.SQL,17d9wd,How to apply auto filter when opening management studio?,dalenn,5,2,4,http://www.reddit.com/r/SQL/comments/17d9wd/how_to_apply_auto_filter_when_opening_management/,"Hi, as sql developer on a third party system i would like to start the management studio with some filters on view, table's stored procedure and functions allready active.  

Is there a way to set this?

Thanks!",,False,self,t5_2qp8q,False,,,True,t3_17d9wd,http://www.reddit.com/r/SQL/comments/17d9wd/how_to_apply_auto_filter_when_opening_management/,
1358868549.0,3,self.SQL,1723na,Serious LAG with SQL queries for remote users,falconfox,3,0,6,http://www.reddit.com/r/SQL/comments/1723na/serious_lag_with_sql_queries_for_remote_users/,"Hi. I've been learning SQL for about 9 months now using Access. Just this week, I split my database into a frontend and a backend. The backend currently resides on my Synology NAS, and remote users VPN into the NAS and are able to connect to the backend database and perform tasks. The problem I have run into is that there is a significant lag when remote users perform Queries. 

I'm wondering if this problem is a network speed problem on my end, a bad query design, or related to using Access. I've briefly looked into SQL Server Express, thinking that this might be a solution.

My goal is to have a system where remote users have quick access to the database. In addition, I'd really like it if remote users were not forced to connect via VPN because I'd like the remote users to be able to use a proxy to hide their IP address. In other words, one of the jobs of the remote user is to query data regarding websites, then go to those websites while hiding their IP address.

I can answer any other questions or clarify goals/objectives if I've been unclear. ",,False,self,t5_2qp8q,False,,,True,t3_1723na,http://www.reddit.com/r/SQL/comments/1723na/serious_lag_with_sql_queries_for_remote_users/,
1358619858.0,3,self.SQL,16vw3m,Accessing  files quickly  from a storage drive.,pressthebuttonfrank,3,0,3,http://www.reddit.com/r/SQL/comments/16vw3m/accessing_files_quickly_from_a_storage_drive/,"I am looking for a way to access files lumped  into a storage drive.  Most are word,  pdf or excel.  Want to pull up complete files that contain certain words, i.e. ""damaged"", ""model number"", etc.  The files are now just randomly dumped on the drive with little directory structure. Any ideas?",,False,self,t5_2qp8q,False,,,True,t3_16vw3m,http://www.reddit.com/r/SQL/comments/16vw3m/accessing_files_quickly_from_a_storage_drive/,
1358281363.0,3,self.SQL,16myg1,Scripting a Primary Key doesn't work for some reason,macness234,4,1,6,http://www.reddit.com/r/SQL/comments/16myg1/scripting_a_primary_key_doesnt_work_for_some/,"I'm trying to move a primary key from one Database (SQL2000) to another database. In the original database I have a primary key that I've used SMMS to script this to a new query window:

    USE [DatabaseName_Test]
    GO
    
    ALTER TABLE [dbo].[tbl_itinerary_item] ADD  CONSTRAINT [PK_tbl_itinerary_item] PRIMARY KEY CLUSTERED 
    (
    	[activity_id] ASC
    )WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, SORT_IN_TEMPDB = OFF, IGNORE_DUP_KEY = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
    GO

All I did was change the database:



    USE [DatabaseName]
    GO
    
    ALTER TABLE [dbo].[tbl_itinerary_item] ADD  CONSTRAINT [PK_tbl_itinerary_item] PRIMARY KEY CLUSTERED 
    (
    	[activity_id] ASC
    )WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, SORT_IN_TEMPDB = OFF, IGNORE_DUP_KEY = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
    GO

The error I get is

Msg 170, Level 15, State 1, Line 5
Line 5: Incorrect syntax near '('.

What am I missing?",,False,self,t5_2qp8q,False,,,True,t3_16myg1,http://www.reddit.com/r/SQL/comments/16myg1/scripting_a_primary_key_doesnt_work_for_some/,
1357321928.0,3,self.SQL,15yknu,[MS SQL] Need help with query,tedistkrieg,3,0,9,http://www.reddit.com/r/SQL/comments/15yknu/ms_sql_need_help_with_query/,"I work for a casino and I am doing an aging report for the machines on the floor.  I am trying to determine what active machines started on the floor from 1999-2012.  

There are two tables. A machine table and period table. The machine table has all the information about the machines including start and enddates. However, if a machine is taken off the floor and then put on at a later date, the startdate changes.  Or if a machine is converted, the machine number changes as well and it begins a new startdate.  In order to find the physical machines you have to use the serial number rather than the machine number. 

The period table has the information for the coin-in and coin-out amounts for every time the machine was played from the very beginning. This table can be used to determine when the machine went on the floor for the first time.  But it will return numerous results for a single machine.

For example

    Select distinct(m.serialnum),m.status,p.date
        from Machine M left outer join period p on m.mnum=p.mnum
        where date between ('01-01-1999') and ('12-31-1999') and m.status='a'

that will return one machine the Sigma Derby

now when I run the query with dates between 01-01-2000 and 12-31-2000 it will return the machines that started in 2000, but will also return the Sigma Derby because it was played in 2000 as well.

Is there a way to run a query that will omit machines that had any play in 1999? Like Select machines where the date is between 01-01-2000 and 12-31-2000 but have no dates in 1999?
Hopefully I explained this well enough. ",,False,self,t5_2qp8q,1357323456.0,,,True,t3_15yknu,http://www.reddit.com/r/SQL/comments/15yknu/ms_sql_need_help_with_query/,
1357320902.0,3,self.SQL,15yjjs,Slow IN query changed to several quicker queries. How can I further make it faster or reduce number of queries?,hesterbest,5,2,16,http://www.reddit.com/r/SQL/comments/15yjjs/slow_in_query_changed_to_several_quicker_queries/,"The originating query was something like this:

&gt; SELECT id, COUNT(id) AS count FROM matches WHERE id IN (1, 2, 3,  ... , 99) GROUP BY id

The query was very slow so I changed it into:

&gt; CREATE TABLE tmp (
&gt; 	id VARCHAR(32)
&gt; );

&gt; INSERT INTO tmp (id) VALUES (1),(2),(3), ... (99)

&gt; SELECT matches.id, COUNT(matches.id) AS count FROM matches INNER JOIN tmp ON matches.id = tmp.id GROUP BY id;

&gt; DROP TABLE tmp;

This was a lot quicker, but I am curious to if there are ways to further improve this. For instance, is there a way to both create a table and insert the data in the same query?

I am using MySQL.",,False,self,t5_2qp8q,False,,,True,t3_15yjjs,http://www.reddit.com/r/SQL/comments/15yjjs/slow_in_query_changed_to_several_quicker_queries/,
1357048544.0,3,self.SQL,15rs2f,[MSSQL] Looking to insert a list into an existing table which auto-increments the primary key. Can't get it working.,n35,5,2,22,http://www.reddit.com/r/SQL/comments/15rs2f/mssql_looking_to_insert_a_list_into_an_existing/,"I am looking to insert a list formatted as follows:
'Name1',
'Name2',
'Name3' and so on.

Into an existing table tbl1, with primarykey ID and Name

I've tried using variations of while loop, and they all work if I use the variable(int i) I am looping over to insert, where I have come to a stop is when I want to run through my list and insert the Name1, name 2 etc. into the list.

Can anyone point me in the right direction here?

Clarification:

    SET ANSI_NULLS ON
    GO
    SET QUOTED_IDENTIFIER ON
    GO

    CREATE TABLE [dbo].[Artists](
    	[ArtistID] [int] IDENTITY(1,1) NOT NULL,
    	[ArtistName] [nvarchar](50) NULL,
     CONSTRAINT [PK_Artists] PRIMARY KEY CLUSTERED 
    ([ArtistID] ASC)
    WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON,  
    ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
    ) ON [PRIMARY]
    GO

I came up with this:

    declare @name str = List (name1, name2, name3, name4, name5, name6)
    declare @counter int
    	set @counter = 0
    	while @counter &lt; 5
    	begin
            set @counter = @counter + 1
            insert into Artists values (null, @name[@counter]);
        end

My problem is, I cant figure out how to set @name to be a list of strings, that contain the names.

",,False,self,t5_2qp8q,1357053946.0,,,True,t3_15rs2f,http://www.reddit.com/r/SQL/comments/15rs2f/mssql_looking_to_insert_a_list_into_an_existing/,
1356556577.0,3,self.SQL,15hg5v,SQL 2012 localdb debugging issue,sodakdave,3,0,4,http://www.reddit.com/r/SQL/comments/15hg5v/sql_2012_localdb_debugging_issue/,"I just switched to SQL Management Studio 2012 and really like the on-demand concept of the localdb instance. However I am having an issue trying to debug a query. When I attempt to start the debugger I get

""Unable to start T-SQL Debugging. Could not connect to the computer '(localdb)'. The debugger cannot connect to the remote computer. This may be because the remote computer does not exist or a firewall may be preventing communication to the remote computer.""

This is confusing since this is a local instance of (localdb). I am on the same computer. Windows firewall is turned off, I have complete admin rights to the database in question, I'm running SSMS under administrative privileges... I just don't understand. It's not a remote machine, it's my computer.

Has anyone seen this?",,False,self,t5_2qp8q,False,,,True,t3_15hg5v,http://www.reddit.com/r/SQL/comments/15hg5v/sql_2012_localdb_debugging_issue/,
1356101260.0,2,self.SQL,15888h,[FilemakerSQL],liltbrockie,4,2,2,http://www.reddit.com/r/SQL/comments/15888h/filemakersql/,"Hi can someone help with this SQL query please? I am trying to retrieve a list of matching addresses based on what the user enters:

 

ExecuteSQL ( ""

 

SELECT UPPER(addressid)

 

FROM AddressSurname

 

WHERE

 

UPPER(surname) LIKE  ? and

UPPER(firstname) LIKE ? and

UPPER(postcode) LIKE ?

""   

 

    ; """" ; """"; 

Upper(Enquiries::Surname&amp;""%"");

Upper(Enquiries::Firstname&amp;""%"");

Upper(Enquiries::Postcode&amp;""%"")         )

 

The above code kind of works but it does not account for fields that are NULL

The problem being if I enter in ""Smith"" for the surname I ONLY get results if there is date in the firstname field (which there often isnt)",,False,self,t5_2qp8q,False,,,True,t3_15888h,http://www.reddit.com/r/SQL/comments/15888h/filemakersql/,
1355829160.0,3,self.SQL,151pum,[MYSQL] Interlaced Select Problem,sour_soup,3,0,7,http://www.reddit.com/r/SQL/comments/151pum/mysql_interlaced_select_problem/,"Hey!
I have 2 Tables:

-----------

1: Comments

comment_id, wine_id, comment,..

----------

2: wine

wine_id, active (1 or 0), ...

----------

Obviously the two wine_ids interact with each other.

I need a SELECT where I get the 10 most common wine_id's in comments WHERE active in table 'wine' = 1.

That's what I have so far:

    mysql_query(""SELECT wine_id, COUNT( * ) Number
											FROM comments a
											WHERE wine_id IN 
												(SELECT wine_id FROM wine WHERE active='1')
											GROUP BY wine_id
											HAVING NOT 
											EXISTS (

											SELECT * 
											FROM comments b
											WHERE b.wine_id = a.wine_id
											AND WHERE wine_id IN 
												(SELECT wine_id FROM wine WHERE active='1')
											GROUP BY b.wine_id
											HAVING COUNT( b.wine_id ) &gt; COUNT( a.wine_id )
											)
											ORDER BY Number DESC 
											LIMIT 0 , 10"");

I need some adivice please :)

Edit: I'm not very skilled in SQL, this code is copied and edited. ",,False,self,t5_2qp8q,1355829408.0,,,True,t3_151pum,http://www.reddit.com/r/SQL/comments/151pum/mysql_interlaced_select_problem/,
1355181697.0,3,self.SQL,14mr89,Production db access: Any authoritative sources?,SupportLackey,3,0,19,http://www.reddit.com/r/SQL/comments/14mr89/production_db_access_any_authoritative_sources/,"Without going too much into the background here, I work as a support technician providing level two support for multiple websites, with a collective userbase slightly in excess of a million or so users. My company does not develop the site content, but rather develops the functional backbone for a particular kind of cross-industry website.

Strictly speaking, we don't have anyone who actually holds the title of DBA. From the clients' perspective, a handful of support team members are generally accepted to be the system administrators. We compile custom reports as needed, perform initial investigation and potential diagnosis of time-sensitive client admin issues, and are generally expected to go far beyond the duties of Level 1 support.

Sometime earlier this year, a decision was made at the upper levels of the company to remove all Support team access to all production databases, and grant production access exclusively to the developers. This has had a severely detrimental effect on Level 2 support items: Issues which would normally take less than 10 minutes now require a minimum of 24 hours as the request is rephrased for the developers, then assigned to one of the (overseas) developers. If the developer doesn't ignore instructions in the request, or overlook file attachments, it might be completed the following day. Otherwise, it's another cycle before the clarification can be sent and received.

I know this isn't normal. I know it's generally seen as the exact opposite of how things should be done. I can link my employer to hundreds of articles on the subject, hammering home the point over and over again. Unfortunately, any assertions that this is anything other than the natural order have been met with comments to the effect of ""Well, that's just your opinion,"" or ""That's just something some random guy posted on the internet."" I need something authoritative.

So, to summarize:

    select Suggestion, Solution from Ideas
    where Problem like '%production access%'
    and Problem like '%developer%'
    and Authority in ('respectable', 'certified', 'best practice')
    order by Effectiveness desc",,False,self,t5_2qp8q,False,,,True,t3_14mr89,http://www.reddit.com/r/SQL/comments/14mr89/production_db_access_any_authoritative_sources/,
1354918921.0,3,self.SQL,14gund,Multi-DBMS IDE/Developer Tool,CubedCodeMonkey,4,1,2,http://www.reddit.com/r/SQL/comments/14gund/multidbms_idedeveloper_tool/,"I'm on the search for a new IDE/Developer Tool, and I'm hoping you fine folks might have some recommendations.  I primarily work with Oracle and MSSQL using a tool called [Aqua Data Studio](http://www.aquafold.com/aquadatastudio.html), and previously when I worked only with Oracle, I used [Toad](http://www.quest.com/toad-for-oracle/) and [Oracle SQL Developer](http://www.oracle.com/technetwork/developer-tools/sql-developer/overview/index.html).

I often use SSMS, however I prefer the flexibility of having one tool that can have multiple, simultaneous DBMS connections from a convenience standpoint.  I have been quite pleased with Aqua Data Studio until recently - after updating to version 12.0.6, I have started to see some choppy and sluggish behavior in the tool.  My work machine is a VDI, so I'm thinking there's some sort of conflict between the new version of the tool and our virtual environment.

A combination of this and my seemingly neverending desire to try out new (to me), fancy toys has led me here with this question:

What are some multi-DBMS IDEs/developer tools that you use or would recommend?",,False,self,t5_2qp8q,False,,,True,t3_14gund,http://www.reddit.com/r/SQL/comments/14gund/multidbms_idedeveloper_tool/,
1354590737.0,3,self.SQL,148okg,[MySQL]Schema for a board game website,matty348,3,0,9,http://www.reddit.com/r/SQL/comments/148okg/mysqlschema_for_a_board_game_website/,"My friends and I play quite a few board games and we decided it would be neat to have a database to track our stats. I have come up with a somewhat workable schema but it definitely isn't fully normalized and has scalability problems. 

Here are the requirements that we are looking at:

* Each game may have different things that we would like to track. Some we may want to track points, who was what character, number of ships left, etc.
* We want to track each game what the name is when we got it, etc.
* some stats about each player, name when they started playing with us, wins, etc.
* stats about individual play such as the date it occurred, how long it took, who was there, etc.


What I have come up with is workable but I think I could do better:

* A table for the player that tracks name etc.
* A table for plays that records basic info about each play
* A table for each game that has different columns based on what we are tracking. Each row in these tables corresponds to a user play a single session of a game (So the primary key of this table is a composite primary key that corresponds to the plays and players tables).


Now this structure leads to the need for a new table for each game which seems terrible but I'm having a hard time figuring out a better way of doing this? Is there some other way of doing this or a technology that would be more suitable?

",,False,self,t5_2qp8q,False,,,True,t3_148okg,http://www.reddit.com/r/SQL/comments/148okg/mysqlschema_for_a_board_game_website/,
1354057346.0,3,self.SQL,13wejq,SQL multi-column display,cozzbp,3,0,12,http://www.reddit.com/r/SQL/comments/13wejq/sql_multicolumn_display/,"I'm not sure how to achieve what I want in SQL, so I will post some pictures.  I have a table that looks like [so](http://i.imgur.com/Bpg7G.png)  
And want it to look like [this](http://i.imgur.com/l9UCe.png) 

The assignments (exam 1 and HW 1) are dynamic and many can be added.  I just want to be able to display it with the name of the assignment as a column.  Is there a way to do this?  Thanks.

EDIT: Missed the [MySQL]",,False,self,t5_2qp8q,1354057853.0,,,True,t3_13wejq,http://www.reddit.com/r/SQL/comments/13wejq/sql_multicolumn_display/,
1353954387.0,3,self.SQL,13tnq7,Custom card deck distribution,Sotall,4,1,10,http://www.reddit.com/r/SQL/comments/13tnq7/custom_card_deck_distribution/,"Hello /r/SQL! 

Ive got an interesting problem for you - Didnt know if i should post here or in r/boardgamedesign, but SQL seems like a handy tool for this sort of set-based problem, so that is what I have been working in. 

So, Say you have a deck of cards.  Each card has 3 different continents listed on it, like so:

	Africa	Europe	Australia
	Africa	North America	Europe
    Russia	Australia	Asia
	...
	
and so on.  I am trying to develop a deck of cards like so where: 

1. Total deck size between 40 and 60 cards, 
2. Each card contains a distinct set of 3 continents(there are 210 distinct sets),
3. Each continent appears exactly the same amount as every other continent in the deck(so exactly 12 cards have africa, 12 cards have asia, etc),
4. All two-country pairs appear exactly the same amount of times(so only 4 cards have both Asia and Africa, only 4 cards have both North America and South America, etc)


I probably could build this out of trial and error, but I am sure there is a slick way to figure this out in SQL. 

Below is some code to start with - it simply lists all of the distinct sets of three continents:


    SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED  
    
    IF OBJECT_ID('tempdb..#tmp1') IS NOT NULL DROP TABLE #tmp1  
    create table #tmp1
    (
    n varchar(20) 
    )
    
    insert into #tmp1
    select 'Africa'
    insert into #tmp1
    select 'Australia'
    insert into #tmp1
    select 'North America'
    insert into #tmp1
    select 'South America'
    insert into #tmp1
    select 'Europe'
    insert into #tmp1
    select 'Antarctica'
    insert into #tmp1
    select 'Asia'
    
    select 
      row_number() over (order by a.n , b.n , c.n) rownum
    , a.n one
    , b.n two
    , c.n three 
    from #tmp1 a
    join #tmp1 b
    on a.n &lt;&gt; b.n
    join #tmp1 c
    on c.n &lt;&gt; b.n and c.n &lt;&gt; a.n
    
    
    

	",,False,self,t5_2qp8q,False,,,True,t3_13tnq7,http://www.reddit.com/r/SQL/comments/13tnq7/custom_card_deck_distribution/,
1353812396.0,3,self.SQL,13qr85,[DB2] Need Help with complex SQL for Logistics/Finance Database Extraction.  ,normanj,4,1,11,http://www.reddit.com/r/SQL/comments/13qr85/db2_need_help_with_complex_sql_for/,"Hi, 

Apologies for the long post but I want to try and give across as much info as possible. 

My SQL skills have been stretched and looking for assistance in writing an efficient SQL to extract data from a logistics/finance database. 

It's a relatively large database with thousands of financial transactions going through daily. I have been tasked to write a report that links the financial transaction back to the originating task. For example, someone receipts an asset into a store, the stock on hand is increased and a financial transaction is generated to recognize that asset. Essentially a Task creates Movements which in turn generates  Financial Transactions. 

This may sound simple, but to trace from the financial transaction to the originating task requires to go through 4 tables with varying duplication of linking fields. 

Essentially, I want to return all records in the Transactions table and only matching TASK_TYPE from the Movement_Task table where available (left outer joins) and with no duplication of records.  To get the TASK_TYPE, you must go through the Transaction_Movement and Movement table. 

I have put together some dummy data in the following spreadsheet that illustrates the content of each of the tables and the desired output:
https://dl.dropbox.com/u/432284/JournalsToTask_Example.xlsx

**Transactions**

 * TRAN_ID
 * ACCOUNT
 * AMOUNT
 * ASSET

**Transactions_Movement**

 * TRAN_ID
 * MOVEMENT_ID

**Movement**

 * MOVEMENT_ID
 * TASK_ID
 * MOVEMENT_TYPE
 * MOVEMENT_QTY

**Movement_Task**

 * TASK_ID
 * TASK_TYPE

This is on DB2 database and using QMF v8 to write the SQL. 

I have tried to do this using nested IN statements with SELECT DISTINCTS, however the query runs extremely slow and generally times out. 

Any help or ideas would be greatly appreciated!

Thanks in advance",,False,self,t5_2qp8q,1353812579.0,,,True,t3_13qr85,http://www.reddit.com/r/SQL/comments/13qr85/db2_need_help_with_complex_sql_for/,
1353719471.0,2,self.SQL,13oyqv,"[Oracle] Coding the DESCRIBE command (homework help, complete newbie!)",Kevspace2,4,2,3,http://www.reddit.com/r/SQL/comments/13oyqv/oracle_coding_the_describe_command_homework_help/,"Hi guys,

I've read some posts and gotten some help and insight into SQL. I'm doing some extremely basic work with Oracle SQL (this is only my second assignment). 

The assignment reads:

Write a script that provides all of the information in, and duplicates the formatting of, Oracle's SQL*Plus describe command. Additionally, the output should add the comments on the rows. Input: owner and table name. Output: columns for Name, Null?, Type, Comments.

I'm lost. I spent hours upon hours looking into different sites for information and I'm just lost. I emailed the Prof and he wrote back 

&gt;Have you run the describe command yet? Step 1 is to find out what it outputs. 
&gt;At an sql prompt run describe STUDENT; or whatever you have a table named.
&gt;Then start querying data dictionary views like dba_tab_columns, dba_tables, dba_col_comments, &gt;dba_tab_comments, dba_views to find out what views or tables have that information available. 
&gt;Then write one query that joins some of those views together and prompts on owner name 
&gt;and table name to allow you to lookup the information displayed in describe through a prompted query &gt;instead.

I still feel lost. This is a state school online class and my in class assets are emails with my Prof and our textbook. The text doesn't help me too much! I've searched YouTube and around the net and I am not finding much. I watched some videos and read in the book, so I get the idea that the data dictionary is metadata..about my data. Obviously I'll need a table in my database. Do I have to have data in that table to run this command as he's asking? And I'm not asking for someone to do my whole assignment, just help me along the way if possible. I think once I understand how to query the data dictionary like I'm being asked to, I can wrap my head around this. 

Thank you for any help or direction you can give me!",,False,self,t5_2qp8q,False,,,True,t3_13oyqv,http://www.reddit.com/r/SQL/comments/13oyqv/oracle_coding_the_describe_command_homework_help/,
1353307672.0,3,self.SQL,13fuox,Does ANSI-SQL offers table lock syntax?,Wimea,4,1,3,http://www.reddit.com/r/SQL/comments/13fuox/does_ansisql_offers_table_lock_syntax/,"i.e is it possible to perform an operation on a table and gain an exclusive lock on it using plain ansi-sql.

There's the goold old ANSI-SQL definition document from 1992, but I couldn't find it there.
http://www.contrib.andrew.cmu.edu/~shadow/sql/sql1992.txt
",,False,self,t5_2qp8q,False,,,True,t3_13fuox,http://www.reddit.com/r/SQL/comments/13fuox/does_ansisql_offers_table_lock_syntax/,
1353165041.0,3,self.SQL,13cps6,[Oracle] Relatively simple problem: function won't return -1 ,rknDA1337,5,2,7,http://www.reddit.com/r/SQL/comments/13cps6/oracle_relatively_simple_problem_function_wont/,"My function:

http://pastebin.com/dsq6Qyvj

Excuse the Swedish; I realize it makes it harder to understand what the function is supposed to do, it's an assignment from my teacher.

The function gets a number and a date, and checks them against a table and if they exist, return the value of the column ""ränta"".


It works fine if the number and date exists, but if they don't, it doesn't return anything, but it's supposed to return ""-1"", because of this part:

http://pastebin.com/pSMpTttz

What am I doing wrong?",,False,self,t5_2qp8q,False,,,True,t3_13cps6,http://www.reddit.com/r/SQL/comments/13cps6/oracle_relatively_simple_problem_function_wont/,
1353090942.0,3,self.SQL,13b6v9,"r/SQL, please help with arbitrary file extract in Access.",Jack97,3,0,12,http://www.reddit.com/r/SQL/comments/13b6v9/rsql_please_help_with_arbitrary_file_extract_in/,"I'm working between multiple Access files, moving particular data from one to the other. However, I need to prompt the user to choose which file data needs to be extracted from. 
Example: 
    FROM table IN {*path* | [""*path*"" ""*type*""] | ["""" [*type*; DATABASE = *path*]]}
Is there a way to, instead of writing a specific path here, prompt the user with a dropdown menu to choose the other Access file (from My Computer or wherever)?",,False,self,t5_2qp8q,False,,,True,t3_13b6v9,http://www.reddit.com/r/SQL/comments/13b6v9/rsql_please_help_with_arbitrary_file_extract_in/,
1352929461.0,3,self.SQL,137bl0,Help with Event Log filtering,mattmurphy,4,1,4,http://www.reddit.com/r/SQL/comments/137bl0/help_with_event_log_filtering/,"I have 2 tables; one is full of windows event log events and the other is exclusions. My company is trying to figure out which events we want to monitor and which ones we want excluded. Currently we are making an ""included"" list also and excluding any events in that list from our query (so we know we've already reviewed those)

I have been trying to figure out the best way to make this query and have been having trouble wrapping my head around it. I am pretty new to writing SQL code so I could really use some help!

I didn't really know where/how to post these tables, so I have dropbox links to CSV files:

[Events](https://www.dropbox.com/s/9nkk3g1o9mse347/events.csv) - table (actually a view) is called vNtEventLog

[Exclusions](https://www.dropbox.com/s/e3xk4tj0hce2fzs/exclusions.csv) - table is called EventSetDef

Would someone be able to help me with a query to return only events that do not match a row in the exclusions list? I've been stumped and none of my code has worked very well at all, but here's some code my coworker wrote. I do not think this is the right approach and it seems really inefficient and I'm not sure it's even accurate

    SELECT 
    DISTINCT 
        (SELECT DISTINCT TOP 1 ApplicationName FROM dbo.vNtEventLog a WHERE a.agentGuid=b.agentguid AND a.machine_groupid=b.machine_groupid) AS applicationname
        , (SELECT DISTINCT TOP 1 eventId FROM dbo.vNtEventLog a WHERE a.agentGuid=b.agentguid AND a.machine_groupid=b.machine_groupid) AS eventid
        , (SELECT DISTINCT TOP 1 EventMessage FROM dbo.vNtEventLog a WHERE a.agentGuid=b.agentguid AND a.machine_groupid=b.machine_groupid) AS eventmessage
        ,b.Machine_GroupID
    FROM dbo.eventSetDef AS a INNER JOIN dbo.vNtEventLog AS b 
        ON a.SOURCE LIKE b.applicationname
            AND b.EventMessage LIKE a.description
            AND b.eventId LIKE REPLACE(a.eventId,'-1','%')
    WHERE b.logType = 1380569194
        AND b.eventType = 1 AND a.eventSetId IN (57068342, 32226495)
        AND a.SOURCE like b.applicationname
        AND b.EventMessage LIKE a.description
        AND b.eventId LIKE REPLACE(a.eventId,'-1','%')
    GROUP BY b.Machine_GroupID,b.ApplicationName,b.eventid, b.EventMessage, b.agentGuid


I hope I posted this correctly! I really appreciate any help people can offer. Thanks!

Edit: Sorry - I forgot to put [MS SQL] at the top!",,False,self,t5_2qp8q,1352929943.0,,,True,t3_137bl0,http://www.reddit.com/r/SQL/comments/137bl0/help_with_event_log_filtering/,
1352833728.0,2,self.SQL,134wi4,[MS SQL] Multi-File Output with SQLCMD,clegmir,3,1,4,http://www.reddit.com/r/SQL/comments/134wi4/ms_sql_multifile_output_with_sqlcmd/,"I've written a small script for extracting data into a CSV, and I'm currently executing it with [sqlcmd](http://msdn.microsoft.com/en-us/library/ms162773.aspx). I'd like to route errors/status messages to a separate file using the -r{0|1} switch (or something similar), but the note in the MSDN entry claims that it has no effect when the -o switch is used.

Is there any way that you know of to write a log file independently of the output file in a case such as this? I'd like to avoid having to write a program to wrap around this, if I can. :(

Thanks!

(And sorry if this isn't the right subreddit for this question)",,False,self,t5_2qp8q,False,,,True,t3_134wi4,http://www.reddit.com/r/SQL/comments/134wi4/ms_sql_multifile_output_with_sqlcmd/,
1352214002.0,3,self.SQL,12qbqt,"I'm interviewing for a MS SQL supervisor job soon, and I'm looking for a few tips.",AthlonRob,3,0,3,http://www.reddit.com/r/SQL/comments/12qbqt/im_interviewing_for_a_ms_sql_supervisor_job_soon/,"I have 15 years experience in IT, spending time in desktop support, network engineer, windows systems admin, dot net programming (VB, C#, ASP, etc), entry level MS SQL, web development, etc. Basically, I've done a lot of different things that I think have prepared me well for this role.  

My question to you is, my experience in SQL has been supporting an ERP system (MS Dynamics) and was entry level in nature. Are there some core concepts in enterprise level SQL administration I should familiarize myself with before I interview, so I can speak semi intelligently about them?  

Thank you!",,False,self,t5_2qp8q,False,,,True,t3_12qbqt,http://www.reddit.com/r/SQL/comments/12qbqt/im_interviewing_for_a_ms_sql_supervisor_job_soon/,
1352136731.0,5,self.SQL,12oco6,"If I want to compare column A and column B, but I only want the column A values which are NOT present in column B from table 1.  What is the best way to go about this?",randomperson24,7,2,11,http://www.reddit.com/r/SQL/comments/12oco6/if_i_want_to_compare_column_a_and_column_b_but_i/,,,False,self,t5_2qp8q,False,,,True,t3_12oco6,http://www.reddit.com/r/SQL/comments/12oco6/if_i_want_to_compare_column_a_and_column_b_but_i/,
1351177930.0,3,self.SQL,122h4k,[SQL via MS Access] Help writing query please.,Fritz_X,5,2,7,http://www.reddit.com/r/SQL/comments/122h4k/sql_via_ms_access_help_writing_query_please/,"I apologize for my novice question but I am hoping to have a little help so that I can modify the response to this question for other similar queries.  
  
I have several tables which I am trying to query from. The exact use-case is:  
  
I want to be able to run a query for subjects (subjects.id) who have an mri scan (scans.id, scans.subject.id) which are anatomical in type (scans.scan_type_id='1') and have alzheimer's disease (population_roster.population_id='12')  
  
So the total tables I am referencing for this query are: subjects, scans, population_roster.  
  
What I have which doesn't work is this:  
  
    SELECT scans.scan_date, subjects.first_name, subjects.last_name, subjects.mrn, subjects.date_of_birth,
        population_roster.population_id
  
    FROM scans, subjects, population_roster
  
    WHERE scans.subject_id=subjects.id AND population_roster.subject_id=subjects.id AND
        population_roster.population_id='12' AND scans.scan_type_id='1'
  
    ORDER BY subjects.last_name, subjects.first_name;  
  
  
**EDIT**

**Got the query working! You folks are quick! Thanks so much :-)**",,False,self,t5_2qp8q,1351184661.0,,,True,t3_122h4k,http://www.reddit.com/r/SQL/comments/122h4k/sql_via_ms_access_help_writing_query_please/,
1351120217.0,3,self.SQL,1218ez,Help with a replace command,whoisearth,6,3,4,http://www.reddit.com/r/SQL/comments/1218ez/help_with_a_replace_command/,"Help no longer required.  I figured out how to do it in a hack method.  Instead of doing both at the same time I just did one at a time.

    select table1.column1, table1.column2, table1.column3, table2.column1 , table2.column2
    , replace (table2.column1,'badtext','goodtext')
    , replace (table2.column2,'badtext','goodtext') 
    from table1
    join table2
    on table2.column3 = table1.column3
    and table1.column4 = 'Y'
    and (
    	table2.column1 like '%badtext%'
    or	table2.column2 like '%badtext%'
    	)
    and table1.column5 != 'X'

Basically what I want to do is replace a single word from wherever it's found in 2 different columns when matching the criteria of a shared column between 2 different tables.

I'm guessing we shouldn't be doing a replace but an update.  any ideas?

edit and sorry forgot the post that this is MS SQL v2008",,False,self,t5_2qp8q,1351128194.0,,,True,t3_1218ez,http://www.reddit.com/r/SQL/comments/1218ez/help_with_a_replace_command/,
1349381355.0,3,self.SQL,10ycoz,[Oracle] SQL Script to validate two databases,i3orn2kill,3,0,2,http://www.reddit.com/r/SQL/comments/10ycoz/oracle_sql_script_to_validate_two_databases/,"I've been tasked with writing a script to validate data that is being downloaded from one database (db1) to another (db2) during a nightly download by a 3rd party. 

db1 is normalized while db2 is not. The data should be 1 to 1 and my company wants me to prove that because the information is critical and has to be correct. 

I have never done this sort of thing and have never used Oracle before (MSSQL is what I normally use) so I wonder:

What is the best approach/ best practices code wise/documentation wise?

What should I be aware of using Oracle?

 I would consider myself a little more advanced than Junior but I've only been doing SQL development for a few years. So anything else you might be able to think of would be a big help.
 ",,False,self,t5_2qp8q,False,,,True,t3_10ycoz,http://www.reddit.com/r/SQL/comments/10ycoz/oracle_sql_script_to_validate_two_databases/,
1348689713.0,3,self.SQL,10iv79,[MySQL] Dell Kace Help,RaptorF22,4,1,11,http://www.reddit.com/r/SQL/comments/10iv79/mysql_dell_kace_help/,"Please forgive me as I'm trying to teach myself how to edit these (as I know very little about SQL). How would I edit this to display the deployment count for 3 specific pieces of software? Here is Kace's sample report that does this, but for all programs on all machines.

    Select 
    PUBLISHER, DISPLAY_NAME, COUNT(DISPLAY_NAME) as Deployment_Count  from (SOFTWARE, MACHINE_SOFTWARE_JT)  
    where SOFTWARE.ID = MACHINE_SOFTWARE_JT.SOFTWARE_ID 
    and not IS_PATCH 
    GROUP BY DISPLAY_NAME order by DISPLAY_NAME
I want to be able to refine this to display the deployment count for just those 3 peices of software (Visio, Office, and Project).
Thanks.",,False,self,t5_2qp8q,False,,,True,t3_10iv79,http://www.reddit.com/r/SQL/comments/10iv79/mysql_dell_kace_help/,
1348614971.0,3,self.SQL,10h6cp,[Oracle] Group By Logic,oraclenoob,3,0,8,http://www.reddit.com/r/SQL/comments/10h6cp/oracle_group_by_logic/,"I've been working on this script the past few days, and I've hit a mental block.  I'm trying to find the rows that contains the most recent price, for each item by using max(dateactive)  

.  
When I group by INVIID only, it appears I get the right amount of results (no duplicates.)  But my main goal here is to come up with a list of INVRENTALIIDs, so I can run a update command on the results.  
.  

If I group by INVRENTALIID, I get too many results because its no longer grouped by product.  I tried some lengthy inner joins, left joins, just tring anything to append the INVRENTALIID to existing result sets, but it breaks my grouping.    
  
  
So my logic must be wrong, I'm hitting this from the wrong angle.   
If the data below was my table, ideally my result set would be:       
         
             INVRENTALIID  
             000521  
             000729  

INVRENTALIID is the primary key.  
INVIID is the product ID (identifies what I'm selling.)  

 
    invrentaliid  inviid  dateactive  price  
    000521        P00023   09/21/2012  25
    000622        P00023   09/10/2012  20
    000729        P00152   09/02/2012  50
   .  

    SELECT inviid, max(dmax) from (
    
       SELECT inviid, invrentaliid, MAX(dateactive) as dmax   
       
       FROM invrentalprice
    
       WHERE rentalunit = 1
    
       AND inviid in 
    
         (select inviid from invmaster where maingroup='AUDIO')
    
       GROUP BY inviid, invrentaliid) A
    
    GROUP BY inviid",,False,self,t5_2qp8q,False,,,True,t3_10h6cp,http://www.reddit.com/r/SQL/comments/10h6cp/oracle_group_by_logic/,
1347331100.0,3,self.SQL,zosb5,MS Access Help,Cyllindra,5,2,20,http://www.reddit.com/r/SQL/comments/zosb5/ms_access_help/,"So I have a gradebook database I am working on.  I want to write a query (or a few queries) that will look at the scores students have for a given concept and then determine the grade for the concept.

The grading system works like this: each time you test on a concept, you get a score of 0 to 4.  If you do a homework assignment for that concept (and you have less than 3), then your score goes up by 1.  If you get a 4 two times in a row, then your Grade will be a 5.  Otherwise, your Grade is the best score (homework bonus included) you have gotten so far.  [If this is confusing, let me know, and I will explain better).

Thusfar, I have:


    INSERT INTO tblGrades ( StudentID, UnitConceptID, Grade )
    SELECT tblConceptChecks.StudentID, tblConceptChecks.UnitConceptID, Score+1 AS Expr1
    FROM tblConceptChecks
        INNER JOIN tblHomework ON (tblConceptChecks.StudentID=tblHomework.StudentID)
        AND (tblConceptChecks.UnitConceptID=tblHomework.UnitConceptID)
    WHERE ((tblConceptChecks.Score)&lt;3) AND ((tblHomework.Completed)=1);

This code checks if the student has a score less than 3, and if they have done the homework.  If so, they get that score +1.

The problem is that it includes every score the student has gotten, where I just want the highest score for that concept.  In the WHERE command, I tried adding in

    (tblConceptChecks.Score) = (max(tblConceptChecks.Score))

But that did not work.

Thanks in Advance for your ideas.

-----------

Update:  I can input everything (kind of) now, but to get the 5's, it is kind of ghetto.

How do you check for the most recent date (this would be a fix if I add OldScore as a field containing the last score they got)?  Can I just subtract the current date from the date in the cell and then use the min?  How can I see if two scores are next to each other (date-wise).  Already appreciate the help people have thrown out there.",,False,self,t5_2qp8q,1347575364.0,,,True,t3_zosb5,http://www.reddit.com/r/SQL/comments/zosb5/ms_access_help/,
1347316573.0,2,self.SQL,zod7u,[MS SQL] Need to relearn SQL by Friday...,pole7979,4,2,8,http://www.reddit.com/r/SQL/comments/zod7u/ms_sql_need_to_relearn_sql_by_friday/,"Hello fellow redditors.  So I'm here to ask for assistance in relearning SQL by Friday.  Reason being is I will be having an SQL assessment test on said day for a BI analyst job.  Now I've used SQL based systems in my career but haven't had to really type out the code since classes I've taken in undergrad 5 years ago.  So I'd like to ask if any of you have taken an SQL assessment before?  If so what sort of questions were asked?  And in general for everybody how should I go about this week in studying?

Thanks ahead of time!",,False,self,t5_2qp8q,False,,,True,t3_zod7u,http://www.reddit.com/r/SQL/comments/zod7u/ms_sql_need_to_relearn_sql_by_friday/,
1346160445.0,3,self.SQL,yykfa,I need help installing SQL 2012.exp on my laptop...Thank you!,SternLecturePlumbing,3,0,6,http://www.reddit.com/r/SQL/comments/yykfa/i_need_help_installing_sql_2012exp_on_my/,"Hi, 
I want to start learning SQL and I'm not off to a great start because I've run into trouble at the instalation stage!

So, I went to the web site to download the 2012 version but I can get this far: [IMG]http://i.imgur.com/g0gPx.png[/IMG] 
but it won't let me continue. When I press ""Next"" it says: 

""[Error Message]
To continue, select a feature to install. If all features are already selected, these features are installed. You cannot add additional features.""

The problem is it wont allow me to select or deselect any of the features....does anyone know what I'm doing wrong/how I can get around it (please and thank you...) ",,False,self,t5_2qp8q,False,,,True,t3_yykfa,http://www.reddit.com/r/SQL/comments/yykfa/i_need_help_installing_sql_2012exp_on_my/,
1346090256.0,3,self.SQL,ywx1m,Query Logic,oraclenoob,4,1,14,http://www.reddit.com/r/SQL/comments/ywx1m/query_logic/,"I'm trying to pull the top department for each product.

Product A has been on 10 orders, 7 of which are Video, 3 are audio.
Product B has been on 20 orders, 15 of which are audio, 5 are video.
I'd like my result set to say 

&gt;PRODUCTA    VIDEO
&gt;
&gt;PRODUCTB    AUDIO


My sql below lists all the departments with their counts, and I keep failing at trying to get only the max.

    SELECT c.product, a.department, count(a.department) cnt
    FROM order a, orderline b, inventory c
    WHERE a.orderiid=b.orderiid
    AND c.productiid=b.productiid
    AND c.product in (select product from inventory where department is null)
    GROUP BY a.department, c.product

edit*  Imagine all the products are cables, and you don't know if its a audio cable or video cable.  This query should give me a nice long list that says PRODUCTA is AUDIO (because it was on a bunch of audio orders.).

*Oracle",,False,self,t5_2qp8q,1346104995.0,,,True,t3_ywx1m,http://www.reddit.com/r/SQL/comments/ywx1m/query_logic/,
1345815263.0,3,self.SQL,yr3qh,[MSSQL] Maintenance plan question,AnonymooseRedditor,4,1,5,http://www.reddit.com/r/SQL/comments/yr3qh/mssql_maintenance_plan_question/,"Hi All, 

I'm a sysadmin, with a fair bit of SQL Experience, and well because we don't have a DBA on staff I tend to get the majority of the DB related tickets.  

I've been setting up a new MS SQL 2008 R2 server and right now am working on the maintenance plans.  

Currently I have two plans setup. 
1. Full backup nightly and 2. hourly transaction logs.  My question is with #2.  Should I be shrinking the log files each time?  Right now they are growing quite a lot. I've read mixed things about whether or not shrinking log files is a good thing to do?  ",,False,self,t5_2qp8q,False,,,True,t3_yr3qh,http://www.reddit.com/r/SQL/comments/yr3qh/mssql_maintenance_plan_question/,
1345663732.0,3,self.SQL,ynj9s,I want to learn SQL - which version to DL?!?,Fegis,4,1,9,http://www.reddit.com/r/SQL/comments/ynj9s/i_want_to_learn_sql_which_version_to_dl/,"As title suggests, i wanna learn SQL.

I searched reddit and a post said DL - SQL Server Express.  But which version do i need (i wanna save HD space here ^^)  

http://www.microsoft.com/sqlserver/en/us/editions/2012-editions/express.aspx

I am guessing SQL Server Express with Tools is enough for home use right?

Thanks in advance ",,False,self,t5_2qp8q,False,,,True,t3_ynj9s,http://www.reddit.com/r/SQL/comments/ynj9s/i_want_to_learn_sql_which_version_to_dl/,
1345241742.0,3,self.SQL,yeevn,[SQLITE] many-to-many-to-many in one table or two separate tables,ts4053,4,1,3,http://www.reddit.com/r/SQL/comments/yeevn/sqlite_manytomanytomany_in_one_table_or_two/,"I have noobie question regarding database structure containing relations between three table. 

I have these tables:

* network (**network_id**, name)
* operator(**operator_id**,name)
* service(**service_id**,name)

I have these relations:

   * operator can have multiple networks
   * network can have multiple operators
   * service can have multiple operators
   * operator can have multiple services

So these are easy, I will make following tables:

   * operator_network -table with **operator_network_id**, operator_id and network_id
   * service_operator -table with **service_operator_id**, service_id and operator_id

My problem comes here. I wan't to be able to list only services which are available in one operator's certain network. I figured out that for this I need to modify the service_operator relation to service_operator_network -relation. 

My question is: should I do one table with three foreign-keys

   *  service_operator_network-table with **service_operator_network_id**, service_id, operator_id, network_id

or should I do this by two different tables:

   * operator_network -table with **operator_network_id**, operator_id, network_id
   * operator_network_service-table with **operator_network_service_id**, operator_network_id, service_id

I'm sure that one of these methods is better than the other but I can't figure it out which one.",,False,self,t5_2qp8q,1345242047.0,,,True,t3_yeevn,http://www.reddit.com/r/SQL/comments/yeevn/sqlite_manytomanytomany_in_one_table_or_two/,
1345039807.0,3,self.SQL,y9fbz,[MSSQL] delete trigger,DrTrunks,5,2,12,http://www.reddit.com/r/SQL/comments/y9fbz/mssql_delete_trigger/,"People are deleting Orders with Order items in it. Since we can't get a developer license I'm going the SQL way.

I've made a trigger which should block the deletion of Orders with a status between 2 &amp; 5. But only the first one 'works', it prevents all the deletion no matter what...

When I run the query with the actual table instead of [deleted] I get a right amount of objects.


    ALTER TRIGGER [dbo].[preventOrderdeletion] ON  [dbo].[Company$Order Header] for DELETE AS 
    BEGIN
       IF EXISTS (select No_ from deleted INNER JOIN [Company$Order Items] ON deleted.No_ = [Company$Order Items].[Document No_] WHERE        ([Company$Order Items].[Repair Status Code] between 2 and 5)
      
          ROLLBACK TRANSACTION
          RAISERROR ('Order Items Exist!',16,1)
    END

Trigger that does nothing:


    ALTER TRIGGER [dbo].[preventOrderdeletion] ON  [dbo].[Company$Order Header] for DELETE AS 
    BEGIN
       IF EXISTS (select No_ from deleted INNER JOIN [Company$Order Items] ON deleted.No_ = [Company$Order Items].[Document No_] WHERE        ([Company$Order Items].[Repair Status Code] between 2 and 5)
      BEGIN
          ROLLBACK TRANSACTION
          RAISERROR ('Order Items Exist!',16,1)
     END
    END

I hope someone can point me in the right direction?",,False,self,t5_2qp8q,1345040014.0,,,True,t3_y9fbz,http://www.reddit.com/r/SQL/comments/y9fbz/mssql_delete_trigger/,
1345012750.0,3,ledgersmbdev.blogspot.com,y90pz,Why ACID is a useful building block of eventually consistent transactions.,einhverfr,3,0,5,http://www.reddit.com/r/SQL/comments/y90pz/why_acid_is_a_useful_building_block_of_eventually/,,,False,default,t5_2qp8q,False,,,False,t3_y90pz,http://ledgersmbdev.blogspot.com/2012/08/acid-as-basic-building-block-of.html,
1344451955.0,3,self.SQL,xw8b3,PostgreSQL vs MySQL - what's better for large data handle?,antjanus,4,1,26,http://www.reddit.com/r/SQL/comments/xw8b3/postgresql_vs_mysql_whats_better_for_large_data/,"I'm building a pretty big project (in comparison to what i'm used to) that needs to handle thousands of rows of data, possibly a million in the future. I'm trying to figure out what tech to use for it.

It'll be built on top of PHP (comments aside, this is just an immovable fact), and needs to connect to a solid database for frequent large-scale reads (pull a thousand rows here, another here, another here) and frequent ""small"" updates (update 10 rows here, 15 here, 50 here) and infrequent larger updates (update 6000 rows right now).

With all that said. I did do my research on PostgreSQL and MySQL but don't seem to come to a conclusion. Some articles are based in the past with irrelevant comments (MySQL is faster than PostgreSQL by a thousand-fold!) while some list specific features and how both can compensate for their shortcomings.

So I guess I'm asking, in your experience, which one did you find more useful and why? 

**EDIT** - I realize I may be jumping back and forth. I'm still trying to figure out what to do. It seems like the majority either agrees that with such little amount of data, it won't make a difference, or that Postgres is the better option. Thanks guys! :)",,False,self,t5_2qp8q,1344482906.0,,,True,t3_xw8b3,http://www.reddit.com/r/SQL/comments/xw8b3/postgresql_vs_mysql_whats_better_for_large_data/,
1343848276.0,3,self.SQL,xir0h,[DB2] Finding dates within the past year,ItsKirbyTime,3,0,6,http://www.reddit.com/r/SQL/comments/xir0h/db2_finding_dates_within_the_past_year/,"I'm trying to filter on whether a date is within the past year. I could do something like

    WHERE days(CURRENT DATE) - days(my_date) &lt; 365

However, this fails if there was a leap day in the past year. What can I do to properly account for leap years?",,False,self,t5_2qp8q,False,,,True,t3_xir0h,http://www.reddit.com/r/SQL/comments/xir0h/db2_finding_dates_within_the_past_year/,
1343311734.0,3,self.SQL,x6udf,[MS SQL] SQL 2012 -So someone by mistake deleted my distribution database..,Kalypso_,3,0,7,http://www.reddit.com/r/SQL/comments/x6udf/ms_sql_sql_2012_so_someone_by_mistake_deleted_my/,"I was in the process of setting up SQL Replication and someone by mistake deleted my distribution database. By delete I mean they deleted the db files not the database from SQL. I tried to use sp_dropdistributor. It fails because it thinks it's still connected to the distribution db.

I tried running sp_dropdistributiondb @&lt;dbname&gt; and that isn't working either. ""Must declare the scalar variable @&lt;dbname&gt; "". I'm pretty sure my syntax is wrong. 

Also in SQL the distribution DB is flagged as (Recovery Pending). 

Can anyone clue me in?

Edit: Explaining the delete.

Update 1: Okay I got the right syntax but now it's complaining about the publisher except I never got to creating the publisher, I only named it while creating the distribution. 
I also cannot disable the distribution through the GUI because it can't find the distribution database.
...
Now what?",,False,self,t5_2qp8q,1343313662.0,,,True,t3_x6udf,http://www.reddit.com/r/SQL/comments/x6udf/ms_sql_sql_2012_so_someone_by_mistake_deleted_my/,
1343257706.0,3,self.SQL,x5pl2,[MS SQL] Question for generating serial numbers,CaptainKirk0000,3,0,7,http://www.reddit.com/r/SQL/comments/x5pl2/ms_sql_question_for_generating_serial_numbers/,"I am relatively new to MS SQL Server (Using the 2012 Express Edition) and have been using to create a simple business app using Lightswitch. I have been tasked with something I'm not sure how to do. 

The system I am working on is a simple order management web app. All orders have a header record in a headers table. They are currently assigned a unique ID using an identity column.  I have been asked to make an order number column, which will function as a means to identify the order. It consists or a location code, two digit year in which it was ordered and a five digit unique serial number. Normally I would make a computed column that would concat all of that together, using the ID column as the serial number, but they want the serial number to reset to 0 with the first order of every year. Would I use a trigger or a stored procedure for something like this? I haven't used either one yet. Any guidance would be greatly appreciated.",,False,self,t5_2qp8q,False,,,True,t3_x5pl2,http://www.reddit.com/r/SQL/comments/x5pl2/ms_sql_question_for_generating_serial_numbers/,
1342537607.0,4,self.SQL,wpcis,Why complex SQL queries over simple SQL queries?,lsumnler,12,8,16,http://www.reddit.com/r/SQL/comments/wpcis/why_complex_sql_queries_over_simple_sql_queries/,"I am not an SQL expert and primarily use SQL in my day to day CRUD work.  I have noticed in a large number of job ads that they are looking for people who can work with complex SQL queries.  Generally, in most of the work I have done I have built several queries (anywhere from 3 to 10) to create a data set I can work with.  Once I have accomplished this I could have gone back and re-factored my queries into 1 or two complex queries but have generally not done so for a number of reason usually related to having to come back 6 month or a year later and having to maintain or change some small aspect of the query.  Are there advantages to the complex queries that I am missing.

NOTE: I understand that there are probably speed and resource advantages; However, I would think that these would only apply in very unique situation such as automated trading system and such.",,False,self,t5_2qp8q,False,,,True,t3_wpcis,http://www.reddit.com/r/SQL/comments/wpcis/why_complex_sql_queries_over_simple_sql_queries/,
1342030836.0,4,self.SQL,wealq,[MS SQL] Optimizing a Derived Table with a few joins,Scytone,6,2,2,http://www.reddit.com/r/SQL/comments/wealq/ms_sql_optimizing_a_derived_table_with_a_few_joins/,"So I'm trying to create this table that displays the amount of Servers we have running Each Edition of SQL Server vs The version they are on. I've gone about this via a derived table and a few interesting joins, however the query takes a whopping 40 seconds to execute! The final table looks like what I need, but like I said, just takes way to long to finish. Any ideas on the best way to create a table like this?

(Heres the table example: http://i.imgur.com/Mncbe.jpg )

My code looks something like this:  http://pastebin.com/AtqESLkM

I'm not the most talented query writer, most of my work doesn't involve actually writing queries, so excuse me if I took the complete wrong approach.
",,False,self,t5_2qp8q,False,,,True,t3_wealq,http://www.reddit.com/r/SQL/comments/wealq/ms_sql_optimizing_a_derived_table_with_a_few_joins/,
1342017739.0,3,self.SQL,wdx7i,"SQL Server replication problem, please help.",eps492003,5,2,1,http://www.reddit.com/r/SQL/comments/wdx7i/sql_server_replication_problem_please_help/,"I'm trying to correct sql server &amp; @@servername returns servername with a ""-"" (dash) in the name, when I try to dropserver it returns an error ""Incorrect syntax near '-'."" and it doesn't allow me to do that???

It's picking up the wrong server name for some odd reason &amp; I'm trying to switch to the correct server name.

**** SOLVED ****

I put those [ ] brackets around the name instead of ' ' &amp; it worked.",,False,self,t5_2qp8q,1342019338.0,,,True,t3_wdx7i,http://www.reddit.com/r/SQL/comments/wdx7i/sql_server_replication_problem_please_help/,
1341584124.0,3,self.SQL,w4nwu,MS SQL Server 2008 R2 - getting incorrect results from query in very-high concurrent DB,huncwot,9,6,22,http://www.reddit.com/r/SQL/comments/w4nwu/ms_sql_server_2008_r2_getting_incorrect_results/,"**Final update: This ended up as an error NOT related to DB, while during troubleshooting I focused on stc with order_number and order_tie different than one provided through procedure, I didn't take it into account, that procedure could be called several times with different data (this should NOT happen, and is still under investigation, whether data is corrupted on data source or IIS), therefore t_debug table gathering raw data with which procedure is called has in this 10 examples I have both correct and incorrect entries. I'm very sorry for the confusion, as I should notice it before, but I found out only after trying SQLDave idea to look for patterns... Thanks all.**

Hi,

I'm running DB gathering some data (irrelevant here). There are hundreds of interactions with DB from different sources going through IIS.

One of tables stores variable A char(9), and B int plus the key, there is also a UNIQUE index on A and B pair.

Second table stores (among other things) foreign key to above table.

Each record going to second table is identified with A and B. Several records can use the same A and B variables.

Naturally I check if first table already has provided pair:

 - if not, I INSERT new pair, and get the key using OUTPUT INTO clause
 - if yes, I get the key in the SELECT statement used for above check already

Here is where the problem appears:

Every now and then, once in about 1000 records, mentioned SELECT statement returns incorrect but existing key (so not a random int).

I can't find the reason for that, and for affected records (I started logging original data for debugging) I can't reproduce the error manually (tried 10mil loop, with no errors).

Query in question is currently not run in transaction, so as to each time record is inserted to first table, SELECT statement can access it without waiting to COMMIT, as it was before.

I added workaround where key is used only when 3 SELECT statements in a row get the same result, but I still get incorrect key from time to time.

Database is run with below settings due to deadlocks we've had before:

    SET READ_COMMITTED_SNAPSHOT ON;

    SET ALLOW_SNAPSHOT_ISOLATION ON;

If you have ANY idea, I'll be more than happy. If you're missing any information, please ask.

Some more detailed information (I'll use pseudocode here and there):

first table:

    
    if OBJECT_ID ('t_order_tie') is null

    CREATE TABLE t_order_tie
    (
    	id_order_tie int IDENTITY (1,1) NOT NULL,
    	order_number char (9) COLLATE SQL_Polish_CP1250_CS_AS NOT NULL,
    	order_tie int NOT NULL,
    	
    	...
    			
    	CONSTRAINT PK_t_order_tie PRIMARY KEY CLUSTERED (id_order_tie ASC)
    	WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
    )
    ON [PRIMARY]
    GO

second table:

    if OBJECT_ID ('t_stc') is null

    CREATE TABLE t_stc
    (
    	id_stc int IDENTITY (1,1) NOT NULL,
    	stc char (8) COLLATE SQL_Polish_CP1250_CS_AS NOT NULL,
    	id_order_tie int NULL,
	
        ...		
	
    	CONSTRAINT PK_t_stc PRIMARY KEY CLUSTERED (id_stc ASC)
    	WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
    )
    ON [PRIMARY]
    GO

procedure called by IIS for each source of incoming data (usually this one is called once every few seconds, however there are more procedures reading above data, or inserting into other tables, no other procedure inserts into t_ot which is worth noting i guess):

**1st version:**

    procedure
    (
        @stc char (8),
        @order_number char (9),
        @order_tie int,
        @some more parameters irrelevant here
    )

    declare
        @id_order_tie int

    select
        @id_order_tie = id_order_tie 
    from
        t_order_tie
    where
        order_number = @order_number 
    and order_tie = @order_tie 

    if @id_order_tie is null
        begin
            declare @idot table (id int)
            
            INSERT INTO t_order_tie
            OUTPUT inserted.id_order_tie INTO @idot
            VALUES (@order_number , @order_tie , @other columns)
            
            select @id_order_tie = id from @idot
        end

    INSERT INTO t_stc
    VALUES (@stc , @id_order_tie )

**2nd version**

I was playing around with some changes to make sure it's not because of calling outside function (originally instead of select), etc. But after that I decided to implement a workaround doublechecking the id, when data needed was already in table t_ot. This way, whenever id was already present, I checked again and used it only when it was the same twice in a row.

    procedure
    (
        @stc char (8),
        @order_number char (9),
        @order_tie int,
        @some more parameters irrelevant here
    )

    declare
        @id_order_tie int,
        @temp_id_order_tie int,
        @confirmed int

    set @confirmed = 0

    select
        @id_order_tie = id_order_tie 
    from
        t_order_tie 
    where
        order_number = @order_number 
    and order_tie = @order_tie 

    if @id_order_tie is null
        begin
            declare @idot table (id int)
            
            INSERT INTO t_order_tie 
            OUTPUT inserted.id_order_tie INTO @idot
            VALUES (@order_number , @order_tie , @other columns)
            
            select @id_order_tie = id from @idot
            
            if @id_order_tie is not null set @confirmed = 1

        end

    while @confirmed = 0

        begin
        
            select
                @temp_id_order_tie = id_order_tie 
            from
                t_order_tie 
            where
                order_number = @order_number 
            and order_tie = @order_tie 

            if @id_order_tie = @temp_id_order_tie 

                set @confirmed = 1

            else

                set @id_order_tie = @temp_id_order_tie 

        end

    INSERT INTO t_stc
    VALUES (@stc, @id_order_tie )


Unfortunately this didn't help, as I still managed to get false id. I even modified it later to continue only after getting the same id three times in a row, with the same result in the end. That is where I stopped for now. However I might not have taken into account autocommiting, and will try manual commiting later.

*Update:*

It is worth noting, that before workaround was implemented, for several (let's say 10) s having identical o_n and o_t pairs, two of them aquired correct id, while 8 got wrong id, but it was the same id for all 8 of them, and procedure was not called for all of them at the same type. This is why I think it's not random per se, erroneous yes, but not random.

After workaround, I got 2 wrong ids, both the same (different than before - very old, usually when id was returned incorrect it was quite close to correct one).

*Update:*

OK, since some of you said variables are unclear, I used real names now, wherever I could. I also pasted above original definition used to create tables.

Below are indexes definitions for 2 tables mentioned above:


    IF EXISTS (SELECT name FROM sys.indexes WHERE name = 'UQ_t_order_tie') drop index UQ_t_order_tie on t_order_tie
    GO

    BEGIN TRANSACTION
    GO

    CREATE UNIQUE NONCLUSTERED INDEX UQ_t_order_tie ON

    	t_order_tie (order_number ASC, order_tie ASC)
	
    WITH( STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
    GO

    ALTER TABLE t_order_tie SET (LOCK_ESCALATION = TABLE)
    GO

    COMMIT




    IF EXISTS (SELECT name FROM sys.indexes WHERE name = 'UQ_t_stc') drop index UQ_t_stc on t_stc
    GO

    BEGIN TRANSACTION
    GO

    CREATE UNIQUE NONCLUSTERED INDEX UQ_t_stc ON

    	t_stc (stc)
	
    WITH( STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
    GO

    ALTER TABLE t_stc SET (LOCK_ESCALATION = TABLE)
    GO

    COMMIT

    GO

    BEGIN TRANSACTION

    GO

    CREATE NONCLUSTERED INDEX IDX_t_stc ON
    	t_stc (columnX, columnY)
    		INCLUDE (id_order_tie, columnZ)
		
    GO

    COMMIT

    GO

**Final update: This ended up as an error NOT related to DB, while during troubleshooting I focused on stc with order_number and order_tie different than one provided through procedure, I didn't take it into account, that procedure could be called several times with different data (this should NOT happen, and is still under investigation, whether data is corrupted on data source or IIS), therefore t_debug table gathering raw data with which procedure is called has in this 10 examples I have both correct and incorrect entries. I'm very sorry for the confusion, as I should notice it before, but I found out only after trying SQLDave idea to look for patterns... Thanks all.**",,False,self,t5_2qp8q,1341841919.0,,,True,t3_w4nwu,http://www.reddit.com/r/SQL/comments/w4nwu/ms_sql_server_2008_r2_getting_incorrect_results/,
1341245641.0,1,self.SQL,vxgg8,SQL Server 2008 R2 - replicate between sites,uster,6,5,5,http://www.reddit.com/r/SQL/comments/vxgg8/sql_server_2008_r2_replicate_between_sites/,"I have a simple SQL database with a web front-end.

I have multiple ""low bandwidth"" sites which each need access to this database. Each site is a subnet of our global network (so network transparency isn't an issue). Each site has a local webserver running the web front-end. Can I setup a local ""copy"" of SQL at each site which will stay in sync? Does SQL have anything built-in facilitate distributed databases?

The whole idea here is to give the users at remote site ""x"" local access to the a distributed copy of the database and web front-end. If that same users goes to remote site ""y"", he should be able to hit ""y's"" local web front-end and ""y"" distributed copy of the database .",,False,self,t5_2qp8q,False,,,True,t3_vxgg8,http://www.reddit.com/r/SQL/comments/vxgg8/sql_server_2008_r2_replicate_between_sites/,
1340688842.0,3,self.SQL,vm6rc,[MYSQL] Joins where one query doesn't return a result,Chiponyasu,4,1,4,http://www.reddit.com/r/SQL/comments/vm6rc/mysql_joins_where_one_query_doesnt_return_a_result/,"Hi! 

I have a database that logs everything that happens to an account as a separate line. I'm trying to find all the accounts that were open on a certain date. 

I'm able to find all the accounts that opened before this date and closed after that date, using the following query:


select t1.accountnumer, t2.closeinfo
from
(select * from accounts where stage = 'Opened' and date &lt; '2012-06-23 00:00:00') as t1,
(select * from accounts where stage = 'Closed' and date &gt; '2012-06-23 00:00:00') as t2
where t1.accountnumber = t2.accountnumber;

However, I also want to find all the accounts that have an opened line, but do NOT have a closed line (i.e., the ones that were open before that date, and are still open now). How can I do this?

Thank you in advance. 

(Also, I just realized the ""select *"" is a terrible idea in this situation, as it is in many, and I'll stop using it)

Edit: I was able to resolve this issue on my own. Thank you to everyone that posted, as it helped me learn a little. ",,False,self,t5_2qp8q,1340773782.0,,,True,t3_vm6rc,http://www.reddit.com/r/SQL/comments/vm6rc/mysql_joins_where_one_query_doesnt_return_a_result/,
1340052324.0,3,self.SQL,v8peb,Need assistance with an AND/OR situation,Daakuryu,3,0,7,http://www.reddit.com/r/SQL/comments/v8peb/need_assistance_with_an_andor_situation/,"The statement below is generated based on a series of options a user picks. 

2 of the values (Changed and UpdatedBySteph) are strings containing 13 characters which are either 0 or 1. and All the The PST and GST are based on check boxes above a grid, they also correspond to one of those 13 characters in Changed and in UpdatedBySteph.

The user sees a list of products and associated taxes based on their selections, the changed and updatedbysteph fields come in when the user chooses whether they want to see everything, everything changed, everything updated or everything new.

What it needs to do is if the user chooses to see everything 'new' and all of the selected provinces have their part of the 13 char strings set to 1 the product doesn't show up but if one of them has a 0 the product shows up.

I'm still an SQL neophyte and obviously it's not doing that, I'm not sure how to organize my and/or's to get the desired results.


SELECT tblGstPstbyProv2.Supplier,

	tblGstPstbyProv2.EventCode,

	tblGstPstbyProv2.SupplierProduct,

	tblGstPstbyProv2.UPCCode,

	tblSupplierProducts.ProductDescription,

	ZZ_PST,

	ZZ_GST,

	BC_PST,

	BC_GST,

	MB_PST,

	MB_GST,

	NS_PST,

	NS_GST 

FROM tblGstPstbyProv2

	INNER JOIN tblsupplierproducts ON tblSupplierProducts.Supplier = tblGstPstbyProv2.Supplier 

	AND tblSupplierProducts.SupplierProduct = tblGstPstbyProv2.SupplierProduct 

	AND tblSupplierProducts.EventCode = tblGstPstbyProv2.EventCode 

WHERE tblGstPstbyProv2.InActiveItem = 'False' 

	AND (SUBSTRING(Changed,2,1) = '0'

		OR SUBSTRING(Changed,3,1) = '0'

		OR SUBSTRING(Changed,6,1) = '0')

	and (SUBSTRING(UpdatedBySteph,2,1) = '0'

		or SUBSTRING(UpdatedBySteph,3,1) = '0'

		or SUBSTRING(UpdatedBySteph,6,1) = '0')

ORDER BY tblGstPstbyProv2.Supplier, tblGstPstbyProv2.EventCode, tblGstPstbyProv2.SupplierProduct ASC
",,False,self,t5_2qp8q,False,,,True,t3_v8peb,http://www.reddit.com/r/SQL/comments/v8peb/need_assistance_with_an_andor_situation/,
1340048013.0,3,self.SQL,v8l1i,SQL Server suggestions for Product,yaodin,5,2,9,http://www.reddit.com/r/SQL/comments/v8l1i/sql_server_suggestions_for_product/,I am working on creating a product with a java front end and a SQL backbone. I am looking for advise on what SQL product to use since I am selling this. A license for MySQL or MSSQL are both out of the question because they would put us greatly over budget. Is there an open source version I can include that allows this? Thanks for the help.,,False,self,t5_2qp8q,False,,,True,t3_v8l1i,http://www.reddit.com/r/SQL/comments/v8l1i/sql_server_suggestions_for_product/,
1339181269.0,3,self.SQL,uryse,[MSSQL] A Query to return the last 7 years,-james,7,4,6,http://www.reddit.com/r/SQL/comments/uryse/mssql_a_query_to_return_the_last_7_years/,"I posted this in learnprogramming but, I think this might be a better place for the question. I need a simple query to populate a lookup list for a filter which returns the last 7 years: like so:

    YearFilter
    2012
    2011
    2010
    2009
    2008
    ....

I came up with this:

	SELECT YearFilter
	from
		(
			SELECT year(getdate())  YearFilter
			union
			SELECT year(getdate()) - 1
			union
			SELECT year(getdate()) - 2
			union
			SELECT year(getdate()) - 3
			union
			SELECT year(getdate()) - 4
			union
			SELECT year(getdate()) - 5
			union
			SELECT year(getdate()) - 6
			union
			SELECT year(getdate()) - 7
		) years

Don't worry about the missing ORDER BY. I guess my question is this seems a bit messy. Is there a better way to achieve the same result?

-james",,False,self,t5_2qp8q,False,,,True,t3_uryse,http://www.reddit.com/r/SQL/comments/uryse/mssql_a_query_to_return_the_last_7_years/,
1338710376.0,3,self.SQL,uido2,[Oracle] String Concatenation/Whitespace Elimination,sqldiaries,6,3,11,http://www.reddit.com/r/SQL/comments/uido2/oracle_string_concatenationwhitespace_elimination/,"Greetings,

Ah, yes, our favorite topic - Whitespace elimination within String Concatenation - I'm at my whits end :)

Background: I use an enterprise-wide Oracle data store that is a near real-time (&lt;4 hr lag) replication of our main billing application.  I have read-only access, and some of the really weird table layouts are the due to how the  original billing application was designed, not design choices in Oracle.  I say this, because ""just change the table"" always comes up and that's not possible :)

Situation: I'm often asked for reports that include address information.  In our data store, addresses are split into discreet columns - one each for: Street/House Number, Fraction, Direction, Street Name, Apt Designation, Apartment Literal.

As is often the case, my users want that address information outputted in a format suitable for mailing, which means I need to concatenate the fields together - simple enough:

    STNUM||' '||STFRACT||' '||STDIR||' '||STNAME||' '||APT||' '||APTN

However (you knew there'd be one :)), things get... interesting, as none of these fields are ever NULL - they always have a value, either alpha/numeric or a blank space (getting the picture yet?).  This means that if, in the above example, the address doesn't have a fraction or direction, I end up with at least two extra spaces in my output - something that severely annoys my EU's, and since one of them is the boss man...

I've tried the following:

    Trim(Trim(STNUM)||' '||Trim(STFRACT)||' '||Trim(STDIR)||' '||Trim(STNAME)||' '||Trim(APT)||' '||Trim(APTN))

And:

    Trim(NVL(STNUM,''))||' '||Trim(NVL(STFRACT,''))||' '||Trim(NVL(STDIR,''))||' '||Trim(NVL(STNAME,''))||' '||Trim(NVL(APT,''))||' '||Trim(NVL(APTN,''))

And even:

    Trim(Trim(NVL(STNUM,''))||' '||Trim(NVL(STFRACT,''))||' '||Trim(NVL(STDIR,''))||' '||Trim(NVL(STNAME,''))||' '||Trim(NVL(APT,''))||' '||Trim(NVL(APTN,'')))

All to no avail - I continue to get excessive whitespace in the output.

Anyone have any ideas?  All I need is for there to be one space between each section of actual output.",,False,self,t5_2qp8q,False,,,True,t3_uido2,http://www.reddit.com/r/SQL/comments/uido2/oracle_string_concatenationwhitespace_elimination/,
1338486680.0,3,self.SQL,ue6q9,Need a little help with a WHERE clause,kaoticsnow,3,0,11,http://www.reddit.com/r/SQL/comments/ue6q9/need_a_little_help_with_a_where_clause/,"Trying to get a list out of the MSSQL database of ICMP only nodes in Orion, however I need to disallow any rows with a Device_Type of URL, as they are external nodes for URL monitoring I do not care about.

&gt;SELECT NodeID, IP_Address, Real_IP, Caption, Customer, Site, Device_Type FROM Nodes WHERE ObjectSubType = 'ICMP';

This will get me a list of ICMP only nodes including the URL's it pulls 586 Rows.

&gt;SELECT NodeID, IP_Address, Real_IP, Caption, Customer, Site, Device_Type FROM Nodes WHERE Device_Type = 'URL';

This will pull the 74 rows I do not care about. However when I combine it into

&gt;SELECT NodeID, IP_Address, Real_IP, Caption, Customer, Site, Device_Type FROM Nodes WHERE ObjectSubType = 'ICMP' AND Device_Type != 'URL;

Only 280 Rows come back I know what's going on the Device_Type filed is optional and not all of them are filled in, so this last query is ignoring any rows where Device_Type is null. What do I need to do to get it to give me all rows where ObjectSubType is ICMP and Device_Type is not URL but may be null?",,False,self,t5_2qp8q,False,,,True,t3_ue6q9,http://www.reddit.com/r/SQL/comments/ue6q9/need_a_little_help_with_a_where_clause/,
1338380755.0,3,self.SQL,uc07o,Need Rank help...,,3,0,7,http://www.reddit.com/r/SQL/comments/uc07o/need_rank_help/,"Ok so it may be a bit advanced for this board.. but i figured i would give it a shot...

can i use the Rank () (Over partition by &lt;xxx&gt; order by &lt;yyy&gt; ) function with multiple columns?

table datetime, keyword, topic...

&gt;Select
&gt;trunc(datetime,'MM') as Month,
&gt;topic,
&gt;keyword,
&gt;count(*),
&gt;rank () over (partition by Trunc(datetime,'MM')||Topic order by &gt;count(*) desc) as Rank 

&gt;from table


Will that work? If not.. is there a way to partition by ""month"" and topic to rank by count(*) ?",,False,self,t5_2qp8q,False,,,True,t3_uc07o,http://www.reddit.com/r/SQL/comments/uc07o/need_rank_help/,
1337283219.0,3,self.SQL,ts3qp,"How can I change a default ""null"" to a ""0""? 
",calu1986,3,0,10,http://www.reddit.com/r/SQL/comments/ts3qp/how_can_i_change_a_default_null_to_a_0/,"I am using sql2005. I have two tables, one is called ""gcbal_dbfile"" the other one is called ""gctran_dbfile"" they both share the same ""Acct"" numbers, but there are no primary-foreign key relationships between them. They both are on the same database tho. I am writing a subquery in order to get information from both tables into one. My problem is that a column named ""CurrentBalance"" has default values of ""0.00"" (decimal(10,2)), however I get value of ""NULL"" when i execute my query.
Here is my query:
select Acct as AccountNumber,(select top 1 trandate from gctran_dbfile where acct=a.acct and trantype='Redeem' order by skey desc) as LastRedeem,(select top 1 trandate from gctran_dbfile where acct=a.acct and trantype='Reload' order by skey desc) as LastReload, date_issuedc as DateIssued,a.IssueAmount - a.VoidIssueAmount as OriginalIssuanceAmount,a.NoOfSale as RedemptionTotal,a.NoOfReload as ReloadedTotal,(select top 1 CurrentBalance from gctran_dbfile where acct=a.acct and convert(int,GcTran_Dbfile.TranDate,101) &lt;= convert(int, cast('05/15/2012' as datetime),101) order by skey desc) as CurrentUnredeemedBalance from gcbal_dbfile a

This is where I need to change my query:
(select top 1 CurrentBalance from gctran_dbfile where acct=a.acct and convert(int,GcTran_Dbfile.TranDate,101) &lt;= convert(int, cast('05/15/2012' as datetime),101) order by skey desc) as CurrentUnredeemedBalance

I know that there is a way to add something to the select in order to get the result desired. 
The result desired is to get back ""0.00"" (as a decimal, not a string) as my result.

HELP??",,False,self,t5_2qp8q,False,,,True,t3_ts3qp,http://www.reddit.com/r/SQL/comments/ts3qp/how_can_i_change_a_default_null_to_a_0/,
1337282396.0,3,self.SQL,ts31l,Question about stored procedures.,Mathlete86,3,0,3,http://www.reddit.com/r/SQL/comments/ts31l/question_about_stored_procedures/,"Is it possible to make a stored procedure that runs through multiple sets of parameters? If so, how?

Right now, I have a procedure named TempSalesInfo which has parameters of ProductKey, StartDate, and EndDate.

When I run:
exec TempSalesInfo 310, 20050701, 20080731

It puts the sales info between 7/1/2005 and 7/31/2008 for product 310 in a temporary table. If I run the same procedure for product 311 between the same dates, the procedure adds the sales info between those dates for product 311 to the table.

I am trying to get a stored procedure where I can run multiple sets of parameters at the same time. Like running (310, 20050701, 20080731) and (311, 20050701, 20080731) at the same time instead of independently.

Is this possible? If so, how?",,False,self,t5_2qp8q,False,,,True,t3_ts31l,http://www.reddit.com/r/SQL/comments/ts31l/question_about_stored_procedures/,
1336501406.0,3,self.SQL,tdajb,Need help with simple SQL SELECT statement,whoisearth,3,0,7,http://www.reddit.com/r/SQL/comments/tdajb/need_help_with_simple_sql_select_statement/,"SOLVED by pythor.

THANK YOU!

I have 2 tables I'm trying to parse the query on.  What I currently have is as follows - 

    SELECT product_id FROM [xxx].[dbo].[Table1] WHERE Column1 LIKE '%test%'

Which works fine.  However, I want to vet that against a value for product_id in a separate table on the same database.  I thought it would be something simple like the following - 

    SELECT product_id FROM [xxx].[dbo].[table1] WHERE column1 LIKE '%test%'AND [xxx].[dbo].[table2] WHERE column1='1234'

However it craps out.  I'm an extreme novice to SQL so I know my syntax is crap somewhere just not sure how.
",,False,self,t5_2qp8q,True,,,True,t3_tdajb,http://www.reddit.com/r/SQL/comments/tdajb/need_help_with_simple_sql_select_statement/,
1336421130.0,3,self.SQL,tbo32,[Oracle] Creating an array of dates.,Hacto,3,0,4,http://www.reddit.com/r/SQL/comments/tbo32/oracle_creating_an_array_of_dates/,"Is there a more elegant way to create an array of the past six months than what I've concocted?  It would be nice if the scalability was based on some parameter, not how many selects are written.

What I need:

    DATE
    -----------
    01-MAY-2012
    01-APR-2012
    01-MAR-2012
    01-FEB-2012
    01-JAN-2012
    01-DEC-2011

The SQL I'm using:

    SELECT TRUNC(ADD_MONTHS(SYSDATE,0),'MM') EFFDT
    FROM DUAL
    UNION
    SELECT TRUNC(ADD_MONTHS(SYSDATE,-1),'MM') EFFDT
    FROM DUAL
    UNION
    SELECT TRUNC(ADD_MONTHS(SYSDATE,-2),'MM') EFFDT
    FROM DUAL
    UNION
    SELECT TRUNC(ADD_MONTHS(SYSDATE,-3),'MM') EFFDT
    FROM DUAL
    UNION
    SELECT TRUNC(ADD_MONTHS(SYSDATE,-4),'MM') EFFDT
    FROM DUAL
    UNION
    SELECT TRUNC(ADD_MONTHS(SYSDATE,-5),'MM') EFFDT
    FROM DUAL
    ORDER BY EFFDT DESC;",,False,self,t5_2qp8q,False,,,True,t3_tbo32,http://www.reddit.com/r/SQL/comments/tbo32/oracle_creating_an_array_of_dates/,
1336273510.0,3,self.SQL,t97yp,Join Confusion x-post MySQL,mrmuszynski,3,0,5,http://www.reddit.com/r/SQL/comments/t97yp/join_confusion_xpost_mysql/,"Hi there. I'm pretty new to SQL, so forgive me if this is a dumb question... I'm having some trouble with a query. I've joined a bunch of tables, each of which has a unique key column called ""ID"" The ""Order_Line"" table has columns that refer to the ""ID"" columns of the other tables (""PO_ID"", ""Employee_ID, etc). Hopefully that's not so hard to see below.

Fine. Easy enough. Now I want to use the ""ID"" value from the ""Order_Line"" table, but try as I might every time I try to reference ""ID"" in my code, it gives me the ""ID"" column for the last-joined table. If tried every joining technique I understand, but I think I might have missed something. How do I reference Order_Line.ID?

    	Select * 
    	FROM Order_Line 
    	JOIN PO ON Order_Line.PO_ID = PO.ID
    	JOIN Employee ON  Order_Line.Emp_ID = Employee.ID 
    	JOIN Type ON Order_Line.Type_ID = Type.ID
    	JOIN Customer ON Order_Line.CUST_ID = Customer.ID
    	JOIN Imprint ON Order_Line.IMPRINT_ID = Imprint.ID
    	WHERE PO_ID = {$PO}",,False,self,t5_2qp8q,False,,,True,t3_t97yp,http://www.reddit.com/r/SQL/comments/t97yp/join_confusion_xpost_mysql/,
1335453555.0,3,self.SQL,stnj7,[t-sql][sybase] can someone explain replication to me as i'm 5?,renser,3,0,7,http://www.reddit.com/r/SQL/comments/stnj7/tsqlsybase_can_someone_explain_replication_to_me/,"Hi!

I'm having a hard time to understand replication. Especially how i proof if a sp can run with replication set on or not.
It has something to so with temporary and persistend tables but i don't have a slight clue.

Thanks everyone for your answers - it's clear to me now. In Addition: The system i'm working on is set up in a specific way as there are no write-operations allowed into persistend tables on the slaves.",,False,self,t5_2qp8q,True,,,True,t3_stnj7,http://www.reddit.com/r/SQL/comments/stnj7/tsqlsybase_can_someone_explain_replication_to_me/,
1335386174.0,3,self.SQL,sschj,"[MS SQL] 2008 Report Server: user gets ""an error has occured during report processing"" and I can't figure out why",OK_now_what,4,1,5,http://www.reddit.com/r/SQL/comments/sschj/ms_sql_2008_report_server_user_gets_an_error_has/,"....total self-taught SQL novice here, so please be gentle:

Running SQL Server 08 Report Server and I've written several reports as part of one Project. Each report is pretty simple TSQL and all of the reports run successfully in ""preview"" of the Business Intelligence Dev Studio.

So, I deploy all the reports and setup a user with access to them. 

She is able to log into the report server website,
She is able to open the project folder,
She is able to run 3 out of the 4 reports with no problem,
the forth report fails with:

*An error has occurred during report processing. (rsProcessingAborted)*

*Query execution failed for dataset 'REPORT_NAME'. (rsErrorExecutingCommand)*

*For more information about this error navigate to the report server on the local server machine, or enable remote errors*

I try when logged in as me - the report works just fine.

Next thing I check - I log back into the report server website as her, launch the report builder for the problem report and it does successfully run in the report builder program.... but not the web interface..... so I'm scratching my head how that is possible!

Any help would be greatly appreciated!",,False,self,t5_2qp8q,False,,,True,t3_sschj,http://www.reddit.com/r/SQL/comments/sschj/ms_sql_2008_report_server_user_gets_an_error_has/,
1335220324.0,4,self.SQL,sox29,"[SQLplus]How do I create an sql table with a date feild formated like this  12-JAN-2010
",redelman431,5,1,8,http://www.reddit.com/r/SQL/comments/sox29/sqlplushow_do_i_create_an_sql_table_with_a_date/,When it's created the date formats  the default way.,,False,self,t5_2qp8q,False,,,True,t3_sox29,http://www.reddit.com/r/SQL/comments/sox29/sqlplushow_do_i_create_an_sql_table_with_a_date/,
1334752185.0,3,self.SQL,sfwd1,Adding/Subtracting points using SQL and VB6?,Arktri,4,1,5,http://www.reddit.com/r/SQL/comments/sfwd1/addingsubtracting_points_using_sql_and_vb6/,"I'm doing a school project based on a points system and I am lost at this point.

[Here](http://i.imgur.com/GtLHb.png) is my form design.

I assume it would be an if statement and EDIT statement but I really am unsure.

if cboPointsType = Add then

      Insert SQL here

else if cboPointsType = Remove then

      Insert SQL here


I assume this would be the case. My teacher sent this

strSQL = ""SELECT SUM([Points]) AS MyCount FROM tblStudentRewards WHERE UserID="" &amp; intCurrentUserID &amp; "" AND bShow = true""

This is pretty much to count up the points awarded from the record of inputs but I have no idea how to display it.

I really do apologise if I'm not explaining myself too well and will try to clear anything up. 
       ",,False,self,t5_2qp8q,False,,,True,t3_sfwd1,http://www.reddit.com/r/SQL/comments/sfwd1/addingsubtracting_points_using_sql_and_vb6/,
1334705494.0,3,self.SQL,sf1yf,Having trouble with adddate function,redelman431,3,0,2,http://www.reddit.com/r/SQL/comments/sf1yf/having_trouble_with_adddate_function/,"Alexamara tries to complete each service
request by the next service date, but
sometimes this is not possible. Alexamara
has a policy, however, to address all service
requests within 14 days of the next
service date.That is, the last possible
date to complete each service request
would be 14 days after the next service
date. Produce a report that includes the
service ID, marina number, slip number,
owner number, owner name, category
description, service description, next service
date, and last possible date for each
service request.

EDIT: Can't get addate to work. It keeps saying add right parenthesis and I tried millions of right parenthesis and it keeps saying add right parenthesis.

",,False,self,t5_2qp8q,True,,,True,t3_sf1yf,http://www.reddit.com/r/SQL/comments/sf1yf/having_trouble_with_adddate_function/,
1334428834.0,3,self.SQL,s9rlo,Learning to write queries for reporting,s0burnt,3,0,3,http://www.reddit.com/r/SQL/comments/s9rlo/learning_to_write_queries_for_reporting/,"Have been a programmer all my life with mediocre sql skills.  

Starting a new job in a week that is mainly creating reports and the queries to support them.  I've been reading some books to try learn more advanced selects and joins, but I feel that I could be studying something better, something more aimed toward writing sql for reports.  Does anyone know of such a site or book? 

If not, if there is anyone who has done this kind of work before, maybe you can tell me what kinds of things to focus on (i.e., intersects, unions, cursors) that get used a lot in reporting.

If it makes a difference, platform will be MS SQL Server 2008, Crystal 11, using with focus on EDI x12 5010's.

Thanks in advance.",,False,self,t5_2qp8q,False,,,True,t3_s9rlo,http://www.reddit.com/r/SQL/comments/s9rlo/learning_to_write_queries_for_reporting/,
1333581142.0,3,self.SQL,rtq2o,SQL diagrams,GeneralIreton,3,0,8,http://www.reddit.com/r/SQL/comments/rtq2o/sql_diagrams/,"Hi.

Question: What does the line between two tables with the key on one end and the squiggly line on the other end mean in SQL diagrams?

Im guessing the side with the key is primary key and squiggly line is foreign key?



",,False,self,t5_2qp8q,False,,,True,t3_rtq2o,http://www.reddit.com/r/SQL/comments/rtq2o/sql_diagrams/,
1332965861.0,3,self.SQL,ri2fb,[FoxPro Free Tables] Automatically updating all foreign keys,Phenomena0,3,0,1,http://www.reddit.com/r/SQL/comments/ri2fb/foxpro_free_tables_automatically_updating_all/,"Not sure if this is the right place to ask this, but I'm looking to update a massive foxpro database. Is there anyway to change a primary key of a table and have the foreign keys that reference it change automatically.

For example. If I have two tables a Customer table, with a primary key called CustID and an Order table that relates to the customer table. 

Now lets say I want to change CustID to be Customer_ID. Is there away I could change it the Order table automatically or am I going to have to hunt down all the tables that reference and change it manually?",,False,self,t5_2qp8q,False,,,True,t3_ri2fb,http://www.reddit.com/r/SQL/comments/ri2fb/foxpro_free_tables_automatically_updating_all/,
1332940415.0,3,dfp.firebirdsql.org,rhhcc,Firebird SQL Project Newsletter Issue number 3 ,mariuz,3,0,0,http://www.reddit.com/r/SQL/comments/rhhcc/firebird_sql_project_newsletter_issue_number_3/,,,False,http://d.thumbs.redditmedia.com/fE_XfGq83gThKYii.jpg,t5_2qp8q,False,,,False,t3_rhhcc,http://dfp.firebirdsql.org/en/newsletter/15504/,
1332452417.0,3,self.SQL,r8z8k,[MS SQL] Deleting multiple rows from a table,Minoripriest,5,2,9,http://www.reddit.com/r/SQL/comments/r8z8k/ms_sql_deleting_multiple_rows_from_a_table/,"My database is out of disk space, and I found one table with historical data that goes back for longer than I need it to that's taking up 500GB of space (there's almost 6 million rows). I want to delete all the rows until I hit a timestamp on one of the columns (about 5 million of them).  What's the fastest way to delete them?

EDIT: Thanks for all the responses. I needed to get the database back up as soon as possible, so I was deleting rows in 200k batches. By the time the responses came, I was almost done but it was not a fun night for me.  ",,False,self,t5_2qp8q,True,,,True,t3_r8z8k,http://www.reddit.com/r/SQL/comments/r8z8k/ms_sql_deleting_multiple_rows_from_a_table/,
1332293786.0,3,self.SQL,r61w8,[Oracle] Student needing help with subquerries,Scarcedflame,4,1,7,http://www.reddit.com/r/SQL/comments/r61w8/oracle_student_needing_help_with_subquerries/,"So basically i'm learning SQL in my computer class, the problem being I was absent and have absolutely ZERO idea how to do anything related to subquerries. Does anyone have a tutorial or can explain them simply to me?",,False,self,t5_2qp8q,False,,,True,t3_r61w8,http://www.reddit.com/r/SQL/comments/r61w8/oracle_student_needing_help_with_subquerries/,
1331742130.0,3,reddit.com,qwc0w,[SQL Server] X-post : performances : what's best between a view or a table-valued Function?,cynferdd,3,0,1,http://www.reddit.com/r/SQL/comments/qwc0w/sql_server_xpost_performances_whats_best_between/,,,False,default,t5_2qp8q,False,,,False,t3_qwc0w,http://www.reddit.com/r/SQLServer/comments/qwbjh/question_performances_whats_best_between_a_view/,
1330628041.0,3,self.SQL,qd96g,"Issue with returning more rows than expected due to joins (Seeing duplicates and erroneous data)
",LynzM,5,2,8,http://www.reddit.com/r/SQL/comments/qd96g/issue_with_returning_more_rows_than_expected_due/,"New-ish to SQL question: PL/SQL connecting to an InForm Clinical Trial database. I'm having an issue with returning more rows than expected due to joins. (Seeing duplicates in the QueryID column and erroneous data in the SiteMnemonic column).  Full question here: https://gist.github.com/1951659

Anybody game for helping me figure this out?  Thanks much!!",,False,self,t5_2qp8q,False,,,True,t3_qd96g,http://www.reddit.com/r/SQL/comments/qd96g/issue_with_returning_more_rows_than_expected_due/,
1330442845.0,3,self.SQL,q9rbc,"[Oracle] Stored Proc to store multiple rows, then delete on the IDs stored",myth84,3,0,4,http://www.reddit.com/r/SQL/comments/q9rbc/oracle_stored_proc_to_store_multiple_rows_then/,"Ok, so basically I need to select multiple IDs from one column, then use those IDs to delete from a table.

At the moment I'm trying to do something like this but I'm not sure if I'm doing something wrong or even in the right ballpark.
 
    --this will return multiple rows
    select user_group_user_id, user_group_id
    bulk collect into USERGROUPUSERID, USERGROUPID
    from user_group_user_tab
    where user_id = USERID; --USERID is argument passed in

    --Attemting to delete multiple rows where the above results are found 
    delete from user_group_user_tab 
    where user_group_user_id in USERGROUPUSERID;

    delete from user_group_tab
    where user_group_id in USERGROUPID;

Anyone have some suggestions on how to accomplish this?  I'm not sure if that bulk collect is the way to go or if there's a totally different approach, or if I'm just flat wrong.

Thanks!

edit: The USERGROUPUSERID and USERGROUPID are declared earlier",,False,self,t5_2qp8q,False,,,True,t3_q9rbc,http://www.reddit.com/r/SQL/comments/q9rbc/oracle_stored_proc_to_store_multiple_rows_then/,
1330319652.0,3,accountingplusplus.blogspot.com,q7pwd,Firebird SQL: choosing an owner for database deployment,mariuz,3,0,0,http://www.reddit.com/r/SQL/comments/q7pwd/firebird_sql_choosing_an_owner_for_database/,,,False,default,t5_2qp8q,False,,,False,t3_q7pwd,http://accountingplusplus.blogspot.com/2012/02/firebird-choosing-owner-for-database.html,
1330250151.0,3,self.SQL,q6knh,[MySQL] Group rows with similar timestamps,pomle,4,1,1,http://www.reddit.com/r/SQL/comments/q6knh/mysql_group_rows_with_similar_timestamps/,"My users upload files and I want to find ""upload events"". By upload events I mean time interval where the user uploaded several files at approximately the same time. For this example, we can pick, say 15 minutes.

In other words, I want to find gaps in the record where there are no new rows for at least 15 minutes, based on UTS timestamp.

I'm thinking something like:
    SELECT uploadID, MAX(timeCreated) AS uts_high, MIN(timeCreated) AS uts_low, COUNT(*) AS fileCount FROM Uploads GROUP BY FANCY_GROUP_FUNCTION(timeCreated)

For example, if the user uploaded 5 files between 12:15 and 12:18 this should come out as one row with 12:15 as uts_low and 12:18 as uts_high;

Any takers?",,False,self,t5_2qp8q,True,,,True,t3_q6knh,http://www.reddit.com/r/SQL/comments/q6knh/mysql_group_rows_with_similar_timestamps/,
1329150206.0,4,self.SQL,pnljl,Anyone using Universal SQL Editor?,postliterate,6,2,4,http://www.reddit.com/r/SQL/comments/pnljl/anyone_using_universal_sql_editor/,"I normally use Rapid SQL (connected to an Oracle db), but wanted to try out other editors - my favorite so far is the Universal SQl Editor - I've got a few days left of my free trial.  I'm able to open and run the same SQL files I created in Rapid SQL - with one exception. I have one DECLARE CURSOR statement that simply WON'T WORK in the Universal SQL Editor. It runs fine in every other editor I've played with. Frustrated! Anyone else have a similar experience?",,False,self,t5_2qp8q,False,,,True,t3_pnljl,http://www.reddit.com/r/SQL/comments/pnljl/anyone_using_universal_sql_editor/,
1328207761.0,3,self.SQL,p80c8,Search specific word in all caps.,youjettisonme,5,2,7,http://www.reddit.com/r/SQL/comments/p80c8/search_specific_word_in_all_caps/,"I am sure this is simple, but...

I need to select every row where the text contains a specific word, but only when that word is in all caps.    

Thanks!",,False,self,t5_2qp8q,False,,,True,t3_p80c8,http://www.reddit.com/r/SQL/comments/p80c8/search_specific_word_in_all_caps/,
1327091733.0,2,self.SQL,opaqh,Crosspost from r/mysql,edzibit,4,2,2,http://www.reddit.com/r/SQL/comments/opaqh/crosspost_from_rmysql/,"Like an idiot, I forget to put the title in.  Sorry and thanks for looking anyhow.

**Ordering in a Nested Set**
http://www.reddit.com/r/mysql/comments/oozxv/ordering_in_a_nested_set/

So, I have a table.

    CREATE TABLE domain_tree (
        domain_id INT UNSIGNED NOT NULL PRIMARY KEY,
        domain_name VARCHAR(255) NOT NULL,
        domain_left INT UNSIGNED NOT NULL,
        domain_right INT UNSIGNED NOT NULL
    )



    Anyhow, My SQL looks like this
    SELECT 
    				
        ( COUNT( domain_tree.domain_id ) - sub_tree.domain_id ) AS depth , 
        node.domain_id AS tree_id , 
        node.domain_left AS tree_left , 
        node.domain_right AS tree_right , 
        node.domain_name , 
        node.domain_id
    						
    
        FROM domain_tree, domain_tree AS sub_parent,
        ( 
            SELECT ( COUNT( node.domain_id ) - 1) as depth,
                node.domain_id
            FROM domain_tree , domain_tree AS node
            WHERE node.domain_left
                BETWEEN domain_tree.domain_left AND domain_tree.domain_right
            AND 2 = node.domain_id
            GROUP BY node.domain_id
            ORDER BY node.domain_left
    
        ) AS sub_tree, domain_tree as node
    
    
    
        WHERE node.domain_left BETWEEN domain_tree.domain_left AND domain_tree.domain_right 
        AND node.domain_left BETWEEN sub_parent.domain_left AND sub_parent.domain_right  
        AND sub_parent.domain_id = sub_tree.domain_id 
    
    GROUP BY node.domain_id
    ORDER BY  node.domain_left
    
I use the output to build a tree object and from there I present it to the user.  However, If I add another node into the group that **domain_name** starts with the letter **A**   and this node exists under the same branch as an ALREADY existing node **Z**, I would want **A** to be listed before **Z**.

This does not happen do to *ORDER BY  node.domain_left*.


Quick Note.  I know there are other flat tree models available but I've settled on this one.

Any assistance would be great, thanks.  I'm pretty sure I've solved this somewhere else but I can't find the damn code...maybe I'm imagining things.",,False,self,t5_2qp8q,False,,,True,t3_opaqh,http://www.reddit.com/r/SQL/comments/opaqh/crosspost_from_rmysql/,
1326724378.0,3,self.SQL,ojb2f,SQL Server 2008 &lt;--&gt; IIS/ASP.Net Caching - Help request,lwl,3,0,3,http://www.reddit.com/r/SQL/comments/ojb2f/sql_server_2008_iisaspnet_caching_help_request/,"**SOLVED**

My mistake... there was no caching issue. Just needed to apply my change to 5 different places in the database. Fun times. Cheers for the responses, it's helpful info.

Hi,
I've just run an update query on a db, and was expecting our web app to reflect the changes straight away... but it isn't. I know very little about caching, and was hoping for some pointers of where to look (back end, front end etc.), in order to make this change visible. Hope that's enough info. Cheers!",,False,self,t5_2qp8q,True,,,True,t3_ojb2f,http://www.reddit.com/r/SQL/comments/ojb2f/sql_server_2008_iisaspnet_caching_help_request/,
1325793550.0,3,self.SQL,o4cn2,Could an Oracle pro help me with a little binding upgrade?,rfederici,3,0,1,http://www.reddit.com/r/SQL/comments/o4cn2/could_an_oracle_pro_help_me_with_a_little_binding/,"I need to upgrade some C files from Oracle 8 to Oracle 11g. Specifically a binding sequence, but I'm not great with Oracle. My boss (knowingly) threw me on this assignment when I had no prior experience with databases. I've done as much research as I can, but documentation is scarce and unclear.

There was a call to obndra() that I apparently need to change to OCIBindByName(). However, they take different parameters, and I'm not sure what any of this jargon is: ub4, ub2, sword, etc. so converting between the two seems damn-near impossible.

Seriously, ANY help would be greatly appreciated. Just please keep it simple, and examples would be lovely!",,False,self,t5_2qp8q,False,,,True,t3_o4cn2,http://www.reddit.com/r/SQL/comments/o4cn2/could_an_oracle_pro_help_me_with_a_little_binding/,
1325389693.0,1,self.SQL,ny900,/r/SQL moderator stuff,mgdmw,4,3,5,http://www.reddit.com/r/SQL/comments/ny900/rsql_moderator_stuff/,"Hello all!

Since this community was first established Reddit has provided facilities to make a subreddit more homely. I'd like to consider these if they add value to us.

I've started working on a descriptive text for the sidebar (""The goal of /r/SQL is ..."") which should ultimately include information on what is and is not on-topic, other potential communities and the like.

Additionally, does anyone have any views for or against a custom Reddit alien icon and ""flair""? I think the icon could be fun although not quite sure what an SQL alien would look like! Flair I am not so persuaded on but if anyone has an opinion I'd be interested to hear it.

Happy new year and may your triggers never fail.

Regards,
 mgdmw",,False,self,t5_2qp8q,False,,,True,t3_ny900,http://www.reddit.com/r/SQL/comments/ny900/rsql_moderator_stuff/,moderator
1322115773.0,3,self.SQL,mnn4t,What's my best bet in syncing an MS SQL (2008r2) table on one box to a MySQL (5.x) table on another?,gadorp,4,1,7,http://www.reddit.com/r/SQL/comments/mnn4t/whats_my_best_bet_in_syncing_an_ms_sql_2008r2/,"Pretty simple question, I hope the answer's easy.

I've set up a linked server in MS SQL Management studio, but I can't do any insert or update statements to the My SQL side (using any credentials) I can do select statements but nothing complex.

I simply need to sync one table of one of my MS SQL databases to one table of one of my MySQL databases at a fairly regular interval. (it could be instant, or it could be hourly or even daily if that's all I can get)",,False,self,t5_2qp8q,False,,,True,t3_mnn4t,http://www.reddit.com/r/SQL/comments/mnn4t/whats_my_best_bet_in_syncing_an_ms_sql_2008r2/,
1321893160.0,2,self.SQL,mk9vc,extracting distinct members of 2 sets of results,shakewell,4,2,3,http://www.reddit.com/r/SQL/comments/mk9vc/extracting_distinct_members_of_2_sets_of_results/,"Probably a pretty dumb question, but I'm just starting to learn sql so please bear with me:

Using PL/SQL,
Here's the current code

    select 
  
    ???

      from (select distinct prh.service_num
              from mob_admin.DIST_ORD_ACT_PROD_RECORD prh
             where prh.orr_seq = '2298229'
               and prh.service_action in 'Reconnect') prc,
           
           (select distinct ds.service_id
              from mob_admin.DIST_SERVICES ds
             where ds.orr_seq = '2298229'
               and ds.action in 'Reconnect') dsc

Have 2 select statements that return sets of distinct service_id/service_num. I need to combine these 2 sets into 1 set of distinct members, ultimately I just need the count. How do I go about this?

Thanks",,False,self,t5_2qp8q,False,,,True,t3_mk9vc,http://www.reddit.com/r/SQL/comments/mk9vc/extracting_distinct_members_of_2_sets_of_results/,
1320462032.0,3,self.SQL,m121d,Is MS Access suitable for this work project? Or would SQL be the ticket?,TxRugby,3,0,8,http://www.reddit.com/r/SQL/comments/m121d/is_ms_access_suitable_for_this_work_project_or/,"Assuming the computer that will be processing this data has specs that are up to this kind of task - is MS Access OK for this?

What I have exactly is over 100+ stores that will be sending me their databases. From these databases, I will be extracting sales figures into a report that will show line by line, sales dollar amounts.

Or possibly extracting the data into a separate database, then running a report on the scraped data. Either way, probably processing over 5GB worth.

If MS Access is not suitable, is there an enterprise level database that can read access data tables to give me the information I need on a reliable basis?
",,False,self,t5_2qp8q,False,,,True,t3_m121d,http://www.reddit.com/r/SQL/comments/m121d/is_ms_access_suitable_for_this_work_project_or/,
1319723010.0,4,self.SQL,lqxoj,SQL 2008 R2 - High Availability Options,AnonymooseRedditor,5,1,10,http://www.reddit.com/r/SQL/comments/lqxoj/sql_2008_r2_high_availability_options/,"Hi All, 

I'm a sysadmin, with a decent amount of SQL experience, but I'm no DBA.  I'm in the process of designing a server infrastructure to support some of our business apps that use MS SQL Server as the supporting DB Engine. 

I'm looking for some best practises or recomendations on how I should go about protecting the databases.  I have two sites that are connected by a large WAN connection, I was thinking of using either log shipping or DB Mirroring, and was wondering what everyone else thinks? 

The DB's that need protecting are probably in the neighbourhood of 30-40gb, but the daily change is fairly small. ",,False,self,t5_2qp8q,False,,,True,t3_lqxoj,http://www.reddit.com/r/SQL/comments/lqxoj/sql_2008_r2_high_availability_options/,
1317159443.0,3,mapleoin.eu,ktdwd,"SQL and Relation Theory Master Class - O'Reilly course 
review
",takezo,3,0,0,http://www.reddit.com/r/SQL/comments/ktdwd/sql_and_relation_theory_master_class_oreilly/,,,False,http://thumbs.reddit.com/t3_ktdwd.png,t5_2qp8q,False,,,False,t3_ktdwd,http://mapleoin.eu/perma/sql-and-relational-theory-master,
1317144210.0,3,self.SQL,kt4pz,[ACCCESS] Please help me create a query to show availability of booking slots between two dates.,Antagony,4,1,25,http://www.reddit.com/r/SQL/comments/kt4pz/acccess_please_help_me_create_a_query_to_show/,"Please forgive me for not making/posting any attempt to create this query myself. I struggle to get my head around SQL and I have no idea how to even approach this – and I've been thinking about it for a day now – or indeed whether it's even possible. 

This is a very simplified example of existing booking data:  

booking_ID|slot_ID|start_Date|end_Date
:---|:---|:---|:---|
1|1|2011/10/16|2011/10/25
2|1|2011/10/31|2011/11/17
3|2|2011/10/21|2011/10/26
4|3|2011/10/03|2011/10/19
5|3|2011/10/23|2011/10/28
6|5|2011/09/22|2011/11/06

**Note:** bookings are actually for `x` no. of nights, so back-to-back bookings on the same slot end and start on the same day.

Now, what I would like is a query that returns availability details for each slot between any two dates. So, if I queried say from 2011/10/01 to 2011/11/01, this is what should be returned:  

slot_ID|start_Date|end_Date
:---|:---|:---|
1|2011/10/01|2011/10/16
1|2011/10/25|2011/10/31
2|2011/10/01|2011/10/21
2|2011/10/26|2011/11/01
3|2011/10/01|2011/10/03
3|2011/10/19|2011/10/23
3|2011/10/28|2011/11/01
4|2011/10/01|2011/11/01
6|2011/10/01|2011/11/01
7|2011/10/01|2011/11/01
…   

For extra clarity, here is a graphic showing the bookings and the availability blocks for the above criteria:  
[http://i.imgur.com/K9nTJ.png](http://i.imgur.com/K9nTJ.png)

Any help will greatly appreciated!

**EDIT:** Just to clarify further: the yellow ""Available"" blocks in the picture don't actually exist – they're just there to illustrate the data (date ranges) I need returning. 

**EDIT 2:** WOW! Thanks for the terrifically detailed responses! I'll try to work through each one in turn, which may take me some time – especially for the ones referencing SQL Server, as I'm totally unfamiliar with it and I know Access doesn't support a lot of its functions. But if nothing else, these should give me a great starting point to work out what I need to do. 

Thanks guys!",,False,self,t5_2qp8q,True,,,True,t3_kt4pz,http://www.reddit.com/r/SQL/comments/kt4pz/acccess_please_help_me_create_a_query_to_show/,
1316422317.0,4,self.SQL,kkbgu,Query Help.,whipper515,5,1,10,http://www.reddit.com/r/SQL/comments/kkbgu/query_help/,"My db runs Sybase, SQL Anywhere. Each row in the table I'm trying to query from is a record for (supposedly) one piece of equipment in a warehouse. For simplicities sake, the table has 3 columns: Item ID, Item Name, Serial Number. I'm trying to query every item that shares a serial number with an item that has a different Item ID Number. Table name is Item List. Sample Table:

**Item ID** **Item Name** **Serial Number**

      1        Pen         0001

      2        Pen         0002

      3        Pen         0003
 
      4        Pen         0001

      5        Pen         0003

      6        Pen         0004
",,False,self,t5_2qp8q,True,,,True,t3_kkbgu,http://www.reddit.com/r/SQL/comments/kkbgu/query_help/,
1315324991.0,3,self.SQL,k6iiq,Question about using CASE update else statements.,Skillet_Lasagna,5,2,13,http://www.reddit.com/r/SQL/comments/k6iiq/question_about_using_case_update_else_statements/,"Is there any way I can just tell it to do nothing in the else portion?  Basically, I just want to see how many rows were actually affected.  When I say:  

    ELSE
        ""whatever value it was before the update""  

the row is still affected.  ",,False,self,t5_2qp8q,False,,,True,t3_k6iiq,http://www.reddit.com/r/SQL/comments/k6iiq/question_about_using_case_update_else_statements/,
1311270444.0,3,self.SQL,iw0im,Invalid identifier,oraclenoob,4,1,12,http://www.reddit.com/r/SQL/comments/iw0im/invalid_identifier/,"I'm trying to find a way to filter the results to show only prepdates in the future, but I get a invalid identifier error whenever I try.

Any thoughts or suggestions would be greatly appreciated, I'm sure there are lots of errors.

SELECT
        a.contractid,
        e.reportgroup,
        e.sku,
        b.quantity Qty,
        e.ucdescription,
        d.siteiid,
        a.type,
        TRUNC(GetPeriodDate(a.ContractIID,9,0)) PrepDate,
        TRUNC(GetPeriodDate(b.ConlineIID,1,0)) ShipDate

FROM 
      Contract a,
      ContractLine b,
      SiteMaster d,
      InvMaster e
WHERE
              a.siteiid = d.siteiid
        and   a.contractiid = b.contractiid
        and   e.inviid = b.inviid
        and   e.reportgroup like '%E1%'
        and   prepdate &gt;= '21-JUL-11'",,False,self,t5_2qp8q,True,,,True,t3_iw0im,http://www.reddit.com/r/SQL/comments/iw0im/invalid_identifier/,
1309871798.0,3,self.SQL,ih556,"I'm pretty new to this, so I'm gonna need some help... selecting columns with similar names from multiple different tables AND the tables' names",mwd410,4,1,13,http://www.reddit.com/r/SQL/comments/ih556/im_pretty_new_to_this_so_im_gonna_need_some_help/,"So I have several different tables that have the same column names. What i'm looking to do is retrieve a query that looks something like this:

    ||part_number||rev||step||table_name  ||
    ||12345      ||A  ||1   ||table name 1||
    ||12345      ||A  ||2   ||table name 2||
    ||12345      ||A  ||3   ||table name 3||

so i get one part number and one revision and it lists all the steps and the table for each step. i only want distinct part numbers and revisions, and of course be able to specify which PN and rev i want.

any ideas? ",,False,self,t5_2qp8q,False,,,True,t3_ih556,http://www.reddit.com/r/SQL/comments/ih556/im_pretty_new_to_this_so_im_gonna_need_some_help/,
1308844160.0,3,self.SQL,i78n2,Break a range of prices down into percentile groups,JCollierDavis,3,0,5,http://www.reddit.com/r/SQL/comments/i78n2/break_a_range_of_prices_down_into_percentile/,"I'm trying to retrieve data from a table of vehicle workorder data.  I need to build a percentile bell graph that I can use to compare future workorders cost or manhours expended against to. My initial thought was to break the cost range down into some number equal sized groups.  One hundred groups would be best, but I could use 20.  Then I could plot the count of workorders in each group.  I need to compare another workorder to see which group it would be in to determine if it cost too much money or we expended too many manhours.

I'd like the resulting table to have fields like:

repair_facility, vehicle_type, workorder_count, sum_quantity_repaired, sum_manhours_expended, or sum_total_cost, 

Any suggestions?


EDIT-
Sorry for the paste here, on a GOV machine you can't access pastebin or even googledocs.
Sample of the data from the source table in csv:

    dol_uic,dol_wo,eq_noun,mh_exp,cost_civ,parts_costs,wo_cost
    W0VC15,0VC15B914399,TRK UTIL ARMT HV,14.6,543.85,175,718.85
    W0VC15,0VC15B914050,TRK CGO TAC 1.25T WE,45.6,1694.88,162.79,1857.67
    W0VC15,0VC15B913971,TRK UTL CGO 1.25T 4X4,8,298,387,685

dol_uic is the place that did the work, dol_wo is the work order number, mh_exp is man hours expended

Query used:
    SELECT 
    dol_uic, dol_wo, eq_noun, mh_exp, cost_civ, parts_costs, wo_cost
	
    FROM	
    	    mgt0.vw_Dol_Clsd_Wo	

    WHERE
	    yr = '10'	
    AND
	    ecc = 'HF'
 
    AND dol_uic = 'W0VC15'
	
    AND ROWNUM &lt;= 250




What I'm looking for:

I'd like to split the range of mh_exp down into percentile groups, say group one is 0 mh_exp to 9 mh_exp, group two would be 10 to 19 and so on. Then I'd like the count of workorders that have a mh_exp that falls inside each group. Say for instance it would look like this:

group 01 = 10 wo
group 02 = 18 wo
. . .
group 10 = 254 wo
group 11 = 200 wo
. . .
group 20 = 2 wo

Then using a graph plotting count of wo as the vertical axis and group as the horizontal axis I can get a visual comparison of how many wo's fall in each group.  I expect it to look something like a bell curve, but will probably be more like a wave.",,False,self,t5_2qp8q,True,,,True,t3_i78n2,http://www.reddit.com/r/SQL/comments/i78n2/break_a_range_of_prices_down_into_percentile/,
1305041951.0,4,self.SQL,h86j8,SQL Delete Statement w/ Subquery in PHP/MySQL,llDemonll,5,1,6,http://www.reddit.com/r/SQL/comments/h86j8/sql_delete_statement_w_subquery_in_phpmysql/,"So I have a simple tool thing setup that I use and I enter part numbers into arrays and the tool queries a site for the title and price of that part number and stick the part number, title, and price into a database.  Simple enough.

What I'm trying to do is make the tool automatically delete any parts from the database that no long exist in the array.

Ex.

    $case = array();
    array_push($case, 'N82E16811119225', 'N82E16811119210');

That's what the array looks like

I know how to loop through the array, write it out, whatever, but what I want to do is essentially

    $deleteID = '(';
    foreach($case as $item) {
        $deleteID .= ""'"" . $item . ""', "";
        }
    $deleteID = substr($deleteID, 0, -2);
    $deleteID .= ')';
    $SQL = ""DELETE FROM `info` WHERE `neweggID` NOT IN (SELECT `neweggID` FROM `info` WHERE `neweggID` IN $deleteID)"";

This *would* work flawlessly, aside from the fact that I found out in MySQL you can't use the same table in the subquery as you do in the main delete query. If only NOT IN didn't have to be a subquery, this would be simple.

I'm looking for some way to delete all the `neweggID` in the `info` table where the `neweggID` **isn't** in the $case array.",,False,self,t5_2qp8q,False,,,True,t3_h86j8,http://www.reddit.com/r/SQL/comments/h86j8/sql_delete_statement_w_subquery_in_phpmysql/,
1304550223.0,3,self.SQL,h4dj3,Oracle statistics?,Hactococcus,3,0,1,http://www.reddit.com/r/SQL/comments/h4dj3/oracle_statistics/,"Is there an easy way to get the number of reads/writes/commits done in an Oracle database for a certain time frame?

I've googled but most of the results I get deal with disk I/O.  The rest is usually over my head regarding optimization of finer details.  I just want to know how many time this application is hitting the database.",,False,self,t5_2qp8q,False,,,True,t3_h4dj3,http://www.reddit.com/r/SQL/comments/h4dj3/oracle_statistics/,
1302783742.0,3,use-the-index-luke.com,gpun9,SQL Performance on Growing System Load,,4,1,0,http://www.reddit.com/r/SQL/comments/gpun9/sql_performance_on_growing_system_load/,,,False,default,t5_2qp8q,False,,,False,t3_gpun9,http://use-the-index-luke.com/sql/testing-scalability/system-load,
1301516551.0,3,self.SQL,geysg,Query Help: An aggregate solution required?,rjcarr,3,0,10,http://www.reddit.com/r/SQL/comments/geysg/query_help_an_aggregate_solution_required/,"My problem is a bit more complicated than this, but I think if I get help with this solution then I can figure it out from here.

Say I have two tables and here are the columns:

Customers: custid(key)

Purchases: purchid(key), custid, time, total

I would like to know what is the most recent purchase for each customer?  Thanks!",,False,self,t5_2qp8q,False,,,True,t3_geysg,http://www.reddit.com/r/SQL/comments/geysg/query_help_an_aggregate_solution_required/,
1301417276.0,3,self.SQL,ge1ch,Need to make a decision on a frontend-backend solution for access/sql server. Help needed.,dreamsofastronomy,3,0,8,http://www.reddit.com/r/SQL/comments/ge1ch/need_to_make_a_decision_on_a_frontendbackend/,"Hey guys,

I come from web development but recentlty started at a large company as a working student. The department i'm in has an internal MS access solution with somewhat hefty tables that they keep on a network drive (with horrible speed). Trying to make a good impression and get some shit done I decided It would be a good move to use access as their frontend client (there would be something like 25 users) and have all tables linked to an MS SQL Server. 

We also had Oracle 10g as a choice but I thought it would be easier to handle migration and development with MS SQL Server.

Now IT has offered us somewhat of a quickfix solution involving MS SQL Server 2005 on VMWare. I have tried researching today and the issue is somewhat pressing. I cannot fully make sense of whether this would be a good option. I really don't want to give bad advice nor do I want to look like an idiot having started this whole project.

Does any one of you have experience with this setup? Would anybody care to explain the possible setup just a bit since I honestly don't  entirely comprehend how it would function at this point.
Do I just access my database settings via VMWare player and connect it to access via ODBC like I would with other external db's?

I feel like an idiot at this point and don't want to make any stupid decisions. Any comment would be helpful.

Thanks guys!

EDIT: Thanks for all the help. With your support and some more research I was able to give some great serious advice today and not look like an idiot on the phone with IT :))
",,False,self,t5_2qp8q,True,,,True,t3_ge1ch,http://www.reddit.com/r/SQL/comments/ge1ch/need_to_make_a_decision_on_a_frontendbackend/,
1301083451.0,3,self.SQL,gbicl,MySQL Noob: Is there a way to return only specific rows with a query?,DangerouslyDevilish,3,0,9,http://www.reddit.com/r/SQL/comments/gbicl/mysql_noob_is_there_a_way_to_return_only_specific/,"Hey guys,

I've only been using SQL (MySQL DB) for a little over a week so to say I'm a beginner is an understatement.  I'm doing an analysis of my company's clients and I'd like to setup a query that will only return me the name and revenue of the 25th client, the 50th client, the 100th client, and the 250th client for a weekly basis.  This is just so that I can better understand the gap in spend for my clients.  I can easily pull a list of ALL my clients by name with their revenue, then export to Excel and just hide rows 1-24, 26-49,51-99, and 101-249 but if possible id like SQL to only return me those rows in the first place.

Here's what I have so far:

    SELECT
        clients.`name`,
        sum(costs) AS revenue
    FROM
        clients ,
        rollup_order_day_costs AS r,
        orders
    WHERE
        clients.id = orders.clientid AND
        orders.id = r.order_id AND
        r.dayperiod BETWEEN TO_DAYS('2011-03-07')-TO_DAYS('1970-01-01')-1 AND  TO_DAYS('2011-03-13')-TO_DAYS('1970-01-01')-1
    GROUP BY
        clients.`name`
    ORDER BY
        revenue DESC

This currently returns something to thing to this effect:

    Client A  | 100000
    Client B  |   75000
    Client C  |   50000
    etc...

But I'd really like to see:

    Client J  |  25000
    Client P  |  20000
    Client W |  10000
    Client Z  |     250


Is this possible? I don't know PHP at all which a Google search returns a lot of.
",,False,self,t5_2qp8q,False,,,True,t3_gbicl,http://www.reddit.com/r/SQL/comments/gbicl/mysql_noob_is_there_a_way_to_return_only_specific/,
1299645391.0,3,self.SQL,g0970,"How would you model this type of workflow in an 
RDBMS?",behrangsa,3,0,2,http://www.reddit.com/r/SQL/comments/g0970/how_would_you_model_this_type_of_workflow_in_an/,"Let's pretend we have a product that before release has to be inspected and verified by several persons. So, for example, when Designer inspects and verifies it, we need to record the person that has verified it and the date of verification. Then only after the designer has verified it, say the QA guy should verify it. Again the date and the person need to be recorded. Then say the release manager can verify the product only after the QA person has done so.

One way is to have a table structure like (product_id, designer_person_id, designer_verification_date, qa_person_id, qa_verification_date, release_manager_person_id, release_manager_verification_date) with all the columns with the exception of product_id set to null initially and getting filled as the workflow progresses. But this doesn't look like an elegant solution (maybe because I don't like a lot of nullable columns in my tables?). 

What do you think? Are there better solutions for this problem?",,False,self,t5_2qp8q,False,,,True,t3_g0970,http://www.reddit.com/r/SQL/comments/g0970/how_would_you_model_this_type_of_workflow_in_an/,
1299391587.0,3,blog.andrewvc.com,fya6n,SQL in Shell,,4,1,0,http://www.reddit.com/r/SQL/comments/fya6n/sql_in_shell/,,,False,http://thumbs.reddit.com/t3_fya6n.png,t5_2qp8q,False,,,False,t3_fya6n,http://blog.andrewvc.com/before-postgresql-bruce-momjian-wrote-an-sql,
1299023633.0,3,redd.it,fvemz,Can a constraint be made to guarantee only one row will have a certain value per foreign key? (x-post from /r/mysql),picto,3,0,0,http://www.reddit.com/r/SQL/comments/fvemz/can_a_constraint_be_made_to_guarantee_only_one/,,,False,default,t5_2qp8q,False,,,False,t3_fvemz,http://redd.it/fvefg,
1298264446.0,3,self.SQL,fpcyx,Weird MySQL LIKE query behavior..,PHiZiX,3,0,4,http://www.reddit.com/r/SQL/comments/fpcyx/weird_mysql_like_query_behavior/,"I'm trying to match usernames to first and last names. I have a list of first names and a list of last names. I do two queries:

    CREATE TABLE firstNameMatches AS
    SELECT * FROM UserNames,FirstNames
     WHERE username LIKE CONCAT(FirstNames.firstName,'%')
     GROUP BY userID
    HAVING CHAR_LENGTH(FirstNames.firstName) = MAX(CHAR_LENGTH(FirstNames.firstName));

    CREATE TABLE lastNameMatches AS
    SELECT * FROM UserNames,LastNames
     WHERE username LIKE CONCAT('%',LastNames.lastName,'%')
     GROUP BY userID
    HAVING CHAR_LENGTH(LastNames.lastName) = MAX(CHAR_LENGTH(LastNames.lastName));

Now, there is a username 'geoff'. There is a firstName 'Geoff' in FirstNames. However there is no match for 'Geoff' in firstNameMatches. I knew username 'geoff' existed only because there is a lastName 'EOFF', and that is matching the username 'geoff' in LastNames.

I just ran update set firstName = lower(firstName) on FirstNames and am re-running the query to generate firstNameMatches to see if it helps, but I thought LIKE queries were case insensitive. (UPDATE: it didn't)

P.S. The FirstNames table is 86k records and the LastNames table is 150k records if that makes a difference.",,False,self,t5_2qp8q,False,,,True,t3_fpcyx,http://www.reddit.com/r/SQL/comments/fpcyx/weird_mysql_like_query_behavior/,
1297182538.0,3,self.SQL,fhkuy,Store image in image column or on disk?,guillotinechoke,3,0,5,http://www.reddit.com/r/SQL/comments/fhkuy/store_image_in_image_column_or_on_disk/,I know that an image column is probably going to slow down the performance of my table but I'll most likely have less than 100 records. Can anyone offer advice on pros/cons of using an image column or storing the image on disk (and saving the path in SQL Server)?,,False,self,t5_2qp8q,False,,,True,t3_fhkuy,http://www.reddit.com/r/SQL/comments/fhkuy/store_image_in_image_column_or_on_disk/,
1297145130.0,3,self.SQL,fhc2x,SQL Math Formula? ,tkepongo,3,0,2,http://www.reddit.com/r/SQL/comments/fhc2x/sql_math_formula/,"I'm having a tough time trying to get this formula: 

GPA Avg= ∑((points/credits)*count) / ∑(count)

This is what a portion of the table looks like:

CrseNo                     Credits        Points        Count

555        6        10     3

555		6	    0		2

666		0	    0		1

666	        4	   16		29

Pretty much I'm trying to get it so that it is grouped by CrseNo and that each CrseNo will have a calculated GPA average. Does anyone have any idea how to do this? I'm using SQL Server 2008. Thanks alot!

Here's an image of the table: http://imgur.com/uE7h4",,False,self,t5_2qp8q,True,,,True,t3_fhc2x,http://www.reddit.com/r/SQL/comments/fhc2x/sql_math_formula/,
1297021996.0,3,self.SQL,fgeuk,Reporting Services 2005 ignoring URL parameters on one Server,sqldev34,3,0,1,http://www.reddit.com/r/SQL/comments/fgeuk/reporting_services_2005_ignoring_url_parameters/,"I'm sending properly formed URL parameters to Reporting Services, and they are being ignored. 

Example:
http://reportserver/Reports/Pages/Report.aspx?ItemPath=%2fTest+Reports%2fTestReport1&amp;rs:Command=Render&amp;Year=2010

This works when ran on one of our Reporting Servers, but not one the primary production server. Has anyone encountered a similar problem?

I've ensured that the parameter name for the above query is ""Year"", and the Report path on the server is ""/Test Reports/TestReport1"". ",,False,self,t5_2qp8q,False,,,True,t3_fgeuk,http://www.reddit.com/r/SQL/comments/fgeuk/reporting_services_2005_ignoring_url_parameters/,
1296829691.0,3,self.SQL,ff72y,SQL server enterprise vs SQL server data center,ringringbananaphone,3,0,11,http://www.reddit.com/r/SQL/comments/ff72y/sql_server_enterprise_vs_sql_server_data_center/,I was wondering if anyone here had any insights into the major difference between Microsoft SQL server enterprise edition and SQL server data center edition.,,False,self,t5_2qp8q,False,,,True,t3_ff72y,http://www.reddit.com/r/SQL/comments/ff72y/sql_server_enterprise_vs_sql_server_data_center/,
1296067967.0,3,self.SQL,f9ifd,How to do a crosstab in SQL,,3,0,7,http://www.reddit.com/r/SQL/comments/f9ifd/how_to_do_a_crosstab_in_sql/,"I'm not even sure if this is possible, as I am still pretty new with SQL.  I have an existing query where I pull the number of incoming units acquired at seven different sites, broken down by day.  If I was just summing each location and day, that would be easy.. but I also have 39 different procedures to track as well, each with a different value.  What I need is the location, the date, and the total number of units multiplied by the procedure value.  


Here is what I have so far:



    select distinct dm.fromdatetime, cd.DescLong,
	pd.DescLong,
	dspd.Performed*case when dspd.ProcedureID = 1 then 1
											when dspd.ProcedureID = 2 then 2
											when dspd.ProcedureID = 7 then 1
											when dspd.ProcedureID = 23 then 1
											when dspd.ProcedureID = 25 then 2
											when dspd.ProcedureID = 26 then 1
											when dspd.ProcedureID = 27 then 2
											when dspd.ProcedureID = 29 then 1
											when dspd.ProcedureID = 36 then 2
											when dspd.ProcedureID = 37 then 1
											else 0
									end as Collected
    from DriveMaster dm
    LEFT OUTER JOIN DriveShiftDetail dsd on dm.DriveID=dsd.DriveID
    LEFT OUTER JOIN DriveShiftProcedureDetail dspd on dsd.ShiftID=dspd.ShiftID
    INNER JOIN CenterDetail cd on dm.CenterID=cd.CenterID
    INNER JOIN ProcedureDef pd on dspd.ProcedureID=pd.ProcedureID
    LEFT OUTER JOIN ProcedureProductLink ppl on dspd.ProcedureID=ppl.ProcedureID
    and dm.CenterID &lt;&gt; 1
    and dm.fromdatetime between '1/1/2010' and '12/31/2010'



Thanks

",,False,self,t5_2qp8q,False,,,True,t3_f9ifd,http://www.reddit.com/r/SQL/comments/f9ifd/how_to_do_a_crosstab_in_sql/,
1294972732.0,4,self.SQL,f1yxn,Help with a query?,markdavidboyd,5,1,4,http://www.reddit.com/r/SQL/comments/f1yxn/help_with_a_query/,"Can anyone help me with a query i am stuck on? I'm ok with SQL but not fantastic, any help is appreciated.

The query i have the moment is:

select distinct agentguid, * from ksubscribers.dbo.monitorAlarm
where alertEmail not like 'this@email.com' 
and  eventDateTime between '2011-01-010 00:00:00.000' and '2011-01-12 00:00:00.000'
order by alertSubject asc

The query returns (as a sample)
http://imgur.com/HMVIh

(Really sorry for the image share, was the easiest way i could bother to think about)

What i need to do, is select distinct based on NOTE, but, the values never distinct because of a time stamp. 

What happens is, we get 50 alarms saying a computers are offline. Most of the time, the cause is the same, i need to generate a report based 1 Server id, that contains multiples of the same error

AS you can see in the screen shot. NOTE is where the acknowledgment of the error sits. If i didn't have the time stamp, it would be a simple distinct, but i have to put up with it.

Does anyone see a way of diplaying ONESERVERNAME, ERRORNAME, HOWMANYTIMESITHAPPENED? Based on note

I have confused myself i hope this makes sense to you kind peoples.",,False,self,t5_2qp8q,False,,,True,t3_f1yxn,http://www.reddit.com/r/SQL/comments/f1yxn/help_with_a_query/,
1294413673.0,3,self.SQL,exxe0,"How can I find popular articles in my SQL database, viewed by unique IPs?",menuitem,3,0,5,http://www.reddit.com/r/SQL/comments/exxe0/how_can_i_find_popular_articles_in_my_sql/,"Sorry if this is the wrong /sub, downvote and redirect me if it is. 

I have a table which is a log of web requests of articles in my database (in mysql).  In it are (say) two columns: (1) an article number ""anumber"" and (2) the IP address which requested that article number ""IP"".  

I want a single query which will return a sorted list of the articles with the number of views from *unique* IPs.  I would have thought using ""distinct"" would do it, but it doesn't.  Here's what I tried: 

SELECT DISTINCT anumber, IP, count(*) as A FROM articles GROUP BY anumber ORDER BY A ASC; 

What this does it counts the total number of requests for anumber, including multiple requests from the same IP -- but I only want to include a single request from each IP. 

Thanks in advance.  I thought I was a pretty intermediate mysql user, having used it for 3 years, but I guess not. ",,False,self,t5_2qp8q,False,,,True,t3_exxe0,http://www.reddit.com/r/SQL/comments/exxe0/how_can_i_find_popular_articles_in_my_sql/,
1294284985.0,3,self.SQL,ex0ku,SQL Reporting Services - Field based off query with another field as a parameter,sqldev34,3,0,2,http://www.reddit.com/r/SQL/comments/ex0ku/sql_reporting_services_field_based_off_query_with/,"I have a report which pulls all of it's data from a stored procedure, however I need to add a field to this report based off the value in an already existing textbox and can't modify that stored procedure.

An example is if I had a report to show person details, one field shows the Person_ID field, but I need to add a Person_Name field, which is pulled from the database.

I've created a query which contains (SELECT Person_Name from Persons WHERE Person_ID = @Person_ID), but I'm not sure how I can run this for every person I want to display on the report.

Is it possible to run a value-setting query based off the value of another field, or anything that would do the equivalent?",,False,self,t5_2qp8q,False,,,True,t3_ex0ku,http://www.reddit.com/r/SQL/comments/ex0ku/sql_reporting_services_field_based_off_query_with/,
1290524709.0,3,self.SQL,eajl0,"Fighting with a very large Oracle 11g DB, attempting to clean up strings returned from CLOBs in output.",Tornado_Wind_of_Love,4,1,3,http://www.reddit.com/r/SQL/comments/eajl0/fighting_with_a_very_large_oracle_11g_db/,"Greetings hivemind, hoping for some help.

I'm working on an Oracle 11g database (UTF8 is the charset), and I'm fighting with cleaning up strings extracted from CLOBs.

The problem arises because when people copy and paste MS Word documents into the client-side (which was originally programmed back in 1980-something) it *seems* to convert everything to ASCII (the backend is UTF8 though).

Ideally, I'd like an expression that converts any CHR(X) (where X is &gt;= 32 and &lt;= 127 OR X == 10 OR X == 9) to a space CHR(32). Here is what I've come up with so far:

REGEXP_REPLACE(DBMS_LOB.SUBSTR(note_text, 4000, 1), CHR(191), CHR(32))

I've been doing some googling for the past day, and going through an oracle 11g PL/SQL book without much luck.

Unfortunately I can't just wrap it in Python or Java or anything, so I'm tied to PL/SQL.
",,False,self,t5_2qp8q,False,,,True,t3_eajl0,http://www.reddit.com/r/SQL/comments/eajl0/fighting_with_a_very_large_oracle_11g_db/,
1289942125.0,3,self.SQL,e75yz,Looking for SQL Server 2008(-R2) Resources,davvolun,3,0,5,http://www.reddit.com/r/SQL/comments/e75yz/looking_for_sql_server_2008r2_resources/,"Inspired by [this post](http://www.reddit.com/r/SQL/comments/e1732/recommend_me_books_on_sql_server_2005_novice_and/). I'm looking for current (reddit) knowledge on SQL Server tools and resources. I'm already evaluating the books mentioned by Ken Henderson, are there useful resources specific to or updated for MSSQL 2008? Other comments are welcome (for example, is Henderson's reference on TSQL still useful and usable today, or do I need a new reference?).

Additionally, what about tools? We've used (e.g.) PHPMyAdmin to help (more technical) users with editing databases or for quick commands, I've used Sequel Pro or MySQLWorkbench previously; what options are there for MSSQL? Are there command line (*nix) utilities for MSSQL?

I'm looking for things across the spectrum -- administration, application development, user support, etc.

Thanks in advance.",,False,self,t5_2qp8q,False,,,True,t3_e75yz,http://www.reddit.com/r/SQL/comments/e75yz/looking_for_sql_server_2008r2_resources/,
1289239672.0,3,self.SQL,e30p1,32 and 64 bit 2k5 SQL on a 64 bit 2008 Cluster??,,3,0,3,http://www.reddit.com/r/SQL/comments/e30p1/32_and_64_bit_2k5_sql_on_a_64_bit_2008_cluster/,"From what I can find online, this isn't possible.  Does anyone have definitive proof that it can or can't be done?  The only thing I can find is a slide deck from a MS Tech saying you can't have both 32 and 64 bit instances of SQL 2005 on a 64 bit cluster.

Any help is greatly appreciated!",,False,self,t5_2qp8q,False,,,True,t3_e30p1,http://www.reddit.com/r/SQL/comments/e30p1/32_and_64_bit_2k5_sql_on_a_64_bit_2008_cluster/,
1288883840.0,3,self.SQL,e1732,Recommend me books on SQL Server 2005 - novice and advanced,Louisblack85,4,1,14,http://www.reddit.com/r/SQL/comments/e1732/recommend_me_books_on_sql_server_2005_novice_and/,"My boss has sent me on a mission to get books for my office on SQL Server 2005. I buy a lot of books on various other computing subjects but I'm a bit over my head when looking for Microsoft stuff.

Now we need a book that's good for novices. These people know a fair bit of SQL but an overview of what's new in 2005 would be good.

We could also use a more advanced book for the developer who'll be delving a little more deeply. 

**edit.** Quite rightly I have been asked to give more details.
The majority of us deal with SQL server on a fairly basic level. We run queries, produce reports and write fairly straightforward stored procedures. In SQL server 2000 we create DTS package to automate sending on reports to clients (either via e-mail or uploading to FTP). 

I'm afraid I'm not as clear about what the developer does. I think anything that covers the useful, high end features of the server would be good. Sorry I can't give any more information.

I know it's a pretty vague description and for that I apologise!",,False,self,t5_2qp8q,True,,,True,t3_e1732,http://www.reddit.com/r/SQL/comments/e1732/recommend_me_books_on_sql_server_2005_novice_and/,
1288224722.0,3,self.SQL,dxgd7,Mathematical operations with date/time,kithkatul,3,0,3,http://www.reddit.com/r/SQL/comments/dxgd7/mathematical_operations_with_datetime/,"I'm using MS Access for a school project, and am trying to simulate a hotel database.  There needs to be a report with the bill, which would be the amount of time stayed multiplied with the cost of the room.  If you had the check-in-date and the check-out-date, is there some sort of operation that would be able to calculate the number of days stayed?",,False,self,t5_2qp8q,False,,,True,t3_dxgd7,http://www.reddit.com/r/SQL/comments/dxgd7/mathematical_operations_with_datetime/,
1281442636.0,3,self.SQL,czgmr,MSSQL: Is there a way to ORDER BY when selecting where ID's are not in asc or desc order?,shadowmoses,3,0,4,http://www.reddit.com/r/SQL/comments/czgmr/mssql_is_there_a_way_to_order_by_when_selecting/,"I want to execute a query like this:

SELECT * FROM Webpages WHERE ID IN (6,12,8,13);

And I want the output to come out in that order, 6, 12, 8 and 13. Is there an ORDER BY clause that allows this in MSSQL?

If I exclude the ORDER BY, then it comes out ordered by ID ASC.",,False,self,t5_2qp8q,False,,,True,t3_czgmr,http://www.reddit.com/r/SQL/comments/czgmr/mssql_is_there_a_way_to_order_by_when_selecting/,
1277699259.0,3,self.SQL,cjpru,SQL Import - How long should it take? PHPMyAdmin has been ticking away for about an hour now and is still going.,iamstandingbehindyou,3,0,10,http://www.reddit.com/r/SQL/comments/cjpru/sql_import_how_long_should_it_take_phpmyadmin_has/,,,False,self,t5_2qp8q,False,,,True,t3_cjpru,http://www.reddit.com/r/SQL/comments/cjpru/sql_import_how_long_should_it_take_phpmyadmin_has/,
1277414585.0,3,self.SQL,cipjc,Multiple SQL Databases Showing Same Date-Time Stamp,RichardMcCarty,4,1,3,http://www.reddit.com/r/SQL/comments/cipjc/multiple_sql_databases_showing_same_datetime_stamp/,"My company has a number of databases, some SQL Server 2000 and others SQL Server 2005, which suddenly all show the exact same date-time stamp. Our network administration claims this occurs when patches are applied to our server and CHECKDB is routinely run thereafter.

Does CHECKDB change date-time stamps unless a repair is done? Are we right to think the exact same date-time stamp on multiple databases with different SQL versions is unusual? ",,False,self,t5_2qp8q,False,,,True,t3_cipjc,http://www.reddit.com/r/SQL/comments/cipjc/multiple_sql_databases_showing_same_datetime_stamp/,
1276544548.0,3,blogs.msdn.com,cexy6,Handling Slowly Changing Dimensions in SSIS,enolakardia,4,1,0,http://www.reddit.com/r/SQL/comments/cexy6/handling_slowly_changing_dimensions_in_ssis/,,,False,http://thumbs.reddit.com/t3_cexy6.png,t5_2qp8q,False,,,False,t3_cexy6,http://blogs.msdn.com/b/mattm/archive/2009/11/13/handling-slowly-changing-dimensions-in-ssis.aspx,
1274790458.0,3,brighthub.com,c7w1i,"How to Copy an SQL Table Using MySQL, MS-SQL or other SQL Formats.",scientificworld,6,3,0,http://www.reddit.com/r/SQL/comments/c7w1i/how_to_copy_an_sql_table_using_mysql_mssql_or/,,,False,http://thumbs.reddit.com/t3_c7w1i.png,t5_2qp8q,False,,,False,t3_c7w1i,http://www.brighthub.com/internet/web-development/articles/72097.aspx,
1272049170.0,3,self.SQL,bv99k,Worthwhile SQL certification?,EnderofDragon,3,0,4,http://www.reddit.com/r/SQL/comments/bv99k/worthwhile_sql_certification/,I'm looking to get certified in SQL so I have something on my resume to stand out a bit. The problem is that there seem to be a lot of different certifications available for the various flavors and I only know the core language. Compounding the problem is that many of the tests I have seen online are of questionable origin and may just be meaningless. Is there a certification that would actually be meaningful to employers or are they all just bits of paper?,,False,self,t5_2qp8q,False,,,True,t3_bv99k,http://www.reddit.com/r/SQL/comments/bv99k/worthwhile_sql_certification/,
1271234209.0,3,self.SQL,bqong,Is it possible and how on SQL server to calculate n number of fields and keep information on the n+1 field.,webholic,3,0,5,http://www.reddit.com/r/SQL/comments/bqong/is_it_possible_and_how_on_sql_server_to_calculate/,"I am very new in SQL and SQL Server 2008 and I'm sorry if it is a stupid question. 

I am working on CRM application that runs on SQL Server 2008.

I have budgets column in the database. I want to calculate e.g 3% of the budget and insert calculated amount into the 3percent column.

Is it possible to do on server level? if yes, please advice.

The only solution I have right now is calculate data in Excel and then import it via CRM application back to SQL DB.",,False,self,t5_2qp8q,False,,,True,t3_bqong,http://www.reddit.com/r/SQL/comments/bqong/is_it_possible_and_how_on_sql_server_to_calculate/,
1270009765.0,3,self.SQL,bki2o,Best practice for updating prices in Server 2005?,proslepsis,3,0,10,http://www.reddit.com/r/SQL/comments/bki2o/best_practice_for_updating_prices_in_server_2005/,"I'm not a db admin, but I've found myself taking care of our Server 2005 database when things need to be done. I have a basic understanding of how things work, I've read some beginner books and played around on a test server, but I'm wondering what the best practice in this scenario is.

We sell widgets.  The widget prices are kept on a table that includes, among other things, ItemID, Item Name, Item Unit of Measure, and Item Price.

We want to change our prices. I have been given an .xls with Item Name, Item Unit of Measure, and updated Item Price.

What's the best way to update Item Price? Can I take the 4 columns I have and update from the .xls to change Item Price where (Item Name and Item Unit of Measure)?

Thanks!",,False,self,t5_2qp8q,False,,,True,t3_bki2o,http://www.reddit.com/r/SQL/comments/bki2o/best_practice_for_updating_prices_in_server_2005/,
1248935406.0,3,chesnok.com,95w5c,"OpenSQL Camp comes to Portland! November 14-15, 2009",siliconflorist,6,3,0,http://www.reddit.com/r/SQL/comments/95w5c/opensql_camp_comes_to_portland_november_1415_2009/,,,False,http://thumbs.reddit.com/t3_95w5c.png,t5_2qp8q,False,,,False,t3_95w5c,http://www.chesnok.com/daily/2009/07/29/opensql-camp-comes-to-portland-november-14-15-2009/,
1234071202.0,3,gfilter.net,7vqbu,Tagging in Normalized Form,FlySwat,5,2,0,http://www.reddit.com/r/SQL/comments/7vqbu/tagging_in_normalized_form/,,,False,http://thumbs.reddit.com/t3_7vqbu.png,t5_2qp8q,False,,,False,t3_7vqbu,http://www.gfilter.net/?Post=Tagging-in-Normalized-Form,
1377012184.0,2,self.SQL,1kqkhu,I need help selecting/joining,Toni_W,2,0,7,http://www.reddit.com/r/SQL/comments/1kqkhu/i_need_help_selectingjoining/,"First post here um.. I haven't ever used anything more complex than a SELECT and I am trying to do something that requires joining. I have a Persons table and a Comments table with a common userID column. I would like to pull everything from the Persons table, the first and last timestamp with matching userID from the Comments table, and the comment associated with the last timestamp from the Comments table

This was my attempt... 

    SELECT A.*, MIN(B.timestamp) firstContacted, MAX(B.timestamp) lastContacted 
    FROM Persons A  JOIN Comments B ON A.userID = B.userID; 

This returned the first and last timestamp in general, not just the ones associated with userID, it only returns one row and I am not sure why, and I dont have the slightest clue how to get the relevant comment. 

Let me know if more information is needed please, Thanks for any help!",,False,self,t5_2qp8q,1377012923.0,,,True,t3_1kqkhu,http://www.reddit.com/r/SQL/comments/1kqkhu/i_need_help_selectingjoining/,
1376973860.0,3,ledgersmbdev.blogspot.com,1kpr63,Perspectives on LedgerSMB: In defence of hand coded SQL,einhverfr,6,3,0,http://www.reddit.com/r/SQL/comments/1kpr63/perspectives_on_ledgersmb_in_defence_of_hand/,,,False,http://a.thumbs.redditmedia.com/srUqHiEgCN9fiDDr.jpg,t5_2qp8q,False,,,False,t3_1kpr63,http://ledgersmbdev.blogspot.com/2013/08/in-defence-of-hand-coded-sql.html,
1376936016.0,2,self.SQL,1kogci,How does this cursor work? [Oracle],crustang,2,0,3,http://www.reddit.com/r/SQL/comments/1kogci/how_does_this_cursor_work_oracle/,"I'm trying to learn how a member of my team codes, he built a getter and I have no idea how it works... 

I tried using Google, but I couldn't find the syntax

    CURSOR getZip (Pa_Zip_Code M_Zip.Zip_Code%TYPE)   
      IS
       SELECT *
         FROM M_Zip
        WHERE Zip_Code = Pa_Zip_Code;

     ZipRec     getZip%ROWTYPE;
",,False,self,t5_2qp8q,False,,,True,t3_1kogci,http://www.reddit.com/r/SQL/comments/1kogci/how_does_this_cursor_work_oracle/,
1376507990.0,2,self.SQL,1kd8vz,"MSSQL Select statement problem. Am I over-complicating this, am I missing something, or is this as hard as it seems?",TurnCoordinator,2,0,6,http://www.reddit.com/r/SQL/comments/1kd8vz/mssql_select_statement_problem_am_i/,"I have a list of barcodes that have 1 or two possible identifiers (MPN and ITEM).


I want to only select the ITEM line of there is no MPN line.  In the case of there being an MPN line, I want to ONLY select the MPN line.


Here is a table example


item_no	size	color	barcode_id	barcod

101	      S	        BLUE	ITEM	        101-1

101	      M	BLUE	ITEM	        101-2

101	      S 	BLUE	MPN	        101-1

101	      M	BLUE	MPN	        101-2

102	      S 	RED	ITEM	        102-1

102	      M	RED	ITEM	        102-2

102	      L	        RED	ITEM	        102-3

102	     XL	RED	ITEM	        102-4



Here is my desired result set

101	      S 	BLUE	MPN	        101-1

101	      M	BLUE	MPN	        101-2

102	      S 	RED	ITEM	        102-1

102	      M	RED	ITEM	        102-2

102	      L	        RED	ITEM	        102-3

102	     XL	RED	ITEM	        102-4



Here is my pseudocode.

SELECT * 
FROM TABLE 
WHERE barcod_id  = ‘ITEM’, unless the same item_no has barcod_id = ‘MPN’ then ignore the ITEM lines for that item_no



",,False,self,t5_2qp8q,1376508184.0,,,True,t3_1kd8vz,http://www.reddit.com/r/SQL/comments/1kd8vz/mssql_select_statement_problem_am_i/,
1376216240.0,2,self.SQL,1k4zfk,"[oracle/generic] given a set of different keys from relation X, how would you determine if they shared the same attributes in another relation Y?",comfyred,3,1,4,http://www.reddit.com/r/SQL/comments/1k4zfk/oraclegeneric_given_a_set_of_different_keys_from/,"This seems really simple, but I'm having trouble formulating anything workable... 

Is it just a matter of counting the DISTINCT attributes of Y for the set, and if COUNT is &gt;1, they are different?

edit: i think it might be clearer to say:

If a set of rows in X share some values, how can I determine if they share values in another table Y? ",,False,self,t5_2qp8q,1376227744.0,,,True,t3_1k4zfk,http://www.reddit.com/r/SQL/comments/1k4zfk/oraclegeneric_given_a_set_of_different_keys_from/,
1376087193.0,2,self.SQL,1k20ej,[MySQL] Help Request For Big Query Across Multiple Tables,TheBob,2,0,11,http://www.reddit.com/r/SQL/comments/1k20ej/mysql_help_request_for_big_query_across_multiple/,"I'm writing a small discussion forum site, and I'm having difficulty with a query involving three tables:

  **Threads Table**  
  ThreadID INT NOT NULL AUTO_INCREMENT PRIMARY KEY,  
  ForumID INT,  
  Title VARCHAR(255),  
  OPID INT,  
  DateCreated DATETIME  

  **Posts Table**  
  PostNum INT NOT NULL AUTO_INCREMENT PRIMARY KEY,  
  ThreadID INT,  
  AuthorID INT,  
  PostDate DATETIME,  
  Text MEDIUMTEXT  

  **Users Table**  
  UserID INT NOT NULL AUTO_INCREMENT PRIMARY KEY,  
  Role INT,  
  Username VARCHAR(32),  
  Password VARCHAR(32),  
  Email VARCHAR(48),  
  Avatar VARCHAR(48),  
  PostCount INT,  
  DateCreated DATE,  
  LoggedIn Bool,  
  LastLogin TIMESTAMP,  
  LastActivity TIMESTAMP,  
  Bio TEXT,  
  IP_Address VARCHAR(16)  

In generating a list of threads, I need all the required stuff from the threads table, which is easy. I also need the thread creator's user name and the thread creation date, and the last post date and last poster's user name. I have all of this except the last poster's user name. Here is the working SQL that I have so far:

SELECT Threads.ThreadID, Threads.Title, Threads.OPID, Threads.DateCreated, Users.Username,  
(SELECT PostDate FROM Posts WHERE Posts.ThreadID = Threads.ThreadID ORDER BY PostDate DESC LIMIT 1) AS PostDate  
FROM Threads, Users  
WHERE Threads.ForumID = $_GET[f]  
AND Users.UserID = Threads.OPID LIMIT 50  

I'm having difficulty getting the last poster's user name. I can't select another field in the inner query. I've played with a second inner query, but I'm not sure how to get the correct data out of it, and it seems like bad form to do so. I've attempted both of these options and the query simply fails. I'm not really an SQL guy, so any help here will be appreciated.
",,False,self,t5_2qp8q,False,,,True,t3_1k20ej,http://www.reddit.com/r/SQL/comments/1k20ej/mysql_help_request_for_big_query_across_multiple/,
1375648068.0,2,self.SQL,1jp4gz,Why doesnt this Else statement work?,bluedemon2813,3,1,8,http://www.reddit.com/r/SQL/comments/1jp4gz/why_doesnt_this_else_statement_work/,"ACCEPT p_1 PROMPT 'Please enter an Interger between 1 and 100:'

DECLARE
    v_rank number;
        v_input	Popular_names.rank%TYPE := '&amp;p_1';
    v_mname varchar2(20);
    v_fname varchar2(20);	
BEGIN
    SELECT rank
    INTO v_rank
    FROM Popular_names
        WHERE rank=v_input;
    IF v_input&gt;= 1 and v_input&lt;= 100 THEN
        DBMS_OUTPUT.PUT_LINE('Valid!');
    ELSE
    DBMS_OUTPUT.PUT_LINE('Invalid Number!');
END IF;
END;

WHen i enter 1 it works fine. But when i enter 101 etc it says no data availiable",,False,self,t5_2qp8q,False,,,True,t3_1jp4gz,http://www.reddit.com/r/SQL/comments/1jp4gz/why_doesnt_this_else_statement_work/,
1375137545.0,1,self.SQL,1jb4df,[MS SQL] View or scalar-valued function?,mecartistronico,4,3,10,http://www.reddit.com/r/SQL/comments/1jb4df/ms_sql_view_or_scalarvalued_function/,"There's a value I need to calculate for each member of my EMPLOYEES table. The value is somewhat complex and depends on several tables and views, but for the sake of this example let's say its the length of the last name. I will be using it as part of another view and/or stored procedure.

So I could very well create a view

    CREATE VIEW lengthOfLastName AS
    select employeeID, len(lastName)
    from EMPLOYEES

or I could also create a scalar function **lengthOfLastName(employeeID)** that returns len(lastName) for the given argument.

Any of those two can be used to populate another table/view.

Which is best?
",,False,self,t5_2qp8q,False,,,True,t3_1jb4df,http://www.reddit.com/r/SQL/comments/1jb4df/ms_sql_view_or_scalarvalued_function/,
1375132505.0,2,self.SQL,1jaxke,[Oracle] sum up status,pflaumengeist,2,0,2,http://www.reddit.com/r/SQL/comments/1jaxke/oracle_sum_up_status/,"I have 3 different tables with some data i want to aggregate.

TABLE 1)

| classId | class    |
|---------:|:---------|
|        1 | Spring
|        2 | Summer
|        3 | Autum
|        4 | Winter


TABLE 2)

| studentId | classId | student    |
|----------:|--------:|:-----------|
|       101 |       1 | Alex
|       102 |       1 | Brian
|       201 |       2 | Susan
|       202 |       2 | John
|       ... |     ... | ....


TABLE 3)

| studentId | assignmentId | status |
|----------:|-------------:|:-------|
|       101 |            1 | DONE
|       101 |            2 | FAILED
|       102 |            1 | DONE
|       102 |            2 | DONE
|       201 |            1 | FAILED
|       201 |            2 | FAILED
|       202 |            1 | null
|       202 |            2 | FAILED
|       ... |          ... | ...


The select result should look something like this, depending on which or how many classes are selected:

| class  | students | null | failed | done |
|:-------|---------:|-----:|-------:|-----:|
| Spring |        2 |    0 |      1 |    3
| Summer |        2 |    1 |      3 |    0
|    ... |      ... |  ... |    ... |  ...",,False,self,t5_2qp8q,False,,,True,t3_1jaxke,http://www.reddit.com/r/SQL/comments/1jaxke/oracle_sum_up_status/,
1373986241.0,2,self.SQL,1iezc1,SQL Server 2012: Only showing objects you have access to,Rggity,3,1,2,http://www.reddit.com/r/SQL/comments/1iezc1/sql_server_2012_only_showing_objects_you_have/,"I connect to a server with over 1000 schemas (or so it seems like), and only have access to two of them. Is there a setting to only show the ones that I have access to?

I only ask because within an ODBC connection within excel, it only shows you the objects you have access to.

Thanks in advance!",,False,self,t5_2qp8q,False,,,True,t3_1iezc1,http://www.reddit.com/r/SQL/comments/1iezc1/sql_server_2012_only_showing_objects_you_have/,
1373891710.0,3,garysieling.com,1ic3jz,Scaling A DataFrame In Javascript,snowelephant,6,3,0,http://www.reddit.com/r/SQL/comments/1ic3jz/scaling_a_dataframe_in_javascript/,,,False,http://f.thumbs.redditmedia.com/F4g4TgBLf4KsxEmM.jpg,t5_2qp8q,False,,,False,t3_1ic3jz,http://garysieling.com/blog/scaling-a-dataframe-in-javascript,
1373607274.0,2,self.SQL,1i4wwc,Intro to SQL and Excel class,jdoldno7,3,1,12,http://www.reddit.com/r/SQL/comments/1i4wwc/intro_to_sql_and_excel_class/,"I am a graduate assistant who has been tasked with helping to create an introductory online class on SQL and Excel for people without a IS or CS background.  This class is aimed at people who would likely have an economics, accounting, or finance background who are in an MBA program and want to learn how to use databases and Excel to analyze data.

The class is going to be using SQL Server since our program teaches SQL Server for other classes and the resources already exist.  My problem is finding a book with a sample database that students could use as a tutorial to help them learn concepts they could apply to  graded homework assignments using another database.  Since it is going to be an online class, the book needs to hold their hands and walk them through things.

Any recommendations on a book or a reputable online tutorial that would meet my requirements?

[Edit: Any book or resource needs to be relevant to SQL Server 2012 and Excel 2010 and later]",,False,self,t5_2qp8q,1373607510.0,,,True,t3_1i4wwc,http://www.reddit.com/r/SQL/comments/1i4wwc/intro_to_sql_and_excel_class/,
1373466469.0,2,self.SQL,1i0bku,[OBIEE]Substring Need Help,daniebanes13,3,1,3,http://www.reddit.com/r/SQL/comments/1i0bku/obieesubstring_need_help/,"SUBSTRING(""COL.""Number"" 
FROM LOCATE('-',""- ""COL.""Number"")-LENGTH(""COL.""Number"") 
FOR LENGTH(""COL.""Number""))

My Col.Number includes data that have a - in it such as: 
552-025
0552-003
0254A-005
1234-567
6789-101

I want to return all of the numbers Left of the - dash. The above formula should do this for me but it is returning everything Right of the dash. What is my code missing?",,False,self,t5_2qp8q,False,,,True,t3_1i0bku,http://www.reddit.com/r/SQL/comments/1i0bku/obieesubstring_need_help/,
1373309281.0,2,self.SQL,1hvprq,[MS SQL] How do I determine how many CPU cores I need for my install?,wrong_profession,3,1,2,http://www.reddit.com/r/SQL/comments/1hvprq/ms_sql_how_do_i_determine_how_many_cpu_cores_i/,"I'm going to be upgrading our SQL 2008 Std to SQL 2012 Std and putting it on a VM. But I'm not sure how I determine how many cores I need to give the VM for it to have the best performance. I don't want to waste my money paying for SQL licenses if I don't have to. Currently we have 8 cores on our physical SQL server, but I'm not sure if I need more cores or if we even need the 8 we have. ",,False,self,t5_2qp8q,False,,,True,t3_1hvprq,http://www.reddit.com/r/SQL/comments/1hvprq/ms_sql_how_do_i_determine_how_many_cpu_cores_i/,
1372861739.0,2,self.SQL,1hkgt7,[MS SQL] Trouble with insert statement. Help appreciated.,Laughingstok,3,1,3,http://www.reddit.com/r/SQL/comments/1hkgt7/ms_sql_trouble_with_insert_statement_help/,"I have attached a screenshot of the table in question here: http://i.imgur.com/r7PE6Av.jpg

There are 22 columns outside of the primary key (lid), and when I try to execute the following statement: 

INSERT INTO Logins VALUES ('140' ,'TEST\c801239', '', '', '4/22/2013 11:51:55 AM', '4/22/2013 11:51:55 AM', 'EHS_v4_Dev', 'us_english', '1', '1', '0', '1', '0', '0', '0', '0', '0','0', '0', '0', '0', '7/2/2013')

I receive the following error:

Msg 213, Level 16, State 1, Line 1
Column name or number of supplied values does not match table definition.

I have 22 items in the insert statement, and every column is an nvarchar which should mean all of those values would work, correct?  

I have no idea why this isn't working.  Any ideas?

Edit: SOLVED - I did not set the Primary Key to ""Is Identity"", which means it was waiting for me to insert the lid instead of increasing it on it's own.  ",,False,self,t5_2qp8q,1372862778.0,,,True,t3_1hkgt7,http://www.reddit.com/r/SQL/comments/1hkgt7/ms_sql_trouble_with_insert_statement_help/,
1372690553.0,2,self.SQL,1hffp8,SQL Server 2008: Can I lock out a certain type of connection?,petrus2,5,3,19,http://www.reddit.com/r/SQL/comments/1hffp8/sql_server_2008_can_i_lock_out_a_certain_type_of/,"Last week, I had a consultant working in-house come to me to tell me that there were tons of connections from the web to the SQL database using the sa login. I checked, and sure enough, hundreds. We looked at what it was connecting to and we traced it to one specific in-house developer.

It turns out that he copied the web.config file from his internal dev server onto the production server and for some reason (probably permissions) he'd been using sa login and password in his dev environment. 

So, I'd like to lock out a certain type of connection from my SQL server -- specifically: 

ApplicationName = .Net SqlClient Data Provider

LoginName = sa

Can I do this in SQL Server 2008?",,False,self,t5_2qp8q,False,,,True,t3_1hffp8,http://www.reddit.com/r/SQL/comments/1hffp8/sql_server_2008_can_i_lock_out_a_certain_type_of/,
1372578102.0,2,self.SQL,1hctcr,MS-SQL String Converting,shaigb,3,1,14,http://www.reddit.com/r/SQL/comments/1hctcr/mssql_string_converting/,"Hi All, 
I have a ms-sql server and a table in it that contains ip addresses that are written without dots (no octates, just 1 string) like this - 21168192. 
Also, the IP Addresses are starting with the 4th oct. and ending with the first.
It should be 192.168.1.2 and it's 21168192.

How Can I convert and add the dots ?

Thanks, 
",,False,self,t5_2qp8q,False,,,True,t3_1hctcr,http://www.reddit.com/r/SQL/comments/1hctcr/mssql_string_converting/,
1372564339.0,2,self.SQL,1hcj59,What am I doing wrong? Do I need to join this table with itself?,redditaccount1975,2,0,3,http://www.reddit.com/r/SQL/comments/1hcj59/what_am_i_doing_wrong_do_i_need_to_join_this/,"When I run this I get ALL records where Section=Totals instead of just the one matching PropID and Version ID. Here is code:

        SELECT OAOutput.LineID, OAOutput.Name,OAOutput.Section, OAOutput.P1,  OAOutput.PropID, OAOutput.VersionID
    FROM OAOutput
    WHERE ( ((OAOutput.Section)='Totals') OR ((OAOutput.Section) = 'Potential Revenue') AND ((OAOutput.PropID)=[Property]) AND ((OAOutput.VersionID)=[PropVersion]) )
    ORDER BY OAOutput.Section, OAOutput.SortOrder;
    ",,False,self,t5_2qp8q,False,,,True,t3_1hcj59,http://www.reddit.com/r/SQL/comments/1hcj59/what_am_i_doing_wrong_do_i_need_to_join_this/,
1372453080.0,5,self.SQL,1h9tk0,[MS SQL] Linked Server timeouts Exec vs sp_executesql,sergcontrol,7,2,1,http://www.reddit.com/r/SQL/comments/1h9tk0/ms_sql_linked_server_timeouts_exec_vs_sp/,"Does anyone know why is it that if you have a linked server query that times out (for example due to a locked table), that Exec will return an error but sp_executesql returns a warning.",,False,self,t5_2qp8q,False,,,True,t3_1h9tk0,http://www.reddit.com/r/SQL/comments/1h9tk0/ms_sql_linked_server_timeouts_exec_vs_sp/,
1372177595.0,2,self.SQL,1h1nc8,[MySQL] Newb question about storing aggregate values in tables and keeping integrity,lpso,4,2,4,http://www.reddit.com/r/SQL/comments/1h1nc8/mysql_newb_question_about_storing_aggregate/,"Hi all,

I'm creating a database that stores the details about scores that every player in the database is given. I have a table for Players, a table for Tasks (each task has a max score), a table for Categories (each task is in a certain category), a table specifying how well a given player did on a certain task, a table specifying how well a given player did on a certain category, and a table specifying which category every task is in. My question is, I could get rid of the table specifying how well each player did on a certain Category and calculate that on each query, but I would rather store that for easy access. How can I make sure that a category score for a player is never incorrect? Is there some way to say in SQL that a column should be auto-generated to be an aggregate function somehow?",,False,self,t5_2qp8q,False,,,True,t3_1h1nc8,http://www.reddit.com/r/SQL/comments/1h1nc8/mysql_newb_question_about_storing_aggregate/,
1371184086.0,2,self.SQL,1gbhpr,[MS SQL] Formatting DateDiff to DD:HH:MM,270,2,0,3,http://www.reddit.com/r/SQL/comments/1gbhpr/ms_sql_formatting_datediff_to_ddhhmm/,"Hello
I am working on a query for a hospital. They need to show the time elapsed since a person was admitted. So I came up with the following forumla (Note: The server that MSSQL is stored on is on the east coast, while I am in Arizona where I am uneffected by daylight savings. Thus the sysutcdatetime -7 hours):
    
    DATEDIFF(HH, CAST(ClientEpisode.hospital_admit_date +' '+ClientEpisode.text2 AS DATETIME),DATEADD(HH,-7,sysutcdatetime())) As Elapsed_Time

The only problem is, I need to show this elapsed time as DD:HH:MM. I need help with writing this formula. I cannot simply concatenate the same formula for DD, then HH then MI because for an elapsed time of 1 day it would show as 1:24:1440. I need an elapsed time of 25 hours to show as 1:01:00. Make sense?
Let me know if any more info is required.
Thanks guys",,False,self,t5_2qp8q,False,,,True,t3_1gbhpr,http://www.reddit.com/r/SQL/comments/1gbhpr/ms_sql_formatting_datediff_to_ddhhmm/,
1370954870.0,2,self.SQL,1g48d3,Best way to document scripts?,fahizzled,3,1,9,http://www.reddit.com/r/SQL/comments/1g48d3/best_way_to_document_scripts/,"Hi there

I inherited a large collection of SQL scripts for work, and I was wondering what the best method was of documenting these scripts. I guess what I'm looking for is a web based simple app that either displays the code itself or links to it and also has a few lines of description that I can then go back and search, rather than having to dig through a huge pile of badly named scripts.",,False,self,t5_2qp8q,False,,,True,t3_1g48d3,http://www.reddit.com/r/SQL/comments/1g48d3/best_way_to_document_scripts/,
1370901498.0,2,self.SQL,1g2phy,[MS SQL] Need advice on how to handle illogical commission structures for our sales associates,VictimOfTheKillers,3,1,8,http://www.reddit.com/r/SQL/comments/1g2phy/ms_sql_need_advice_on_how_to_handle_illogical/,"This question has been plaguing me for a few weeks and my lack of database knowledge hasn't been helpful. Basically, when the company first started we calculated a sales rep's commission based on a set criteria. If you sold X at Y you get 10%.

Now, we want to add incentive to sell more. So, we've been doing things like:

If you sold $100k worth of products, you're commission is 12%. $101-$150k is 15% etc.

I'm thinking that I'll have to run a script every month to calculate these. The solution that I came up is to create an XML column on our SalesAssociates table called ""CommissionsLogic"". The XML would look like:

    &lt;ROOT&gt;
        &lt;Commission Lower=""0"" Upper=""100000"" Pct="".05"" /&gt;
        &lt;Commission Lower=""100001"" Upper=""150000"" Pct="".10"" /&gt;
        &lt;Commission Lower=""150001"" Upper=""200000"" Pct="".12"" /&gt;
        &lt;Commission Lower=""200000"" Upper="""" Pct="".15"" /&gt;
    &lt;/ROOT&gt;

Then, I created a SQL Function that would return the reps commission percent based on SalesAssociateID and TotalSales variables:

    SELECT  @Output = ( SELECT  D.element.value('@Pct', 'decimal(3,2)') CommissionPct
                    FROM    dbo.SalesAssociates AS sa
                            CROSS APPLY CommissionLogic.nodes('/ROOT/Commission')
                            AS D ( element )
                    WHERE   UserID = @SalesAssociateID
                            AND ( D.element.value('@Lower', 'MONEY') &lt; @TotalSales
                                    AND D.element.value('@Upper',
                                                        'MONEY') &gt; @TotalSales
                                )
                    )

And, thus, I would run (or schedule) a script to update our Commissions table at the end of the month with the percentage returned from the function.

My questions are: 

* Does anyone see anything absolutely crazy about this implementation?
* Any recommendations for an alternative?
* Is there anything that I should consider doing to make improvements or to make it more scalable?

I sincerely appreciate your time and thoughts...

Thanks,
Andrew",,False,self,t5_2qp8q,False,,,True,t3_1g2phy,http://www.reddit.com/r/SQL/comments/1g2phy/ms_sql_need_advice_on_how_to_handle_illogical/,
1370550479.0,2,self.SQL,1ftcnc,[MS SQL] Do a count based on column values,twonx,2,0,3,http://www.reddit.com/r/SQL/comments/1ftcnc/ms_sql_do_a_count_based_on_column_values/,"So I got a table like this:

|ID | Product |
:--|:-
1|A
2|B
3|A
3|B
4|A
4|B
5|B

How can I have a create a table that displays the distinct list of IDs and a count of Product A, and a count of Product B by it?",,False,self,t5_2qp8q,False,,,True,t3_1ftcnc,http://www.reddit.com/r/SQL/comments/1ftcnc/ms_sql_do_a_count_based_on_column_values/,
1370460427.0,2,self.SQL,1fqo41,Am I in over my head? Access and SQL,jobhunt222,4,2,33,http://www.reddit.com/r/SQL/comments/1fqo41/am_i_in_over_my_head_access_and_sql/,"i got a job where the job listing wanted someone with knowledge of SQL.  I self taught myself SQL about 2 months ago and can do all the basics with ease. But on more complex queries, it takes me a while to figure it out as i have to refer back to my notes, reference books, etc

On the interview, the only programs they really used were Excel and Access.  For the most part,  Im pretty good at Access using its query builder, forms, reports, and creating macros.

so, my question really is... do you think I will struggle much with only limited, albeit well studied(2-3 hours a day) exposure of SQL if the only program im using is access?

",,False,self,t5_2qp8q,False,,,True,t3_1fqo41,http://www.reddit.com/r/SQL/comments/1fqo41/am_i_in_over_my_head_access_and_sql/,
1370388799.0,2,self.SQL,1fop80,[MS SQL] MIN MAX CASE Statment,tedistkrieg,3,1,5,http://www.reddit.com/r/SQL/comments/1fop80/ms_sql_min_max_case_statment/,"I have this script that returns Room Reservation Arrivals for the week.  Some people have more than one reservation during that time in different room types with different rankings. 1 being the best.
    
    For example (columns are playerid,       
    name,arrival,departure,roomtype,roomrank):
    1234|John Smith|06-04-2013|06-06-2013|Mansion|1
    1234|John Smith|06-04-2013|06-06-2013|Main Tower|4
    1234|John Smith|06-03-2013|06-06-2013|Main Tower|6
    5465|Jenny Andrews|06-05-2013|06-07-2013|SkyLoft|2
    etc...

What I am trying to do is return one result for each person with the best room type so I want to turn the above into
    
    1234|John Smith|06-04-2013|06-06-2013|Mansion|1
    5465|Jenny Andrews|06-05-2013|06-07-2013|Skyloft|2

I have been able to get the best room type using

    SELECT count(playerid) as    
    NumofRoom,playerid,lastname,
    firstname,arrival,departure,min(roomrank) as RoomRank
    FROM TABLE  

However, if the person has two rooms with either a different arrival or departure date it will split them up, first column is number of rooms:
    
    2|1234|John Smith|06-04-2013|06-06-2013|Mansion|1
    1|1234|John Smith|06-03-2013|06-06-2013|Main Tower|6


What is the best way to return just one result for each person with the best room type, while still keeping the arrival/departure dates for the best room?  I am guessing its a case statement but cant think through the best way to do it

",,False,self,t5_2qp8q,1370390938.0,,,True,t3_1fop80,http://www.reddit.com/r/SQL/comments/1fop80/ms_sql_min_max_case_statment/,
1370360894.0,2,self.SQL,1fno0l,MSSQL - Clustering Gotchas,pmpjr6465,5,3,6,http://www.reddit.com/r/SQL/comments/1fno0l/mssql_clustering_gotchas/,"Hi

I'm getting ready to build two, two node clusters (server 2012, sql 2012 standard).  All my small scale testing is working perfectly.  Before I go pitch a 100k option and get hardware and do it live, anyone got any gotchas they can throw at me?

Thanks",,False,self,t5_2qp8q,False,,,True,t3_1fno0l,http://www.reddit.com/r/SQL/comments/1fno0l/mssql_clustering_gotchas/,
1370291133.0,2,self.SQL,1flqvi,"[MS SQL] SSRS problem with a report parameter, please help",hi_lampworking,5,3,8,http://www.reddit.com/r/SQL/comments/1flqvi/ms_sql_ssrs_problem_with_a_report_parameter/,"(Microsoft SQL Server 2008 / SSRS  / Visual Studio)

Hi All!
I'm working on a report that displays a bunch of results where each row containins a ""Technician ID number"" 

My primary dataset has a **where table.user2=@techID**

My second dataset (for the parameter) is constructed like:
**select '&lt;ALL&gt;' AS name**
**UNION**
**SELECT name FROM table**
**ORDER BY name**

and the actual parameter is configured to pull from the second dataset ""name"" field 


The current results are that the name parameter does correctly populate and selecting any individual name produces the right results but the &lt;ALL&gt; option is broken. When I try to run &lt;ALL&gt; it just pulls blank results with no errors.

Any thoughts on how to get &lt;ALL&gt; to work?



",,False,self,t5_2qp8q,False,,,True,t3_1flqvi,http://www.reddit.com/r/SQL/comments/1flqvi/ms_sql_ssrs_problem_with_a_report_parameter/,
1369933891.0,2,self.SQL,1fci3h,[MSSQL] Querying/grouping based on first part of contents of a varchar column,The_Ombudsman,2,0,5,http://www.reddit.com/r/SQL/comments/1fci3h/mssql_queryinggrouping_based_on_first_part_of/,"In the table(s) I'm querying on, I've a column that holds browser page view referrer data. I'm trying to come up with a way to query this data and return only the domain info, i.e. everything left of the first slash (I'm trimming off the leading http:// or https:// on insert so that's not a concern) and the counts of those strings.

With my current query syntax, I'm getting back a recordset something like:

    domain.com   8
    domain.com   2
    domain.com   3

where each of those record's ""referrer"" value starts with ""domain.com/"" but has different URL variables attached for each returned row (and different total counts of the full referrer string). I'm doing a LEFT() on the position of the slash to return just the domain.

What I'd like is to craft the syntax to do the extra job of combining all these rows based on the common values left of the first slash position, and ignoring the first slash and everything after it, with a combined total count value - so I end up with

    domain.com   13
",,False,self,t5_2qp8q,False,,,True,t3_1fci3h,http://www.reddit.com/r/SQL/comments/1fci3h/mssql_queryinggrouping_based_on_first_part_of/,
1369412729.0,2,self.SQL,1ez8bk,Is this an appropriate book for me to learn SQL?,wantolearn81,3,1,17,http://www.reddit.com/r/SQL/comments/1ez8bk/is_this_an_appropriate_book_for_me_to_learn_sql/,"I learn best from books, not websites...

I have limited use of SQL in Access and want to increase my knowledge.

Thinking of buying SQL cookbook by anthony morelii

would this be useful or have alot of stuff not applicable to access?",,False,self,t5_2qp8q,False,,,True,t3_1ez8bk,http://www.reddit.com/r/SQL/comments/1ez8bk/is_this_an_appropriate_book_for_me_to_learn_sql/,
1369319907.0,2,self.SQL,1ewl8p,Help me combine these 3 queries into one,fa2424,3,1,6,http://www.reddit.com/r/SQL/comments/1ewl8p/help_me_combine_these_3_queries_into_one/,"I have 2 tables.  

Table A- Company( A or B), Product #,  Price

Table B(has company C information)- Product #, Price

I want to have my columns look like this (Product #, Company A price, Company B price, Company C price)

I tried this and it did not work because unions need to have matching columns.  Any other ideas?

select Product #, Price as Company A price
from table A
where company=A
union
Select Product #, price as company B price
from table A
where company=B
union
select product #, price as company C price
from table B
",,False,self,t5_2qp8q,False,,,True,t3_1ewl8p,http://www.reddit.com/r/SQL/comments/1ewl8p/help_me_combine_these_3_queries_into_one/,
1369241488.0,2,self.SQL,1eudk1,"[tSQL]Wondering why I am getting ""Conversion failed when converting date and/or time from character string""",randomperson24,2,0,4,http://www.reddit.com/r/SQL/comments/1eudk1/tsqlwondering_why_i_am_getting_conversion_failed/,"I am not sure why I am getting this error as I did the exact same syntax on another report and it is fine.  The data is even being pulled from the same table.  Any ideas?
	
SELECT
		CONVERT(datetime, LEFT(#Client.Birthdate,4)+
			SUBSTRING(#Client.Birthdate,6,2)+
			RIGHT(#Client.Birthdate,2)) AS 'BirthDate',
			#Client.Client_ID
	INTO #Client_Birthdate
	FROM #Client
",,False,self,t5_2qp8q,False,,,True,t3_1eudk1,http://www.reddit.com/r/SQL/comments/1eudk1/tsqlwondering_why_i_am_getting_conversion_failed/,
1368776182.0,2,self.SQL,1ei8af,System 21 / JBA / AS400 SQL question,,3,1,6,http://www.reddit.com/r/SQL/comments/1ei8af/system_21_jba_as400_sql_question/,"Hello everyone,
I'm brand new to this sub Reddit and relatively new to SQL as well. In the office i work in the last programer left and i no longer have anyone to ask questions regarding my musings in SQL. We use both AS400 (aka JBA aka system 21) and Oracle depending on the company we are accounting for (im an accountant). In my SQL code for JBA i have a WHERE NOT clause. In the said WHERE NOT clause I want SQL not to return a record if all of the fields are NULL. When i practice at home in Access i can accomplish this with the clause WHERE NOT ( cl1 = """" AND cl2 = """" AND cl3 = """"). In MS Access this will return a record if any of the cl fields contain non NULL data - this makes sense to me. But in AS400 to get the same results i have to use the following clause:
WHERE NOT ( cl1 = 0.00 OR cl2 = 0.00 OR cl3 = 0.00). To me the Access syntax use of AND makes sense but the AS400 use of OR instead of AND makes my mind go into a uncontrolled seizure. Why why why is the syntax so different in the so called standardized SQL. I'm just assuming there is a very good reason my companies developing a DBMS don't follow standard SQL syntax. Sorry in advance if my noob question through you into a rage ;p
but i am genuinely curious. ",,False,self,t5_2qp8q,False,,,True,t3_1ei8af,http://www.reddit.com/r/SQL/comments/1ei8af/system_21_jba_as400_sql_question/,
1368733891.0,2,self.SQL,1egyap,MS SQL Server Update Issue,Kazoli,2,0,7,http://www.reddit.com/r/SQL/comments/1egyap/ms_sql_server_update_issue/,"I am updating one record in my table with a simple update,set,where syntax, and I am getting a message saying that the intended rows have been affected. However, when I try to query something in that table after the update, it isn't able to fully execute the query. Records up to the updated row show up, but it won't get to the new one. I have sat and waited on this for up to 15 minutes with no luck. Also, there are no triggers or anything like that on this table. Any ideas what could be going on?",,False,self,t5_2qp8q,False,,,True,t3_1egyap,http://www.reddit.com/r/SQL/comments/1egyap/ms_sql_server_update_issue/,
1368478860.0,2,self.SQL,1e9oyf,[MySQL] Database for 2014 world cup in soccer,hesterbest,3,1,7,http://www.reddit.com/r/SQL/comments/1e9oyf/mysql_database_for_2014_world_cup_in_soccer/,"I'm working on a personal project where I'd like to keep track of games and standings in next years world cup in soccer. I want to do this in form of a web-site. I want the web-site to be able to do the following:

* Display the group standings (A-H)
* Display the group matches
* Display the match-detail of a match: goal scorers, cards, penalties, extra-time, penalty shootout, venue.
* Display the squad of each team (Not the formation or starting 11, I just wanna display the 23 players of each team)
* Display the knockout stage bracket.

There are a total of 64 matches played in the world cup, 48 in the group stage and 16 in the knockout stage.

Since I did something similar for the European Championship in 2012 I have a basic idea how to build this. However, I would really appreciate some input on the database.

[http://pastebin.com/jzGzZKBR](http://pastebin.com/jzGzZKBR)

I have the following tables:

* teams
* players
* venues
* matches
* goals (half = 1st half, 2nd half, 1st extra time, 2nd extra time or shootout. Possibly make enum here)
* cards (half = 1st half, 2nd half, 1st extra time, 2nd extra time or shootout. Possibly make enum here)
* standings

I have the following view:

* results (this view gives me the result of matches).

I query the results-view to populate the standings table after a match has been completed.

Now these tables seems to cater to my needs. Do any of you have any suggestions to improvements? Also, can someone point out some reasons to why any these tables are not in 3NF or BCNF?

Edit: Changed to get better formating.

Edit: I do not want the database to support multiple tournaments, so I do not need tips on how to create a database which will support the 2018 World Cup or any other tournaments.",,False,self,t5_2qp8q,False,,,True,t3_1e9oyf,http://www.reddit.com/r/SQL/comments/1e9oyf/mysql_database_for_2014_world_cup_in_soccer/,
1368302161.0,2,self.SQL,1e57j9,[ACCESS] Union is acting weird. Any help appreciated!,arvi1000,2,0,2,http://www.reddit.com/r/SQL/comments/1e57j9/access_union_is_acting_weird_any_help_appreciated/,"Hi all. Something weird is happening with UNION.

-I have two tables with the same fields: [id, d1, d2, weight]

-I want to collapse the tables and store as a third table, so i did this

    insert into EdgeTemp3
    select d1, d2, sum(w) as weight from
    (select d1,d2,weight as w from EdgeTemp1 union
    select d1,d2,weight as w from EdgeTemp2)
    group by d1, d2

but the sum of the 'weight' field in table 3 != the sums of that field in tables 1 and 2.  When I run:

    SELECT sum(weight) from EdgeTemp1 union
    SELECT sum(weight) from EdgeTemp2 union
    SELECT sum(weight) from EdgeTemp3

...I get:

    790,303 (table 1)
    1,066,462 (table 2)
    1,823,850 (table 3)

Table 3 is 2% smaller than 1 + 2, when I was expecting it to be the exact same (fewer rows but same sum of 'weight'). Any thoughts? This is in Access 2007, but I'm not doing anything Access-specific here, I don't think. Thanks!",,False,self,t5_2qp8q,False,,,True,t3_1e57j9,http://www.reddit.com/r/SQL/comments/1e57j9/access_union_is_acting_weird_any_help_appreciated/,
1368126702.0,2,self.SQL,1e0ox3,Targeting specific parts in a row [tSQL],randomperson24,2,0,5,http://www.reddit.com/r/SQL/comments/1e0ox3/targeting_specific_parts_in_a_row_tsql/,"Is there a way to split up addresses so that I only get specific parts in a column?  The issue is some of the lengths of the addresses are different and I don’t know how to grab certain parts if the character length varies.  For example, I could have ""1234  SE Hope St""  in a row and ""54 N Grant St"" in another.  I would need 1234 and 54 in a column, SE and N in a different column, Hope and Grant in a different column, and St and St in a different column.  Is this possible?",,False,self,t5_2qp8q,False,,,True,t3_1e0ox3,http://www.reddit.com/r/SQL/comments/1e0ox3/targeting_specific_parts_in_a_row_tsql/,
1368117127.0,1,self.SQL,1e0cbs,Basic question. new to sql,noob2828,4,3,18,http://www.reddit.com/r/SQL/comments/1e0cbs/basic_question_new_to_sql/,"My query looks like this Select Distinct Company, Product
From Master_table
Where product &lt;&gt; '0'

I want a list of companies that sell products through us.  I only want a company to be returned ONE time. 

However, since most companies sell 50 products through us, they are being returned 50 times for each product.

How can i change this query to fix this?",,False,self,t5_2qp8q,False,,,True,t3_1e0cbs,http://www.reddit.com/r/SQL/comments/1e0cbs/basic_question_new_to_sql/,
1368025104.0,2,self.SQL,1dxnht,Need help loading data into a table with a recursive FK,laurenza,2,0,2,http://www.reddit.com/r/SQL/comments/1dxnht/need_help_loading_data_into_a_table_with_a/,"I have a stored proc that inserts data into a table.  One of the fields is a recursive foreign key - it references another record in the same table.  When I run my statement the first time, the FK field is not populated.  It's all nulls.  When I run it a second time, it gets populated correctly.

Is there a way to have this field populated during the first pass?  The records are in the correct order such that records that are trying to reference other records come after those that they are trying to reference.",,False,self,t5_2qp8q,False,,,True,t3_1dxnht,http://www.reddit.com/r/SQL/comments/1dxnht/need_help_loading_data_into_a_table_with_a/,
1367947291.0,2,self.SQL,1dvfhw,[MS SQL] Need help pulling headers from my query WITH the data.,yuckypants,3,1,12,http://www.reddit.com/r/SQL/comments/1dvfhw/ms_sql_need_help_pulling_headers_from_my_query/,"I've been tasked with inserting headers into sql query results. The catch is, this is an automated job. I searched around and found the code I need to add, but I'm having some difficulty trying to figure out where to put it. 

Here's my code so far: 

    select 
          i.COMPANY, 
          i.ITEM, 
          li.ON_HAND_QTY, 
          li.ALLOCATED_QTY, 
          li.SUSPENSE_QTY, 
          CASE 
                WHEN li.ON_HAND_QTY - li.ALLOCATED_QTY - isnull(sd.total_qty , 0) &lt; 0 THEN 0 
                ELSE li.ON_HAND_QTY - li.ALLOCATED_QTY - isnull(sd.total_qty , 0) 
          END AVAILABLE_QTY,
          li.TOTAL_COST, 
          li.TOTAL_VALUE, 
          i.USER_DEF3,
          case when li.ON_HAND_QTY - li.ALLOCATED_QTY - isnull(sd.total_qty , 0) &gt; 0 then 'In Stock' else 'Out Of Stock' end IN_STOCK
    from (
          select li.ITEM, li.COMPANY, SUM(ON_HAND_QTY) ON_HAND_QTY, SUM(ALLOCATED_QTY) ALLOCATED_QTY, SUM(SUSPENSE_QTY) SUSPENSE_QTY, SUM(TOTAL_COST) TOTAL_COST, SUM(TOTAL_VALUE) TOTAL_VALUE
          from LOCATION_INVENTORY li inner join LOCATION l
                on li.LOCATION = l.LOCATION
                and li.warehouse = l.warehouse
          inner join GENERIC_CONFIG_DETAIL Loc_Class
                on Loc_Class.IDENTIFIER = l.LOCATION_CLASS
                and RECORD_TYPE = 'LOCCLASS'
          where Loc_Class.SYS1VALUE = 'Y'
          and li.COMPANY = '000000201140'
          group by li.ITEM, li.COMPANY
    ) li
    inner join ITEM i
          on li.ITEM = i.ITEM
          and ISNULL(li.COMPANY, '') = isnull(i.COMPANY, '')
    left outer join (
          select ITEM, company, SUM(total_qty) total_qty
          from SHIPMENT_DETAIL
          where STATUS1 = 100
          group by ITEM, COMPANY
    ) sd
          on li.ITEM = sd.ITEM
          and isnull(li.COMPANY, '') = isnull(sd.COMPANY, '')
    --group by i.COMPANY, i.ITEM, i.USER_DEF3
    order by i.COMPANY, i.ITEM, i.USER_DEF3
    

This is what I need to add: 

    SELECT COLUMN_NAME
    FROM INFORMATION_SCHEMA.COLUMNS
    WHERE TABLE_NAME = 'TableNameGoesHere'
    ORDER BY ORDINAL_POSITION

I'm not entirely certain how/where to add this though. In fact, I believe I'd need a UNION ALL command as well, right? 

**EDIT** Maybe this *isn't* what I need to add. I need to append the columns to the data, not just query the columns. Besides - the new query isn't a table - it's a combination of tables. How can I pull the resulting columns? 

I found this [here](http://stackoverflow.com/questions/4964162/how-to-add-table-column-headings-to-sql-select-statement)

Select FirstName, LastName

 from (

    select Sorter = 1, FirstName, LastName from People

    union all

    select 0, 'FirstName', 'LastName') X

 order by Sorter, FirstName",,False,self,t5_2qp8q,1367948083.0,,,True,t3_1dvfhw,http://www.reddit.com/r/SQL/comments/1dvfhw/ms_sql_need_help_pulling_headers_from_my_query/,
1367751313.0,2,self.SQL,1dq67n,Having a really tough time with EQUI joins using the same table [Oracle],Cassiop,2,0,2,http://www.reddit.com/r/SQL/comments/1dq67n/having_a_really_tough_time_with_equi_joins_using/,"Hey all,

I'm stuck on a problem from my teacher, he is having me use 1 table for an Equi join. The table looks like this 
http://i.imgur.com/gFzsATs.png

as you can see there are 3 manager ids.
each employee has an assigned manager.

What my teacher wants is to display 
Employee name, with the corresponding Manager name
using an EQUI join.

This is all using the same table.
Ive been at this problem for hours and cannot figure this out.
Is this possible using the same table?

Any tips help!

Thank you!",,False,self,t5_2qp8q,False,,,True,t3_1dq67n,http://www.reddit.com/r/SQL/comments/1dq67n/having_a_really_tough_time_with_equi_joins_using/,
1367447761.0,2,self.SQL,1dig4t,2 primary keys to one foreign key - query 2 separate values?,airtrixxx1080,3,1,4,http://www.reddit.com/r/SQL/comments/1dig4t/2_primary_keys_to_one_foreign_key_query_2/,"Table 1:
Contains 1) Origin vendor code and 2) Destination vendor code. This table does *not* provide vendor names

Table 2:
Contains vendor name based on a vendor code (regardless of whether it's an origin or destination vendor)

Currently, I have ""Origin vendor code"" (in table 1) linked to ""Vendor Code"" (in table 2). In my report, it gives me 1) the origin vendor **code**, 2) the origin vendor **name**, and 3) the destination vendor **code**. I would like to add the *destination vendor name* to this report, which would also pull from Table 2.

Is this possible?

",,False,self,t5_2qp8q,False,,,True,t3_1dig4t,http://www.reddit.com/r/SQL/comments/1dig4t/2_primary_keys_to_one_foreign_key_query_2/,
1367426748.0,2,self.SQL,1dhnkd,problem using variables,whoisearth,4,2,8,http://www.reddit.com/r/SQL/comments/1dhnkd/problem_using_variables/,"Can someone let me know what I'm doing wrong here?

The field I'm trying to use the variable in is TEXT if it matters.

    DECLARE @parentID varchar(7)
    SET @parentID = (SELECT jobrun_id FROM jobrun WHERE jobrun_params LIKE '%equity_warrant_euro.dif%'
    AND jobrun_proddt = '2013-04-29' AND CAST(jobrun_stachgtm As DATE) = '2013-04-29'
    AND jobrun_prntid IS NULL)
    SELECT jobmst_name, CAST (jobrun_proddt AS DATE) ProdDate, jobrun_duration DuraTime, DATEDIFF (ss,jobrun_launchtm, jobrun_lstchgtm) TidDuraTime, CAST (jobrun_lstchgtm As TIME) CompTime FROM jobrun
    JOIN jobmst ON (jobrun.jobmst_id = jobmst.jobmst_id)
    WHERE jobrun_prntid = (SELECT jobrun_id from jobrun WHERE jobrun_prntid = (
    SELECT jobrun_id from jobrun WHERE CONVERT(varchar,jobrun_params) LIKE @parentID))

I know the variable is returning the value I want, but it doesn't seem to be parsing it into the LIKE @parentID.  I've tried '@parentID' and '%@parentID%' and variations of both '%' + @parentID, etc.

Alternatively, if someone know how I can embed my SELECT statement into the LIKE clause I would do that, but it doesn't like the syntax.

UPDATE - 

So I must have been brainfarting I got it to work thanks to the help of you guys :)  But it doesn't like that I'm trying to do it as a 3rd UNION (see below).  If I run everything after **DECLARE** on it's own it's fine.  As soon as I try to run the whole thing together it craps out.

    SELECT jobmst_name, CAST (jobrun_proddt AS DATE) ProdDate, jobrun_duration DuraTime, DATEDIFF (ss,jobrun_launchtm, jobrun_lstchgtm) TidDuraTime, CAST (jobrun_lstchgtm As TIME) CompTime FROM jobrun
    JOIN jobmst ON (jobrun.jobmst_id = jobmst.jobmst_id)
    WHERE jobmst.jobmst_id = (SELECT jobmst_id FROM jobmst WHERE jobmst_type = 6
    AND jobmst_prntid = (SELECT jobmst_id FROM jobmst WHERE jobmst_name LIKE '%FTP%'
    AND jobmst_prntid = (SELECT jobmst_id FROM jobmst JOIN jobdtl ON jobmst.jobmst_id = jobdtl.jobdtl_id WHERE jobdtl_params LIKE '%equity_warrant_euro.dif%'
    AND jobmst_type = 1 AND jobmst_active = 'Y')))
    AND jobrun_status = 101 AND jobrun_duration IS NOT NULL AND jobrun_proddt = '2013-04-29'
    UNION
    SELECT jobmst_name, CAST (jobrun_proddt AS DATE) ProdDate, jobrun_duration DuraTime, DATEDIFF (ss,jobrun_launchtm, jobrun_lstchgtm) TidDuraTime, CAST (jobrun_lstchgtm As TIME) CompTime FROM jobrun
    JOIN jobmst ON (jobrun.jobmst_id = jobmst.jobmst_id)
    WHERE jobrun_prntid = (
    SELECT jobrun_id FROM jobrun WHERE jobrun_prntid = (
    SELECT jobrun_id FROM jobrun WHERE jobrun_params LIKE '%equity_warrant_euro.dif%'
    AND jobrun_proddt = '2013-04-29' AND CAST(jobrun_stachgtm As DATE) = '2013-04-29'
    AND jobrun_prntid IS NULL
    ))
    UNION
    DECLARE @parentID varchar(7)
    SET @parentID = (SELECT jobrun_id FROM jobrun WHERE jobrun_params LIKE '%equity_warrant_euro.dif%'
    AND jobrun_proddt = '2013-04-29' AND CAST(jobrun_stachgtm As DATE) = '2013-04-29'
    AND jobrun_prntid IS NULL)
    SELECT jobmst_name, CAST (jobrun_proddt AS DATE) ProdDate, jobrun_duration DuraTime, DATEDIFF (ss,jobrun_launchtm, jobrun_lstchgtm) TidDuraTime, CAST (jobrun_lstchgtm As TIME) CompTime FROM jobrun
    JOIN jobmst ON (jobrun.jobmst_id = jobmst.jobmst_id)
    WHERE jobrun_prntid = (SELECT jobrun_id from jobrun WHERE jobrun_prntid = (
    SELECT jobrun_id from jobrun WHERE jobrun_params LIKE '%' + @parentID + '%'))

EDIT _ FINAL - 

I moved the DECLARE to the beginning and did an order by jobmst_name at the end and we're all good!

Thanks guys!

",,False,self,t5_2qp8q,1367449910.0,,,True,t3_1dhnkd,http://www.reddit.com/r/SQL/comments/1dhnkd/problem_using_variables/,
1367424307.0,2,self.SQL,1dhkgj,Multiple SELECTs in loop breaking up query (T-SQL),zombiedada,2,0,2,http://www.reddit.com/r/SQL/comments/1dhkgj/multiple_selects_in_loop_breaking_up_query_tsql/,"I'm using a WHILE loop to increment a time variable (it's for school terms), so that I can grab multiple terms and their offsets. But when I drop the query from SSMS into Power Pivot, Power Pivot only grabs the results of the very first SELECT statement. I can't seem to programmatically add-in a UNION, and I'm stuck. Any help, suggestions, greatly appreciated. I do not have access to create temporary tables.

http://pastebin.com/TxAvRagd",,False,self,t5_2qp8q,False,,,True,t3_1dhkgj,http://www.reddit.com/r/SQL/comments/1dhkgj/multiple_selects_in_loop_breaking_up_query_tsql/,
1367340662.0,2,self.SQL,1df55x,[MS SQL] Replication failing on one table. Weird.,firsttbrocade,2,0,6,http://www.reddit.com/r/SQL/comments/1df55x/ms_sql_replication_failing_on_one_table_weird/,"I have replication occurring for a database and one of the tables is not being replicated and I am unsure why. Not only is it not replicating the data it is dropping the table all together. This has worked for several years and the issue just suddenly popped up.

I have tried to reinitialize the subscription with a new snapshot and that does not work. I have also tried creating the table again and once it comes time to replicate the data it drops the table again.

I have also tried recreating the entire subscription from scratch to no avail. 

Any thoughts as to what to check here, I am a networking and infrastructure guy so DBA isn't my primary role.",,False,self,t5_2qp8q,1367342084.0,,,True,t3_1df55x,http://www.reddit.com/r/SQL/comments/1df55x/ms_sql_replication_failing_on_one_table_weird/,
1367240750.0,2,self.SQL,1dc2qz,[SQL] Taking an introductory database class and could use some help on a final project.,komebeaux,4,2,6,http://www.reddit.com/r/SQL/comments/1dc2qz/sql_taking_an_introductory_database_class_and/,"Ok, first off, this is a required class and I have struggled all semester. I really need to nail this to keep my gpa up. I am not adept at programming, hence why I am struggling.
I was provided an existing SQL database that I am running in XAMP. I have a list of tasks I need to run on this database. 

This is the first question of 12 total, so I will take this one at a time as they are answered. Thanks in advance for any help you can provide. I would imagine this is child's play for an experienced SQL programmer, but like I said before, I struggle with this stuff. I want to understand it better, however, and have had difficulty getting explanations from my instructor.   

So, anyway, here's the first one:

Create a new table that uses the following criteria: 
*column
*type
*length
*decimal places
*nulls allowed?
*description
I am ok with this one for the most part, but the 'nulls allowed?' and 'description' are confusing me. ",,False,self,t5_2qp8q,False,,,True,t3_1dc2qz,http://www.reddit.com/r/SQL/comments/1dc2qz/sql_taking_an_introductory_database_class_and/,
1366998848.0,2,self.SQL,1d611b,[TSQL]Creating Dummy Values in Table,randomperson24,2,0,3,http://www.reddit.com/r/SQL/comments/1d611b/tsqlcreating_dummy_values_in_table/,Currently what I have is a table like [this](http://www.freeimagehosting.net/dkz79).  It contains a date if the letter occurred during that particular month.  What I need is something like [this](http://www.freeimagehosting.net/hojfn).  Where there is a letter for every possible date.  I also have a table with [all possible letters](http://www.freeimagehosting.net/qpeh2) and another table with [all possible dates](http://www.freeimagehosting.net/fc6uw).  What I am trying to create is [another table](http://www.freeimagehosting.net/hojfn) with dummy values so if an alphabet does not appear in a particular month; it would still have a possible row for each alphabet and date like this.  Let me know if this doesn’t make sense because I was trying to make this as simple as possible.,,False,self,t5_2qp8q,False,,,True,t3_1d611b,http://www.reddit.com/r/SQL/comments/1d611b/tsqlcreating_dummy_values_in_table/,
1366603792.0,2,self.SQL,1cuep0,Remote bulk insert,RshAndRoulette,2,0,6,http://www.reddit.com/r/SQL/comments/1cuep0/remote_bulk_insert/,"I'm working on a project for a class that requires me to be able to import a .csv file to my university's server. I do not have access to the server itself, so when I specify a file path such as C:\ , it cannot find the file because the server is looking on its own network drives, and not on my remote machine. Does anyone have any ideas on how to get this (or a similar function) to work remotely? Thank you all in advance for your help. I really appreciate it.",,False,self,t5_2qp8q,False,,,True,t3_1cuep0,http://www.reddit.com/r/SQL/comments/1cuep0/remote_bulk_insert/,
1366317540.0,2,self.SQL,1cmp6a,Learning SQL can you help me debug?,BlameTheAirForGossip,2,0,4,http://www.reddit.com/r/SQL/comments/1cmp6a/learning_sql_can_you_help_me_debug/,"I am learning SQL and cannot figure out the error of my text. I am getting Msg 102, Level 15, State 1, Line 12 Incorrect syntax near ';'. Though I do not see a fault in what I am trying to do. Essentially I am trying to make a new table to replace the old Inventory Data. If this post does not belong here I am sorry.

Create Table	CUST_INV (

	Inv#		INT		NOT NULL,

	CustID		INT		NOT NULL,

	DateIn		DateTime	NOT NULL,

	DateOut		DateTime	NULL,

	Subtotal	Numeric(8,2) NULL,

	Tax		Numeric(8,2) NULL,

	Total		Numeric(8,2) NULL

	Constraint	CUST_INV_PK			Primary Key(Inv#)

	Constraint	CUST_INV_Cust_FK	Foreign Key(CustID)

	References	CUST(CustID)		ON Update No Action

									ON Delete No Action;

Alter Table INV
	Drop Constraint INV_CUST_FK;


Alter Table ITEM
	Drop Constraint ITEM_INV_FK;


Alter Table ITEM
	Add Constraint ITEM_CUST_INV_FK		Foreign Key (Inv#)

	References CUST_INV(Inv#)

	ON Update Cascade

	ON Delete Cascade;
	
Insert Into CUST_INV (Inv#, CustID, DateIn, DateOut, Subtotal, Tax, Total)

	Select Inv#, CustID, DateIn, DateOut, Subtotal, Tax, Total

	From INV;


Drop Table INV;

",,False,self,t5_2qp8q,False,,,True,t3_1cmp6a,http://www.reddit.com/r/SQL/comments/1cmp6a/learning_sql_can_you_help_me_debug/,
1365093281.0,2,self.SQL,1bo3tr,[Oracle] Can anyone help with this max function?,crustang,2,0,7,http://www.reddit.com/r/SQL/comments/1bo3tr/oracle_can_anyone_help_with_this_max_function/,"I'm trying to find an elegant way to do this.. I have a query with 4 columns, the 4th column is an integer, I want to pull the max integer and use data from the other three columns.  I know I could build a subquery, but I'm trying to find better/cleaner ways to build my code.

Here's what I have so far, it's pulling all 4 columns which isn't what I'm looking for.


    SELECT 
      COMP_CODE, 
      QTY_BKD_PROF_CODE,
      SKU_CODE,
      MAX(QTY_BKD_PROF_LEV_NUM) AS MAX_INT
    FROM 
      M_QTY_BKD_PROF_D
    GROUP BY 
      COMP_CODE, 
      QTY_BKD_PROF_CODE, 
      SKU_CODE;

",,False,self,t5_2qp8q,False,,,True,t3_1bo3tr,http://www.reddit.com/r/SQL/comments/1bo3tr/oracle_can_anyone_help_with_this_max_function/,
1364357188.0,2,ntu.edu.sg,1b3b1e,sQL dETAILS Tutorials,imryadav,3,1,0,http://www.reddit.com/r/SQL/comments/1b3b1e/sql_details_tutorials/,,,False,http://c.thumbs.redditmedia.com/YQy4mmbdQYwW_ndt.jpg,t5_2qp8q,False,,,False,t3_1b3b1e,http://www3.ntu.edu.sg/home/ehchua/programming/sql/MySQL_Beginner.html,
1364251202.0,2,self.SQL,1b04p6,[Oracle]Trying to connect using sqlplus with a username that has brackets fails,listix,2,0,7,http://www.reddit.com/r/SQL/comments/1b04p6/oracletrying_to_connect_using_sqlplus_with_a/,"Hi everyone.

I am trying to connect to a database where the username is like:

user[abc]

But when I try to connect using sqlplus like this:

    sqlplus user[abc]@database

and then put the password it says:

ORA-01017: invalid username/password; logon denied

I have connected to that same database using sqldeveloper with that username with no issue. The password contains a . but no other special character. I have another user without the stuff inside the brackets that works fine.

    sqlplus user@database

I put the password(which has a . too) and it works fine. Do I have to escape some character? I tried with \ and "" but to no avail. Its getting on my nerves. What am I doing wrong?

Thank you in advance.


EDIT: For future reference, to connect with a proxy using SQL*Plus the version has to be 10.2 or more otherwise is not possible.",,False,self,t5_2qp8q,1364314664.0,,,True,t3_1b04p6,http://www.reddit.com/r/SQL/comments/1b04p6/oracletrying_to_connect_using_sqlplus_with_a/,
1363136981.0,2,self.SQL,1a6pmb,[MS SQL] Help with SQL Server Maintenance Plan Email Report,Narusa,2,0,3,http://www.reddit.com/r/SQL/comments/1a6pmb/ms_sql_help_with_sql_server_maintenance_plan/,"So I followed the instructions listed [here](https://support.quest.com/SolutionDetail.aspx?id=SOLSL4092) on how to create a SQL maintenance plan. 

I receive the email but it is a wall of text which contains the commands used (information I don't care about really). All I need the email to show is that the job was a success. 

Are there any settings I can change or is there a simpler way with something like power shell?

Thank you!

EDIT: I added a copy of the emailed reports I receive [here](http://pastebin.com/fi9tEKLt) on pastebin.",,False,self,t5_2qp8q,1363148175.0,,,True,t3_1a6pmb,http://www.reddit.com/r/SQL/comments/1a6pmb/ms_sql_help_with_sql_server_maintenance_plan/,
1362450742.0,2,self.SQL,19oiep,"How to Join on a ""Distinct Selection"" or Select values before the ""Distinct Selection"" ",2MyLou,4,2,7,http://www.reddit.com/r/SQL/comments/19oiep/how_to_join_on_a_distinct_selection_or_select/,"The query below works but I would like to ideally have Step.ST_TEST_ID as the first column in the query. I've also tried joining to other tables with no luck. I know this should be simple, any help would be appreciated. Thanks.
   
   
  
    SELECT
          DISTINCT Step.ST_RUN_ID as 'Run Id', COUNT(Step.ST_RUN_ID) as 'Step Count',
          Step.ST_TEST_ID as 'Test ID'

    FROM STEP

    GROUP BY ST_RUN_ID, Step.ST_TEST_ID",,False,self,t5_2qp8q,False,,,True,t3_19oiep,http://www.reddit.com/r/SQL/comments/19oiep/how_to_join_on_a_distinct_selection_or_select/,
1360351865.0,2,self.SQL,185c7j,[MS SQL 2008] Upload files on schedule,Fritz_Meister,2,0,11,http://www.reddit.com/r/SQL/comments/185c7j/ms_sql_2008_upload_files_on_schedule/,"Up until now, my SQL experience has been mostly using tables, views, and integrating PowerShell to manage my databases. I'm working on a new project where I need to upload my files, of a few different formats, to the SQL server, and the web front end will have to be able to download the files from the SQL database and provide them to the user. I am using ASP.NET with PKI authentication on the website.

Please provide advice on the best practice/recommended action for uploading files to MS SQL 2008. I will be getting these files via FTP from another server on a routine schedule and need to upload the files to the database around that time.",,False,self,t5_2qp8q,False,,,True,t3_185c7j,http://www.reddit.com/r/SQL/comments/185c7j/ms_sql_2008_upload_files_on_schedule/,
1360149277.0,1,self.SQL,17zsfn,Cannot connect to server,Stalemate9,5,4,16,http://www.reddit.com/r/SQL/comments/17zsfn/cannot_connect_to_server/,"Hi I am trying to learn SQL and have installed SQL Express 2008 but when I try to connect I get the following message, CHUR-ORP-LT10 is my computer name.  Any help would be much apreciated.



",,False,self,t5_2qp8q,False,,,True,t3_17zsfn,http://www.reddit.com/r/SQL/comments/17zsfn/cannot_connect_to_server/,
1359919554.0,2,self.SQL,17tizc,"[SQLite] How to call up DB entries, and open the corresponding folder in Windows Explorer?",featheredtar,2,0,1,http://www.reddit.com/r/SQL/comments/17tizc/sqlite_how_to_call_up_db_entries_and_open_the/,"Is there a script, or program that can do this? Preferably for opening the corresponding folder*s* for multiple entries? I don't know how to script, but could work something out if there was an example and adequate explanation.

This is to find time lapse footage from a complex database spanning multiple hard drives, for the purpose of importing specific time lapse sequences into After Effects.",,False,self,t5_2qp8q,False,,,True,t3_17tizc,http://www.reddit.com/r/SQL/comments/17tizc/sqlite_how_to_call_up_db_entries_and_open_the/,
1359672696.0,2,self.SQL,17npbq,How to easily export a .csv file for each date in a record?,AlkalineDuck,2,0,3,http://www.reddit.com/r/SQL/comments/17npbq/how_to_easily_export_a_csv_file_for_each_date_in/,"I'm still fairly new to SQL, but I've found myself having to do something that google doesn't seem to be giving a simple answer for.

Basically we have a record going back about a year, and I need to export the data for each day in that year in a .csv file called something along the lines of [date].csv.

I've figured out how to iterate over the days and do a query for each day, but I have no idea how to export each day's query into a .csv file without doing it manually 365 times.

I'm using MS SQL Server management studio, but I'm not sure if that's any good for this. I hear there may be a way of doing it in command prompt?

Thanks!",,False,self,t5_2qp8q,False,,,True,t3_17npbq,http://www.reddit.com/r/SQL/comments/17npbq/how_to_easily_export_a_csv_file_for_each_date_in/,
1359533898.0,2,self.SQL,17jw4n,Combining multiple count queries with varying constraints,boiling_penis,3,1,10,http://www.reddit.com/r/SQL/comments/17jw4n/combining_multiple_count_queries_with_varying/,"So I have four queries I have to run, over and over again.  They're basically these:

     select count(METRIC) from TABLE where date='2013-01-04' and METRIC&gt;=10000000;
     select count(METRIC) from TABLE where date='2013-01-04' and METRIC&lt;10000000 and METRIC&gt;=5000000;
     select count(METRIC) from TABLE where date='2013-01-04' and METRIC&lt;5000000 and METRIC&gt;=1000000;
     select count(METRIC) from TABLE where date='2013-01-04' and METRIC&lt;1000000 and METRIC&gt;=500000;

and then again, replacing count with sum.  But I have to run these not just for the fourth, but for several days.

Is there a single query I can run which will return these four values like

       -----------
       | first count |
       ---------
       | second count |
       -----------
       | third |
       ---------
       | four |
       ---------
       | first sum |
       -------------
          etc.

?",,False,self,t5_2qp8q,1359534472.0,,,True,t3_17jw4n,http://www.reddit.com/r/SQL/comments/17jw4n/combining_multiple_count_queries_with_varying/,
1359144120.0,2,self.SQL,179up2,[Oracle] - Question about error handling - known errors and Exception vs other methods,just_dig_in_work,2,0,7,http://www.reddit.com/r/SQL/comments/179up2/oracle_question_about_error_handling_known_errors/,"Given this:

    CREATE TABLE pair
    (

        pair_id   NUMBER CONSTRAINT p_pair_id_nn NOT NULL,
        name      VARCHAR2 (64) CONSTRAINT p_name_nn NOT NULL,
        VALUE     VARCHAR2 (64) CONSTRAINT p_value_nn NOT NULL

    );


    CREATE INDEX pk_pair_id_idx
    ON pair (pair_id);


    ALTER TABLE pair 
    ADD CONSTRAINT pk_pair_id 
    PRIMARY KEY (pair_id)
    USING INDEX pk_pair_id_idx;


    ALTER TABLE pair 
    ADD CONSTRAINT p_name_value_uniq 
    UNIQUE (name, VALUE);


    CREATE SEQUENCE seq_pair_id
    START WITH 1
    INCREMENT BY 1;



    CREATE OR REPLACE PROCEDURE i_pair2 (
        name_     IN     VARCHAR2,
        value_    IN     VARCHAR2,
        result_      OUT NUMBER)
    IS
        v_pair_id    NUMBER;

        CURSOR pair_cur
        IS
        SELECT COUNT (*)
        FROM pair
        WHERE name = name_ AND VALUE = value_;

        pair_count   NUMBER;
    BEGIN
        
        OPEN pair_cur;

        FETCH pair_cur INTO pair_count;

        CLOSE pair_cur;

        IF pair_count = 1
        THEN
            SELECT pair_id
            INTO v_pair_id
            FROM pair
           WHERE name = name_ AND VALUE = value_;
       ELSIF pair_count = 0
       THEN
           INSERT INTO pair
           VALUES (seq_pair_id.NEXTVAL, name_, value_)
           RETURNING pair_id
           INTO v_pair_id;
        END IF;

        result_ := v_pair_id;
    END;


    CREATE OR REPLACE PROCEDURE i_pair1 (
        name_     IN     VARCHAR2,
        value_    IN     VARCHAR2,
        result_      OUT NUMBER)
    IS
        v_pair_id   NUMBER;
    BEGIN
         SELECT pair_id
         INTO v_pair_id
         FROM pair
         WHERE name = name_ AND VALUE = value_;

        result_ := v_pair_id;
     EXCEPTION
    WHEN NO_DATA_FOUND
    THEN
          SELECT seq_pair_id.NEXTVAL INTO v_pair_id FROM DUAL;

          INSERT INTO pair
          VALUES (v_pair_id, name_, value_)
          RETURNING pair_id
          INTO result_;
    END;

    DECLARE
        result_   NUMBER;
    BEGIN
        i_pair1 ('name1', 'value1', RESULT_);
        DBMS_OUTPUT.put_line ('returned ' || result_);
        i_pair2 ('name2', 'value2', RESULT_);
        DBMS_OUTPUT.put_line ('returned ' || result_);
        i_pair1 ('name3', 'value3', RESULT_);
        DBMS_OUTPUT.put_line ('returned ' || result_);
        i_pair2 ('name4', 'value4', RESULT_);
        DBMS_OUTPUT.put_line ('returned ' || result_);
        i_pair1 ('name5', 'value5', RESULT_);
        DBMS_OUTPUT.put_line ('returned ' || result_);
        i_pair2 ('name6', 'value6', RESULT_);
        DBMS_OUTPUT.put_line ('returned ' || result_);

        i_pair2 ('name8', 'value8', RESULT_);
        DBMS_OUTPUT.put_line ('returned ' || result_);
    END;



Is I_PAIR1 better or is I_PAIR2 better?

I have taken over some database development duties and the previous developer has some procedures written in the style of I_PAIR1. I have attempted to follow this pattern but one of my DBA's has cautioned me against this and prefers something after the style of I_PAIR2. If the precedent has been set with I_PAIR1 would there be benefit to switch to the other style, aside from pleasing my DBA. 

It seems odd to me that using named exceptions would be bad or wrong. It also seems odd to me to try to figure out a way to avoid using standard exception handling. But, I am new to this and could be wrong.

Can anyone offer advice or an opinion on this?

tl;dr - Is it better to use standard exception handling or figure out ways to circumvent it and handle known exceptions without referencing them in the Exception block?

Edit1: formatting didn't copy/paste well...",,False,self,t5_2qp8q,1359144754.0,,,True,t3_179up2,http://www.reddit.com/r/SQL/comments/179up2/oracle_question_about_error_handling_known_errors/,
1358438042.0,2,self.SQL,16r8ac,[MS SQL] Help running batch file when current date equals date in a table,andyfhx,2,0,9,http://www.reddit.com/r/SQL/comments/16r8ac/ms_sql_help_running_batch_file_when_current_date/,"I'm trying to modify a store procedure to not run a batch file if the current date is equal to dates in a certain table and if the current date is not equal  to the dates in the table, then run the batch file. 

I'm rather new SQL and I'm not sure where to really start on this one. Could you guys get me started?

Thanks in advance!",,False,self,t5_2qp8q,False,,,True,t3_16r8ac,http://www.reddit.com/r/SQL/comments/16r8ac/ms_sql_help_running_batch_file_when_current_date/,
1357929728.0,2,self.SQL,16e3yz,[MSSQL]: Mapping Table Schema Example?,mariocatch,2,0,1,http://www.reddit.com/r/SQL/comments/16e3yz/mssql_mapping_table_schema_example/,"Does anyone have any example of a very simple 2 column mapping schema?

IE: Assume I have 2 tables, each with an integer primary key.
I'm trying to create a 3rd table that can map 2 rows from the other 2 tables together.",,False,self,t5_2qp8q,False,,,True,t3_16e3yz,http://www.reddit.com/r/SQL/comments/16e3yz/mssql_mapping_table_schema_example/,
1357859732.0,2,self.SQL,16cdsz,"[Oracle] I am having trouble connecting to Oracle behind a firewall. 1521 is fine and the connections are coming in, but the random out is blocked. I have tried USE_SHARED_SOCKET but it still won't work. Any ideas?",SonOfZork,3,1,0,http://www.reddit.com/r/SQL/comments/16cdsz/oracle_i_am_having_trouble_connecting_to_oracle/,,,False,self,t5_2qp8q,False,,,True,t3_16cdsz,http://www.reddit.com/r/SQL/comments/16cdsz/oracle_i_am_having_trouble_connecting_to_oracle/,
1357676747.0,2,self.SQL,167akz,[Oracle]Update values where the field is NULL,borensoren,2,0,12,http://www.reddit.com/r/SQL/comments/167akz/oracleupdate_values_where_the_field_is_null/,"So I have a list I matched and I'm trying to add the values that I found to an existing table, the problem is the update statement I'm trying to run keeps over-writing the values I had before so I'm actually losing data.

    UPDATE JM_TEMP_010713 A SET A.NPI = 
        (
            SELECT B.NPI FROM JM_TEMP_010713_NPINA B
            WHERE A.UNIQUEID = B.UNIQUEID
            AND A.NPI IS NULL
        ) ",,False,self,t5_2qp8q,False,,,True,t3_167akz,http://www.reddit.com/r/SQL/comments/167akz/oracleupdate_values_where_the_field_is_null/,
1357505748.0,2,self.SQL,162tck,[MySQL] Inner Join Help,Jeklah,2,0,11,http://www.reddit.com/r/SQL/comments/162tck/mysql_inner_join_help/,"Ok, this is a bit weird and I'm not sure why I'm having this problem.
Basically I'm trying to do a simple join and it's not working the way it should be.

I have it kind of working. The syntax is correct it's just not working as expected.

    SELECT * 
    FROM sales sa
    INNER JOIN stock st ON st.StockCode = sa.StockCode
    WHERE st.SuppName =  'Name 1'

This works and returns what I thought it would.

    SELECT * 
    FROM sales sa
    INNER JOIN stock st ON st.StockCode = sa.StockCode
    WHERE st.SuppName =  'Name 2'

This doesn't work and I've been through the data multiple times, it definitely should be returning something.
Is there a reason this could be happening or is it definitely the data? Am I just losing my sight.

Thanks everyone.",,False,self,t5_2qp8q,False,,,True,t3_162tck,http://www.reddit.com/r/SQL/comments/162tck/mysql_inner_join_help/,
1356578012.0,2,self.SQL,15i00t,[ANSI SQL] Pagination,cfv,3,1,8,http://www.reddit.com/r/SQL/comments/15i00t/ansi_sql_pagination/,"Hi all!

So, I was goofing around with SQLite, and noted it uses a LIMIT clause to determine how many records to bring on each query. 

Now, from what I recall from highschool, other engines (like SQLServer or whatever other) don't seem to do pagination the same way. Is there a standard ANSI manner of getting ""paged"" sets of results? How'd that go?",,False,self,t5_2qp8q,False,,,True,t3_15i00t,http://www.reddit.com/r/SQL/comments/15i00t/ansi_sql_pagination/,
1356014149.0,2,self.SQL,1562h6,Looking for Financal and Medical Data Information,markpelly,2,0,0,http://www.reddit.com/r/SQL/comments/1562h6/looking_for_financal_and_medical_data_information/,"I recently started a new position, and part of the position is reporting for many departments in a hospital. No I have done reporting in the past but I would like to know if there is any information or sources that I can use that will help me more in the Financial side of things. I am looking for some souces to learn specific data guidelines for finance. I am not sure if this makes sense or if I am on the wrong track to understanding their data. I also will need to learn the data structure and terms ""lingo"" for Medical.

Almost like some sort of crash course.",,False,self,t5_2qp8q,False,,,True,t3_1562h6,http://www.reddit.com/r/SQL/comments/1562h6/looking_for_financal_and_medical_data_information/,
1354892335.0,2,publib.boulder.ibm.com,14g1zz,Need assistance deleting data from one table when it exists in another table. Could not find the answer on IBM's page.,,3,1,13,http://www.reddit.com/r/SQL/comments/14g1zz/need_assistance_deleting_data_from_one_table_when/,,,False,default,t5_2qp8q,False,,,False,t3_14g1zz,http://publib.boulder.ibm.com/infocenter/db2luw/v8/index.jsp?topic=/com.ibm.db2.udb.doc/admin/r0000939.htm,
1354656273.0,2,self.SQL,14a6i9,[Oracle] Pulling members of 2 tables if all applicable records meet specific criteria.,el_monstruo,2,0,11,http://www.reddit.com/r/SQL/comments/14a6i9/oracle_pulling_members_of_2_tables_if_all/,"I have two tables here: [TABLES](http://i.imgur.com/KYrGi.png)

What I want to do is write a script that pulls any ID from table one that has all reference numbers with a RE or RW status that have matching reference numbers on table 2 with status that are not RE or RW in the same years.  So based on the provided tables, 101 and 119 would be pulled.

I know how to combine the two tables but I am not sure I am combining them in a way that can get me the data I want.

Any suggestions?

",,False,self,t5_2qp8q,False,,,True,t3_14a6i9,http://www.reddit.com/r/SQL/comments/14a6i9/oracle_pulling_members_of_2_tables_if_all/,
1354630733.0,2,codular.com,149g46,An Introduction to SQL - Codular,michaelwr9052,2,0,1,http://www.reddit.com/r/SQL/comments/149g46/an_introduction_to_sql_codular/,,,False,default,t5_2qp8q,False,,,False,t3_149g46,http://codular.com/sql-introduction,
1354163145.0,2,self.SQL,13z60o,[MS Access SQL] Help writing a query,thePersonCSC,3,1,2,http://www.reddit.com/r/SQL/comments/13z60o/ms_access_sql_help_writing_a_query/,"Given a set of tables in Access:

* Client
 * ID
 * first_name
 * last_name
 * middle_initial
* Phone_Numbers
 * ID
 * client_id
 * phone_number
 * type
* Assigned_Numbers
 * ID
 * client_id
 * phone_number
 * extension
		
If I want to select a query that contains the following information about every client:
	
* Client.first_name
* Client.last_name
* Client.middle_initial
* One phone_number where type = ""home"" (null for this cell otherwise)
* One phone_number where type = ""cell"" (null for this cell otherwise)
* One assigned_number (null for this cell otherwise if it doesn't exist)
	
The relationships are:
	
* Client has many Phone_Numbers
* Client has many Assigned_Numbers
	
I want the query to select clients even if those clients don't have phone_numbers, but it should not select a client more than once.

How do I write this?",,False,self,t5_2qp8q,False,,,True,t3_13z60o,http://www.reddit.com/r/SQL/comments/13z60o/ms_access_sql_help_writing_a_query/,
1353295909.0,2,self.SQL,13fk8o,How to Query 3 Different Tables With a Sum Function?,el_monstruo,2,0,4,http://www.reddit.com/r/SQL/comments/13fk8o/how_to_query_3_different_tables_with_a_sum/,"The example tables are located here: [TABLES](http://i.imgur.com/TMaHH.png)

What I want is the query to pull any people who are HERE in 2012 and have 10 or more units of Apple in either LOCAL, HISTORY or both of those tables combined. Given this information, Jack, Jill, Jim and John would be pulled by the query.

I know how to query each table and then combine the results to get the required data but is there a way to do this in one query?",,False,self,t5_2qp8q,False,,,True,t3_13fk8o,http://www.reddit.com/r/SQL/comments/13fk8o/how_to_query_3_different_tables_with_a_sum/,
1353263595.0,2,self.SQL,13enpx, sql insert into using access (im a noob),justinsane714,2,0,5,http://www.reddit.com/r/SQL/comments/13enpx/sql_insert_into_using_access_im_a_noob/,"Maybe I am tired, but I am trying to do a simple insert into in access 2007 using the code below. 
It keeps giving me error message saying ""characters found after end of SQL statement."" I assume it is talking about the second INSERT INTO statement. 

INSERT INTO EMP_1 VALUES('101','News','John','G','11/8/2000','502');   
INSERT INTO EMP_1 VALUES('102','Senior','David','H','7/12/1989','501');",,False,self,t5_2qp8q,False,,,True,t3_13enpx,http://www.reddit.com/r/SQL/comments/13enpx/sql_insert_into_using_access_im_a_noob/,
1352915966.0,2,self.SQL,136wab,Oracle: Do I need to know programming?,zaciroth,2,0,6,http://www.reddit.com/r/SQL/comments/136wab/oracle_do_i_need_to_know_programming/,"I'm looking at having to take a Oracle Database class this next semester. My school has a prerequisite on the class that says it needs me to have taken at least Intro to Programming. It is the only class open online this semester and my professor said she would wave me in. However, I have never had any programming yet. She claims I only need programming knowledge for the logic. I'm really worried. Anyone able to give me some advice on if I should buckle down and take this class or not? 

A study of the structure of data bases and the techniques for managing data bases. Competencies in the use of an existing data base management system will be treated. These competencies will include creating, loading, querying and maintaining data bases, report generation and SQL. Prerequisite(s): CPSC 1230 or equivalent As required
3 hours lecture / 2 hours laboratory

The 1230 class is an intro to programming class (usually taught in Visual Basic) 

Thanks guys",,False,self,t5_2qp8q,False,,,True,t3_136wab,http://www.reddit.com/r/SQL/comments/136wab/oracle_do_i_need_to_know_programming/,
1352749312.0,2,self.SQL,132t77,Query,Team_Rocket,3,1,7,http://www.reddit.com/r/SQL/comments/132t77/query/,"Why does this method return 0 results

where (DateTimeHistory &gt; (SELECT DATEADD(d,DATEDIFF(d, 0, getdate()),0)))
AND (DateTimeHistory &lt; (SELECT DATEADD(d,DATEDIFF(d, 1, getdate()),0)))

Versus this method:

where DateTimeHistory &gt; '2012-11-12 00:00'
AND DateTimeHistory &lt; '2012-11-13 00:00'

",,False,self,t5_2qp8q,False,,,True,t3_132t77,http://www.reddit.com/r/SQL/comments/132t77/query/,
1352414028.0,2,self.SQL,12vqcx,Count records by month between two dates.,Bandude,2,0,15,http://www.reddit.com/r/SQL/comments/12vqcx/count_records_by_month_between_two_dates/,"Having trouble with this one and can't find any good examples on the web.


I have 2 dates 'Eff Date' and 'Term Date'. 

(term can be null which would indicate the record is active)


I need to count how many historical effective members there were per month given a date range.



**DATA**

| ID   | Eff Date    | Term Date   |
|:-----------|:------------|:------------|
| 1|5/1/2011|&lt;null&gt;
| 2 |5/1/2011|3/1/2012 
| 3|5/1/2011|2/1/2012

I want a count of active members for Jan, Feb, and March 2012



**Expected Results**

| Month   | Active member count
|:-----------|:------------
| JAN|3
| FEB|2
| MAR|1

Any help would be appreciated.

I'm using a [bastardized](http://documentation.softwareag.com/adabas/cxx1101/intro/introover.htm) version of SQL but you can provide your solution via your preferred platform 
",,False,self,t5_2qp8q,False,,,True,t3_12vqcx,http://www.reddit.com/r/SQL/comments/12vqcx/count_records_by_month_between_two_dates/,
1352341321.0,2,self.SQL,12u2ej,Invalid Data Object when trying to load table,simkessy,3,1,5,http://www.reddit.com/r/SQL/comments/12u2ej/invalid_data_object_when_trying_to_load_table/,"I used Forward Engineer plugin for Visio to convert and ERD Diagram into SQL. This created the tables, now im tryin to load data into them. However, I keep getting invalid data object error. 

Here's a screenshot: http://imgur.com/vE3zC",,False,self,t5_2qp8q,False,,,True,t3_12u2ej,http://www.reddit.com/r/SQL/comments/12u2ej/invalid_data_object_when_trying_to_load_table/,
1351697322.0,2,forum.ragezone.com,12ehgy,Scheduled an SQL Event with your MySQL Server,UberEmetophobic,3,1,0,http://www.reddit.com/r/SQL/comments/12ehgy/scheduled_an_sql_event_with_your_mysql_server/,,,False,http://a.thumbs.redditmedia.com/V7AM5UmJUxWCPb6H.jpg,t5_2qp8q,False,,,False,t3_12ehgy,http://forum.ragezone.com/f335/scheduled-sql-event-mysql-server-874646/,
1351545805.0,2,self.SQL,12arf7,ER Diagram for a Phonecall [INNODB],bpmn,2,0,3,http://www.reddit.com/r/SQL/comments/12arf7/er_diagram_for_a_phonecall_innodb/,"I am trying to develop a phonecall database, one that would record phone calls and the data relevant to it such as Numbers that participated, location of those numbers, and the start and end time of the phone call.   I think a Many to Many Recursive relationship would be the correct, however it falls apart when I imagine 3-way calling.",,False,self,t5_2qp8q,False,,,True,t3_12arf7,http://www.reddit.com/r/SQL/comments/12arf7/er_diagram_for_a_phonecall_innodb/,
1351199203.0,2,github.com,12354c,"[MSSQL] my weekend-project: SQL Extractor; Track 
your views/storedprocs/... in your git/hg/...",jackthelumber,3,1,5,http://www.reddit.com/r/SQL/comments/12354c/mssql_my_weekendproject_sql_extractor_track_your/,,,False,http://c.thumbs.redditmedia.com/qXf13PkX_FTS-heD.jpg,t5_2qp8q,False,,,False,t3_12354c,https://github.com/DanielWeigl/SQL_Extractor,
1351111614.0,2,self.SQL,120yo6,[TSQL] Newly minted SQL Admin needs help. ,e13ct,3,1,12,http://www.reddit.com/r/SQL/comments/120yo6/tsql_newly_minted_sql_admin_needs_help/,"Hey everybody, I just got a job as a Sql admin for a university with an Academic ERP system called Cams Enterprise. I have very little experience with T-SQL, and am being tasked with a couple of projects out of the gate in a working, production environment with no dev environment. 

What kind of resources would you suggest to get a working knowledge of Sql as fast as possible??? 

I have a book from Sybex, ""Mastering SQL Server 2008"", and have been getting the basics from the Coursera course on Introduction of databases which has helped, but I am having trouble applying what I know to our environment. 

TL;DR New Sql admin needs help with SQL and Academic ERP systems. 

Thanks. ",,False,self,t5_2qp8q,False,,,True,t3_120yo6,http://www.reddit.com/r/SQL/comments/120yo6/tsql_newly_minted_sql_admin_needs_help/,
1350660596.0,2,self.SQL,11r1h7,Subselect statements to avoid using temp tables?  Is this possible?,,3,1,6,http://www.reddit.com/r/SQL/comments/11r1h7/subselect_statements_to_avoid_using_temp_tables/,"In Access, there is the option to select the output from another query for a new query.  This allows for there to be no temp tables and for the queries to run back to back dependent on the preceding query’s output.  An example would be 

SELECT qry00.”columnA”, qry00.”columnB” FROM qry00.  

How could I do this in SQL?  Could I do a subselect statement such as 

SELECT columnA, columnB 
FROM (SELECT columnA, columnB FROM table1 WHERE columnB = ‘12’)

?  I would be hoping to select only the criteria from the inner-substatement in the outer select statement.    I don’t have to do it this way; I am just interesting in the idea of not putting data into temp tables to run more smoothly.
",,False,self,t5_2qp8q,False,,,True,t3_11r1h7,http://www.reddit.com/r/SQL/comments/11r1h7/subselect_statements_to_avoid_using_temp_tables/,
1350361798.0,2,self.SQL,11jzei,How can I manage an event over many rows? [Vertica],cptwngr,3,1,3,http://www.reddit.com/r/SQL/comments/11jzei/how_can_i_manage_an_event_over_many_rows_vertica/,"I store data from a JMS output and it has a composite key of 4 fields and about 20 others. 

class, instance, event, timestamp 

As an instance of this event lives, attributes change and those changes are stored as new rows with an updated timestamp in a column called lastchanged. I find myself grabbing distinct events out of the database, then looping back through to analyze attribute changes. 

Are there any techniques I could use to better manage this data? I think this sounds like a time series, but I don't have any experience with it. ",,False,self,t5_2qp8q,False,,,True,t3_11jzei,http://www.reddit.com/r/SQL/comments/11jzei/how_can_i_manage_an_event_over_many_rows_vertica/,
1350308050.0,2,opengamma.com,11id80,"Just Released: ElSql, a Standalone Java Library for Managing SQL",soi_la,2,0,0,http://www.reddit.com/r/SQL/comments/11id80/just_released_elsql_a_standalone_java_library_for/,,,False,http://c.thumbs.redditmedia.com/GcZ6zkgXjuGBxTXt.jpg,t5_2qp8q,False,,,False,t3_11id80,http://www.opengamma.com/blog/2012/10/15/elsql-java-library-for-managing-sql,
1349966595.0,2,self.SQL,11b70p,[MSSQL] Easy Transact SQL Problem. ,Orwell84,3,1,18,http://www.reddit.com/r/SQL/comments/11b70p/mssql_easy_transact_sql_problem/,"I don't usally do too much transact SQL coding, but I got thrown into this project and I'm a little bit stumped. 

I'm trying to get the **PO2_PurchaseOrderEntryLine.UnitCost** column to show up in the table **Open PO Report**. I know I need to add some sort of relational statement torwards the end of of the script, but I'm not sure of the exact format. I've been messing around with it for a while without any luck, so any advice would be appericated. 

-------------------------------

    SELECT     CASE PO2_PurchaseOrderEntryLine.ProductLine WHEN '0001' THEN 'LOBSTER' WHEN '0002' THEN 'LOBSTER' WHEN '0003' THEN 'LOBSTER' WHEN '0004' THEN 'LOBSTER'
                       WHEN '0005' THEN 'LOBSTER' WHEN '0006' THEN 'LOBSTER' WHEN '0007' THEN 'LOBSTER' WHEN '0008' THEN 'LOBSTER' WHEN '0009' THEN 'LOBSTER' WHEN
                       '0010' THEN 'LOBSTER' WHEN '0011' THEN 'LOBSTER' WHEN '0014' THEN 'LOBSTER' WHEN '0015' THEN 'LOBSTER' WHEN '0103' THEN 'CRAB' WHEN '0113' THEN
                       'CRAB' WHEN '0105' THEN 'CRAB' WHEN '0114' THEN 'CRAB' WHEN '0120' THEN 'CRAB' WHEN '0100' THEN 'CRAB' WHEN '0101' THEN 'CRAB' WHEN '0108' THEN
                       'CRAB' WHEN '0110' THEN 'CRAB' WHEN '0111' THEN 'CRAB' WHEN '0118' THEN 'CRAB' WHEN '0122' THEN 'SHRIMP' WHEN '0126' THEN 'SHRIMP' WHEN '0127' THEN
                       'KING CRAB' WHEN '0128' THEN 'ARGENTINE CRAB' WHEN '0130' THEN 'PACKAGING' ELSE 'OTHER' END AS Category, PO1_PurchaseOrderEntryHeader.PurchaseOrderNumber AS [PO #], 
                      ci_udt_subcategory.UDF_SUBCATEGORY_DES AS SubCategory,
                      PO1_PurchaseOrderEntryHeader.MasterRepeatingPOOrSO AS [Mast PO], PO1_PurchaseOrderEntryHeader.OrderType AS Type, 
                      PO1_PurchaseOrderEntryHeader.OnHold AS [Hold?], PO1_PurchaseOrderEntryHeader.PurchaseOrderDate AS [PO Date], 
                      PO1_PurchaseOrderEntryHeader.RequiredExpireDate AS ETA, PO1_PurchaseOrderEntryHeader.VendorName AS Vendor, 
                      PO2_PurchaseOrderEntryLine.WarehouseCode AS Whse, PO2_PurchaseOrderEntryLine.ItemNumber AS [Item #], PO2_PurchaseOrderEntryLine.Description, 
                      PO_95_UDF_PurchaseOrderLines.Pbrand AS Brand, PO_95_UDF_PurchaseOrderLines.Alloc_Cust AS Customer, 
                      PO2_PurchaseOrderEntryLine.UMConversionFactor AS [U/M], PO2_PurchaseOrderEntryLine.QtyOrdered AS Cases, 
                      PO2_PurchaseOrderEntryLine.UMConversionFactor * PO2_PurchaseOrderEntryLine.QtyOrdered AS [Lbs/Kgs], 
                      PO2_PurchaseOrderEntryLine.QtyReceived AS Received, PO2_PurchaseOrderEntryLine.QtyBckordrd AS [Back Ordered], CONVERT(money, 
                      PO2_PurchaseOrderEntryLine.UnitCost) AS Cost, CONVERT(money, PO2_PurchaseOrderEntryLine.UnitCost / PO2_PurchaseOrderEntryLine.UMConversionFactor) 
                      AS [Cost/Unit], CONVERT(money, PO2_PurchaseOrderEntryLine.OrderExtension) AS Extended
    INTO [Open PO Report]
    FROM         ci_udt_category INNER JOIN
                      ci_item ON ci_udt_category.UDF_CATEGORY_CODE = ci_item.UDF_CATEGORY INNER JOIN
                      ci_udt_subcategory ON ci_item.UDF_SUBCAT = ci_udt_subcategory.UDF_SUBCATEGORY_CODE RIGHT OUTER JOIN
                      PO2_PurchaseOrderEntryLine AS PO2_PurchaseOrderEntryLine INNER JOIN
                      PO1_PurchaseOrderEntryHeader AS PO1_PurchaseOrderEntryHeader ON 
                      PO2_PurchaseOrderEntryLine.PurchaseOrderNumber = PO1_PurchaseOrderEntryHeader.PurchaseOrderNumber INNER JOIN
                      PO_95_UDF_PurchaseOrderLines AS PO_95_UDF_PurchaseOrderLines ON 
                      PO2_PurchaseOrderEntryLine.LineIndex = PO_95_UDF_PurchaseOrderLines.LineIndex AND 
                      PO2_PurchaseOrderEntryLine.PurchaseOrderNumber = PO_95_UDF_PurchaseOrderLines.PurchaseOrderNumber AND 
                      PO1_PurchaseOrderEntryHeader.PurchaseOrderNumber = PO_95_UDF_PurchaseOrderLines.PurchaseOrderNumber ON 
                      ci_item.ItemCode = PO2_PurchaseOrderEntryLine.ItemNumber
    WHERE     (PO1_PurchaseOrderEntryHeader.PurchaseOrderDate &gt;= GETDATE() - 31) AND (PO1_PurchaseOrderEntryHeader.PurchaseOrderDate &lt;= GETDATE())
    ORDER BY [PO Date]",,False,self,t5_2qp8q,1349966858.0,,,True,t3_11b70p,http://www.reddit.com/r/SQL/comments/11b70p/mssql_easy_transact_sql_problem/,
1349549302.0,2,self.SQL,111vzq,[MSSQL] Replication alternatives for 2008R2/2012 Express,jersully,2,0,15,http://www.reddit.com/r/SQL/comments/111vzq/mssql_replication_alternatives_for_2008r22012/,"I'm a longtime Windows SysAdmin with not much SQL experience.  What synchronization options do I have other than replication for 2-4GB database synchronization over broadband?  DB changes are made manually by users keying information into our application front-end.

Google tells me there are other options, but lacking SQL knowledge it's a bit overwhelming.  We're lining up a SQL consultant but I would appreciate any information that would give me a head start on talking intelligently with him.

**Edit:**  hello_josh (Hi Josh!) may have hit upon the answer.  It's not tested yet so I may be jumping the gun.  

&gt;Just doule checked - If you have one SQL Server Std edition as the publisher your satellites can merge replicate as subscriber with Express Edition.    &lt;snip&gt; Merge is two way.

This would mean that I only need to upgrade 6 of my sites and the 24 customers involved in this could stay on Express.  We recently prodded them all into upgrading to 2008 R2 Express to get everyone on the same version, so asking them to upgrade to spend the money on Standard just a few months later isn't something we wanted to attempt.  ",,False,self,t5_2qp8q,1349636960.0,,,True,t3_111vzq,http://www.reddit.com/r/SQL/comments/111vzq/mssql_replication_alternatives_for_2008r22012/,
1348805272.0,2,self.SQL,10lqfc,[MSSQL] Select from linked server to local server causing waits on both sides,pluckythewhale,4,2,4,http://www.reddit.com/r/SQL/comments/10lqfc/mssql_select_from_linked_server_to_local_server/,"The queries in question are here: http://pastie.org/4833351

Run individually, each of these queries runs through (albeit slow).

Run as a group, it just sits there, showing either OLEDB waits on the local box or in a SUSPENDED state on the linked server (wait type: ASYNC_NETWORK_IO).

Can anyone here point me in the direction of how I can both diagnose and fix this?

Thanks in advance. My apologies if I've (most likely) left out a key detail.",,False,self,t5_2qp8q,False,,,True,t3_10lqfc,http://www.reddit.com/r/SQL/comments/10lqfc/mssql_select_from_linked_server_to_local_server/,
1348802068.0,2,self.SQL,10lnfk,Hello r/SQL! I'd like to ask you guys for suggestions for an application that I can make to show my SQL skills to a potential employer?,maicull,5,3,3,http://www.reddit.com/r/SQL/comments/10lnfk/hello_rsql_id_like_to_ask_you_guys_for/,"I have a couple of days to develope the app. I mainly work with Java but know my way fairly well with other popular languages (C#, VB.NET, etc)

The position is for a graduate analyst programmer and the company mainly developes utilities billing softwares.

I suppose the obvious choice is to try and develope a simple utilities billing app, but you guys have any better suggestions, I am all ears.

Thank you, guys!",,False,self,t5_2qp8q,False,,,True,t3_10lnfk,http://www.reddit.com/r/SQL/comments/10lnfk/hello_rsql_id_like_to_ask_you_guys_for/,
1348580811.0,2,stackoverflow.com,10g6b9,[SQLITE] Trying to create list from two tables. Not sure if possible. (Hope it isnt taboo to post my own link from SO),docular,6,4,2,http://www.reddit.com/r/SQL/comments/10g6b9/sqlite_trying_to_create_list_from_two_tables_not/,,,False,default,t5_2qp8q,False,,,False,t3_10g6b9,http://stackoverflow.com/questions/12584281/generating-list-of-unique-values-from-two-tables-with-all-the-columns-from-one-t,
1348522822.0,2,reddit.com,10ewqb,Sysadmin by day needing help with a DBA problem : SQLServer (xpost from /r/sqlserver),burkhalp74,4,2,2,http://www.reddit.com/r/SQL/comments/10ewqb/sysadmin_by_day_needing_help_with_a_dba_problem/,,,False,default,t5_2qp8q,False,,,False,t3_10ewqb,http://www.reddit.com/r/SQLServer/comments/10evxv/sysadmin_by_day_needing_help_with_a_dba_problem/,
1348150326.0,2,self.SQL,106xmf,[MS SQL 2k] Returning 1 record from a multiple record query.,Smotpoker,3,1,15,http://www.reddit.com/r/SQL/comments/106xmf/ms_sql_2k_returning_1_record_from_a_multiple/,"I'm trying to add a column for ""shipping date"" to an existing query. Each returned line is an item sale on an invoice. The shipment tracking details (std) table can only join to the invoice, not the item. So when I add the std table to my query it creates duplicates any time there are multiple boxes or tracking numbers on an order. I would like to just return the first record.

    SELECT
	invoices.order_no, x_invoic.item_code, x_invoic.qty_ship,
	INVHIST.QTY_STK,
	invoices.order_date, addressB.acct_name,
	addressB.street_address, addressB.city,
	addressB.state, addressB.zip,
	addressS.street_address, addressS.city,
	addressS.state, addressS.zip,
	items.descript,
	invoices.date_fld,
	CASE cust.custclass 
		WHEN 'WHSL' THEN 
			CASE addressB.CUSTCHAR6 
				WHEN 'Small Medium' THEN 'SMB' 
				WHEN 'Large' THEN 'LB' 
				Else 'LOCAL' 
			End 
		Else 'RETAIL' 
	End, std.delivery_date
    FROM
	X_INVOIC
    INNER  	
	JOIN
		INVOICES ON INVOICES.ORDER_NO = X_INVOIC.ORDER_NO AND INVOICES.STATUS = X_INVOIC.STATUS
	JOIN 
		ITEMS ON ITEMS.ITEMNO = X_INVOIC.ITEM_CODE
	JOIN
		ADDRESS ADDRESSS ON ADDRESSS.ADDR_CODE = INVOICES.SHIP_CODE AND ADDRESSS.CUST_CODE = INVOICES.CUST_CODE 
 	JOIN
		ADDRESS ADDRESSB ON ADDRESSB.ADDR_CODE = INVOICES.BILL_CODE
 	JOIN
		CUST ON CUST.CUST_CODE = INVOICES.CUST_CODE AND CUST.CUST_CODE = ADDRESSS.CUST_CODE
	JOIN
		INVHIST ON INVHIST.ITEMNO = X_INVOIC.ITEM_CODE AND INVHIST.DOC_NO = INVOICES.ORDER_NO 
        AND INVHIST.DOC_TYPE = INVOICES.STATUS
    JOIN
		SHIPMENT_TRACKING_DETAILS STD ON STD.DOCNUM = X_INVOIC.ORDER_NO AND STD.DOC_TYPE = INVOICES.STATUS


    WHERE
	items.serialize = 'F'
	AND invoices.status = '9'
	AND (invoices.shipped ='F')
   	AND (x_invoic.qty_ship &gt;= 1)   
	AND (invoices.order_date
	
    -- Date Range
	
	Between
	{ts '2012-09-01 00:00:00'} And {ts '2012-09-07 00:00:00'})
	AND (invoices.order_date is not null)
	AND
	(items.category IN ('11111','22222','33333','44444'))
	
	
    Order BY
	x_invoic.order_no


The **std.delivery_date** will return multiple rows, causing duplicates in my query. I'm guessing I need some kind of nested select with a min() or first(), but I can't wrap my head around it. Also I don't think SQL Server 2000 has first().
",,False,self,t5_2qp8q,False,,,True,t3_106xmf,http://www.reddit.com/r/SQL/comments/106xmf/ms_sql_2k_returning_1_record_from_a_multiple/,
1347886003.0,2,self.SQL,100pwi,Junior-level SQL programming?,ricankng787,2,0,2,http://www.reddit.com/r/SQL/comments/100pwi/juniorlevel_sql_programming/,"x-post (/r/learnprogramming)

Good morning everyone,

I'm currently in a temporary help desk position at a educational non-profit and they are opening up a ""technical and software specialist"" position.

I'm very interested in the position. Part of the job description cites knowledge in SQL, MS Office, Crystal Reports (desirable), and ""experience in data communications and an understanding of the Internet and web-based applications are highly preferred."" I am curious as to what skills a ""junior-level SQL programmer"" should have.

All of my SQL knowledge has been text-book and online resources. I am very confident in my ability to learn any proprietary software that they may use or support. I am just a bit hesitant whether my non-professional, self-taught SQL knowledge will be enough.

Can anyone recommend some ""junior-level"" work, or even define that for me? The applications for this job are not due until September 28th, I'd like to get as much practice in as I can before any interviews. Also, if anyone could point me in the right direction on how to implement self-teaching into a resume? Forgive me if this is the wrong subreddit!

Thanks a lot everyone!

TL;DR: What is junior-level SQL programming? Any good resources on that level? Also, how do you input self-taught, non-professional programming onto a resume?",,False,self,t5_2qp8q,False,,,True,t3_100pwi,http://www.reddit.com/r/SQL/comments/100pwi/juniorlevel_sql_programming/,
1347821153.0,2,self.SQL,zzcm0,MYSQL - Insert and multiple update query troubles,maxhatcher,3,1,5,http://www.reddit.com/r/SQL/comments/zzcm0/mysql_insert_and_multiple_update_query_troubles/,"When I try to run this, it throws an error at the first UPDATE.

-- Moves leads from Table_One that have been processed one round to Table_Two.
INSERT INTO Database_Two.Table_Two
    SELECT * FROM Database_One.Table_One
    WHERE `ID` &gt;= '465540' AND (`ASK_RESPONSE_CODE` = 'Failed' OR `ANSWER_RESPONSE_CODE` IN  ('LOW_PRICE', 'Failed'))
-- Update Database_Two.Table_Two so it can run again.
UPDATE Database_Two.Table_Two
    SET `ASK_IS_PROCESSED` = '0', `ANSWER_IS_PROCESSED` = '0', `ASK_RESPONSE_CODE` = '', `ASK_ID` = '', `ANSWER_RESPONSE_CODE` = '', `ANSWER_ID` = '', `PRICE` = '0.00'
    WHERE `ID` &gt;= '465540' AND (`ASK_RESPONSE_CODE` = 'Failed' OR `ANSWER_RESPONSE_CODE` IN  ('LOW_PRICE', 'Failed'))
-- Update Table_One to mark they were copied.
UPDATE Database_One.Table_One
    SET `COPIED` = 'Y'
    WHERE `ID` &gt;= '465540' AND (`ASK_RESPONSE_CODE` = 'Failed' OR `ANSWER_RESPONSE_CODE` IN  ('LOW_PRICE', 'Failed'));

I was trying to replicate something like this [this](http://stackoverflow.com/questions/8998580/insert-the-data-from-old-table-to-new-table-id-from-new-table-and-update-for-th) but I don't 'think' I need all those crazy helper variables. So I came up with the code above. 

I basically want to move table data from one database to another database and update both tables so I know they were copied and so I can send out the data again from the second database. 

From what I understand this is probably a not very efficient way to do this but I turn Right at the JOIN left statement so I this is the best I can come up with and still understand what's going on. I know I shouldn't be allowed near the database, but I can't help myself.",,False,self,t5_2qp8q,False,,,True,t3_zzcm0,http://www.reddit.com/r/SQL/comments/zzcm0/mysql_insert_and_multiple_update_query_troubles/,
1347553483.0,2,firebirdsql.org,zttt6,Firebird 2.5.2 Release Candidate is Available,mariuz,3,1,0,http://www.reddit.com/r/SQL/comments/zttt6/firebird_252_release_candidate_is_available/,,,False,http://c.thumbs.redditmedia.com/XJVDAgklid6hNnq2.jpg,t5_2qp8q,False,,,False,t3_zttt6,http://www.firebirdsql.org/en/news/firebird-2-5-2-release-candidate-available-18787/,
1347394869.0,2,self.SQL,zq6dp,MS SQL My simple query returns counts to high.,sqlta,7,5,6,http://www.reddit.com/r/SQL/comments/zq6dp/ms_sql_my_simple_query_returns_counts_to_high/,"Table sales is
Salesperson
SaleID
WeekNumber
ProductID    

Select a.salesperson, count(a.SaleID), count(b.Sale.ID)

from sales a, sales b

where a.weeknumber = 1

and b.weeknumber = 2

and  a.salesperson = b.salesperson

group by a.salesperson

Table only holds 2 weeks worth of data.

I need to return 1 row for each salesperson with both of their weeks sales summed. Unfortunately my totals are way high.
",,False,self,t5_2qp8q,False,,,True,t3_zq6dp,http://www.reddit.com/r/SQL/comments/zq6dp/ms_sql_my_simple_query_returns_counts_to_high/,
1346275269.0,2,self.SQL,z1h7j,Small date time without seconds?,sh33ts,3,1,5,http://www.reddit.com/r/SQL/comments/z1h7j/small_date_time_without_seconds/,"I have a field in a table that is the smalldatetime data type. I need it to show up in my table (I view and edit and all in a Qt program) without the seconds. If anyone knows how to do this please let me know.

Also I've never done much with SQL so if I need to do some SQL statement stuff please tell me where to put it because I have no idea",,False,self,t5_2qp8q,False,,,True,t3_z1h7j,http://www.reddit.com/r/SQL/comments/z1h7j/small_date_time_without_seconds/,
1346130796.0,2,self.SQL,yy3wo,How can I create a requirement for users to input a value that will be applied to the select statement in TSQL?,,3,1,6,http://www.reddit.com/r/SQL/comments/yy3wo/how_can_i_create_a_requirement_for_users_to_input/,"I'm creating a tool with an Access interface that runs off of SQL.  I would like a query to ask a user for a value which will be applied to the select statement they are running.  Specifically to create a view as: 
 
CREATE VIEW delinq_report.VI&lt;userinput required here&gt;I
AS
SELECT *
FROM delinq_report.""Delinquent Scanners in Edata""
WHERE Protocol LIKE '&lt;userinput required here&gt;%'
 
An example final output of the code is:
 
CREATE VIEW delinq_report.VI0448I
AS
SELECT *
FROM delinq_report.""Delinquent Scanners in Edata""
WHERE Protocol LIKE '0448%'
 
So the user would basically input 0448 and it would be applied to the statement.
 
Any ideas?
",,False,self,t5_2qp8q,False,,,True,t3_yy3wo,http://www.reddit.com/r/SQL/comments/yy3wo/how_can_i_create_a_requirement_for_users_to_input/,
1346043349.0,2,self.SQL,yw1gu,Any help with a function?,jjzaus,4,2,5,http://www.reddit.com/r/SQL/comments/yw1gu/any_help_with_a_function/,"I cannot figure out what mistake I am making here. I need a function that searches a database for a partial name and returns the ID for that person. I'd appreciate a hand with the syntax and have posted the function underneath. It is not complete, because I do not see the sense in completing something I do not understand.

CREATE OR REPLACE FUNCTION A1_GUEST_NAME_EXISTS  
  (p_guest_name IN OUT A1_guests.guest_name%TYPE)
RETURN NUMBER AS 
  v_guest_name A1_guests.guest_name%TYPE;
  v_guest_id A1_guests.guest_id%TYPE;
  CURSOR c_guest IS
  SELECT guest_name, guest_id FROM A1_guests
  WHERE guest_name LIKE p_guest_name;
  v_guest c_guest%ROWTYPE;
BEGIN
  OPEN c_guest;
    FETCH c_guest INTO v_guest;
      IF c_guest%NOTFOUND THEN
         v_guest_id := 0;
      END IF;
      
  RETURN v_guest_id;
END A1_GUEST_NAME_EXISTS;",,False,self,t5_2qp8q,False,,,True,t3_yw1gu,http://www.reddit.com/r/SQL/comments/yw1gu/any_help_with_a_function/,
1343933256.0,2,self.SQL,xkrxu,[Oracle] Matching chars not equivalent?,Almace,2,0,17,http://www.reddit.com/r/SQL/comments/xkrxu/oracle_matching_chars_not_equivalent/,"I'm attempting to join two tables on a column both defined as char(8). However, no matter what I do, the query never returns any values because the value never ""matches"", even when they do. I've printed the results without matching on this value just to check, and return something that looks like this:

    0 00101 00103
    1 00301 00301
    3 00202 00202

Where the first column is an ID, and the second and third column are the values I'm trying to match from separate tables. Despite the records for ID value 1 and 3 matching, when joining on the second and third columns the query returns nothing.

I've added a third column as such:

       case
            when trim ( cast ( VALUE_1 as char(8) ) ) = cast ( VALUE_2 as char(8) ) then 'true'
            else 'false'
       end MATCH

which constantly returns false as well. What is wrong exactly, and how do I correct it?",,False,self,t5_2qp8q,1343933471.0,,,True,t3_xkrxu,http://www.reddit.com/r/SQL/comments/xkrxu/oracle_matching_chars_not_equivalent/,
1343778028.0,2,self.SQL,xh603,[MS SQL] (generic T-SQL question) nesting SELECT?,ImHighCurrently,3,1,15,http://www.reddit.com/r/SQL/comments/xh603/ms_sql_generic_tsql_question_nesting_select/,"I'm getting spanked by a SQL problem.  Can anyone save my bacon?

Take a look at the following 2 tables:


    |tblHumans
    |---------|
    | HumanID | PK (ONE to MANY to TABLE2.HumanID) 
    |---------|
    | 1       |
    | 2       |
    | 3       |
    |---------|


    |tblHumanColors
    | HAS NO PK.  HumanID + DAYofWEEK Will always be unique
    |-----------------------------|
    |COLORS | HumanID | DAYofWEEK |
    |-----------------------------|
    | RED   | 1       | 1         |
    | BLUE  | 1       | 2         |
    | RED   | 2       | 1         |
    | YELLOW| 3       | 1         |
    | PINK  | 3       | 3         |
    | PINK  | 3       | 7         |
    |-----------------------------|


 
tblHumans is my 'primary' table.  I have a large query with JOINS to 5 tables other than tblHumanColors.

Part of this query I need 7 fields (1 for each day of the week).  I'm trying to return the COLORS for each HUMAN for each DAYofWEEK

So the result should look like this:

    |ResultTable
    |-------------------------------------------------------|
    | HumanID  | ColorForDay1 | ColorForDay2 | ColorForDay3 | (...through Day7)
    |-------------------------------------------------------|
    | 1        | RED          | BLUE         |              |
    | 2        | RED          |              |              |
    | 3        | YELLOW       |              | PINK         | 
    |-------------------------------------------------------|

The trick is that ***this ResultTable is just a small part of a larger table.***

I tried nesting a SELECT statement inside the larger query but I get multiple rows (I was hoping it would pass the tblHumans.HumanID into the nested Select, but no luck:

    SELECT tblHumans.AField
    , Table3.SomeOtherField
    , Table4.AnotherField
    , Table5.YetAnotherField 
    , (SELECT tblHumanColors.COLORS FROM tblHumanColors
       INNER JOIN tblHumans ON tblHumans.HumanID = tblHumanColors.HumanID
       WHERE DayofWeek = 1)
    , (SELECT TABLE2.COLORS FROM TABLE2 
       INNER JOIN tblHumans ON tblHumans.HumanID = tblHumanColors.HumanID
       WHERE DayofWeek = 2)
    ...


I tried using a variable (DECLARE &amp; SET) but I can't seem to get it to SET inside the main SELECT statement.  I guess you have to use them outside the SELECT(?)

This one has me feeling extra derpy.  Can anyone point me in the right direction?

-Preemptive thank you very much",,False,self,t5_2qp8q,False,,,True,t3_xh603,http://www.reddit.com/r/SQL/comments/xh603/ms_sql_generic_tsql_question_nesting_select/,
1343154649.0,2,self.SQL,x33cu,[MS SQL] Database engine lost after SP3,Icetime58,3,1,48,http://www.reddit.com/r/SQL/comments/x33cu/ms_sql_database_engine_lost_after_sp3/,"I recently went from MS SQL Server RTM to SP3 and now my database engine is missing. Before I could just log in with (local) for server name and use Windows Authentication. But after installing SP3 I can't do this anymore. I get the following error: 

Cannot connect to (local).
-&gt; Login failed for user 'UserName'. (Microsoft SQL Server, Error: 18456)
Severity: 14
State: 1
Line Number: 65536

All of my Google results have been telling me to ensure the authentication mode is in SQL and Windows authentication. However, in the object explorer I have no objects. This is different compared to before SP3 was installed where I had a local instance in the object explorer. What do I do?

**Edit**: I found the error logs and they show this at the end.

2012-07-24 10:43:26.43 Logon       Login failed for user 'UserName'. Reason: Token-based server access validation failed with an infrastructure error. Check for previous errors. [CLIENT: &lt;local machine&gt;]
2012-07-24 10:43:28.74 Logon       Error: 18456, Severity: 14, State: 11.

**Edit 2**: Sorry about that. I should of been more descriptive. I am running MS SQL Server 2008 Standard SP3 on Windows Server 2008 R2 64-bit virtual machine using VMware. 

**Edit 3**: I have turned off UAC and ensured that my user is set to administrator under control panel -&gt; user accounts. I am now in the process of finding out how to uninstall SP3 and see if this gets me anywhere. 

**Edit 4**: I have followed the steps in the blog below and I am still unable to login to my default instance. I am getting the error:

Cannot connect to (local).

A network-related or instance-specific error occurred while establishing a connection to SQL Server. The server was not found or was not accessible. Verify that the instance name is correct and that SQL Server is configured to allow remote connections. (provider: Named Pipers Provider, error: 40- Could not open a connection to SQL Server)(Microsoft SQL Server, Error: 2)

http://beyondrelational.com/modules/2/blogs/115/posts/11143/how-to-access-a-newly-installed-sql-server-2008-r2-instance-if-you-do-not-know-the-login-and-passwor.aspx

**Edit 5**: Here is my current error log http://pastebin.com/25pUSCYa",,False,self,t5_2qp8q,1343234155.0,,,True,t3_x33cu,http://www.reddit.com/r/SQL/comments/x33cu/ms_sql_database_engine_lost_after_sp3/,
1342712132.0,2,self.SQL,wtkc8,"Upgraded our server from SQL 2000 to 2008, and now some stuff is broken. Any tips?",lolajoan,5,3,6,http://www.reddit.com/r/SQL/comments/wtkc8/upgraded_our_server_from_sql_2000_to_2008_and_now/,"I work in a library. In our catalog, we have videos and can display them by playtime. The playtime field has the format of the number of minutes, then a space, then the word minutes. So, '8 minutes' or '29 minutes' or '430 minutes' (and a few NULLs). The query that is broken was the one to find out just the digits from that field, then figure out what range they fall into.  An example of the old one that used to work in 2000 is:

    case ""2"":
    $query .= "" and (cast(SUBSTRING(V.fPlaytime,1,CHARINDEX(' ',V.fPlaytime)-1) as smallint(2)) &lt; 15) 
    and (cast(SUBSTRING(V.fPlaytime,1,CHARINDEX(' ',V.fPlaytime)-1) as smallint(2)) &gt; 10)"";

So that should return videos with playtimes from 10-15 minutes. I went through a bunch of documentation to try to figure out what the problem is and it all looks okay to me.

Can you give me any ideas on where to poke to find the hole? Thanks!",,False,self,t5_2qp8q,False,,,True,t3_wtkc8,http://www.reddit.com/r/SQL/comments/wtkc8/upgraded_our_server_from_sql_2000_to_2008_and_now/,
1342639190.0,3,self.SQL,wrws3,SQLite or Alternative for Java?,CompEngCraft,8,5,2,http://www.reddit.com/r/SQL/comments/wrws3/sqlite_or_alternative_for_java/,"For work I have been asked to try and use a more portable code model (pretty much extract and run type deal) for a piece of software that heavily uses databases.

I have only ever really worked with server DBMS systems and connect using JDBC, however I have in the past used SQLite with C++ which was pretty much exactly what I need now.

Problem is I am stuck with Java, and there doesnt seem to be any official Java implementation I can find for SQLite (other than Android which doesnt count). I have found multiple wrappers but would rather avoid licensing anything if possible.

Help?",,False,self,t5_2qp8q,False,,,True,t3_wrws3,http://www.reddit.com/r/SQL/comments/wrws3/sqlite_or_alternative_for_java/,
1341708838.0,2,self.SQL,w79rn,[SQLite] How best to set up a DB for song metadata?,TankorSmash,7,5,16,http://www.reddit.com/r/SQL/comments/w79rn/sqlite_how_best_to_set_up_a_db_for_song_metadata/,"I'm very new to DBM, so I really don't know what to do. I've asked the same question over at /r/learnpython [here](http://www.reddit.com/r/learnpython/comments/w6ty9/sqlite3_basictointermediate_tutorials_should_i/) and got some good answers, especially a good example, but I'd like to know what you guys think.

**I've got the following data so far: `filepath`, a single` ID3tags` python custom object (but there are over 100 ID3 tags inside each object) and `times played`. How do I store the information in a database effectively?**

I'm reading about the fundamentals [here](http://www.deeptraining.com/litwin/dbdesign/FundamentalsOfRelationalDatabaseDesign.aspx)",,False,self,t5_2qp8q,False,,,True,t3_w79rn,http://www.reddit.com/r/SQL/comments/w79rn/sqlite_how_best_to_set_up_a_db_for_song_metadata/,
1341192390.0,2,self.SQL,vwijf,Business Analyst SQL interview questions?,loki0wn,6,4,3,http://www.reddit.com/r/SQL/comments/vwijf/business_analyst_sql_interview_questions/,"I have a second interview this week for a Business Analyst position at a company. I don't believe that there will be a lot of DDL type questions, although Views will likely come up; however, my biggest issue with the first interview was the way that the questions were set up: I have two tables called blah and blah2, with the columns etc1...etc2. I want two columns and two rows summing the quantity sold for today and yesterday, how would you do this?

I began to over engineer the problems and doing stupid shit like inner joins where only it only needed to be select date, sum(qty) from blah. I have the knowledge, just issues taking desires to actual script. Anyone have a good website or resource that provides something like this instead of esoteric/academic questions that are there to screw over your mind palace.",,False,self,t5_2qp8q,False,,,True,t3_vwijf,http://www.reddit.com/r/SQL/comments/vwijf/business_analyst_sql_interview_questions/,
1340218806.0,2,self.SQL,vcbd6,[MS SQL] Is there a known solution to recreate Excel's INDIRECT()?,frescani,2,0,4,http://www.reddit.com/r/SQL/comments/vcbd6/ms_sql_is_there_a_known_solution_to_recreate/,"I also posted this in /r/SQLServer..

I'm sure this is a total newbie question, but... is there a way to store large amounts of calculations and call them based on a sort of mapping. e.g. if value a = 'x' then calculate column b as 'whatever', if 'y', if 'z', etc...

As an alternative approach to storing in a table, can i store it in a script or view or whatever and pass the appropriate field-calculation back to the calling query?",,False,self,t5_2qp8q,False,,,True,t3_vcbd6,http://www.reddit.com/r/SQL/comments/vcbd6/ms_sql_is_there_a_known_solution_to_recreate/,
1340032674.0,2,self.SQL,v86d3,[MSSQL] Returned value contains a newline character?,wsnich,2,0,7,http://www.reddit.com/r/SQL/comments/v86d3/mssql_returned_value_contains_a_newline_character/,"I'm having trouble with a query that returns values from a free form text field that contains a special character, I assume, that starts a new line. 

Example:
My result should be this, in one line:

""Maximum container weight is 99ozs per 99 oz container.  99 oz On Call as requested""

Except it gives me the result in the export as:

""Maximum container weight is 99ozs per 99 oz container.  ""

""99 oz On Call as requested""

Is there anything I can do to fix this?",,False,self,t5_2qp8q,1340033759.0,,,True,t3_v86d3,http://www.reddit.com/r/SQL/comments/v86d3/mssql_returned_value_contains_a_newline_character/,
1339522835.0,2,self.SQL,uy9as,Altering data type for specific cells SQL,,2,0,4,http://www.reddit.com/r/SQL/comments/uy9as/altering_data_type_for_specific_cells_sql/,I am trying to alter the data types for specific cells in a column.  The column is currently text.  I need to change the ones with actual dates to a date and time format and keep the ones labeled as 'current' or 'No data received' as text.  Any ideas?,,False,self,t5_2qp8q,False,,,True,t3_uy9as,http://www.reddit.com/r/SQL/comments/uy9as/altering_data_type_for_specific_cells_sql/,
1339173001.0,2,self.SQL,urrnz,[MS SQL] Natural keys vs artificial keys in this case?,,4,2,11,http://www.reddit.com/r/SQL/comments/urrnz/ms_sql_natural_keys_vs_artificial_keys_in_this/,"I am trying to design a database system for a website. In the past, mainly working with MySQL, I have tended to use artificial primary keys (often int, unsigned, not null, auto_increment). For this project some sample tables will be LocationCountries, LocationSubdivisions, LocationCities. I am wondering how to go about this, using natural keys for the tables. For example, here are the two different ideas I was considering:

**Artificial Keys**

    LocationCountries
        Columns
            CountryID - int, unsigned, not null, auto_increment
            CountryName - varchar(255), not null
            CountryNameSlug - char(2), not null
        Indices
            CountryID - Primary Key
            CountryName - Unique
            Slug - Unique - CountryNameSlug
    
    LocationSubdivisions
        Columns
            SubdivisionID - int, unsigned, not null, auto_increment
            CountryID - int, unsigned, not null
            SubdivisionName - varchar(255), not null
            SubdivisionNameSlug - varchar(255), not null
        Indices
            SubdivisionID - Primary Key
            CountryID - Foreign Key - CountryID =&gt; LocationCountries(CountryID)
            Slug - Unique =&gt; CountryID, SubdivisionNameSlug
    
    LocationCities
        Columns
            CityID - int, unsigned, not null, auto_increment
            SubdivisionID - int, unsigned, not null
            CityName - varchar(255), not null
            CityNameSlug - varchar(255), not null
        Indices
            CityID - Primary Key
            SubdivisionID - Foreign Key - SubdivisionID =&gt; LocationSubdivisions(SubdivisionID)
            Slug - Unique - SubdivisionID, CityNameSlug

*OR*

**Natural Keys**

    LocationCountries
        Columns
            CountryCode - char(2), not null
            CountryName - varchar(255), not null
        Indices
            CountryID - Primary Key - CountryCode
            CountryName - Unique
    
    LocationSubdivisions
        Columns
            SubdivisionCode - char(3), not null
            CountryCode - int, unsigned, not null
            SubdivisionName - varchar(255), not null
            SubdivisionNameSlug - varchar(255), not null
        Indices
            SubdivisionID - Primary Key - SubdivisionCode, CountryCode
            CountryID - Foreign Key - CountryCode =&gt; LocationCountries(CountryCode)
            Slug - Unique - CountryCode, SubdivisionNameSlug
    
    LocationCities
        Columns
            CityNameSlug - varchar(255), not null
            SubdivisionCode - char(3), not null
            CountryCode - char(2), not null
            CityName - varchar(255), not null
        Indices
            CityID - Primary Key - CityNameSlug, SubdivisionCode, CountryCode
            SubdivisionID - Foreign Key - (SubdivisionCode, CountryCode) =&gt; LocationSubdivisions(SubdivisionCode, CountryCode)

By the way, example urls are:

 * site.com/us
 * site.com/us/california
 * site.com/us/california/los_angeles

As you can probably tell, I'm fairly new to SQL and RDBMSs. What method do you think is better, or is there another way to go about this? I know varchars in primary keys can be problematic compared to just ints",,False,self,t5_2qp8q,1339174618.0,,,True,t3_urrnz,http://www.reddit.com/r/SQL/comments/urrnz/ms_sql_natural_keys_vs_artificial_keys_in_this/,
1339062496.0,2,self.SQL,upk4r,Restoring from corrupt .bak file,YesMrBossMan,2,0,6,http://www.reddit.com/r/SQL/comments/upk4r/restoring_from_corrupt_bak_file/,"So I need to restore a database backup from a .bak file. I have the latest backup and it's working but management is under the impression that there is other info on the old corrupted .bak file.

I have tried the following:
1- RESTORE DATABASE dbname FROM DISK='pathtodisk.bak' WITH RECOVERY, CONTINUE_AFTER_ERROR;

2- RESTORE DATABASE dbname DEOM DISK='pathtodisk.bak' WITH FILE=1, NO RECOVERY, CONTINUE_AFTER_ERROR;

3- Restoring from GUI

4- Currently attempting: RESTORE DATABASE dbname FROM DISK='pathtodisk.bak' WITH FILE=1, NOUNLOAD, REPLACE, STATS=10

On all the above(excluding 4, since it's still running) I get the error ""Not a valid NT BACKUP device"" clearly because it's corrupted.

The DB is 280GB in size, so each one took forever to run.
There is no disc space issue.

Is there anything else that I can attempt to run in order to restore the corrupted DB?",,False,self,t5_2qp8q,False,,,True,t3_upk4r,http://www.reddit.com/r/SQL/comments/upk4r/restoring_from_corrupt_bak_file/,
1339056144.0,2,self.SQL,uphk1,[Oracle] Can someone suggest if there is any alternate way for this sql? ,1581947,2,0,5,http://www.reddit.com/r/SQL/comments/uphk1/oracle_can_someone_suggest_if_there_is_any/,"Sql
select name and marks of the student who got max marks in maths in below tables

Table: student
Columns: roll_no, name

Table: result 
Columns: roll_no, subj, marks

I think below should work

select student.name, result.marks
from student, result
where student.roll_no = result.roll_no
and result.subj= ""maths""
and result.marks = (select max(marks) from result where subj = ""maths"")

I am trying to find out if there is any other way of doing this without the sub query.",,False,self,t5_2qp8q,False,,,True,t3_uphk1,http://www.reddit.com/r/SQL/comments/uphk1/oracle_can_someone_suggest_if_there_is_any/,
1338922827.0,2,self.SQL,umigh,[Oracle] grouping redundant output of certain columns,sizzleplatter,2,0,7,http://www.reddit.com/r/SQL/comments/umigh/oracle_grouping_redundant_output_of_certain/,"Thanks for any help. Basically I'm trying to group the output of only the first three columns in the output below so that the report is cleaner and easier to read.  Basically I'd like to have header for each person and each product listed individually.  Is it possible to do something like this in a single select statement?


[example output](http://i.imgur.com/il2Pw.png)

query:
SELECT 
    p.id,
    p.name,
	p.city,
	o.product,
	o.amount
from p left join o on p.id = o.person_id
where o.amount &gt; 0;

",,False,self,t5_2qp8q,False,,,True,t3_umigh,http://www.reddit.com/r/SQL/comments/umigh/oracle_grouping_redundant_output_of_certain/,
1338887800.0,2,self.SQL,ulu5n,top 25 list not showing all users and wrong scores,johanm,2,0,7,http://www.reddit.com/r/SQL/comments/ulu5n/top_25_list_not_showing_all_users_and_wrong_scores/,"hi guys,
im in a very deep bucket of f***** with a client. 
They're running a sales competition (with some big prizes) and this top 25 list I've written is showing the wrong results.

users arent showing that should be pretty far up on the list. 
any idea what the issue could be?

SELECT u.fname, u.lname, SUM(p.point) as points 
FROM comp_sale s, comp_product p, comp_user u  
WHERE s.prod_id = p.product_id 
AND s.sale_id = u.wp_id 
GROUP BY lname 
ORDER BY points DESC limit 25",,False,self,t5_2qp8q,False,,,True,t3_ulu5n,http://www.reddit.com/r/SQL/comments/ulu5n/top_25_list_not_showing_all_users_and_wrong_scores/,
1338570670.0,2,self.SQL,ufuv4,"""Order by"" and WinLatin1 encoding",,2,0,1,http://www.reddit.com/r/SQL/comments/ufuv4/order_by_and_winlatin1_encoding/,"Hello,

I am running into a small issue on Postgre 8.4 in the US. When doing an order by on results, an entry with an accented character, e.g. ""Égypte"", will show up at the end of the results, rather than with the E's, as should happen. Has anyone ever come across this issue and found a fix?

Thanks",,False,self,t5_2qp8q,False,,,True,t3_ufuv4,http://www.reddit.com/r/SQL/comments/ufuv4/order_by_and_winlatin1_encoding/,
1337570859.0,2,self.SQL,twyvl,Learning SQL on my PC - Connection Issues,MongrelNymph,2,0,6,http://www.reddit.com/r/SQL/comments/twyvl/learning_sql_on_my_pc_connection_issues/,"I am trying to teach myself SQL on my new PC. I downloaded Microsoft SQL Server 2012 and installed but now I'm stuck. I am using Windows Authentication, but it won't let me connect. While researching a solution, i saw a few threads suggest a few options on what to name my server, localhost or sqlexpress or ""."" but whatever I use I get this error: 

TITLE: Connect to Server
------------------------------

Cannot connect to localhost.

------------------------------
ADDITIONAL INFORMATION:

A network-related or instance-specific error occurred while establishing a connection to SQL Server. The server was not found or was not accessible. Verify that the instance name is correct and that SQL Server is configured to allow remote connections. (provider: Named Pipes Provider, error: 40 - Could not open a connection to SQL Server) (Microsoft SQL Server, Error: 2)

For help, click: http://go.microsoft.com/fwlink?ProdName=Microsoft%20SQL%20Server&amp;EvtSrc=MSSQLServer&amp;EvtID=2&amp;LinkId=20476

I have most likely neglected to do some simple step but as I am a ultra-noob I do not know what I missed. Do I need to something to my PC to get it to act as a server first? Do I need to do something in Windows so it knows I'm an administrator?  The fields are greyed out, and it shows my name but nothing for my password. I'm using my home PC so there is no password.  
",,False,self,t5_2qp8q,False,,,True,t3_twyvl,http://www.reddit.com/r/SQL/comments/twyvl/learning_sql_on_my_pc_connection_issues/,
1336730515.0,2,self.SQL,thz18,It possible to execute this in one sql statement?,juwking,3,1,6,http://www.reddit.com/r/SQL/comments/thz18/it_possible_to_execute_this_in_one_sql_statement/,"So I Got two sql statement for SSRS. One just gets the data.



    SELECT Type, FirstName, LastName, Adress1, Adress2, Amount, Date, CASE WHEN Type = '1' THEN 'Refund' ELSE 'Payment' END AS TypeName
FROM            Transactions
WHERE        (Date &lt; @DateTo) AND (Date &gt; @DateFrom) AND (FirstName LIKE '%' + @FirstName + '%')AND(LastName LIKE '%' + @LastName + '%')



This sums the amounts, payments and refunds are substracted.



    SELECT        refund.value - payment.value AS Total
FROM            (SELECT        SUM(Amount) AS value
                          FROM            Transactions
                          WHERE        (Type = 0) AND (Date &lt; @DateTo) AND (Date &gt; @DateFrom) AND (FirstName LIKE '%' + @FirstName + '%') AND (LastName LIKE '%' + @LastName + '%')) 
                         AS refund CROSS JOIN
                             (SELECT        SUM(Amount) AS value
                               FROM            Transactions AS Transactions_1
                               WHERE        (Type = 1) AND (Date &lt; @DateTo) AND (Date &gt; @DateFrom) AND (FirstName LIKE '%' + @FirstName + '%') AND (LastName LIKE '%' + @LastName + '%'))
                          AS payment

Is it posible to combine those two?
",,False,self,t5_2qp8q,False,,,True,t3_thz18,http://www.reddit.com/r/SQL/comments/thz18/it_possible_to_execute_this_in_one_sql_statement/,
1336099529.0,2,self.SQL,t681e,Help passing/sharing information between an Orders table and a Order Details table,AlreadyGone45,5,3,3,http://www.reddit.com/r/SQL/comments/t681e/help_passingsharing_information_between_an_orders/,"Hello everyone,

I'm working on a simple DB project and was looking for some help if possible. I am building a database for a fictioonal bookstore and two of the tables are:

Orders
(TransactionID,
CustomerID,
StaffID,
Qty,
Price,
Date)

Order Details Order_details
(OrderID,
TransactionID,
BookID,
Qty)

Basically each transaction can have multiple order details (what books did they buy and how many of them?)

I have been adding rows and doing the math by hand to make sure the price and quantity makes sense between the two tables (the price of each book is in another table). 

My question is, can I automate this somehow? So transaction.price and transaction.qty can be calculated automatically based on order details when inserting rows.

Hopefully that made sense...



",,False,self,t5_2qp8q,False,,,True,t3_t681e,http://www.reddit.com/r/SQL/comments/t681e/help_passingsharing_information_between_an_orders/,
1336008894.0,2,self.SQL,t4cf2,Is SQL dba right for me?,hiGooGee,3,1,15,http://www.reddit.com/r/SQL/comments/t4cf2/is_sql_dba_right_for_me/,"Hello reddit, lately i have been considering a career change and SQL dba came in my radar. Here's a little background info about me: i am a intermediate to advanced excel user, from using simple VBA code to pdf files to using pivot table making meaningful reports. I do not have much programming knowledge as the last C++ course i took was ten years ago. I figured that it should be possible for me to study SQL anyway? I also built my home computer from parts following manual instruction.  Can someone lead me into the right direction? Whats a good book and where should i start considering my pre requisites? Thank you very much. :)",,False,self,t5_2qp8q,False,,,True,t3_t4cf2,http://www.reddit.com/r/SQL/comments/t4cf2/is_sql_dba_right_for_me/,
1335728420.0,2,self.SQL,syizg,[MS SQL] Help compare dates using only month and year in separate columns,noatm,3,1,7,http://www.reddit.com/r/SQL/comments/syizg/ms_sql_help_compare_dates_using_only_month_and/,"I have a list of credit cards and their expiration month and year are in two separate columns. I need to get those credit cards that have already expired. This is what I've come up with but for some reason, it's not working properly, it's only giving me months 1-3 for every year. I'm using Adventureworks to practice:

select * from Sales.CreditCard
where ExpYear &lt;= year(GETDATE())
or (ExpYear &lt;= Year(GETDATE())
and ExpMonth &lt; MONTH(GETDATE()))
order by ExpYear desc, ExpMonth asc",,False,self,t5_2qp8q,False,,,True,t3_syizg,http://www.reddit.com/r/SQL/comments/syizg/ms_sql_help_compare_dates_using_only_month_and/,
1335569685.0,2,self.SQL,sw2jf,Anyone know of a good physical book on cursors or at least one that covers them well and in-depth?,,2,0,4,http://www.reddit.com/r/SQL/comments/sw2jf/anyone_know_of_a_good_physical_book_on_cursors_or/,,,False,self,t5_2qp8q,False,,,True,t3_sw2jf,http://www.reddit.com/r/SQL/comments/sw2jf/anyone_know_of_a_good_physical_book_on_cursors_or/,
1335370831.0,2,self.SQL,srxvm,[MySQL] Need a little help with a join,YoureAFuckingTowel,2,0,3,http://www.reddit.com/r/SQL/comments/srxvm/mysql_need_a_little_help_with_a_join/,"Here's the scenario: I'm building a webpage in PHP/MySQL where a user will select their site, and then be presented with an order form for the items relevant to their site. In my database I have three tables: sites, items, and sites_items_junction (let's just call it junction). 

Basically, I need to combine the following two queries: 
    SELECT item_id FROM items; 
    /* If there are ten items, it will return id's 1-10 */
    SELECT * FROM junction WHERE site_id = '5'; 
    /* let's say it returns 1, 3, and 7 */

To produce a result similar to this:

&gt;item_id  |  Available

&gt;--------+----------

&gt;1&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;|&amp;nbsp;&amp;nbsp;&amp;nbsp;**true**

&gt;2&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;|&amp;nbsp;&amp;nbsp;&amp;nbsp;false

&gt;3&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;|&amp;nbsp;&amp;nbsp;&amp;nbsp;**true**

&gt;4&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;|&amp;nbsp;&amp;nbsp;&amp;nbsp;false

&gt;5&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;|&amp;nbsp;&amp;nbsp;&amp;nbsp;false

&gt;6&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;|&amp;nbsp;&amp;nbsp;&amp;nbsp;false

&gt;7&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;|&amp;nbsp;&amp;nbsp;&amp;nbsp;**true**

&gt;8&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;|&amp;nbsp;&amp;nbsp;&amp;nbsp;false

&gt;9&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;|&amp;nbsp;&amp;nbsp;&amp;nbsp;false

&gt;10&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;|&amp;nbsp;&amp;nbsp;&amp;nbsp;false


It doesn't have to necessarily be a boolean, 0 or 1 would work as well. 

All the items that are not available to the site will be generated as hidden fields in the order form.",,False,self,t5_2qp8q,False,,,True,t3_srxvm,http://www.reddit.com/r/SQL/comments/srxvm/mysql_need_a_little_help_with_a_join/,
1334942292.0,2,self.SQL,sjyfj,Need help with using getdate(),,2,0,5,http://www.reddit.com/r/SQL/comments/sjyfj/need_help_with_using_getdate/,"select * into DelinquentFacilities from All_Forms where column1 &gt;= (getdate()-90) column2 &gt;= (getdate()-90) 

Table All_Forms with columns FacilityID(numeric), Form1(date), Form2(date)

The All_Forms table contains the most recent date received for Form1 in column Form1 and the most recent data received for Form2 in column Form2 for a particular facility.  I am trying to create a query which will return the facilityID if values for Form1 or Form2 is past 90 days of todays date with getdate.  I would like to return NULLs for the other correpsonding column, even if only one is past 90s days.  However, I do not want any return if both Column1 and Column 2 are NULL.  

I am unsure of what exactly I am returning at the moment.  Any idea in order to correct my statement above?
",,False,self,t5_2qp8q,False,,,True,t3_sjyfj,http://www.reddit.com/r/SQL/comments/sjyfj/need_help_with_using_getdate/,
1334794660.0,2,self.SQL,sgya8,[Oracle] SELECT INTO from Multiple tables,tinydan,2,0,6,http://www.reddit.com/r/SQL/comments/sgya8/oracle_select_into_from_multiple_tables/,"Hey, I'm working on a schema translation project and I'm at a point where i need to build a collection of references within a table. I've decided that storing the refernces within nested should work, however i'm having trouble selecting data from multiple tables and inserting it into a table with a nested table field. Could anyone offer any help or insight if this is possible? Thanks",,False,self,t5_2qp8q,False,,,True,t3_sgya8,http://www.reddit.com/r/SQL/comments/sgya8/oracle_select_into_from_multiple_tables/,
1334721040.0,2,self.SQL,sfge1,[SQL in Access] SQL noob here looking for help with simple query,loeras,2,0,17,http://www.reddit.com/r/SQL/comments/sfge1/sql_in_access_sql_noob_here_looking_for_help_with/,"Hey all, I'm very new to SQL but I'm looking for help with a simple query and I can not seem to get it to work.

I have a table named BCS. It has a bunch of different columns but I am trying to get information from two of them. I need the minimum value from a column labeled HPTS and I need the corresponding value from the column labeled Team.

I know how to get the minimum value already.

SELECT MIN (HPTS)
FROM BCS 

This only shows me the value itself though, and I need to have the corresponding value in Team along with it. 

Thank you for your help in advance!",,False,self,t5_2qp8q,False,,,True,t3_sfge1,http://www.reddit.com/r/SQL/comments/sfge1/sql_in_access_sql_noob_here_looking_for_help_with/,
1334270400.0,2,self.SQL,s6y69,[Oracle] Rights needed for PL/SQL development?,Hacto,2,0,2,http://www.reddit.com/r/SQL/comments/s6y69/oracle_rights_needed_for_plsql_development/,"What rights do I need my DBA to grant so I can work on things such as Functions, Triggers, and Stored Procedures in an Oracle 11g database?",,False,self,t5_2qp8q,False,,,True,t3_s6y69,http://www.reddit.com/r/SQL/comments/s6y69/oracle_rights_needed_for_plsql_development/,
1334095251.0,2,self.SQL,s399h,"Quick question regarding permissions and ""Scalar-Valued Functions""",Kendro_Boudrizmo,2,0,0,http://www.reddit.com/r/SQL/comments/s399h/quick_question_regarding_permissions_and/,"We have a user who has read/write permissions to a specific DB in SQL 2008 R2. He can usually do everything he needs with read/write but now he's saying he cant access 

""Programmability, functions, Scalar-valued Functions"" from this DB.

My question:  Does anyone know what the minimum permissions hell needs for this are? I'm trying to avoid making him dbowner unless necessary.",,False,self,t5_2qp8q,False,,,True,t3_s399h,http://www.reddit.com/r/SQL/comments/s399h/quick_question_regarding_permissions_and/,
1333983769.0,2,self.SQL,s0unj,[MS SQL] Automating Query for End User,Smotpoker,2,0,2,http://www.reddit.com/r/SQL/comments/s0unj/ms_sql_automating_query_for_end_user/,"Using MS SQL 2000. What would be the best way for an end user to run a SQL Query that requires their input?

I have the query written. There are a couple date fields and a customer name field I would have to prompt the end user for.

Would just setting up some kind of pivot table in Excel be the easiest way to do this or would I be better off using a stored procedure and programming a gui? ( I have visual studio 11 beta, I was looking at LightSwitch, but it isn't compatible with MSSQL 2000). I also have a copy of crystal reports 11. 

Data is all read-only, never need to insert anything. There are several blank fields like:

    '' AS 'Rebate Currency'

that are just used to format the data correctly.

I would rather not have my end user accessing the server directly and I don't want to have to run his reports for him every month.

End result needs to be output to csv or Excel.",,False,self,t5_2qp8q,True,,,True,t3_s0unj,http://www.reddit.com/r/SQL/comments/s0unj/ms_sql_automating_query_for_end_user/,
1332876904.0,2,self.SQL,rgan5,[MySQL] Newbie...need help loading an .sql file.,ExplosiveHippo,3,1,6,http://www.reddit.com/r/SQL/comments/rgan5/mysql_newbieneed_help_loading_an_sql_file/,"Hi, guys. I'm very new with mysql. I'm trying to load an .sql file but I get ERROR: Failed to open file 'Lance's HD/Users/lancealaughlin/Desktop/PE5.sql;', error: 2

This is the query I'm entering: . Lance's HD/Users/lancealaughlin/Desktop/PE5.sql;

I'm using a mac and the file is on my desktop. I've tried searching online but haven't had much luck.

I'd really appreciate any help! Trying to get moving on this!
",,False,self,t5_2qp8q,False,,,True,t3_rgan5,http://www.reddit.com/r/SQL/comments/rgan5/mysql_newbieneed_help_loading_an_sql_file/,
1332872052.0,2,self.SQL,rg6cq,Selecting XML (Serialised c# object),mogawowo,2,0,9,http://www.reddit.com/r/SQL/comments/rg6cq/selecting_xml_serialised_c_object/,"(MS SQL 2008)

I have a serialised object that looks like this in table  'sessions'  column 'serialisedobjects' :

&lt;ApplicationLicence ApplicationCode=""CoreApp"" NumberOfSeats=""10"" NumberOfTransactions=""1000444"" LicenceByToken=""true"" /&gt;

I want to return 

Appcode   NoOfSeats  NoOfTransactions  LicenceBytokens  with the node values eg Appcode = CoreApp


How would i accomplish this i have tried numerous methods but cant get anything to work in sql2008  :( any help from you SQL gurus would be appreciated!",,False,self,t5_2qp8q,True,,,True,t3_rg6cq,http://www.reddit.com/r/SQL/comments/rg6cq/selecting_xml_serialised_c_object/,
1332731786.0,2,self.SQL,rdnc8,[MS SQL] I just can't get around understanding these 2 concepts. Appreciated if anyone can?,moc_tidder,2,0,3,http://www.reddit.com/r/SQL/comments/rdnc8/ms_sql_i_just_cant_get_around_understanding_these/,"1: Recursion CTE 

2: Row number() over partition 

I understand the concept, but I simply can't understand on what situations/scenarios I can use the above and how to implement?
",,False,self,t5_2qp8q,False,,,True,t3_rdnc8,http://www.reddit.com/r/SQL/comments/rdnc8/ms_sql_i_just_cant_get_around_understanding_these/,
1332434444.0,2,self.SQL,r8k1b,Self teaching SQL is there anything out there that lets you get hands on exp?,Beastarino,2,0,3,http://www.reddit.com/r/SQL/comments/r8k1b/self_teaching_sql_is_there_anything_out_there/,"I've gone through alot of the online stuff w3schools, SQL Course and the like. But i'm hoping to get more advanced education on creation and manipulation of Databases. I seem to remember something called Adventure works. How is that for self education?",,False,self,t5_2qp8q,False,,,True,t3_r8k1b,http://www.reddit.com/r/SQL/comments/r8k1b/self_teaching_sql_is_there_anything_out_there/,
1332250958.0,2,self.SQL,r51ro,[SQL MS Access]  Comparing two fields on 4 tables,KingZing,2,0,3,http://www.reddit.com/r/SQL/comments/r51ro/sql_ms_access_comparing_two_fields_on_4_tables/,"I think I'm on the right track but I am unable to get the particulars down.  
I tried to do a nested IIF statement but it was not working.

The criteria I am trying to establish are:

* [A,B,C,orD]Security = [A,B,C,orD]Security **AND** 
* [A,B,C,orD] Universal_system &lt;&gt; [A,B,C,orD]Universal_system **OR** 
* [A,B,C,orD]Universal_fund &lt;&gt; [A,B,C,orD]Universal_fund 


I am trying to find results for when the Security is the same, but the universal_system(or)fund do not match across tables.
Ideally, they should all match, but if there is anywhere Security matches across tables and they don't, I want to be able to see every time Security is present so I can compare.

4 Tables:

[TableA][TableB][TableC][TableD]

* System
* Fund
* Security
* Universal_system
* Universal_fund


Thanks again for the help.  You guys have really been great in guiding me in previous questions.",,False,self,t5_2qp8q,True,,,True,t3_r51ro,http://www.reddit.com/r/SQL/comments/r51ro/sql_ms_access_comparing_two_fields_on_4_tables/,
1332221716.0,2,self.SQL,r4pq0,[MySQL] How do I update multiple fields so empty field content is moved to the logically last columns?,C_IsForCookie,2,0,4,http://www.reddit.com/r/SQL/comments/r4pq0/mysql_how_do_i_update_multiple_fields_so_empty/,"I copy/pasted the title from [this page](http://stackoverflow.com/questions/5107563/sql-how-to-update-multiple-fields-so-empty-field-content-is-moved-to-the-logica) whose OP has the same problem as me. Figured the title was a perfect description so I used it. I unfortunately couldn't find anything there to help me despite the suggestions, at least that I could follow. I read the code that was suggested in one post there and it seemed to only work if you have a very small number of columns since it was pretty static.

Basically I'm making a Netflix-esque queue on a website. I currently have 5 columns (in an SQL table, which will soon be extended to 50 columns) in which users can add titles to their queue (which will be an interactive list where they can edit the order). My code currently first tests to see if the title has been added. If it has it gives the option to remove and if it hasn't it checks to assure the queue isn't full and then gives the option to add. If added, the code finds the first empty column in the users queue and populates it with the title. The problem I'm having is that if I have 5 columns and 1,2,4,&amp;5 are populated, a newly added title would be populated in field 3 instead of at the end. For this reason, I'd like a string of code which I could implement (the entire site is PHP and I plan to implement some jQuery) which would shift the data over so new titles will populate the end of the list instead of a random middle field.

Any suggestions on how I could do this? Or even an alternative method of storing the data which may provide a workaround?

Thanks!

EDIT: Just thought that I could do:

    if($queues[q1] = 0){UPDATE 'q1' = 'q2 IN queues WHERE ID = '$id'; UPDATE 'q2' = '0' IN queues WHERE ID = '$id';}

and do it 50 times, 1 for each column, but that seems pretty inefficient and it could possibly take up a lot of resources, especially if the user has a relatively empty queue.",,False,self,t5_2qp8q,True,,,True,t3_r4pq0,http://www.reddit.com/r/SQL/comments/r4pq0/mysql_how_do_i_update_multiple_fields_so_empty/,
1332212582.0,2,self.SQL,r4iwx,I honestly wished I knew about Rollback and Commit.....,aboxofrice,2,0,4,http://www.reddit.com/r/SQL/comments/r4iwx/i_honestly_wished_i_knew_about_rollback_and_commit/,"Today in the heat of some craziness I did an update statement and ended up losing another hour of work. I ended up not only disabling one district but all districts......Moral of the story, always triple check your updates (I'm sure everybody here does that already) and do a 

BEGIN TRAN
update table set BitField1=1

ROLLBACK 
COMMIT TRAN
 ",,False,self,t5_2qp8q,False,,,True,t3_r4iwx,http://www.reddit.com/r/SQL/comments/r4iwx/i_honestly_wished_i_knew_about_rollback_and_commit/,
1331856326.0,2,self.SQL,qylk4,[MySQL] Nested WHERE IN Query Help / Avoidance,bear_karpov,3,1,8,http://www.reddit.com/r/SQL/comments/qylk4/mysql_nested_where_in_query_help_avoidance/,"My application is drastically different than this (has nothing to do with any type of class / school etc), but I felt this ""setup"" for the query would be the easiest to explain / receive help on.  
  
Assume we have a table, ITEMS, full of users (UID) and their classes (CLASS).  Each time a user enrolls in a class, a new row is created (example table below).  
  
  
-----------------------------  
  
  
CLASS  |  UID  
\\\\\\\\\\\\\\\\\\\\\\\\\\\  
ENG    |  ABC  
ENG    |  XYZ  
MATH   |  XYZ  
CHEM   |  ABC  
  
  
----------------------------  
  
  
To access this information I am using a nested SELECT WHERE IN Query and find it to be extremely inefficient when I try to query for more than 2 classes (If I try to match say 6 classes it becomes close to useable.)  
  
My table currently has 7.5 mil rows and will likely expand by at least 1 magnitude.  
  
Can you please suggest a rewrite on my query below to make it more efficient?  OR, if you feel like I should design my table in a completely different manner I am absolutely up for that as well, just need your advice.  
  
(Side note, there exists an unrelated table IDS that contains distinct UIDs I use for another purpose that I can join against if you feel like that would help.)  
  
  
------------------------  
  
  
THE QUERY  
  
  
    SELECT UID  
    FROM ITEMS  
    WHERE CLASS = 'ENG'  
    AND UID  
    IN (  
  
      SELECT UID FROM ITEMS  
      WHERE CLASS = 'MATCH'  
      AND UID  
      IN (  
  
        SELECT UID FROM ITEMS  
        WHERE CLASS = 'SCI'  
        AND UID  
        IN (  
  
          SELECT UID FROM ITEMS  
          WHERE CLASS = 'CHEM'  
  
          )  
        )  
      )  
  
    GROUP BY UID  
    LIMIT 100  
  
  
--------------------
   
  
A query like this will return a list of users enrolled in all four of those classes.  
  
Thanks a ton!",,False,self,t5_2qp8q,False,,,True,t3_qylk4,http://www.reddit.com/r/SQL/comments/qylk4/mysql_nested_where_in_query_help_avoidance/,
1331736444.0,2,artfulsoftware.com,qw7pp,Common MySQL Queries,Andrey_Karpov_N,2,0,1,http://www.reddit.com/r/SQL/comments/qw7pp/common_mysql_queries/,,,False,default,t5_2qp8q,False,,,False,t3_qw7pp,http://www.artfulsoftware.com/infotree/queries.php?bw=1024,
1330787581.0,2,self.SQL,qfxti,[MS SQL] Group By + ROLLUP question,o1o1197o,2,0,4,http://www.reddit.com/r/SQL/comments/qfxti/ms_sql_group_by_rollup_question/,"I am working my way through the group by, rollup, grouping exercises and I am having a hard time understanding whats happening when I try to generate sub total and grand totals. This is from this [article](http://beyondrelational.com/modules/2/blogs/28/posts/10471/tsql-lab-6-using-with-cube-to-generate-subtotal-and-grand-total-rows.aspx).

---

**Basic rollup:**

	select CustomerName, OrderID, sum(pricepercase*quantity) as Amount
	from orders
	group by customername,orderid
	with rollup

	CustomerName	OrderID	Amount
    ------------	-------	------
	Jacob			1		305.00
	Jacob			2		487.50
	Jacob			NULL	792.50
	Mike			1		119.00
	Mike			NULL	119.00
	NULL			NULL	911.50

---

**Grouping values:**
I understand that grouping(col) returns 1 if the column is aggregated and 0 if its not. So I wrote this to get some visual understanding. Ok it is fine until here.

	select grouping(CustomerName), grouping(OrderID), sum(pricepercase*quantity) as Amount
	from orders
	group by customername,orderid
	with rollup

	gcn	goi	Amount
    --- --- ------
	0	0	305.00
	0	0	487.50
	0	1	792.50
	0	0	119.00
	0	1	119.00
	1	1	911.50

---
Here is how I the **sub and grand totals** are being printed. 

	select
	case
	    when grouping(CustomerName) = 1 then 'Grand Total'
	    when grouping(OrderID) = 1 then ''
	    else CustomerName
	end as CustomerName,
	case
	    when grouping(CustomerName) = 1 then ''
	    when grouping(OrderID) = 1 then 'Customer Total'
	    else cast(OrderID as varchar)
	end as OrderID,
	sum(quantity*pricepercase) as Amount
	from orders
	group by CustomerName, OrderID
	with rollup

	CustomerName	OrderID	Amount
	------------	-------	------
	Jacob			1		305.00
	Jacob			2		487.50
			Customer Total	792.50
	Mike			1		119.00
			Customer Total	119.00
	Grand Total				911.50

---

**Edit** *removed my old question as it was confusing. rephrasing the question:*

Can someone please help me understand how the `Customer Total` and `Grand Total` were displayed where it was necessary? If possible please provide a step by step analysis of how to arrive at the result.",,False,self,t5_2qp8q,True,,,True,t3_qfxti,http://www.reddit.com/r/SQL/comments/qfxti/ms_sql_group_by_rollup_question/,
1330389896.0,2,self.SQL,q8x7r,Access 2007 - Noob Question about Queries ,RuchW,3,1,7,http://www.reddit.com/r/SQL/comments/q8x7r/access_2007_noob_question_about_queries/,"Sorry about the newbie question, but I'm building a database that has two tables (essentially). One table contains a bunch of facilities while the other contains the assets which belong to that facility. 
Each of those assets has a monetary value. How can I sum up the total monetary value of all the assets for each facility? Basically, I want to populate a field in the facilities table with the sum of the value of all the assets that belong to that facility.

Hope that makes sense.

Thanks",,False,self,t5_2qp8q,False,,,True,t3_q8x7r,http://www.reddit.com/r/SQL/comments/q8x7r/access_2007_noob_question_about_queries/,
1330210871.0,2,self.SQL,q5zbk,[Oracle] Simple Question...,MandMOnster,2,0,5,http://www.reddit.com/r/SQL/comments/q5zbk/oracle_simple_question/,"I can not figure out they want me to show:

List all staff and provide a total of salary (table:staff)
(inside staff is STAFFID, other junk, SALARY)

Do they want me to list all the IDs and the total salary of all?
or they mean just the count of IDs and total of salary?


Please help",,False,self,t5_2qp8q,False,,,True,t3_q5zbk,http://www.reddit.com/r/SQL/comments/q5zbk/oracle_simple_question/,
1328769945.0,2,support.microsoft.com,phih8,How to manually synchronize replication subscriptions by using backup or restore,cjusti,3,1,0,http://www.reddit.com/r/SQL/comments/phih8/how_to_manually_synchronize_replication/,,,False,http://f.thumbs.redditmedia.com/tjC8dfwsz6xOg6fY.jpg,t5_2qp8q,False,,,False,t3_phih8,http://support.microsoft.com/kb/320499,
1328745981.0,2,self.SQL,ph19t,[MSSQL] Triggers. Need ideas to overcome drop table issue.,ramse,3,1,4,http://www.reddit.com/r/SQL/comments/ph19t/mssql_triggers_need_ideas_to_overcome_drop_table/,"I have a problem. I work with a program that, i don't know what to call it, but has no backup system and no way to undo a deleted record. Now it's not all bad, because it is actually an enterprise level application and the only backups required are at the SQL database end and the applications save folder on the server.

One problem that we see weekly, is people constantly deleting things they shouldn't and then asking us to bring it back.... well bringing it back entails restoring a massive backup, remounting it to the program, copying the details out, dismount and remount live database then copying details back in. That is very tedious and a pain.

I've made SQL triggers on all tables that are ""INSTEAD OF DELETE"" and it takes the record from the live table and moves it to a deletion database which has the exact same tables just without data. And now I'm able to, in about 5 minutes, restore a record.

That is all fine and dandy, but now I'm running into issues when a user changes a field or adds one, the table gets modified and the schemas don't match anymore. Today, I was reading up on DDL triggers at the database level as ALTER_TABLE attempting to figure out my problem.

My real headache begins now. I've learned, that there is some SQL standard out there for modifying a large table(we're dealing with DB's 100's of GB's) that all data be moved to a temporary table, drop the live table, recreate it with the new column and then move everything back. I've learned this is done because at the enterprise level, you do not want to be editing a live table without a backup, so you move the data, make the table and make sure it went through fine then move everything back in.

Well that is causing problems, because it's deleting my triggers, and not only that but my DDL trigger doesn't work because it's not an ALTER_TABLE but rather CREATE/DROP table.

I'm at a loss of what to do now. Is it possible to have a trigger create a trigger within itself? Such as, when CREATE/DROP TABLE is fired, the DDL trigger actually recreates all table triggers to make sure all tables contain one?",,False,self,t5_2qp8q,False,,,True,t3_ph19t,http://www.reddit.com/r/SQL/comments/ph19t/mssql_triggers_need_ideas_to_overcome_drop_table/,
1328709288.0,2,kodyaz.com,pg81b,Microsoft SQL Server 2012 Features,luismiguel982,2,0,3,http://www.reddit.com/r/SQL/comments/pg81b/microsoft_sql_server_2012_features/,,,False,http://e.thumbs.redditmedia.com/h7s9q-DyORBSRSLF.jpg,t5_2qp8q,False,,,False,t3_pg81b,http://www.kodyaz.com/sql-server-2012/microsoft-sql-server-2012-features.aspx,
1328391448.0,2,self.SQL,pb1z2,Evaluating where clauses in a view,PierceClayton,3,1,3,http://www.reddit.com/r/SQL/comments/pb1z2/evaluating_where_clauses_in_a_view/,"I probably should know this...

When applying a where clause to a view, the whole view result set is brought back, then the where clause is applied against it...Right? 

Put another way, it's more efficient to add a where clause to the view statement (if you can) than to add a where clause to a select from the view. Right? Thanks!",,False,self,t5_2qp8q,False,,,True,t3_pb1z2,http://www.reddit.com/r/SQL/comments/pb1z2/evaluating_where_clauses_in_a_view/,
1328001412.0,2,firebirdnews.org,p4db8,"InfoQ: Q&amp;A with Jiri Cincura of the Firebird Database Project about the ADO.NET provider , ORM , SQL Server compact limitations",mariuz,3,1,0,http://www.reddit.com/r/SQL/comments/p4db8/infoq_qa_with_jiri_cincura_of_the_firebird/,,,False,default,t5_2qp8q,False,,,False,t3_p4db8,http://www.firebirdnews.org/?p=6736,
1327496751.0,2,self.SQL,ovzyc,SQL Newbie: Some help on solving a problem?,SuperFlyChris,3,1,14,http://www.reddit.com/r/SQL/comments/ovzyc/sql_newbie_some_help_on_solving_a_problem/,"Good morning all, 

I am not sure if SQL is the answer but I hope you might know...

I work in construction and we constantly receive new versions of drawings, so for example we might have three drawings called A1, A2 &amp; A3. Each will have a Revision, i.e. Revision 1 and each will have a Revision Date. 

I would like it so that when a new file came through (normally in pdf form) it would be stored in a database with its name, date and revision. I would then like a page that displays links to the most recent revision of the drawings, as well as a page displaying a matrix of all the drawings on a project. 

As I say, I am a complete newbie and am just wondering if this is possible in SQL before pursuing it further. We already use SQL databases at work so that would be my ideal solution, but if there is a better one then please feel free to suggest! 

Thanks in advance!
",,False,self,t5_2qp8q,False,,,True,t3_ovzyc,http://www.reddit.com/r/SQL/comments/ovzyc/sql_newbie_some_help_on_solving_a_problem/,
1325436227.0,2,firebirdnews.org,nynqe,Official FirebirdSQL video channel launched,mariuz,2,0,0,http://www.reddit.com/r/SQL/comments/nynqe/official_firebirdsql_video_channel_launched/,,,False,default,t5_2qp8q,False,,,False,t3_nynqe,http://www.firebirdnews.org/?p=6643,
1324071121.0,0,self.SQL,nfmd5,SQL 2008... How do you disable the type ahead feature in the query window? This is driving me crazy!!!,DonMegaTron,5,5,10,http://www.reddit.com/r/SQL/comments/nfmd5/sql_2008_how_do_you_disable_the_type_ahead/,,,False,self,t5_2qp8q,False,,,True,t3_nfmd5,http://www.reddit.com/r/SQL/comments/nfmd5/sql_2008_how_do_you_disable_the_type_ahead/,
1323190584.0,2,self.SQL,n2npg,SQL Max,Opetich,4,2,6,http://www.reddit.com/r/SQL/comments/n2npg/sql_max/,"Hi,

i was trying to find the most studied disease, and i have 

    select  name ,max(cnt)  from(
    	select d.name  name,count(i.iid) cnt   
    	from disease d, study s, institute i    
    	where d.did =s.did and s.iid=i.iid and i.cidade like 'London'   
    	group by name)    

    
when i was looking at the data there should be a draw between 2, and i need to show both, what do i have wrong or what do i change?

Edit: yes its homework, sorry i'm not asking for code just how can i approach in a better way, and it haves to be done in a single query",,False,self,t5_2qp8q,True,,,True,t3_n2npg,http://www.reddit.com/r/SQL/comments/n2npg/sql_max/,
1320857549.0,2,self.SQL,m68wd,Allow all users access to Views created by other users,ClearPepsi,2,0,3,http://www.reddit.com/r/SQL/comments/m68wd/allow_all_users_access_to_views_created_by_other/,We recently migrated from SQL 2000 to SQL 2008 and am now having issues with views migrated from the old server. On the new server all users have been recreated with the same permissions but when a user logs in they are not able to see Views created by other users that they would have been able to access on our old server. Any ideas?,,False,self,t5_2qp8q,False,,,True,t3_m68wd,http://www.reddit.com/r/SQL/comments/m68wd/allow_all_users_access_to_views_created_by_other/,
1320164578.0,2,firebirdnews.org,lwjuf,Firebird SQL Trace Manager V2.0.0 released,mariuz,3,1,0,http://www.reddit.com/r/SQL/comments/lwjuf/firebird_sql_trace_manager_v200_released/,,,False,default,t5_2qp8q,False,,,False,t3_lwjuf,http://www.firebirdnews.org/?p=6394,
1318493651.0,2,self.SQL,lambt,How to reclaim disk space from sqlite3 database once you have dropped huge data/table/index etc. ?,,2,0,0,http://www.reddit.com/r/SQL/comments/lambt/how_to_reclaim_disk_space_from_sqlite3_database/,"For reclaiming one can use ""vacuum"" command. This command copies the whole relevant data from db  to a temporary-db. And cleans-up original-db and renames this temporary.
Its a slow command. But reduces the fragmentation in database.

Anyone knows a better idea ?? May be by way of some sqlite3-extension ?
",,False,self,t5_2qp8q,False,,,True,t3_lambt,http://www.reddit.com/r/SQL/comments/lambt/how_to_reclaim_disk_space_from_sqlite3_database/,
1318439618.0,2,techinfogurus.com,l9qyd,sqlite3 database performance analysis with and without indexes,,2,0,1,http://www.reddit.com/r/SQL/comments/l9qyd/sqlite3_database_performance_analysis_with_and/,,,False,http://thumbs.reddit.com/t3_l9qyd.png,t5_2qp8q,False,,,False,t3_l9qyd,http://techinfogurus.com/modules/editor/view_article.php?id=39,
1317763470.0,2,firebirdnews.org,l0yal,Firebird SQL 2.5.1 is released ,mariuz,2,0,0,http://www.reddit.com/r/SQL/comments/l0yal/firebird_sql_251_is_released/,,,False,default,t5_2qp8q,False,,,False,t3_l0yal,http://www.firebirdnews.org/?p=6288,
1317349334.0,2,self.SQL,kw0bf,Tricky query sorting and grouping at the same time ,Tu_Amigo,2,0,10,http://www.reddit.com/r/SQL/comments/kw0bf/tricky_query_sorting_and_grouping_at_the_same_time/,"Having trouble writing a query which seems to be getting longer and more complicated the more I look at it.

I've got two tables:

    ANIMAL                        ANIMAL_FOOD
    A_ID   AnimalName             F_ID   FoodName      Purchase_Date   A_ID
    ------------------            ------------------------------------------
     1       Dog                   1     DogBix         2011-11-27       1         
     2       Cat                   2     Tuna           2011-11-11       2
     3       Rabbit                3     Bones          2012-06-08       1
     4       Bird                  4     CatBix         2010-06-04       2  
                                   5     Bird Seed      2011-12-12       4
                                   6     Carrots        2011-05-04       3
                                   7     Pedigree Chum  2011-02-08       1
                                   8     Rabbit Mix     2011-09-02       3


And I want to have the following output in this order:
   
    AnimalName   FoodName      Purchase_Date
    ----------------------------------------
    Cat          Tuna           2011-11-11
    Cat          CatBix         2010-06-04

    Dog          DogBix         2011-11-27
    Dog          Bones          2012-06-08
    Dog          Pedigree Chum  2011-02-08

    Bird         Bird Seed      2011-12-12

    Rabbit       Rabbit Mix     2011-09-02
    Rabbit       Carrots        2011-05-04

I am finding the closest purchase date coming up (in the future) then listing the rest of that animal's foods - first the future ones in order of the closest to today's date, then the past ones with the newest first.
So sort of in this order:

* Tomorrow
* Next week
* Next month
* Yesterday
* Last week 


The animals are grouped together then their individual dates are ordered.

If any one has any ideas they would be really valued.",,False,self,t5_2qp8q,True,,,True,t3_kw0bf,http://www.reddit.com/r/SQL/comments/kw0bf/tricky_query_sorting_and_grouping_at_the_same_time/,
1316089254.0,2,self.SQL,kgfrt,Query Optimization Challenge!,Sotall,4,2,11,http://www.reddit.com/r/SQL/comments/kgfrt/query_optimization_challenge/,"Help! 

Given a table with the following fields and records:

    A B C
    1 1 3
    2 1 2 
    3 2 3
    4 2 1
    5 3 1
    6 3 2

Now, given A = 1, write a query that returns the following result set:

    A B C 
    1 1 3
    3 2 3 

Basically, find all of the records where C is equal to the value in the A = 1 record. 

Now, this is easy with a simple subselect, but the table involved is *very* large. I want to do this in as few table scans as possible, possibly by utilizing a temporary table or two.  Oh, this is Oracle, by the way. 

Thoughts? ",,False,self,t5_2qp8q,False,,,True,t3_kgfrt,http://www.reddit.com/r/SQL/comments/kgfrt/query_optimization_challenge/,
1315425245.0,2,self.SQL,k7xs9,"Dealing with ""Divide by Zero"" errors in queries",JCollierDavis,2,0,8,http://www.reddit.com/r/SQL/comments/k7xs9/dealing_with_divide_by_zero_errors_in_queries/,"The statement below works just fine

    (SUM (CASE WHEN (wo_age &lt;= '30' AND ipd BETWEEN '01' AND '03' AND prj = '9GQ') THEN 1 ELSE 0 END)) / (SUM (CASE WHEN (ipd BETWEEN '01' AND '03' AND prj = '9GQ') THEN 1 ELSE 0 END)) reset_mpd1,

However, if the result is a divisor of 0, than the query errors and stops running. So, I decided to add an IF to make the query still run.  Here's my attempt

    IF	(COUNT(CASE WHEN (wo_age &lt;= '90' AND ipd BETWEEN '09' AND '15' AND prj = '9GQ'))) = '0' THEN 'ZERO' ELSE	((SUM (CASE WHEN (wo_age &lt;= '90' AND ipd BETWEEN '09' AND '15' AND prj = '9GQ') THEN 1 ELSE 0 END)) / (SUM (CASE WHEN (ipd BETWEEN '09' AND '15' AND prj = '9GQ') THEN 1 ELSE 0 END))) END IF reset_mpd3

That also gives me a missing keyword error. This is the first IF I've ever used so there must be something missing that I don't see.
I've never used an IF before, so I'm sure there's something missing.",,False,self,t5_2qp8q,False,,,True,t3_k7xs9,http://www.reddit.com/r/SQL/comments/k7xs9/dealing_with_divide_by_zero_errors_in_queries/,
1313864657.0,2,self.SQL,jp07i,QUERY HELP: Returning all values in another table that matches one linked value in another,Tu_Amigo,3,1,3,http://www.reddit.com/r/SQL/comments/jp07i/query_help_returning_all_values_in_another_table/,"Sorry the title is a bit convoluted! Also posted this in r/mysql.

I've had a little search everywhere but I'm not sure I'm wording it right to get any results or if what I want to do is even possible...

Basically I want to return all values in a table that match a value in another.

[http://i.imgur.com/QVmPL.png](http://i.imgur.com/QVmPL.png)

The image probably explains it better- if I search for the model of a car say ""Mustang"" I want to return every other model that is a Ford too.

Any one have any ideas?",,False,self,t5_2qp8q,False,,,True,t3_jp07i,http://www.reddit.com/r/SQL/comments/jp07i/query_help_returning_all_values_in_another_table/,
1312922366.0,2,firebirdnews.org,jduz1,Firebird 2.5.1 RC1 will probably be released until next weekend. (firebirdnews.org),mariuz,3,1,0,http://www.reddit.com/r/SQL/comments/jduz1/firebird_251_rc1_will_probably_be_released_until/,,,False,default,t5_2qp8q,False,,,False,t3_jduz1,http://www.firebirdnews.org/?p=6106,
1312714282.0,2,firebirdnews.org,jbh89,Firebird for database experts: Indices. “Must read” articles series,mariuz,2,0,0,http://www.reddit.com/r/SQL/comments/jbh89/firebird_for_database_experts_indices_must_read/,,,False,default,t5_2qp8q,False,,,False,t3_jbh89,http://www.firebirdnews.org/?p=6104,
1307324071.0,2,self.SQL,hshru,Can some one explain simply what log_reuse_wait does in conjunction with recovery mode: full or simple?,markdavidboyd,4,2,2,http://www.reddit.com/r/SQL/comments/hshru/can_some_one_explain_simply_what_log_reuse_wait/,"I have never properly understood it, i now need to. 

I have a DB i am meant to support with log_reuse_wait: 0 (nothing) and the recovery mode set to FULL

Is it bad when the transaction log fills up with these settings? I can't get my head around whether the alerts about the trans log being full are bad or not. 

Any explanation as to how this works would be appreciated, large or small. 

Regards Me !",,False,self,t5_2qp8q,False,,,True,t3_hshru,http://www.reddit.com/r/SQL/comments/hshru/can_some_one_explain_simply_what_log_reuse_wait/,
1305655942.0,2,self.SQL,hdjk3,"I feel this should be an easy query, but without proper caffeine supply, it's not.",Kinsbane,4,2,11,http://www.reddit.com/r/SQL/comments/hdjk3/i_feel_this_should_be_an_easy_query_but_without/,"This is a really basic example, but for some reason, the queries I'm trying are not working. This is not homework!

At my company, we have software that's used to manage &amp; monitor optical networking switches. One of the software devs for it has been learning SQL/MySQL and came to me with this problem to get my input (I was not helpful):

So, we have two tables:

**monitorings**

mid, far_sid, near_sid, stamp

**switches**

sid, name

Now, the idea with this is the monitorings table houses monitoring transactions - when two switches make a connection, the row is saved in the table with the near_sid being one switch, and the far_sid being another switch. These two fields are populated using the sid field from the switches table. These two fields can either have different sid's or the same sid.

What the software dev wanted was to return the *names* of the switches for the near_sid and far_sid fields, even if they are the same, as well as the stamp field from the monitorings table. 

Many attempts to do sub-queries and joins have fallen flat. The developer I think came up with a workaround (involving another table), but for me, I was curious to see if this could be output with one statement.

Thank you!
",,False,self,t5_2qp8q,False,,,True,t3_hdjk3,http://www.reddit.com/r/SQL/comments/hdjk3/i_feel_this_should_be_an_easy_query_but_without/,
1304954859.0,2,self.SQL,h7dwi,How to list all columns in report?,ignathius,2,0,5,http://www.reddit.com/r/SQL/comments/h7dwi/how_to_list_all_columns_in_report/,"Hello. I'm extremly new to SQL and SSRS, and am having an issue getting a report to display properly and was hoping someone here could point me in the right direction.

What i'm trying to do, is display all of the IDs associated with a Parameter in the same cell. I'm not sure if this is something that needs to be done in the query, or just in the report. What i'm currently getting is:

Parameter     ID

A                 1

A                 2

B                 3

B                 4


what i need is:

Parameter     ID

A                1,2

B                3,4


I'm thinking i may need a function in the report to get this to work right, but not entirely certain. If anyone has any suggestions i'd greatly appreciate it :)",,False,self,t5_2qp8q,False,,,True,t3_h7dwi,http://www.reddit.com/r/SQL/comments/h7dwi/how_to_list_all_columns_in_report/,
1304629912.0,2,self.SQL,h5454,Tough one... Creating a 'feature-matrix' like table from many-to-many data?,synt4xtician,3,1,4,http://www.reddit.com/r/SQL/comments/h5454/tough_one_creating_a_featurematrix_like_table/,"Say I have 2 tables, ""feature"" and ""application"", with an association table to keep track of what apps have what feature.

Can anybody come up with a way, through a single tsql statement, to create a feature matrix style view [like this one](http://en.wikipedia.org/wiki/Comparison_of_issue-tracking_systems#Input_interfaces)?

I have examined PIVOT and have been unable to make that work.

Edit: Not sure if it was obvious, but I want the columns to build themselves dynamically, as the rows, columns, and associations are changing all the time.",,False,self,t5_2qp8q,True,,,True,t3_h5454,http://www.reddit.com/r/SQL/comments/h5454/tough_one_creating_a_featurematrix_like_table/,
1304219986.0,2,self.SQL,h1711,Alternative to SQLServer's create index ... include ... syntax in other DBs,behrangsa,3,1,7,http://www.reddit.com/r/SQL/comments/h1711/alternative_to_sqlservers_create_index_include/,"Looks like SQLServer is the only RDBMS that supports the include ... clause in the create index statements. What are the downsides of using create index (col1, col2, col3, col4) in comparison to create index (col1, col2) include (col3, col4) in those DBs that don't support the include clause?",,False,self,t5_2qp8q,False,,,True,t3_h1711,http://www.reddit.com/r/SQL/comments/h1711/alternative_to_sqlservers_create_index_include/,
1303950466.0,2,self.SQL,gyvj5,What convention do you follow for the order of columns in a table?,behrangsa,3,1,3,http://www.reddit.com/r/SQL/comments/gyvj5/what_convention_do_you_follow_for_the_order_of/,"I usually start with the primary keys of the table, then its foreign keys, and then the rest of the columns. However, sometimes a table has a foreign key like ordered_by that references an another table and another column named ordered_at which indicates when the order was made and it makes sense to keep the ordered_by and ordered_at close to each other. So in cases like this it's not possible to follow that convention.

How do you usually order the columns in your tables and what do you think about the convention I am following?",,False,self,t5_2qp8q,False,,,True,t3_gyvj5,http://www.reddit.com/r/SQL/comments/gyvj5/what_convention_do_you_follow_for_the_order_of/,
1303746801.0,2,self.SQL,gx1zk,Looking for common strings: SQL Oracle,tweaked540,2,0,3,http://www.reddit.com/r/SQL/comments/gx1zk/looking_for_common_strings_sql_oracle/,"Does anyone here know how to look up a table and only pull back, lets say, the top 10 most common words in a database.  So lets say the table contains: 

dog, dog, cat, cat, mouse, rat, dog, cat, dog, elephant, turtle, bird, dog, bird.

I want the result to be: 
dog, cat, bird, mouse, rat, elephant, turtle...

I know I could just do a select * and let PHP do the math and processing for the output, but the table I am using has a lot of data.  I'd rather have the database do the computation of all this instead of the web code. Thanks.",,False,self,t5_2qp8q,False,,,True,t3_gx1zk,http://www.reddit.com/r/SQL/comments/gx1zk/looking_for_common_strings_sql_oracle/,
1302192598.0,2,self.SQL,gktmj,Is there a way to sum multiple rows based on unix schedtime?,skyjump5,2,0,6,http://www.reddit.com/r/SQL/comments/gktmj/is_there_a_way_to_sum_multiple_rows_based_on_unix/,"So I've got a large dataset with data points taken at 5 minute intervals.  Each point consists of a unix schedtime stamp and a measurement.  I'd like to sum these data points so they represent 30 minute intervals.  

Rather than just summing blocks of 6 consecutive points, I'd like to to sum based on the schedtime values.  This is important because sometimes data points are missing.  Could someone please give me some pointers or a direction to begin working?  I'm very new at SQL.  

Thanks!",,False,self,t5_2qp8q,False,,,True,t3_gktmj,http://www.reddit.com/r/SQL/comments/gktmj/is_there_a_way_to_sum_multiple_rows_based_on_unix/,
1301409902.0,2,self.SQL,gdydz,help with converting to date time format!,spriteburn,3,1,8,http://www.reddit.com/r/SQL/comments/gdydz/help_with_converting_to_date_time_format/,"i am using Rational Quality Manager, and when querying the sql database, i have a date time that is stored as the integer -831105021.  this somehow corresponds to the date ""25 May 2010 09:56:21"" but i have no idea what the conversion calculation is!

please could somebody help?",,False,self,t5_2qp8q,False,,,True,t3_gdydz,http://www.reddit.com/r/SQL/comments/gdydz/help_with_converting_to_date_time_format/,
1300756911.0,2,self.SQL,g8lj7,Help please - Need to select in a select with group by's etc,cyberwired,2,0,5,http://www.reddit.com/r/SQL/comments/g8lj7/help_please_need_to_select_in_a_select_with_group/,"Sorry title is confusing, I'm confused!


I have two tables: scheme.slcustm and scheme.slitemm

slcustm is basically a listing of customers with name, account number, phone, sales person etc


slitemm is a list of invoices with customer name, invoice numbers, date due and amount


What I have so far is the following:

    SELECT     c.name, c.customer, c.address5, c.analysis_codes2, sum(i.currency_amount) AS currency_amount
    FROM         scheme.slcustm AS c RIGHT OUTER JOIN
                      scheme.slitemm AS i ON c.customer = i.customer
    WHERE     (i.open_indicator = 'O')
    GROUP BY c.name, c.customer, c.address5, c.analysis_codes2
    ORDER BY c.name ASC

This gives me a list of the customers with their account number, phone number, sales person and amount owing.


Heres the tricky part:

I want to list the total amount of invoices owing in this month, next month, 2 months and 3 months+


I'm guessing I need to do something in the chosen fields I'm selecting and put selects inside that where the date is something and sum the currency amount....yeah this is where I get confused? Can someone lead the way a bit here?
",,False,self,t5_2qp8q,False,,,True,t3_g8lj7,http://www.reddit.com/r/SQL/comments/g8lj7/help_please_need_to_select_in_a_select_with_group/,
1300750414.0,2,self.SQL,g8izw,Trying to reverse engineer a trainwreck...,,2,0,8,http://www.reddit.com/r/SQL/comments/g8izw/trying_to_reverse_engineer_a_trainwreck/,"Hey guys,

So basically - I've got limited knowledge of PHP/SQL, and apologize in advanced for not using proper terminology / asking stupid questions.

I'd like to know how I can ""view"" the SQL DB our site uses and be able to make changes to it. My end goal is to have a separate site use this DB (sister sites) instead of having to make the same changes twice.",,False,self,t5_2qp8q,False,,,True,t3_g8izw,http://www.reddit.com/r/SQL/comments/g8izw/trying_to_reverse_engineer_a_trainwreck/,
1299386188.0,2,self.SQL,fy8zr,Requesting SQL Zoo Neeps Database Help,moebaca,2,0,3,http://www.reddit.com/r/SQL/comments/fy8zr/requesting_sql_zoo_neeps_database_help/,"Hello ladies and gentlemen of /r/SQL! I come to ask a favor of any member who is looking for a quick challange to both a) test their SQL query skills; and b) help me with an assignment that is way over my head. 

On SQL Zoo problems 11 through 15 in the Neeps Database are completely out of my league. If anyone could hammer out these few queries and help a SQL novice out.. it would be so ridiculously appreciated by me that there isn't a measurement to ascribe it with.

The links to the problem are at: http://sqlzoo.net/a1d.htm

and the reference material is at : http://sqlzoo.net/a1.htm

Any help would be appreciated.. Thanks so much!",,False,self,t5_2qp8q,False,,,True,t3_fy8zr,http://www.reddit.com/r/SQL/comments/fy8zr/requesting_sql_zoo_neeps_database_help/,
1297963160.0,2,self.SQL,fnb2k,"SQL Report Builder 3.0...Is it possible to return to the ""Wizard"" once you build the report?",DREWLONESTAR,2,0,1,http://www.reddit.com/r/SQL/comments/fnb2k/sql_report_builder_30is_it_possible_to_return_to/,I'm new to building these reports and returning to the Wizard would really help.  Anyone know if this is possible?,,False,self,t5_2qp8q,False,,,True,t3_fnb2k,http://www.reddit.com/r/SQL/comments/fnb2k/sql_report_builder_30is_it_possible_to_return_to/,
1296766285.0,2,self.SQL,feqns,Please help with my query,Patti234,3,1,4,http://www.reddit.com/r/SQL/comments/feqns/please_help_with_my_query/,"Hello.  I am a first-time poster to this thread, so I apologize if this is post is not formed properly.

Here is the query I need help fixing:


select r.remittance_id, r.remittance_type_cd , r.remittance_sequence_no,r.COLLECTED_AMT, r.paid_dt  
, rh.responsibility_centre_cd, rh.EFFECTIVE_DTTM

from remittance r, remittance_history rh

where rh.REMITTANCE_STATUS_CD = 11

and rh.REMITTANCE_TYPE_CD = r.REMITTANCE_TYPE_CD

and rh.REMITTANCE_ID = r.REMITTANCE_ID

and rh.REMITTANCE_SEQUENCE_NO = r.REMITTANCE_SEQUENCE_NO

and r.REMITTANCE_STATUS_CD = 11


Additional Info: remittance_id, remittance_type_cd, and remittance_sequence_no are three fields that make up a unique id for a receipt
-	The Remittance table only has one record for each receipt.  The Remittance History table has multiple records for each receipt, because it tracks each time the receipt is changed.  I.e. the receipt is entered into the system = entry into Remittance History table with date timestamp in EFFECTIVE_DTTM.  Then that same receipt is set to a Status of Reserved (11) = another Remittance History Entry

The query currently returns: multiple rows for the same receipt, because the same receipt can be Reserved (11), Unreserved(some other #), then Reserved (11) again, etc.  So every time there is an 11 entry, I get that many rows returned by the query above.

Problem: I want all the remittances returned by this query, but ONLY THOSE which have the most recent EFFECTIVE_DTTM for that remittance, so that each remittance only appears once in the results and the effective_dttm is reflective of the most recent reservation date for that remittance
",,False,self,t5_2qp8q,True,,,True,t3_feqns,http://www.reddit.com/r/SQL/comments/feqns/please_help_with_my_query/,
1296763792.0,2,firebirdsql.org,fepqi,Firebird 2.1.4 Release Candidate ready to test,mariuz,2,0,0,http://www.reddit.com/r/SQL/comments/fepqi/firebird_214_release_candidate_ready_to_test/,,,False,http://thumbs.reddit.com/t3_fepqi.png,t5_2qp8q,False,,,False,t3_fepqi,http://www.firebirdsql.org/index.php?op=files&amp;id=fb214_RC1,
1296675736.0,2,self.SQL,fe011,How do I prevent Reporting Services from reformatting a query,sqldev34,2,0,4,http://www.reddit.com/r/SQL/comments/fe011/how_do_i_prevent_reporting_services_from/,"After reformatting an SQL query powering a report in BIDS so it is more readable, I pasted it into the report, and on going back to it, it's completely undone the formatting changes I had made, including comments. 

This is a problem we've been having for a while, but have put up with.

I expect this is some sort of query optimization, but it makes it a lot harder to read, and on rarely ran but complex reports, the speed increase isn't a great benefit.

Does anyone know how to prevent BIDS/Reporting Services from reformatting a query?",,False,self,t5_2qp8q,False,,,True,t3_fe011,http://www.reddit.com/r/SQL/comments/fe011/how_do_i_prevent_reporting_services_from/,
1296491079.0,2,self.SQL,fcg52,Is there a way to stop a plus sign (+) changing to an ampersand (&amp;) when exporting from SQL Server Reporting Services to Excel?,UNHDude,2,0,2,http://www.reddit.com/r/SQL/comments/fcg52/is_there_a_way_to_stop_a_plus_sign_changing_to_an/,"I have a column header that is ""89+"" in my report, but it gets exported to ""89&amp;"" in excel and the customer is complaining. The weird thing is the formula shows up as 89&amp; in excel 2010 but it'll display as 89+ if in read-only mode and then switch to 89&amp; if you enable editing.


It exports to PDF fine.


Does anyone have any tips for a workaround, or is it not possible to get it to export as a +? ",,False,self,t5_2qp8q,False,,,True,t3_fcg52,http://www.reddit.com/r/SQL/comments/fcg52/is_there_a_way_to_stop_a_plus_sign_changing_to_an/,
1296139624.0,2,self.SQL,fa1r8,help with this query please.,lostinsql,2,0,5,http://www.reddit.com/r/SQL/comments/fa1r8/help_with_this_query_please/,"I have a table, rn_ip, with columns for deviceid, ipaddress and usedtoaccessdevice.  There can be multiple 'ipaddress' rows for a given 'deviceid'.  Usually one of the rows for a given 'deviceid' also has a value where 'usedtoaccessdevice' is set to 0, and all others are set to 1.

How could I write a query to display any deviceid that has no rows where the value for 'usedtoaccessdevice' is 0?

Thanks in advance... I hope that his forum is an appropriate place for this question.",,False,self,t5_2qp8q,False,,,True,t3_fa1r8,http://www.reddit.com/r/SQL/comments/fa1r8/help_with_this_query_please/,
1295858285.0,2,feedproxy.google.com,f7yqa,SQL Perl/PL Overview,addisonchristopher,3,1,0,http://www.reddit.com/r/SQL/comments/f7yqa/sql_perlpl_overview/,,,False,default,t5_2qp8q,False,,,False,t3_f7yqa,http://feedproxy.google.com/~r/blogspot/rkYGD/~3/8LtOJnTz9WM/sql-perlpl-overview.html,
1295085947.0,2,self.SQL,f2r2l,Select and join two tables then update field if a single match,cyberwired,2,0,3,http://www.reddit.com/r/SQL/comments/f2r2l/select_and_join_two_tables_then_update_field_if_a/,"Hoping someone can help me out here to make this a little easier, I'll probably code this in PHP if worst comes to it


Basically I have taken over a system based on PHP and MYSQL and the previous person has decided not to link tables based on a unique ID but the name.


So here is what I have:


Table furniture_sets

Fields: id, sku_name, component_id, component_name



Table components

Fields: id, sku_name, component_name


I've added component_id to link components.id to the correct field in furniture_sets and I need to populate this with the correct id


Problem comes about when two components have the same name and two different furniture sets reference that name and one ends up with the incorrect details or ends up showing two components


so what I'm thinking is something that will do select all those fields from both tables where sku_name=sku_name and component_name=component_name then update the furniture_sets.component_id with corresponding component.id


Is this possible in just SQL?


I know in PHP I can just do a select and join then for each record do an update on the component_id field but I'd really like to know if this can be done in pure SQL and learn how!


Thanks for your help :)
",,False,self,t5_2qp8q,False,,,True,t3_f2r2l,http://www.reddit.com/r/SQL/comments/f2r2l/select_and_join_two_tables_then_update_field_if_a/,
1292806155.0,2,ibm.com,eoiqt,Setting up IBM DB2 database for IBM Systems Director 6.2: Best practices on how to setup a DB2 database as Systems Director's data repository,davidreiss666,2,0,0,http://www.reddit.com/r/SQL/comments/eoiqt/setting_up_ibm_db2_database_for_ibm_systems/,,,False,http://thumbs.reddit.com/t3_eoiqt.png,t5_2qp8q,False,,,False,t3_eoiqt,http://www.ibm.com/developerworks/aix/library/au-director_db2/index.html,
1292435219.0,2,self.SQL,embow,Noob trying to get a connection,ringringbananaphone,2,0,3,http://www.reddit.com/r/SQL/comments/embow/noob_trying_to_get_a_connection/,"Hi reddit,

I'm trying to get a database set up so that I can connect to it with PHP. The mysql server and the webserver are located on the same machine. 

I've got mysql running so that I can log into it from the command line.

I also have this test page


&lt;html&gt;
&lt;head&gt;
&lt;title&gt; Test Database page &lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;

&lt;?php
$dbhost = 'localhost';
$dbuser = 'user';
$dbpass = 'password';

mysql_connect($dbhost, $dbuser, $dbpass ) or die('fail');
?&gt;

&lt;/body&gt;
&lt;/html&gt;


The html generated by this when I try to connect via the browser is:

&lt;html&gt; 
&lt;head&gt; 
&lt;title&gt; Test Database page &lt;/title&gt; 
&lt;/head&gt; 
&lt;body&gt; 

note that the final body and html tags don't get printed.

For the sake of troubleshooting I've turned iptables off. 

I'm just curious if there is some common mistake I'm making with the set up. Everything I read suggests that this should be easy. 

Thanks",,False,self,t5_2qp8q,False,,,True,t3_embow,http://www.reddit.com/r/SQL/comments/embow/noob_trying_to_get_a_connection/,
1291052549.0,2,dhdursoassociates.com,edez9,Glossary of Database Terms,,4,2,0,http://www.reddit.com/r/SQL/comments/edez9/glossary_of_database_terms/,,,False,http://thumbs.reddit.com/t3_edez9.png,t5_2qp8q,False,,,False,t3_edez9,http://www.dhdursoassociates.com/glossary.html,
1290159197.0,2,self.SQL,e8krt,Could someone help me with a Scar UDF in MS SQL 2K5?,adamnmcc,2,0,1,http://www.reddit.com/r/SQL/comments/e8krt/could_someone_help_me_with_a_scar_udf_in_ms_sql/,"Hi everyone, 

i've posted this ins r/rlearnprogramming too, but then i noticed this subreddit, can anyone help me?

i've been tasked with moving creating a system in work and need to design a UDF that calculates the earned premium in insurance. 

the formula should be:

    if the experience date &gt; return date
        premium earned = 100%
    if the experience date &gt; issue date and &lt; outward travel date
        premium earned = 20% / (datediff(experiencedate, issuedate)
    if the experience date is &gt; outward travel date and &lt; return date
        premium earned = 20% + (80% / (datediff(issuedate, outward traveldate))

heres what i've got so far, but i keep getting divide by zero errors when i use the function in a query. 

====================================================

    USE [ATIUnderwriting]
    GO

    SET ANSI_NULLS ON
    GO
    
    SET QUOTED_IDENTIFIER ON
    GO
    -- =============================================
    -- Author:		Adam McCartney
    -- Create date: 18/11/2010
    -- Description:	calculate earned premium function
    -- =============================================
    ALTER FUNCTION [dbo].[fnEarnedPremium]
    (	
    	-- Add the parameters for the function here
        	@issuedate datetime,
    	@outdate datetime,
    	@returndate datetime,
    	@experiencedate datetime,
    	@pretripearnings decimal(10,2),
    	@premium decimal(10,2)
    )
    RETURNS decimal(10,2)
    AS
    
    begin

    declare @earnedpremium decimal(10,2)
    declare @tripearnings decimal(10,2)
    --declare @tripearningsperc decimal(10,2)
    --declare @ptep decimal(10,2)
    declare @datediff decimal(10,2)



    if datediff(day, @experiencedate, @returndate) &lt; 0 
    	set @Earnedpremium = @premium
    else if datediff(day, @issuedate, @experiencedate) &lt; datediff(day, @issuedate, @outdate)
    	set @earnedpremium = @premium * (@pretripearnings / datediff(day, @issuedate, @experiencedate))
    Else 
    	set @earnedpremium = @premium * (@pretripearnings + (@tripearnings / datediff(day, @outdate, @experiencedate)))

		

    RETURN @earnedpremium 

    end

====================================================

any help would be fantastic.. i'm very new to programming. i now how to structure it but the syntax eludes me.. 

Many Thanks in Advance. ",,False,self,t5_2qp8q,False,,,True,t3_e8krt,http://www.reddit.com/r/SQL/comments/e8krt/could_someone_help_me_with_a_scar_udf_in_ms_sql/,
1290111278.0,2,self.SQL,e89t3,Trying to accomplish something that might not be possible via joins...,frustrated_dev,2,0,6,http://www.reddit.com/r/SQL/comments/e89t3/trying_to_accomplish_something_that_might_not_be/,"So basically, so far I've got a query with 2 very basic inner joins. It produces a result set like the following.

HeaderID | Username | Question | Answer
------ | ------ | ------ | ------
123  |  user1  |   date? | $2010-18-11
123  |  user1  |   name? | $user one

Now what I want to do is append each row with the date. No hassle with the first row, just do a self join. Is there any way I can do the same again on the subsequent rows that have the same HeaderID but don't have a date in the answer field?

To give an idea of the (bad) design, the header/username are coming from one table, the question is coming from one table and the answer is coming from one table. Header and answer are linked by ID and question and answer are also linked by an identity on the question table. Here's what the query looks like so far.

    SELECT h.ID, h.Username, q.QuestionText, a.Answer
    FROM tblHeader h
    INNER JOIN tblAnswer a on h.ID = a.HeaderID
    INNER JOIN tblQuestion q on q.ID = a.QuestionID

I think it might be easier to just go ahead and use a temporary table and work on that but I'd like some second opinions first. Any ideas?

edit: damn table formatting got me.

edit 2: thanks to shaara for suggesting this query

    SELECT h.ID, h.Username, q.QuestionText, a.Answer, foo.MyDate
    FROM tblHeader h
    INNER JOIN tblAnswer a on h.ID = a.HeaderID
    INNER JOIN tblQuestion q on q.ID = a.QuestionID
    JOIN (
        SELECT HeaderID, QuestionID, Answer as MyDate FROM tblAnswer WHERE QuestionID=1
    ) foo ON foo.HeaderID=h.ID

Works perfectly! And yes, as he pointed out the table design is pretty awful. I'll be changing it.",,False,self,t5_2qp8q,True,,,True,t3_e89t3,http://www.reddit.com/r/SQL/comments/e89t3/trying_to_accomplish_something_that_might_not_be/,
1289948691.0,2,self.SQL,e77s9,Getting -5 continually when using SUM(),toxicityj,3,1,14,http://www.reddit.com/r/SQL/comments/e77s9/getting_5_continually_when_using_sum/,"I've got a database full of lovely numbers in a column that I'm trying to add up. I'm still new to PHP/SQL so I spend half the day googling for that solution. Well for some reason it just keeps outputting -5 and the sum no matter what the numbers are that it's given.

I'm pretty sure my code is correct, because I got it to add up a separate column properly. 

SELECT SUM($year_select) AS Totals FROM agglomeration_growth_rate WHERE Country = $region_select
Any ideas?",,False,self,t5_2qp8q,False,,,True,t3_e77s9,http://www.reddit.com/r/SQL/comments/e77s9/getting_5_continually_when_using_sum/,
1284149340.0,2,self.SQL,dc8c3,After moving from 5.0 to 5.1 using a database dump...,NWLierly,3,1,2,http://www.reddit.com/r/SQL/comments/dc8c3/after_moving_from_50_to_51_using_a_database_dump/,"I get these errors on startup;

100910 11:48:06 [ERROR] Column count of mysql.db is wrong. Expected 22, found 20. The table is probably corrupted
100910 11:48:06 [ERROR] mysql.user has no `Event_priv` column at position 29
100910 11:48:06 [ERROR] Event Scheduler: An error occurred when initializing system tables. Disabling the Event Scheduler.

I can't connect using anything but the built in admin account, and can't successfully run any checks. I'm hoping that I'm just failing to follow instructions on fixes and that one of you can save me.",,False,self,t5_2qp8q,False,,,True,t3_dc8c3,http://www.reddit.com/r/SQL/comments/dc8c3/after_moving_from_50_to_51_using_a_database_dump/,
1282824228.0,2,self.SQL,d5ofh,"Is there a way to make this query quicker, please?",Antagony,2,0,10,http://www.reddit.com/r/SQL/comments/d5ofh/is_there_a_way_to_make_this_query_quicker_please/,"I've been handed an old legacy application which uses an MS Access database for its backend. It has a mail merge utility, which allows users to set various criteria to filter the selection. The problem is it works but the query it generates gets slower as the recordset it returns gets larger.  

This is the general structure of the application generated query:

    SELECT [fields] 
    FROM qryMailMerge 
    WHERE Booking_Ref IN(
        SELECT MAX(Booking_Ref) 
        FROM qryMailMerge 
        WHERE [criteria]
        GROUP BY ID)
    ORDER BY [field]


In case it isn't obvious, the reason for the first WHERE clause is that it has to return only booking information from the latest booking when selected customers have multiple bookings.


I'm sure there must be a way to make this quicker, but I've only dabbled a bit in SQL so I'm struggling. Any help will be greatly appreciated.",,False,self,t5_2qp8q,False,,,True,t3_d5ofh,http://www.reddit.com/r/SQL/comments/d5ofh/is_there_a_way_to_make_this_query_quicker_please/,
1282174111.0,2,arstechnica.com,d2sa7,New sql injection attacks snags Apple in a wide net,amaxen,2,0,0,http://www.reddit.com/r/SQL/comments/d2sa7/new_sql_injection_attacks_snags_apple_in_a_wide/,,,False,http://thumbs.reddit.com/t3_d2sa7.png,t5_2qp8q,False,,,False,t3_d2sa7,http://arstechnica.com/security/news/2010/08/newly-detected-sql-injection-attack-snags-apple-in-wide-net.ars,
1281492406.0,2,self.SQL,czr0k,Need some SQL Advice please.,lazylion_ca,2,0,11,http://www.reddit.com/r/SQL/comments/czr0k/need_some_sql_advice_please/,"Does the following look correct? Is there a better way to do it?  
  
---------
   
SELECT tinvent.lId, tinvent.sPartCode, tinvent.sName, tinvbyln.dInStock, tinvprc.dPrice, tinvbyln.dLastCost

FROM (tinvent INNER JOIN tinvbyln ON tinvent.lId = tinvbyln.lInventId) INNER JOIN tinvprc ON tinvent.lId = tinvprc.lInventId AND tinvprc.lPrcListId=1;  
  
---------
  
I imported our Simply Accounting 2010 MySQL database into MS Access 2003 so that I could play around with it with out messing anything up.  
  
It appears to return the results that I want (a basic price list) but I'm not sure if I should be using the AND or if I should use a WHERE for the last bit.

3 tables. The third table (tinvprc) has 3 entries for each item in table1. tinvprc.lPrcListId=1 or 2 or 3.
  
1 would mean normal price  
2 is discounted price  
3 is super discounted price ( or inflated place I guess)  
  
For this query, I only need the normal price.  
  
All suggestions welcome, but I can't alter the existing table structure.  
  
Thanks in advance.",,False,self,t5_2qp8q,False,,,True,t3_czr0k,http://www.reddit.com/r/SQL/comments/czr0k/need_some_sql_advice_please/,
1281039046.0,2,self.SQL,cxubs,"Joining on Multiple Columns, Multiple Tables",cubixy2k,3,1,4,http://www.reddit.com/r/SQL/comments/cxubs/joining_on_multiple_columns_multiple_tables/,"Currently, I've been working on optimizing our sql select queries for search on  various criteria. Essential, I have a rather large DB holding millions of rows of information, and I have 3 columns which I search to find the relevant rows. As of now, the system will take all the criteria corresponding to, let say, column A, and search the whole database for anything matching. Next, it will run through all the criteria for Column B, and searching the whole DB. And of course, it will then search in Column C for criteria in that column. 

As you would expect, searching the tables fully, each time, causes a bit of delay (it used to cycle though each specific criteria once per pass, but thankfully I fixed that).

I am curious if there is a way to join the 3 different tables in a single query and have it respond with all the rows matching any one of the 3 criteria tables. A left join obviously returns irrelevant rows, and a regular join will cut out all the unmatched rows by the first join, leaving the remaining joins only a small fraction of the data to join on.

TLdr; I'm frustrated trying to run 3 complete joins in one query.",,False,self,t5_2qp8q,False,,,True,t3_cxubs,http://www.reddit.com/r/SQL/comments/cxubs/joining_on_multiple_columns_multiple_tables/,
1280250167.0,2,self.SQL,cuaik,It's driving me nuts! How the hell is it not working?,lemonidas,3,1,21,http://www.reddit.com/r/SQL/comments/cuaik/its_driving_me_nuts_how_the_hell_is_it_not_working/,"I'm trying to get the following to work but had no luck so far, and it's starting to get on my nerves. granted I have little to no experience on the matter, but it seems to me that it should work...

&gt;UPDATE    prices
&gt;SET              dateto = '1/3/2011'
&gt;WHERE     (eof IN
&gt;                          (SELECT     eof
&gt;                           FROM          prices AS prices_1
&gt;                            WHERE      (datefrom LIKE '27/07/2010') AND (dateto LIKE '' OR
&gt;                                                   dateto IS NULL))) AND 
&gt;(datefrom NOT LIKE '27/07/2010') AND (dateto LIKE '' OR
&gt;                      dateto IS NULL)


When I run the nested select, it returns results as it should, so I know there are records that satisfy this where clause. But the query returns 0 rows affected...

Any ideas? (I'm definitely wrong, I just don't know on how many levels)

UPDATE: for some very strange reason, the above now works. Nothing has changed since last time I tried, but it now works as expected... :/ 

It is also noticeably faster than the loop queries, but I'm thinking that as data grow, it will eventually become slower, so I'll save this version, and start experimenting with the fine suggestions you gave me :)",,False,self,t5_2qp8q,True,,,True,t3_cuaik,http://www.reddit.com/r/SQL/comments/cuaik/its_driving_me_nuts_how_the_hell_is_it_not_working/,
1279317820.0,2,self.SQL,cqgih,Looking for a solution [insertion of different numbers of records],joehouse,2,0,2,http://www.reddit.com/r/SQL/comments/cqgih/looking_for_a_solution_insertion_of_different/,"Hello gang, this is what I'm looking to do:

    'If
        'HAVING (((Count(BabyTable.ParentTableID)) &lt; [ParentTable.BUbbleCount]))
    'Then 
        'insert # recs = BUbbleCount into BabyTable
    'Else
        'Next record

I'm using MSSQL and Acess. The only thing I can think of is using VBA.

And I need to do this for 20k+ records in the parent table.

Many thanks!",,False,self,t5_2qp8q,False,,,True,t3_cqgih,http://www.reddit.com/r/SQL/comments/cqgih/looking_for_a_solution_insertion_of_different/,
1276715970.0,2,blogs.msdn.com,cfq7t,Differences between ISNULL and COALESCE,enolakardia,4,2,0,http://www.reddit.com/r/SQL/comments/cfq7t/differences_between_isnull_and_coalesce/,,,False,http://thumbs.reddit.com/t3_cfq7t.png,t5_2qp8q,False,,,False,t3_cfq7t,http://blogs.msdn.com/b/sqltips/archive/2008/06/26/differences-between-isnull-and-coalesce.aspx,
1276708337.0,2,ssistalk.com,cfokq,SSIS Talk; How to introduce data corruption without trying.,enolakardia,3,1,0,http://www.reddit.com/r/SQL/comments/cfokq/ssis_talk_how_to_introduce_data_corruption/,,,False,default,t5_2qp8q,False,,,False,t3_cfokq,http://www.ssistalk.com/2010/05/04/sql-server-2005-how-to-introduce-data-corruption-without-trying/,
1276260871.0,2,sqlservercentral.com,cdxd4,Make a 100+ Server Inventory in 30 minutes - SQLServerCentral,enolakardia,5,3,4,http://www.reddit.com/r/SQL/comments/cdxd4/make_a_100_server_inventory_in_30_minutes/,,,False,http://thumbs.reddit.com/t3_cdxd4.png,t5_2qp8q,False,,,False,t3_cdxd4,http://www.sqlservercentral.com/articles/Administration/70129/,
1377011430.0,1,self.SQL,1kqjiz,[MY SQL] Silly SQLZOO question,Papadopulos,1,0,2,http://www.reddit.com/r/SQL/comments/1kqjiz/my_sql_silly_sqlzoo_question/,"The question is Identify the countries which have names including the word 'United'


I thought it was simple and put 
    SELECT name 
    FROM world 
    WHERE name = '%United%'

but that returns nothing :/",,False,self,t5_2qp8q,False,,,True,t3_1kqjiz,http://www.reddit.com/r/SQL/comments/1kqjiz/my_sql_silly_sqlzoo_question/,
1377010424.0,2,self.SQL,1kqia4,[MS SQL] Changing SA passwords,26252643,2,0,9,http://www.reddit.com/r/SQL/comments/1kqia4/ms_sql_changing_sa_passwords/,"Hi everyone.

I am very new to SQL language and Have been given the task to change the SA passwords for multiple servers.

However since there are waay too many servers to go do this 1 by 1 it would be great if there is a way to get a quick powershell script or a MSSQL script to do this.

I understand that I can change the passwords one at a time by using SQL server Mgmt Studio however it would be great if there was a quicker method.

Please Help me with this.
Thanks in advance!",,False,self,t5_2qp8q,False,,,True,t3_1kqia4,http://www.reddit.com/r/SQL/comments/1kqia4/ms_sql_changing_sa_passwords/,
1377006969.0,1,self.SQL,1kqedw,[MySQL] Concat and Case are not working together.,enim,1,0,1,http://www.reddit.com/r/SQL/comments/1kqedw/mysql_concat_and_case_are_not_working_together/,"Here is my query:

    INSERT INTO scored 
    SELECT emid,em, 
    CASE 
    WHEN em LIKE CONCAT(""%"", (ms.trig) ,""%"") THEN 1
        ELSE 0
    END as score
    from ems;

It is giving me an error of ""subquery contains more than 1 row"" - which is true, ms.trig does contain some 4922 rows.  I was hoping that it would make 4922 'when em like [row] then 1' statements so I didn't have to, but it doesn't like that apparently.

Could anyone give any insight onto how I could make this work?

Further, once that gets figured out, I'm on to try to figure out how to score them.  Each row in ms.trig has a score associated to it, and I want to add up all of the scores of matches and sum them together. So if ms.trig contains

abc, -5
def, -8

and it is matching on something that is abcldef, it would report score as -13.",,False,self,t5_2qp8q,False,,,True,t3_1kqedw,http://www.reddit.com/r/SQL/comments/1kqedw/mysql_concat_and_case_are_not_working_together/,
1376973369.0,2,letstalkdata.com,1kpqoe,[PostgreSQL] generate_series() Tricks,shivasprogeny,3,1,0,http://www.reddit.com/r/SQL/comments/1kpqoe/postgresql_generate_series_tricks/,,,False,default,t5_2qp8q,False,,,False,t3_1kpqoe,http://letstalkdata.com/2013/08/postgresql-generate_series-tricks/,
1376931108.0,2,self.SQL,1kobsm,"My work is paying for me to go to school to become a DBA, we are learning everything in Oracle, work only uses SQL Server. Need some advice from a professional (see note).",NerdEnvy,2,0,6,http://www.reddit.com/r/SQL/comments/1kobsm/my_work_is_paying_for_me_to_go_to_school_to/,"I guess I just want to know what things in Oracle I shouldn't worry too much about and which things I should really put time into studying. I don't want to spend a lot of time on an Oracle specific concept that is not related to SQL Server. 
Also, in general, what aspects of the DBA role should I be focusing on the most while in school?
Lastly, I get mixed readings when looking up salary for a DBA. The company I work for is a smaller international corporation and so the DBA type work I will be doing will not be full-time as we only have 3 Servers (trans, analytical, and dev) with only about 10 total databases. Right now I am a Database Analyst I and make $19/hour. What can I expect to be paid after graduation? Thank you so much in advance!",,False,self,t5_2qp8q,False,,,True,t3_1kobsm,http://www.reddit.com/r/SQL/comments/1kobsm/my_work_is_paying_for_me_to_go_to_school_to/,
1376678238.0,0,youtube.com,1ki513,Even my dog knows SQL!,RebeccaMurison,4,10,0,http://www.reddit.com/r/SQL/comments/1ki513/even_my_dog_knows_sql/,,,False,http://c.thumbs.redditmedia.com/tcmh9X8coeTZbQh8.jpg,t5_2qp8q,False,,,False,t3_1ki513,http://www.youtube.com/watch?v=JxvCaUCg2XE&amp;feature=youtu.be&amp;a,
1376605321.0,1,self.SQL,1kg672,Trying to Calculate A Player's 'Quality of Competition',MattPfeffer,1,0,1,http://www.reddit.com/r/SQL/comments/1kg672/trying_to_calculate_a_players_quality_of/,"Hey. So I have a player A. This player faces many different opponents, sometimes facing them more then once. Each opposition player has his own statistic we'll call X.

What would I have to do to calculate the average X of player A's opposition?

Know this is a tricky one, many thanks to any help!",,False,self,t5_2qp8q,False,,,True,t3_1kg672,http://www.reddit.com/r/SQL/comments/1kg672/trying_to_calculate_a_players_quality_of/,
1376503126.0,1,self.SQL,1kd1s0,Converting from T-SQL to PL/SQL using [Microsoft Visual Studio],sPIERCEn,2,1,6,http://www.reddit.com/r/SQL/comments/1kd1s0/converting_from_tsql_to_plsql_using_microsoft/,"I'm using Microsoft visual studio, and was using an openquery command, but I need to switch to using a direct oracle connection. 

DECLARE @LastDayOfPreviousMonth DATETIME
DECLARE @MostRecentAsOfDate DATETIME

SET @LastDayOfPreviousMonth=DATEADD(M, DATEDIFF(M,0,GETDATE()),-1)

SELECT @MostRecentAsOfDate=MAXDATE FROM OPENQUERY(XXXX_HIST,'SELECT MAX(AS_OF_DATE) AS MAXDATE FROM SOURCE.TABLE')

IF @LastDayOfPreviousMonth&lt;&gt;CONVERT(char,@MostRecentAsOfDate,101)
BEGIN

RAISERROR('SOURCE.TABLE Data is not up to date',16,1)

END",,False,self,t5_2qp8q,False,,,True,t3_1kd1s0,http://www.reddit.com/r/SQL/comments/1kd1s0/converting_from_tsql_to_plsql_using_microsoft/,
1376491287.0,0,self.SQL,1kcm35,Can I install both SQL Server 2008R2 express and SQL Server 2012 express on my laptop?,ergregerighe,3,4,5,http://www.reddit.com/r/SQL/comments/1kcm35/can_i_install_both_sql_server_2008r2_express_and/,"I have 2012 Express installed already and I tried installing 2008R2 Express, but I get the following error:

A network error occurred while attempting to read from the file ... SQL2008R2NativeClient.",,False,self,t5_2qp8q,False,,,True,t3_1kcm35,http://www.reddit.com/r/SQL/comments/1kcm35/can_i_install_both_sql_server_2008r2_express_and/,
1376425240.0,1,self.SQL,1kauxf,Using the first 7 characters of 2 tables to match up,wolfman3127,2,1,2,http://www.reddit.com/r/SQL/comments/1kauxf/using_the_first_7_characters_of_2_tables_to_match/,"I have two tables just filled with data, I'd like to view the data in a query where the first 7 characters of the one table matches to first 7 characters of the second table. Thanks for your help!

I am using access as well. But I know I can use SQL within it.",,False,self,t5_2qp8q,False,,,True,t3_1kauxf,http://www.reddit.com/r/SQL/comments/1kauxf/using_the_first_7_characters_of_2_tables_to_match/,
1376318668.0,1,self.SQL,1k7ix9,[TSQL] Query Help,sholder89,1,0,14,http://www.reddit.com/r/SQL/comments/1k7ix9/tsql_query_help/,"Let me preface this by saying I am not a finance person so I've done my best to explain what was explained to me...

I have a SQL database that stores transactions for a loan company, I need to write a query that calculates the current amount due, and separates that out into fees due, interest due, and principle due. The database contains each transaction labelled as either a payment, principle, or fee. See below for an example. The interest is not stored in the database but can be calculated each principle payment by principle amount * .05 * daysBetween, where daysBetween is the number of days since the last principle type.

So now the hard part, I can easily calculate a running total of all the fields and get the amounts, and subtract the payments, however these are current loans that are still racking up interest, fees, etc. We need to see a ""picture"" of the loan in it's current state. So each payment that comes in gets applied first to whatever fees there are, then to the interest, and then to whatever principle there is. This means I can't just add them all up and subtract, I need to do it row by row.

Anyone have any ideas? I'm totally stuck, I've had this on my plate for two weeks now luckily there's no specific due date but I need to get it done sooner than later. ""It's not possible"" is an answer my boss will accept as long as I can explain why it's not possible with the database as it currently is.

Example Data (Completely Made Up and Simplified):

    |-Amount-|-PaymentType-|---Date---|
    | 150.00 | PRINCIPLE   | 06-01-13 |
    | 125.00 | PRINCIPLE   | 06-05-13 |
    |  25.00 | PAYMENT     | 06-05-13 |
    |  35.00 | FEE         | 06-21-13 |
    | 120.00 | PRINCIPLE   | 07-02-13 |
    | 100.00 | PAYMENT     | 07-15-13 |
    |  35.00 | FEE         | 07-21-13 |
    |---------------------------------|",,False,self,t5_2qp8q,False,,,True,t3_1k7ix9,http://www.reddit.com/r/SQL/comments/1k7ix9/tsql_query_help/,
1376092047.0,0,self.SQL,1k25ul,Need help with sql - original title I know ;),davodeth,4,5,4,http://www.reddit.com/r/SQL/comments/1k25ul/need_help_with_sql_original_title_i_know/,"Hi,

So I'm working with some php and sql and am trying to output multiple posts by users. I have encountered a problem where it will bring up the first entry repeated as many times as posts I have.

eg. I have 3 posts by users it brings up

post 1

post 1
 
post 1

where I want it to bring up 
post 1

post 2

post 3


if more people make more posts, the same thing happens.

I'm only learning php and sql at the moment so please forgive my formatting and any mistakes I have made.

     $sql = mysql_query(""SELECT post_id, post_user, post_title, post_description, post_info, post_date FROM posts"");
    $row = mysql_fetch_array($sql);
    $post_id = $row['post_id'];
    $post_user = $row['post_user'];
    $post_title = $row['post_title'];
    $post_description = $row['post_description'];
    $post_info = $row['post_info'];
    $post_date = $row['post_date'];
    ?&gt;
    &lt;?php do {
    ?&gt;
    &lt;article&gt;
    &lt;h2&gt;
    &lt;?php echo  $post_title; 
    ?&gt;
    &lt;/h2&gt;
    &lt;?php echo $post_description;
    	echo $post_info;
    	echo 'Posted by '.$post_user.' on '.$post_date;
    ?&gt;
    &lt;?php } while ($row = mysql_fetch_array($sql)); 
    ?&gt;
    &lt;/article&gt;  ",,False,self,t5_2qp8q,False,,,True,t3_1k25ul,http://www.reddit.com/r/SQL/comments/1k25ul/need_help_with_sql_original_title_i_know/,
1375882731.0,0,self.SQL,1jvrmg,[ORACLE]Joining Multiple Group-By statements,borensoren,1,1,2,http://www.reddit.com/r/SQL/comments/1jvrmg/oraclejoining_multiple_groupby_statements/,"So, I have a table containing records with various medical specialties and a client defined decile.  What I want to do is create a table grouping by specialty with columns totalling the number of distinct physicians with emails for each decile.  Here's a sample of how the table looks now:

    UNIQUEID    EMAIL                            SPECIALTY    DECILE
    --------------------------------------------------------
    103702      redacted@fakeemail.com    NEUROLOGY    10
    113744      dev@null.co.uk                 NEUROLOGY    10


What I want is something like this:

    SPECIALTY  COUNT(DECILE 1)  COUNT(DECILE 2)
    -----------------------------------------------
    NEUROLOGY 400                     500

The only way I can think to do this is a long string of join statements on SPECIALTY like this:

    SELECT A.CLI_SPEC, A.DECILE_1, B.DECILE_2 FROM
    (select cli_spec, count(UNIQUEID) AS DECILE_1
    from JM_MR_20130807
    where have_email is not null
    and MS_DECILE = '1'
    or email is not null
    and MS_DECILE = '1'
    group by cli_spec
    order by count(menum10) desc) a 
    join 
    (select CLI_SPEC, COUNT(MENUM10) AS DECILE_2
    from JM_MR_20130807
    where have_email is not null
    and MS_DECILE = '2'
    OR email is not null
    and MS_DECILE = '2'
    group by cli_spec) B
    on a.cli_spec = b.cli_spec

all the way through decile 10.",,False,self,t5_2qp8q,False,,,True,t3_1jvrmg,http://www.reddit.com/r/SQL/comments/1jvrmg/oraclejoining_multiple_groupby_statements/,
1375281166.0,0,self.SQL,1jf83p,My query isn't running with all my WHERE statements,whoisearth,4,6,8,http://www.reddit.com/r/SQL/comments/1jf83p/my_query_isnt_running_with_all_my_where_statements/,"To avoid more people providing input I found a simpler way to get what I want and then running the scalar values after just on the temp table. :)

To get to the gist I have a query pulling data between 2 sets which works fine up until a point.

My where is as follows - 

    WHERE (trgtskrun_crtdt &lt; @nextTime
        AND trgtskrun_crtdt &gt; @lowerTime)
		AND ((trgmst_id = 1475 AND tskmst_id = 1578) OR (trgmst_id = 1476 AND tskmst_id = 1579))

It has no problem with the first part of the where, and it even adds in the first part of the AND (trgmst_id = 1475 AND tskmst_id = 1579) but it's not parsing that second set (the last trgmst_id = 1476 AND tskmst_id = 1579).  I've tried numerous options moving around the order, putting in brackets, etc. etc. but it only ever pulls the 1475/1578 values.  UNLESS - 

I do it this way - 

    WHERE (trgtskrun_crtdt &lt; @nextTime
        AND trgtskrun_crtdt &gt; @lowerTime)
		AND (trgmst_id = 1475 AND tskmst_id = 1578) OR (trgmst_id = 1476 AND tskmst_id = 1579)

but then it gets effed up and it is pulling 159 instances of the same value (I'm dumping the results of the query into a temp table.

I've tried setting a DISTINCT on the value but it won't let me it complains with the following - 

Msg 421, Level 16, State 1, Line 21
The text data type cannot be selected as DISTINCT because it is not comparable.

even though the value I'm trying to do a distinct on is an INT (I am copying over a text column too which it's duplicating 159 times as well)

this make sense?",,False,self,t5_2qp8q,1375283161.0,,,True,t3_1jf83p,http://www.reddit.com/r/SQL/comments/1jf83p/my_query_isnt_running_with_all_my_where_statements/,
1375280322.0,1,self.SQL,1jf74g,[MS SQL] Balancing Of Record Assignments,NakedLoki,2,1,5,http://www.reddit.com/r/SQL/comments/1jf74g/ms_sql_balancing_of_record_assignments/,"So I've got a table that has rows inserted into it each day that has assignment column (we'll call it PersonAssigned) which can either have the login assigned to that record that day or is blank.  

What I want to do is fill in the blank PersonAssigned and assign from a list of logins evenly but I want to take into account the records that the login might have already had filled in.

Example 
bob - 5 records for today 
nick - 3 records for today 
joe -  0 records for today

5 blank records.  I want 4 records to go to joe and one record to go to nick.  I know how to do this using cursors and loops but I feel like I should be able to use NTILE but I haven't really used it in the past.  ",,False,self,t5_2qp8q,False,,,True,t3_1jf74g,http://www.reddit.com/r/SQL/comments/1jf74g/ms_sql_balancing_of_record_assignments/,
1375190812.0,0,self.SQL,1jchn9,[MySQL] Select sales column twice - current year and last year,gezza07,1,1,7,http://www.reddit.com/r/SQL/comments/1jchn9/mysql_select_sales_column_twice_current_year_and/,"My table is sorted as [sales], [yyyymdd]. I am trying to figure out how I can perform a query that will give me [sales], [yyyymmdd] and [LYsales].

[LYsales] being the sales from the same day 365 days ago. Is this possible to perform in SQL?

Thank you for your assistance.",,False,self,t5_2qp8q,False,,,True,t3_1jchn9,http://www.reddit.com/r/SQL/comments/1jchn9/mysql_select_sales_column_twice_current_year_and/,
1374818317.0,1,self.SQL,1j2yfl,I have a workplace full of computers. I want to write all their software into a database and then be able to query later so I can see how many PC's I have Office installed on (for example). How?,misterpotatomato,2,1,7,http://www.reddit.com/r/SQL/comments/1j2yfl/i_have_a_workplace_full_of_computers_i_want_to/,"Hi all,

So, I'm a desktop tech working for a healthcare provider in Australia and I've started coding solutions to manage our cataclysmic software situation (not really sure what software is on what pc's).

I've modified an audit tool that used to write all our stuff out to a CSV file and now its writing to a MSSQL database.  Now, what I'm trying to do, is write all the information of whats in a pc's add/remove list to a table in a database so we can query it at a later date.

So, when this is finished, it will look like this

Database: db_softwareaudit
Tables:
PC11111111
PC22222222
PC33333333
PC44444444
(...and so on and so forth. We have about 2000 PC's or so, maybe more)
Columns: SoftwareName (thats it for now)

So, ideally, we'd have a master table that would contain all the distinct software names in it (And would get updated nightly via scheduled task), and then when the user goes to a asp net web page, selects the software from a web page, a SQL operation will happen that will find how many PC's that piece of software is installed on, as well as their asset numbers etc.

I'm sorry if this isn't making much sense.  I'm a noob to SQL and I am only here out of neccesity. Please be kind :)",,False,self,t5_2qp8q,False,,,True,t3_1j2yfl,http://www.reddit.com/r/SQL/comments/1j2yfl/i_have_a_workplace_full_of_computers_i_want_to/,
1374628649.0,1,self.SQL,1ixbo3,[Oracle] How do I run a 2nd query only if the first returns no rows.,shanegerous,1,0,3,http://www.reddit.com/r/SQL/comments/1ixbo3/oracle_how_do_i_run_a_2nd_query_only_if_the_first/,"I have a production table that updates every 30 minutes, 1 minute past the hour and 31 minutes past the hour (the table is appended with new data all old data is kept) I am accessing this table once an hour and want the most recent data if possible. 

My problem is that sometimes the update takes 8 minutes or so and my query will return no rows, which is ok. Right now I am just left joining this query and accepting all nulls. What I would prefer is a way to say use the 30 minute update interval if there is data, if not use an interval of 45 minutes to grab the previous set of data.

Is there a function or just simple exists statement that I can use to accomplish this? Thanks!",,False,self,t5_2qp8q,False,,,True,t3_1ixbo3,http://www.reddit.com/r/SQL/comments/1ixbo3/oracle_how_do_i_run_a_2nd_query_only_if_the_first/,
1374614239.0,1,self.SQL,1iwtf3,Help creating an EER or ERD with MySQL Workbench,valen089,1,0,2,http://www.reddit.com/r/SQL/comments/1iwtf3/help_creating_an_eer_or_erd_with_mysql_workbench/,"I'm trying to reverse engineer the EER or ERD for a database. I have been given an SQL script and the tables, as text files. Unfortunately I do not have access to the actual database. Can anyone tell me if what I want to do is possible and if it is give me a few pointers in the right direction.",,False,self,t5_2qp8q,False,,,True,t3_1iwtf3,http://www.reddit.com/r/SQL/comments/1iwtf3/help_creating_an_eer_or_erd_with_mysql_workbench/,
1374270016.0,1,self.SQL,1inqcr,Help with [MS SQL] query,not_a_sql_expert,3,2,4,http://www.reddit.com/r/SQL/comments/1inqcr/help_with_ms_sql_query/,"Simply put, I need a little help.

I'm sorry if the formatting comes out wonky.

An old admin fancied himself a SQL guru and left me with little gems like the following.

I know there has to be an easier way to do this, but I honesty don't know SQL well enough to fix this.  I've been able to make it work, but it is clunky and requires multiple calls to the same data.



    SELECT Employee.EmpId, Employee.Name, Employee.Department, Employee.PayGrpId, PRTran.TranAmt AS ""Net Pay"", Employee.StdUnitRate as ""Rate"" ,
    (SELECT sum(RptEarnSubjDed)  FROM PRTran b WHERE (PRTran.TranDate=b.TranDate AND (PRTran.EmpId=b.EmpId AND EarnDedId='401K'))) AS ""Gross Wages"",
    (SELECT SUM(Qty) FROM PRTran c WHERE PRTran.TranDate=c.TranDate AND PRTran.EmpId=c.EmpId) as ""Hours"",
    (SELECT SUM(Qty) FROM PRTran d WHERE PRTran.TranDate=d.TranDate AND PRTran.EmpId=d.EmpId AND EarnDedId='OT') AS ""OT Hours"",
    (SELECT SUM(Qty) FROM PRTran e WHERE PRTran.TranDate=e.TranDate AND PRTran.EmpId=e.EmpId AND EarnDedId='OT') * Employee.StdUnitRate / 2 as ""OT Extra $"",
    (Select ROUND((SELECT SUM(Qty) FROM PRTran d WHERE PRTran.TranDate=d.TranDate AND PRTran.EmpId=d.EmpId AND EarnDedId='OT') / (SELECT SUM(Qty) FROM PRTran c WHERE PRTran.TranDate=c.TranDate AND PRTran.EmpId=c.EmpId), 4)*100) as ""% of Hours""
    FROM BLANKED.dbo.Employee Employee, BLANKED.dbo.PRTran PRTran
    WHERE (PRTran.EmpId = Employee.EmpId) AND (PRTran.TranDate='2013-07-16 00:00:00' AND PRTran.TranDesc='Net Pay')
    ORDER BY Employee.Department,  Employee.EmpId",,False,self,t5_2qp8q,False,,,True,t3_1inqcr,http://www.reddit.com/r/SQL/comments/1inqcr/help_with_ms_sql_query/,
1374085832.0,1,self.SQL,1ii3hp,[MSACCESS] Newbie help... Find common element in AT LEAST 3/5 tables,zombieraptors,2,1,2,http://www.reddit.com/r/SQL/comments/1ii3hp/msaccess_newbie_help_find_common_element_in_at/,"Hi all -- I'm just learning to deal with microsoft access and am sorta figuring it out as I go. I've googled, but haven't been able to find an answer to this question and was hoping someone might help.

I have 5 tables of data.  Is there a way to find common elements that occur in at least 3 out of 5 of those tables?  I know how to find common elements between two tables, but I'm not sure how to find common elements in an ""at least"" number of tables.

Thanks!",,False,self,t5_2qp8q,False,,,True,t3_1ii3hp,http://www.reddit.com/r/SQL/comments/1ii3hp/msaccess_newbie_help_find_common_element_in_at/,
1373816672.0,1,self.SQL,1ia2we,[Oracle] Sum two columns from different tables,falcorethedog,3,2,5,http://www.reddit.com/r/SQL/comments/1ia2we/oracle_sum_two_columns_from_different_tables/,"What I need to do is calculate percent change from two tables. I want to sum the result of these two queries and then divide by the sum of the first. 

    SELECT Sum(Sales.Sales) AS SumOfSales_04
    FROM Sales INNER JOIN Orders ON Sales.orderNumber = Orders.orderNumber
    WHERE (((Orders.orderDate) Between '1-Jan-2004' AND '31-Dec-2004')) 

    SELECT Sum(Sales.Sales) AS SumOfSales_03
    FROM Sales INNER JOIN Orders ON Sales.orderNumber = Orders.orderNumber
    WHERE (((Orders.orderDate) Between '1-Jan-2003' AND '31-Dec-2003'));",,False,self,t5_2qp8q,False,,,True,t3_1ia2we,http://www.reddit.com/r/SQL/comments/1ia2we/oracle_sum_two_columns_from_different_tables/,
1373633733.0,1,self.SQL,1i5er6,Drop user cascade and dump files,s1mpd1ddy,3,2,4,http://www.reddit.com/r/SQL/comments/1i5er6/drop_user_cascade_and_dump_files/,"Oracle 11g running on 64 bit windows server 2008

Does drop user cascade effect the dump file that contains that user ? 

Reason I'm asking is... I exported a dump file with 4 users/schemas (I'm still confused on what is what)

I then dropped cascade those users/schemas .


When I went to import the dump file in the same database, using impdp , oracle says those users could not be found. 

Any help?",,False,self,t5_2qp8q,False,,,True,t3_1i5er6,http://www.reddit.com/r/SQL/comments/1i5er6/drop_user_cascade_and_dump_files/,
1373492946.0,1,self.SQL,1i1cka,[MS SQL] Help with query comparing two tables and updating a field.,OliverTw1st,2,1,5,http://www.reddit.com/r/SQL/comments/1i1cka/ms_sql_help_with_query_comparing_two_tables_and/,"I'm a SQL novice but I have been tasked with writing a script for a small project. I have a table of records (data_tbl) with one field listing an account numbers (acct_no) and another field with security access (secure) flag (Y if it should be secure, Null if not). There are many other fields in this table as well but I think these are the only relevant ones. I have another table (access_tbl) with only an account numbers (acct_no) field. The account numbers listed in this field are the ones that need to have a Y next to them in the data_tbl field. What would be the best way to compare data_tbl to access_tbl and update the Y flag on data_tbl if the record exists in access_tbl. I only need to add the Y flag to rows in the data_tbl that don't already have them. Thanks in advance for any help!  ",,False,self,t5_2qp8q,False,,,True,t3_1i1cka,http://www.reddit.com/r/SQL/comments/1i1cka/ms_sql_help_with_query_comparing_two_tables_and/,
1373485606.0,1,self.SQL,1i11xx,[MS SQL]Checking that each character in a string is valid without looping/cursor,NakedLoki,2,1,12,http://www.reddit.com/r/SQL/comments/1i11xx/ms_sqlchecking_that_each_character_in_a_string_is/,"So we have a list of VALID characters that can be allowed in a string (email).    So you can't do email like (list of valid characters) because the email could be ""bobb╙@gmail.com"" and it would say it's correct even tough it's got that weird character in there.  

Trying to find a way without cursor/looping but that may be the only way.",,False,self,t5_2qp8q,False,,,True,t3_1i11xx,http://www.reddit.com/r/SQL/comments/1i11xx/ms_sqlchecking_that_each_character_in_a_string_is/,
1373229987.0,1,self.SQL,1htjy4,[MySQL] Looking for some help with joined table inheritance and 'unknown' types / discriminator,Kerry350,1,0,3,http://www.reddit.com/r/SQL/comments/1htjy4/mysql_looking_for_some_help_with_joined_table/,"Hi, little warning I'm not the most proficient at SQL but I'm getting my feet very wet with it on a project at the moment. So if anything I've put / any explanations are a bit off if you point it out I'll try and explain further :)

So I can't divulge the exact details due to the project, but I'll give some more generic examples. I have a 'container' of sorts. The container will hold many items, all of these items inherit from a common 'item' entity. For this I'll say they're items of different media types - audio_item, image_item, video_item and so on. In terms of the inheritance I'm going to (or want) to use joined table / table per class inheritance. Like that of the Hibernate ORM for Java or SQL Alchemy for Python (http://docs.sqlalchemy.org/en/latest/orm/inheritance.html). I understand how this works on it's own, and would want to store a 'type' in the base class table and map it's ID to the ID within the sub class tables (with a foreign key also) and perform a join to get the necessary data. I understand how the queries would work etc, that is until I need to get all of the items belonging to a 'container'. Reason being it can hold lots of items, all of varying types, at the time of the query I need to know how I can dynamically handle the type - or if this is even possible at all. 

I.e. one of the common examples is the 'employee' base and 'managers' or 'worker' sub types. Getting all managers or workers is nice and easy as you have the table name to join to within the join operation. But I won't know what table name I'm joining on (LEFT OUTER JOIN &lt;type&gt;) other than type coming from the base tables type column. Can I use this result in the query somehow? But, even then, the different types are going to have different properties / columns that I need to query. 

So could someone tell me how to do this? Or if I'm just pursuing it wrong / overcomplicating / undercomplicating / being stupid point me in the right direction? Thanks!",,False,self,t5_2qp8q,False,,,True,t3_1htjy4,http://www.reddit.com/r/SQL/comments/1htjy4/mysql_looking_for_some_help_with_joined_table/,
1373050551.0,1,self.SQL,1hpemr,[MSSQL] Query help needed,whoisearth,3,2,7,http://www.reddit.com/r/SQL/comments/1hpemr/mssql_query_help_needed/,"I've got a complex one here.  I basically have the following Table - 

ITEM             Time

2                  12:34

1                  12:15

1                  12:07

1                  12:03

1                  11:23

2                  11:10

1                  11:05

1                  10:59

2                  10:46

1                  10:43

1                  10:23

1                  10:10

2                  10:07

1                  10:01

2                  09:52

I basically want to select the COUNT(ITEM) for 1 when it's between ITEM 2.  So at the top of the table above running a query I want to see it return 4 as ITEM 1 appears 4 times between the 2 ITEM 2 listings.  Problem is the time is always dynamic.

How would I go about doing this?

edit - as this seems to either be stumping you all, or no one is interested I am open to designing a stored proc or a trigger to add a column where it can record the iteration of the 1 or somehow make it easier to get the data I want, but I'm not sure where to start on that one too.",,False,self,t5_2qp8q,1373079025.0,,,True,t3_1hpemr,http://www.reddit.com/r/SQL/comments/1hpemr/mssql_query_help_needed/,
1372709529.0,1,self.SQL,1hg562,[MSAccess] Count fields then set as percentage,Krainz,2,1,15,http://www.reddit.com/r/SQL/comments/1hg562/msaccess_count_fields_then_set_as_percentage/,"Hello,

I have a yes/no field for each entry in the table. I'd like the report to have a field that would sum up the amount of each field that has ""yes"" and then divide it by the total of fields, giving me a percentage.

Like 8 entries, 4 yes, 4 no, 50%. 10 entries, 2 yes, 8 no, 80%.

Is that possible?

Access 2010 btw",,False,self,t5_2qp8q,False,,,True,t3_1hg562,http://www.reddit.com/r/SQL/comments/1hg562/msaccess_count_fields_then_set_as_percentage/,
1372703456.0,1,self.SQL,1hfwku,[Oracle] Selecting values that are different than the previous entry,Deanicus,2,1,5,http://www.reddit.com/r/SQL/comments/1hfwku/oracle_selecting_values_that_are_different_than/,"I've tried looking online for a solution but maybe I'm not phrasing my request very well in the search engine...

I'm trying to flag each time stamp in a column when a datum changes within a date range.  To further clarify, the logic I've figured is If previous entry is different than current entry, Then select.  If the same, ignore.  Any help with the syntax for this would be appreciated.",,False,self,t5_2qp8q,False,,,True,t3_1hfwku,http://www.reddit.com/r/SQL/comments/1hfwku/oracle_selecting_values_that_are_different_than/,
1372344394.0,1,notes.mindprince.in,1h6iee,Sparse matrix multiplication using SQL,mindprince,2,1,2,http://www.reddit.com/r/SQL/comments/1h6iee/sparse_matrix_multiplication_using_sql/,,,False,default,t5_2qp8q,False,,,False,t3_1h6iee,http://notes.mindprince.in/2013/06/07/sparse-matrix-multiplication-using-sql.html,
1372260234.0,1,self.SQL,1h420r,I do not understand how a cross tab query would help me find in this situation. thoughts?,q14802,2,1,3,http://www.reddit.com/r/SQL/comments/1h420r/i_do_not_understand_how_a_cross_tab_query_would/,"I was given an assignment at work. 

""Compare 6/25/2013 Revenue Table with the Historical Revenue table""

The goal of this comparision is to find  the instances in which the Customer ID  belongs to a different group or a different Contract ID.

My boss told me to run a cross tab query.  I thought cross tab queries just summarize data, so how does a cross tab query help me at all?  ",,False,self,t5_2qp8q,False,,,True,t3_1h420r,http://www.reddit.com/r/SQL/comments/1h420r/i_do_not_understand_how_a_cross_tab_query_would/,
1372191166.0,1,self.SQL,1h260c,[MS SQL] Running SQL Integration Services service as Local System as opposed to NetworkService. Problem?,ElCriadorDePollos,1,0,2,http://www.reddit.com/r/SQL/comments/1h260c/ms_sql_running_sql_integration_services_service/,"I am wondering what the implications of running this service as local system instead of networkservice and if this would cause problems.

Currently the service won't start using the network service account but will as local system. Wondering if this can be a stopgap while the larger problem is investigated.

SQL Server 2005 on Server 2003.",,False,self,t5_2qp8q,False,,,True,t3_1h260c,http://www.reddit.com/r/SQL/comments/1h260c/ms_sql_running_sql_integration_services_service/,
1371839107.0,1,self.SQL,1gt536,[MS SQL] Restoring with NORECOVERY...,misseff,3,2,2,http://www.reddit.com/r/SQL/comments/1gt536/ms_sql_restoring_with_norecovery/,"I just restored two databases from full backups with NORECOVERY ahead of a migration tonight, during which I'll restore from diff backups. My question is, is it normal for the databases to be stuck in ""Restoring..."" mode after restoring with NORECOVERY? I'm not a DBA and have never had to restore this way before, just following a checklist and all our DBAs are offline for the next 10 hours... just want to make sure this is normal and I don't need to wake one of them up. Thanks! ",,False,self,t5_2qp8q,False,,,True,t3_1gt536,http://www.reddit.com/r/SQL/comments/1gt536/ms_sql_restoring_with_norecovery/,
1371750625.0,1,self.SQL,1gqnor,How can I do this in SQL?,loct99,1,0,1,http://www.reddit.com/r/SQL/comments/1gqnor/how_can_i_do_this_in_sql/,"Table2013- company name, employee I'd
Table2012- company name, employee I'd


I want to find all instances where the employee I'd has a different company in the two tables. In excell I'd just do a vlookup and the a true false statement .  But I can't export tanles this big
",,False,self,t5_2qp8q,False,,,True,t3_1gqnor,http://www.reddit.com/r/SQL/comments/1gqnor/how_can_i_do_this_in_sql/,
1371496223.0,1,self.SQL,1gj7n2,[MySQL] Newcomer attempting to BULK INSERT a text file into table.,UnagiandRoe,2,1,17,http://www.reddit.com/r/SQL/comments/1gj7n2/mysql_newcomer_attempting_to_bulk_insert_a_text/,"Hello, I am VERY new to DBMS related work. I have created a database, set up my table definitions, and I'm ready to throw in the actual data. I know how to use the INSERT INTO statement, but I'm trying to import a large text file with all of my statements and data rather than typing it all in the command line.

In my research, I have found the BULK INSERT statement to fit my needs. However, for the life of me, I can't get it to work. My data values are comma delimited within the text file.

BULK INSERT 'table name' FROM 'Directory Path' WITH (FIELDTERMINATOR = ',')

I am receiving a syntax error. Am I approaching the text file import in the right way?

Thanks!",,False,self,t5_2qp8q,False,,,True,t3_1gj7n2,http://www.reddit.com/r/SQL/comments/1gj7n2/mysql_newcomer_attempting_to_bulk_insert_a_text/,
1371492305.0,1,self.SQL,1gj29i,[SQL Server] Error converting varchar value to int when attempting to convert a comma-delimited string into a table,delugio,1,0,3,http://www.reddit.com/r/SQL/comments/1gj29i/sql_server_error_converting_varchar_value_to_int/,"The end goal of the udf below is to allow a user to type in custom parameter values to generate a report in SSRS. This is slightly modified from an example I found at http://www.codeproject.com/Tips/584680/Using-comma-separated-value-parameter-strings-in-S

    CREATE FUNCTION [dbo].[CSVToTable] (@InStr VARCHAR(MAX))
    RETURNS @TempTab TABLE
       ([Name] VARCHAR(200))
    AS
    BEGIN
        SET @InStr = REPLACE(@InStr + ',', ',,', ',')
        DECLARE @SP INT
    DECLARE @VALUE VARCHAR(1000)
    WHILE PATINDEX('%,%', @INSTR ) &lt;&gt; 0 
    BEGIN
       SELECT  @SP = PATINDEX('%,%',@INSTR)
       SELECT  @VALUE = LEFT(@INSTR , @SP - 1)
       SELECT  @INSTR = STUFF(@INSTR, 1, @SP, '')
       INSERT INTO @TempTab([Name]) VALUES (@VALUE)
    END
        RETURN
    END
    GO

    DECLARE @LIST VARCHAR(200)
    SET @LIST = 'a'
    SELECT * FROM dbo.CSVToTable(@LIST)

NOTE: when i simply initialize LIST as '', the returned value is a table with one column named id, and one value, 0. If I set list equal to a string such as '10,5,99,...' the udf works fine
",,False,self,t5_2qp8q,False,,,True,t3_1gj29i,http://www.reddit.com/r/SQL/comments/1gj29i/sql_server_error_converting_varchar_value_to_int/,
1371304366.0,1,self.SQL,1gedtv,[MS Access] Basic SQL query help.,Shalaiyn,1,0,5,http://www.reddit.com/r/SQL/comments/1gedtv/ms_access_basic_sql_query_help/,"I'm asking on behalf of a friend who can't get into Reddit right now:

""Hey guys, i need some help/ a nudge in the right direction.

I need to sort out Author, Authors first year of publication and as the third column the books he published within that year
and grouping all of that by Authors.

Heres the picture what im working with - http://i.imgur.com/0qW0HDc.png

and heres what i have so far but it creates multiple entries as seen here - http://i.imgur.com/OPXFxpP.png

SQL i have so far:

SELECT Authors.Author, Titles.[Year Published], Titles.Title
FROM Titles INNER JOIN (Authors INNER JOIN [Title Author] ON Authors.[Au_ID] = [Title Author].[Au_ID]) ON Titles.[ISBN] = [Title Author].[ISBN]

but this is wrong as it creates multiple entries :(""

",,False,self,t5_2qp8q,False,,,True,t3_1gedtv,http://www.reddit.com/r/SQL/comments/1gedtv/ms_access_basic_sql_query_help/,
1371138976.0,1,self.SQL,1g9vmh,MSSQL query2 using results of query1,whoisearth,1,0,24,http://www.reddit.com/r/SQL/comments/1g9vmh/mssql_query2_using_results_of_query1/,"So I have a query where I want to find the value of a table.  I have the query successful and it pulls around 10 - 20 lines of info.

I then want to do a query taking the results of 1 of the columns of that table and run another query for each result of the 10 - 20 lines.

How would I go about doing this?",,False,self,t5_2qp8q,False,,,True,t3_1g9vmh,http://www.reddit.com/r/SQL/comments/1g9vmh/mssql_query2_using_results_of_query1/,
1370790546.0,1,self.SQL,1fzf01,[MS Access 2010] Copying and updating multiple records at once,Krainz,3,2,8,http://www.reddit.com/r/SQL/comments/1fzf01/ms_access_2010_copying_and_updating_multiple/,"Hi guys,

I have this database I'm working on, which is based off an Access model (projects), and I have these 106 records, which are the same for all projects: http://i.imgur.com/cNzIzip.jpg

To make my job easier, I would like to copy all these records and change the ""Projeto"" value, which works like this: http://i.imgur.com/OH8qvFX.jpg

It is very important to me because I'm going to have to do that for nearly 20 projects, all having these same records, because they are our company's default steps of development.

So, how do I do that?",,False,self,t5_2qp8q,False,,,True,t3_1fzf01,http://www.reddit.com/r/SQL/comments/1fzf01/ms_access_2010_copying_and_updating_multiple/,
1370602312.0,1,self.SQL,1fus3h,[MySQL] Need a little help here,Sexyfish69,2,1,4,http://www.reddit.com/r/SQL/comments/1fus3h/mysql_need_a_little_help_here/,"I'm going to make a ""combine elements"" game where one register as an user and then gets a starting pack with different objects (wood x5, shears x2, ink x4 etc). Then the user can combine the items (1 wood + 1 shears = 5 sticks etc) and trade items with each others and so on.
I've got a table named Items and a table named Users.
The Items table got the columns: 'item_id' and 'name', where I store the name of the item.
In the Users table i've got 'user_id', 'username', 'rank' and 'xp'

How can I create a relationship so that I can store which one of the elements the player owns and how many of it?
Am I supposed to make a table with each element at it's own column and each player at its own row, so that I can insert how many of each item each player owns?",,False,self,t5_2qp8q,False,,,True,t3_1fus3h,http://www.reddit.com/r/SQL/comments/1fus3h/mysql_need_a_little_help_here/,
1370524300.0,1,self.SQL,1fsdfb,super simple error I keep getting,428reo,1,0,5,http://www.reddit.com/r/SQL/comments/1fsdfb/super_simple_error_i_keep_getting/,"I need to use two NOT statements.

For example,

Select Client Number, Group
From Table A
Where Group not 70 or not 14 and report_date between 5/1/2013 and 5/31/2013


it returns both 70 and 14 groups when i do this",,False,self,t5_2qp8q,False,,,True,t3_1fsdfb,http://www.reddit.com/r/SQL/comments/1fsdfb/super_simple_error_i_keep_getting/,
1370154994.0,1,self.SQL,1fib2v,What are some one-to-many examples of two tables I can practice creating by writing queries?,Liger86,1,0,6,http://www.reddit.com/r/SQL/comments/1fib2v/what_are_some_onetomany_examples_of_two_tables_i/,My brain is fried and I can't think of that many but I need to practice to remember syntax better.,,False,self,t5_2qp8q,False,,,True,t3_1fib2v,http://www.reddit.com/r/SQL/comments/1fib2v/what_are_some_onetomany_examples_of_two_tables_i/,
1370115779.0,1,self.SQL,1fh8zv,"[mssql] I've ran a lot of queries against master database, how do I roll back them all?",Liger86,1,0,4,http://www.reddit.com/r/SQL/comments/1fh8zv/mssql_ive_ran_a_lot_of_queries_against_master/,There are so many changes to master it's hard to delete just one thing. I think it's just tables that were created in its context but could be other things too. Is it possible to reinstal sql server or repair it and it would get rid of those changes?,,False,self,t5_2qp8q,False,,,True,t3_1fh8zv,http://www.reddit.com/r/SQL/comments/1fh8zv/mssql_ive_ran_a_lot_of_queries_against_master/,
1369868410.0,1,self.SQL,1fat70,DateDiff returns zero,PichardRryor,1,0,9,http://www.reddit.com/r/SQL/comments/1fat70/datediff_returns_zero/,"Hi everyone,  
I'm calculating the difference btw two dates, 14-apr-2013 and 14-mar-2013, however these dates are in columns along with many others.
I'm writing the following: 
Datediff(d, column1, column2) 
But its returning zero.
I've swapped places of the columns,  with the same results.
Any ideas? ",,False,self,t5_2qp8q,False,,,True,t3_1fat70,http://www.reddit.com/r/SQL/comments/1fat70/datediff_returns_zero/,
1369708506.0,1,self.SQL,1f6bzf,"Microsoft SQL Server 2005 Express: Using sqlcmd, is it possible to add a formula to a field?",TipOfTheSpear,2,1,1,http://www.reddit.com/r/SQL/comments/1f6bzf/microsoft_sql_server_2005_express_using_sqlcmd_is/,"I'm using an application that accesses an instance of SQLEXPRESS on my local machine. I'm trying to tailor it to meet my needs by working with the database directly when possible. 

For whatever reason, I'm not able to install something like SQL Server Management Studio expressed, and I'm using Access 2003 to make minor edits to the database. I do, however, own the database, so anything can be done via sqlcmd. 

I don't know enough about it to know if it's even possible, but could add a formula, say change a SomeDate field from ""text"" to where it will actually interpret someting like ""=Date()""?",,False,self,t5_2qp8q,False,,,True,t3_1f6bzf,http://www.reddit.com/r/SQL/comments/1f6bzf/microsoft_sql_server_2005_express_using_sqlcmd_is/,
1369704744.0,1,self.SQL,1f67py,Question about joins,shif,1,0,18,http://www.reddit.com/r/SQL/comments/1f67py/question_about_joins/,"I taught sql mysql and i've never used the inner, right or left joins they way i've been joining tables is with and statements, for example take this postgres tables

    CREATE TABLE product (
      id    serial,
      brand int,
      type  int,
      name  text
    );
    
    CREATE TABLE brands (
      id    serial,
      name  text
    );
    
    CREATE TABLE types (
      id    serial,
      name  text
    );

if i wanted to get the results of a product with the name of the brand and the name of the type i would do

    SELECT p.name, b.name brand, t.name AS type 
    FROM product p, brands b, types t 
    WHERE brand = b.id AND type = t.id;

Am i supposed to be using joins for this?, or what is the common practice in the field, what way do you guys recommend?

im currently clueless on how joins work, i haven't really needed them but curiosity is itching
",,False,self,t5_2qp8q,1369707765.0,,,True,t3_1f67py,http://www.reddit.com/r/SQL/comments/1f67py/question_about_joins/,
1369326094.0,1,self.SQL,1ewsm8,SQL cluster fail over question!!!,Justinjaw,1,0,1,http://www.reddit.com/r/SQL/comments/1ewsm8/sql_cluster_fail_over_question/,does anyone know if adding CPU / memory to a 2 node SQL cluster will break it?,,False,self,t5_2qp8q,False,,,True,t3_1ewsm8,http://www.reddit.com/r/SQL/comments/1ewsm8/sql_cluster_fail_over_question/,
1369004455.0,1,self.SQL,1enpyd,SQL question - joining two tables with some NULL values (see text for details),ReidWings,1,0,11,http://www.reddit.com/r/SQL/comments/1enpyd/sql_question_joining_two_tables_with_some_null/,"Hi, I'm new to SQL and am trying to link a few tables together and have run into a problem I was hoping someone here could help me solve!  

I have a medical record system that links to patient documents and has an identifier for each data point for the patient document all stored in different tables.  I want to link them to make a table for each patient of all their documents.  Each document is listed more than once to give the different variables related to it, but not all of these listings have an attached patient (it simply lists the document ID)

I'll simplify to the example:

I've created this table by using multiple inner joins:

DocumentID------Patient -------- DocumentField-------Data------ImageType

1 ----------------- Smith--------MedicalRecord--------223-------- Photo

1 ----------------- NULL -------- Date of Service --------1/23/12 -------- Photo

1 ----------------- NULL-------- InsuranceType -----------2 -------- Photo

2 ----------------- Johnson-------- MedicalRecord --------239  -------- HistoryForm

2 ----------------- NULL--------Date of Service--------4/11/13 -------- HistoryForm

2 ----------------- NULL -------- InsuranceType ------  2  -------- HistoryForm

3 ----------------- Davis -------- MedicalRecord ------ 837  -------- HIPPA

3 ----------------- NULL-------- Date of Service ------ 2/13/12--------HIPPA

3 ----------------- NULL --------  InsuranceType ------  2 -------- HIPPA

I want to have a table that lists:

DocumentID    --------   Patient      --------     DocumentField    --------   Data   --------    ImageType

1  ----------------  Smith  --------  Date of Service--------  1/23/12 --------   Photo

2  ---------------  Johnson  --------  Date of Service   --------4/11/13  --------  HistoryForm

3 ----------------- Davis --------   Date of Service -------- 2/13/12  -------- HIPPA

AND then I want to be able to filter it down by individual patients.  The reason I can't do that now is as you can see in my first table, not every incident lists the patient name (NULL in some slots).  The documentID is listed to link to all the other data but only one instance uses the patient name to link to the document ID.   When I filter down by patient name, I lose the date of service rows which is the one I want to keep.  

Any guidance on how to do this would be VERY appreciated!!

Thanks!",,False,self,t5_2qp8q,1369004884.0,,,True,t3_1enpyd,http://www.reddit.com/r/SQL/comments/1enpyd/sql_question_joining_two_tables_with_some_null/,
1368783431.0,1,self.SQL,1eibxq,Visual SQL designer?,Penetal,1,0,2,http://www.reddit.com/r/SQL/comments/1eibxq/visual_sql_designer/,"Hey I suck at SQL, and it makes it much easier when using a visual tool that can export good SQL syntax for me. 

I have tried mysql workbench, and either I suck more than I realize or the tool is way more powerful than what I need. 

Is there a good option for beginners that run under Linux/debian? 

What are your favorite tools that can export to mysql and sqlite?",,False,self,t5_2qp8q,False,,,True,t3_1eibxq,http://www.reddit.com/r/SQL/comments/1eibxq/visual_sql_designer/,
1368650793.0,1,self.SQL,1een29,What [MS SQL] or [Oracle] Certifications are worth getting?,NakedLoki,1,0,2,http://www.reddit.com/r/SQL/comments/1een29/what_ms_sql_or_oracle_certifications_are_worth/,I've done some searching but I can never really tell what's worth getting and what's some no name website trying to make money.  Anyone have any recommendations?,,False,self,t5_2qp8q,False,,,True,t3_1een29,http://www.reddit.com/r/SQL/comments/1een29/what_ms_sql_or_oracle_certifications_are_worth/,
1368636030.0,1,self.SQL,1ee31k,"[MS JET SQL] ""Join Expression Not supported?"" help me fix this in ONE SINGLE QUERY PLEASE!",jesusw00t,1,0,16,http://www.reddit.com/r/SQL/comments/1ee31k/ms_jet_sql_join_expression_not_supported_help_me/,"MY CODE (Im using MS Access 2000 with JET Database engine)

    SELECT Members.First_Name + ' ' + Members.Last_Name AS Member,     iif(NULL,Friends.My_E_Mail, Friends.Friend_E_Mail) AS E_Mail, Members.First_Name AS Name 

    FROM ((Members LEFT OUTER JOIN Friends ON Members.E_Mail = Friends.My_E_Mail AND   Friends.Friend_E_Mail = ?) 

    LEFT OUTER JOIN Friends Friends_1 ON Members.E_Mail = Friends.Friend_E_Mail AND Friends.My_E_Mail = ?)




My Tables
    Members(all VARCHAR)     SOME DATA
    First_Name               Alester Jude Carl Jones
    Last_Name                A       B    C    J
    
    FRIENDS(ALL VARCHAR)
    My_E_Mail               Alester@lam.com Alester@lam.com  Alester@lam.com
    Friend_E_Mail           jude@lam.com    carl@lam.com   jones@lam.com

   ***NOTE Friends Table ALLOWS duplicates so jude can be on my_E_Mail but CAN NOT add alester because they are already friends.


Desired Output if (""?"" in above query is: jones@lam.com)

    +--------------+-----------+------------+
    |Member        |E_Mail     |  Name      |
    +---------------------------------------+
     Alester A   Alester@lam.com  Alester




Desired Output if(""?"" in above query is: Alester@lam.com)

    +--------------+-----------+------------+
    |Member        |E_Mail     |  Name      |
    +---------------------------------------+
     Jude B        jude@lam.com  Jude
     carl C        carl@lam.com  Carl
     Jones J       jones@lam.com Jones

PS the ""?"" are query string parameters that im passing in the ""?"" i know that works fine. 
 

MY QUESTION IS : i keep getting this error ""Join Expression not Supported"" 

is their a work around query i can use without using a stored procedure or using multiple queries since this needs to be ONE SINGLE QUERY!?

Thanks.",,False,self,t5_2qp8q,False,,,True,t3_1ee31k,http://www.reddit.com/r/SQL/comments/1ee31k/ms_jet_sql_join_expression_not_supported_help_me/,
1368559188.0,1,self.SQL,1ebzq9,[JET SQL] help me with this SQL statment access 2000,jesusw00t,1,0,3,http://www.reddit.com/r/SQL/comments/1ebzq9/jet_sql_help_me_with_this_sql_statment_access_2000/,"this Query Dose NOT work in Access 2000

    SELECT (Members.First_Name + "" "" + Members.Last_Name)AS Member,
    (
    (SELECT Friend_E_Mail,
    FROM    Friends,Members
    WHERE My_E_Mail = ? and Friend_E_Mail &lt;&gt; ?
    UNION ALL
    SELECT My_E_Mail,
    FROM  Friends,Members
    WHERE  Friend_E_Mail = ?and My_E_Mail &lt;&gt; ?)) AS E_Mail,
    (Members.First_Name) AS Name

    FROM Members,Friends

 Sample Tables
   
    Members(all VARCHAR)     SOME DATA
    First_Name               Alester Jude Carl Jones
    Last_Name                A       B    C    J
    
    FRIENDS(ALL VARCHAR)
    My_E_Mail               Alester@lam.com Alester@lam.com   Alester@lam.com
    Friend_E_Mail            jude@lam.com carl@lam.com jones@lam.com


Desired Output if(""?"" in above query is: jones@lam.com)

    +--------------+-----------+------------+
    |Member        |E_Mail     |  Name      |
    +---------------------------------------+
     Alester A   Alester@lam.com  Alester




Desired Output if(""?"" in above query is: Alester@lam.com)

    +--------------+-----------+------------+
    |Member        |E_Mail     |  Name      |
    +---------------------------------------+
     Jude B        jude@lam.com  Jude
     carl C        carl@lam.com  Carl
     Jones J       jones@lam.com Jones
PS the ""?"" are query string parameters that im passing in the ""?"" i know that works fine. 
 

MY QUESTION IS : i keep getting this error ""Operation Not Allowed in Sub Query"" is their a work around query i can use without using a stored procedure?

Thanks.",,False,self,t5_2qp8q,False,,,True,t3_1ebzq9,http://www.reddit.com/r/SQL/comments/1ebzq9/jet_sql_help_me_with_this_sql_statment_access_2000/,
1368543065.0,1,self.SQL,1ebemd,[HeidiSQL/Python+MySQLdb] How to join prices from one table into another table for specific dates?,ridetherhombus,1,0,2,http://www.reddit.com/r/SQL/comments/1ebemd/heidisqlpythonmysqldb_how_to_join_prices_from_one/,"I'm pretty new to SQL. I need to take data from one table and add it to another table based on the date and then multiply the price by the amount purchased. The first table is very small compared to the second.

**Table 1: year, month, day, price**

**Table 2: customer, year, month, day, amount**

I'm trying to get to...

**Table 2: customer, year, month, day, amount, price, amount*price**",,False,self,t5_2qp8q,1368543852.0,,,True,t3_1ebemd,http://www.reddit.com/r/SQL/comments/1ebemd/heidisqlpythonmysqldb_how_to_join_prices_from_one/,
1368195688.0,1,self.SQL,1e2iin,[MSSQL] Is it possible to apply a Mask to add leading zeros?,Groty,2,1,5,http://www.reddit.com/r/SQL/comments/1e2iin/mssql_is_it_possible_to_apply_a_mask_to_add/,"I have a rather large dataset loaded into a new table.  First time working with this new set.  It was pulled out of SAS then imported into MSSQL.  The problem I have is that our Customer Account Numbers are 11 digit numerics. I have them stored as varchar's because of leading zeros.  Unfortunately, somewhere in the process from SAS&gt;CSV&gt;MSSQL, leading zeros were dropped on the account numbers.  Building the relationship on these records will be a challenge.  

Is there a way to Mask the Customer Account Number within the query, the leading zeros are backfilled to 11 characters?  Is there another way to do this?  In excel, I always solve this when it comes up by simply putting in a custom mask on the column but I don't know if there is a function within MS TSQL that is the equivalent.",,False,self,t5_2qp8q,False,,,True,t3_1e2iin,http://www.reddit.com/r/SQL/comments/1e2iin/mssql_is_it_possible_to_apply_a_mask_to_add/,
1368041163.0,1,self.SQL,1dy7wk,"I want to make 80 tables into one effectively, and can't figure it out. Need help.",Terzelius,2,1,5,http://www.reddit.com/r/SQL/comments/1dy7wk/i_want_to_make_80_tables_into_one_effectively_and/,"First of all, I don't master the english language (yet). My problem is this:

I have 80 similar tables. They all have the same columns, with 3000 to 4000 rows each. I want to make a table with the same columns that will contain all the rows of all the 80 tables.

I know I can just do INSERT INTO for each table, but this is a long process and I would prefer a way to do this with a function in PL/PGSQL (with a loop of some kind).

I'm working in Postgres.
",,False,self,t5_2qp8q,False,,,True,t3_1dy7wk,http://www.reddit.com/r/SQL/comments/1dy7wk/i_want_to_make_80_tables_into_one_effectively_and/,
1367945629.0,1,monkeyandcrow.com,1dvdc1,[PostgreSQL] Implementing Tagging with Arrays,netghost,1,0,0,http://www.reddit.com/r/SQL/comments/1dvdc1/postgresql_implementing_tagging_with_arrays/,,,False,http://d.thumbs.redditmedia.com/V4PMNn4N8evF8x3u.jpg,t5_2qp8q,False,,,False,t3_1dvdc1,http://monkeyandcrow.com/blog/tagging_with_active_record_and_postgres/,
1367345940.0,1,self.SQL,1dfcb4,Still learning SQL if you dont mind sparing knowledge please help.,BlameTheAirForGossip,1,0,8,http://www.reddit.com/r/SQL/comments/1dfcb4/still_learning_sql_if_you_dont_mind_sparing/,"I am working on homework and I am confused as to what it is asking me to do. The problem states:

5)	Rename the SaleBuyerID field in the SALE table to SaleCustID.  This code is not covered in the book but you should simply substitute the actual names into the code below.  Substitute the actual table for TABLE and the actual field for Field.  The first ‘TABLE.field’ will be the name of the table and old field and the second ‘Field’ will be the name of the new field.  Everything else must stay the same.   (1 pt)

sp_RENAME 'TABLE.Field', 'Field', 'COLUMN';

What is placed in the Column Field? I am assuming SALE.SaleBuyerId=TABLE.Field and the SaleCustId=Feild but what is Column?",,False,self,t5_2qp8q,False,,,True,t3_1dfcb4,http://www.reddit.com/r/SQL/comments/1dfcb4/still_learning_sql_if_you_dont_mind_sparing/,
1366595344.0,1,self.SQL,1cu4ty,[MS SQL] I don't know what this error means,rossi1592,2,1,8,http://www.reddit.com/r/SQL/comments/1cu4ty/ms_sql_i_dont_know_what_this_error_means/,"I keep getting an error when ever I try and try and do an insert statement. I know it has to do with the Foreign Key but don't know how to fix it. 

Error: http://i.imgur.com/oGhWB06.jpg ",,False,self,t5_2qp8q,False,,,True,t3_1cu4ty,http://www.reddit.com/r/SQL/comments/1cu4ty/ms_sql_i_dont_know_what_this_error_means/,
1366377858.0,1,self.SQL,1cobmp,How DO you normalize an existing database?,DerManiac,2,1,16,http://www.reddit.com/r/SQL/comments/1cobmp/how_do_you_normalize_an_existing_database/,"This may sound like a silly question, but let me explain:

I know normalization. I know how to design and create a normalized database. I've been recently given 7 excel sheets with about 10,000 rows each, with the task ""put those in a database so we can query stuff"".

First thing I did was examine the data and create an EER diagram of how I imagined the final database should look like (in th 5NF). Luckily the data I got was already in the 1NF, which should make the rest a piece of cake.

But.. how do I bring this data into the 2NF or 3NF - into the format I designed before? Are there any tools that can help me do that? In other words: How do I import this unnormalized data into my normalized database?

The main question basically is: Do I really have to do that all by hand? Or is there some kind of tool that let's me ""map"" the data onto my normalized scheme? Or maybe someone just knows some small tipps or tricks that can make the job a little bit less tedious?

**TL;DR:** How to convert existing data into a normalized form without doing it all by hand?",,False,self,t5_2qp8q,False,,,True,t3_1cobmp,http://www.reddit.com/r/SQL/comments/1cobmp/how_do_you_normalize_an_existing_database/,
1366335305.0,1,self.SQL,1cne79,Succinct list of what doesn't work with Merge Replication,jersully,3,2,1,http://www.reddit.com/r/SQL/comments/1cne79/succinct_list_of_what_doesnt_work_with_merge/,"I'm a sysadmin, not a DBA.  We're exploring the use of Merge Replication between our SQL 2008 R2 Standard and our customers' Express versions.  I learned today that there are certain things (such as dropping replicated tables) that my merge replication doesn't allow.

We write and sell software which is specific to our industry and a front-end to SQL data. I've already explained to our software support folks that they need to prepare themselves to re-think all their SQL scripts.

For their sake, and the sake of the developer who writes that front end, is there a list somewhere of MS SQL commands that are verboten when you're doing merge replication?  I've looked, but my Google Fu failed me.

I promise I'm not a complete idiot, I'm just SQL ignorant.  I've been doing this for 20 years and am a prettly good Jack of all trades.  But I purposely avoided DBA stuff because the McCorporations I worked for had dedicated staff for that.  Now I'm a standalone sysadmin playing catch-up.  TIA.",,False,self,t5_2qp8q,False,,,True,t3_1cne79,http://www.reddit.com/r/SQL/comments/1cne79/succinct_list_of_what_doesnt_work_with_merge/,
1366305103.0,1,stackoverflow.com,1cm79w,Why does UNION ALL seem to wait for both queries to finish before start streaming rows?,ysangkok,1,0,0,http://www.reddit.com/r/SQL/comments/1cm79w/why_does_union_all_seem_to_wait_for_both_queries/,,,False,default,t5_2qp8q,False,,,False,t3_1cm79w,http://stackoverflow.com/questions/15253399/why-does-union-all-seem-to-wait-for-both-queries-to-finish,
1366149398.0,1,self.SQL,1chn9l,how do I fix the syntax here?,helpprogram2,4,3,2,http://www.reddit.com/r/SQL/comments/1chn9l/how_do_i_fix_the_syntax_here/,"    create table temp
    
    
    Select title, sum(onHand) as BigSum
    From book,inventory
    Where book.bookcode = inventory.bookcode AND
    book.publishercode = @publishcode
    Group by book.title
     
    
    set @Booktitle = 
    (select title 
    From temp
    Where BigSum = (Select max(BigSum)
                   From temp))",,False,self,t5_2qp8q,False,,,True,t3_1chn9l,http://www.reddit.com/r/SQL/comments/1chn9l/how_do_i_fix_the_syntax_here/,
1366045992.0,1,self.SQL,1cee6k,[MS SQL] Help Inserting a File into the database,dobby_resurrected,1,0,3,http://www.reddit.com/r/SQL/comments/1cee6k/ms_sql_help_inserting_a_file_into_the_database/,"I have searched a lot of places but I cannot get this done. 

My client has a database where files are stored in the database as varbinary(max). I can't seem to convert my file into varbinary(max) to insert into the db.

I am using php to read the file. Here is my code:

    $fp = fopen ($file_data,'rb');
    $file_content = fread($fp, filesize($file_data));
    fclose($fp);
       
    $insert=""INSERT INTO table(file_data) 
        VALUES('CONVERT(varbinary(max),'"".$file_content.""') )"";
    $res = mssql_query($insert,$dbhandle);
    ",,False,self,t5_2qp8q,False,,,True,t3_1cee6k,http://www.reddit.com/r/SQL/comments/1cee6k/ms_sql_help_inserting_a_file_into_the_database/,
1365598304.0,1,self.SQL,1c25ho,"[MS SQL] Breaking a MSSQL Cluster, suggestions / pitfalls?",stalinusmc,2,1,1,http://www.reddit.com/r/SQL/comments/1c25ho/ms_sql_breaking_a_mssql_cluster_suggestions/,"To preface, I am a system admin, not a DBA; so I apologize if some of my questions / syntex appear ignorant. 

We currently have a SQL cluster in a physical environment, running on Server 2003 SP 2 Enterprise. We are currently 95+% virtual, with only fax server and this cluster still physical. We want to break them out into stand-alone servers, to better manage. We currently have one node controlling the file aspect, and another node controlling the database. From what I gather, typically both nodes usually share these roles, ours do not. We need to have them retain the same server names (if it is possible) to minimize impact to the rest of the environment. 

What is the best way of going about breaking them out? Should we build whole new servers, transferring the database and files? Or should we just break the cluster? Ultimately, we want to virtualize these servers. 

I have done some googling, and came up with these articles; but would the SQL jobs transfer over as well, or just the database? We also use SQL Integration Services, would those jobs transfer as well?

http://itknowledgeexchange.techtarget.com/itanswers/how-to-move-sql-server-clustered-instance-to-a-seperate-stand-alone-server/

http://social.msdn.microsoft.com/Forums/en-US/sqlsetupandupgrade/thread/5e3da872-4eb4-4a5b-857e-b46e9d3802b5

I apologize for the rambling, just looking for some sound advice / direction. Also, very cautious because this is our core SQL servers and any downtime is unacceptable. TIA. ",,False,self,t5_2qp8q,False,,,True,t3_1c25ho,http://www.reddit.com/r/SQL/comments/1c25ho/ms_sql_breaking_a_mssql_cluster_suggestions/,
1365098181.0,1,mysqlperformanceblog.com,1boana,Why MySQL Performance at Low Concurrency is Important,strangeloops,2,1,0,http://www.reddit.com/r/SQL/comments/1boana/why_mysql_performance_at_low_concurrency_is/,,,False,http://e.thumbs.redditmedia.com/G6nZwFB2RDSebMYv.jpg,t5_2qp8q,False,,,False,t3_1boana,http://www.mysqlperformanceblog.com/2013/03/27/why-mysql-performance-at-low-concurrency-is-important/,
1365004732.0,1,self.SQL,1ble6o,[Oracle] Selecting a variable column based on the value in a different table,automounter,2,1,9,http://www.reddit.com/r/SQL/comments/1ble6o/oracle_selecting_a_variable_column_based_on_the/,"I apologize up front for posting a question to your subredit.  I'm not asking you to do my schoolwork or anything, and google has not been much help.

I am working with a turnkey solution where the schema is what it is.  I have also changed the actual table and column names to make it more readable.

In the case I am working with, there is a main table in it that has a key to another table where the column names in that table are just an id and ""value1"", ""value2"", ""value3""...  Then there is a 3rd table that consists of what each column represents.

    MAINDATA
    	MAINID
    	USERNAME
    	METARECORDID
    METAATTRIBUTESRECORD
    	METARECORDID
    	VALUE14 (i.e. ""42101"")
    	VALUE20 (i.e. ""XYZ123"")
    METAATTRIBUTEDEFINITION
    	NAME (i.e. ""Zip Code"" or ""License Plate"")
    	COLUMNID (i.e. ""14"" or ""20"")
    
So, for instance.  If I wanted to get all of the rows that had a zip code of 42101, I would first have to select columnid from METAATTRIBUTEDEFINITION where name = ""Zip Code"" and then use that columnid to select * from METAATTRIBUTESRECORD where value$columnid = '42101'.

This could be achieved programmatically, but this is where my SQL ignorance begins.  The whole program must be defined as part of a SP, so a programming language I am more familiar with is not available.  How would I put the column name I need into a variable?  Or can all of this be done in the context of one query inside the SP?

Anyone tips or references on how to do this would be greatly appreciated.",,False,self,t5_2qp8q,1365007406.0,,,True,t3_1ble6o,http://www.reddit.com/r/SQL/comments/1ble6o/oracle_selecting_a_variable_column_based_on_the/,
1364933478.0,1,self.SQL,1bjd7u,SQL *Plus Function,varnecr,2,1,2,http://www.reddit.com/r/SQL/comments/1bjd7u/sql_plus_function/,"Is there a reason why my system account is not listed when I try and generate the listing of users assigned the sqlplus function? I'm using the query ""select * from product_profile""",,False,self,t5_2qp8q,False,,,True,t3_1bjd7u,http://www.reddit.com/r/SQL/comments/1bjd7u/sql_plus_function/,
1364859048.0,1,i-programmer.info,1bh0a1,Biggest SQL Disasters [infograph],udelblue,8,7,3,http://www.reddit.com/r/SQL/comments/1bh0a1/biggest_sql_disasters_infograph/,,,False,http://a.thumbs.redditmedia.com/A1cUjCm4tPYfFIN0.jpg,t5_2qp8q,False,,,False,t3_1bh0a1,http://www.i-programmer.info/news/84-database/5690-biggest-sql-disasters.html,
1364374231.0,1,self.SQL,1b3njj,[Postgres] Quick and simple index question..,hirolau,2,1,2,http://www.reddit.com/r/SQL/comments/1b3njj/postgres_quick_and_simple_index_question/,"Trying to optimize some quires I have got my hands on.

I see a lot of:

Create index ix1 on table(a)
Create index ix2 on table(b)
Create index ix3 on table(a,b)

Now, if I have understood things correctly one of these three indexes is useless. Given that I think ix3 is necessary, ix1 is pretty much useless right?

Does anyone know how (if at all) much better ix3 is compared to ix1 and ix2 on a join using both a and b? Time to get some empirical data!
",,False,self,t5_2qp8q,False,,,True,t3_1b3njj,http://www.reddit.com/r/SQL/comments/1b3njj/postgres_quick_and_simple_index_question/,
1364315862.0,1,self.SQL,1b1s8x,Code Management,sqldiaries,1,0,9,http://www.reddit.com/r/SQL/comments/1b1s8x/code_management/,"My boss has asked me to look into finding some kind of ""code management"" solution for all of our SQL scripts.

Currently they all exist as simple text files either on the Department network share, or in private directories on our individual machines.

We'd like something that supports NT security (so we don't have to remember yet *another* username/password), and allows us to restrict access to certain folders/selects/what-have-you.

I've never used any kind of CVS/SVN in the past (and perhaps those aren't the right terms), so I'm not sure what's out there.  I've seen Subversion, but I'm not sure how to even deploy it in our environment, and I'm not sure that it would work as it appears to be mostly CLI-based, which isn't going to work for our group.

I'd love to hear what other folks are using!",,False,self,t5_2qp8q,False,,,True,t3_1b1s8x,http://www.reddit.com/r/SQL/comments/1b1s8x/code_management/,
1364239463.0,1,self.SQL,1azon2,[MS SQL] Dynamic Row Filtering that is on demand,mandlebar,1,0,1,http://www.reddit.com/r/SQL/comments/1azon2/ms_sql_dynamic_row_filtering_that_is_on_demand/,"I am a C# Web Developer with limited/moderate knowledge of MSSQL.
MS SQL 2008 R2
Our existing solution involves a single large (1 TB) database table that we are replicating to a local subscriber database for use with the web service.
We are currently using MSSQL Transactional replication with a simple row filter that only replicates rows based on a certain column. (only pull records that are linked to certain companies)

The problem is that we have a new need to be able to change the list of companies dynamically, and still maintain realtime replication without needing to manually change the filter and create a new snapshot. 

Is there an elegant database replication/caching solution that we can use that can replicate data on demand, and then continue to replicate records pertaining to that filter in the future.

So for example

    A request is made to check the data of company A. 
    Company A is in list and is kept locally in the subscriber database, so data is pulled from the subscriber  database.
    A request is made for company D, but D's data is not in the subscriber database.
    Company D is added to the row filter and replicated to the database subscriber.  
    Company D is added to the row filter list.
    Company D's data will continue to be replicated to the subscriber database for any future calls.


All of this logic would have to originate and be controlled by the subscriber side, as we have no control over what happens on the publisher.
",,False,self,t5_2qp8q,1364239708.0,,,True,t3_1azon2,http://www.reddit.com/r/SQL/comments/1azon2/ms_sql_dynamic_row_filtering_that_is_on_demand/,
1364237309.0,1,self.SQL,1azltl,[MySQL] Intermediate SQL help?,ffxpwns,2,1,8,http://www.reddit.com/r/SQL/comments/1azltl/mysql_intermediate_sql_help/,EDIT: nevermind,,False,self,t5_2qp8q,1364242381.0,,,True,t3_1azltl,http://www.reddit.com/r/SQL/comments/1azltl/mysql_intermediate_sql_help/,
1364224361.0,1,self.SQL,1az5na,Calling all SQL Gods,paddyman123,2,1,5,http://www.reddit.com/r/SQL/comments/1az5na/calling_all_sql_gods/,"Having issues with SQL LOG shrinking, seem to be getting stuck here with incorrect Syntax.

BACKUP LOG [SharePoint_Config_29c26fca-17b8-48c1-9704-b869932abcb6] TO DISK=’c:\backup-sql\config.bk’

Msg 102, Level 15, State 1, Line 1 Incorrect syntax near '’'.

Any idea where I'm going wrong? I'm not entirely sure if you can backup logs back to the host drive? They don't use SQL so its just taking 20GB worth of space and bugging the hell outa me.

Just need to shrink it rather than delete it.",,False,self,t5_2qp8q,False,,,True,t3_1az5na,http://www.reddit.com/r/SQL/comments/1az5na/calling_all_sql_gods/,
1363884684.0,1,self.SQL,1aqoru,[MySQL] Basic database design questions,arexious,1,0,1,http://www.reddit.com/r/SQL/comments/1aqoru/mysql_basic_database_design_questions/,"I'm currently in an introductory MySQL database programming course and we have a course project in which we need to design a database for a small business.  The business rents out party supplies to local businesses as well as individual local clients.  

I'm having a couple of issues with my database structure that I was hoping some of you could help me with.  I'd like to add that we have not yet discussed creating functions, triggers, procedures, or loops.  We just recently went over normalization and basics of DB design.  We are only required to design our DB up to the third normal form. 

One of the requirements is that we must store how the customer paid, when they paid, and if paid by check, whether or not the check bounced.  Here is where I'm starting to get a bit lost.  [This](http://arexius.com/favorites/structure.jpg) is how my table structure currently looks.  As you can see my payments table contains a ""check_bounced"" boolean.  Regardless of whether someone pays using a check or not, it will still store a value for whether or not the payment check bounced.  I considered making a table to specifically store which payment_id's bounced like so:

    CREATE TABLE IF NOT EXISTS bounced_checks
    (
    payment_id    INT,

    CONSTRAINT bounced_checks_fk_payments
        FOREIGN KEY (payment_id)
        REFERENCES payments (payment_id)
    );

It seems a bit odd to only store one INT on a table and not have anything in it but a foreign key.  Would this be a more efficient way of doing it, and if not, can anyone suggest another solution?


The other issue I've come across is I'm not sure where the most efficient place to store my invoice_total would be.  Either way it will have to be calculated based on how many items are being rented, how long, at what cost, and if returned late i'll have to account for that as well.  I'm assuming I'll use a procedure for the calculations, although I'm not sure yet.  Here's a sample of how the system works based on the [current database structure](http://arexius.com/favorites/structure.jpg):

    INSERT INTO general_invoices VALUES (DEFAULT, 1, '2013-03-10', DEFAULT);
    INSERT INTO invoice_item_rental VALUES (DEFAULT, 1, 6, 3, 1, '2013-03-11', '2013-03-15', DEFAULT);
    UPDATE inventory SET item_quantity_out=(item_quantity_out+3) WHERE item_id=6;
    UPDATE inventory SET item_cumulative_rentals=(item_quantity_out+3) WHERE item_id=6;
    UPDATE general_invoices 
    SET invoice_total = invoice_total +
    (
    (SELECT item_quantity*(rental_return-rental_pickup) FROM invoice_item_rental WHERE invoice_item_id=1)
    *
    (SELECT item_cost FROM inventory WHERE item_id=6)
    )
    WHERE invoice_id=1;

That would create the general_invoice, create an invoice_item_rental record that links to the general_invoice_id, then calculate the total from inventory-&gt;invoice_item_rental-&gt;general_invoice and update the invoice_total record stored there.  Is this an efficient method of calculating and storing the totals?

Sorry for the wall of text and thanks in advance for anyone who is willing to help me out.

",,False,self,t5_2qp8q,False,,,True,t3_1aqoru,http://www.reddit.com/r/SQL/comments/1aqoru/mysql_basic_database_design_questions/,
1363877705.0,1,self.SQL,1aqgao,Help a newbie subtract sales tax from the invoice amount,Excel__,1,0,12,http://www.reddit.com/r/SQL/comments/1aqgao/help_a_newbie_subtract_sales_tax_from_the_invoice/,"[MS SQL]

Beforehand, thanks for the help. 

I've got a spreadsheet that has a query that pulls the invoice amount from a table. This is DBO.a_invoice.totalship_amount

In another table, I have the sales tax amounts. This is DBO.a_acct_trans.cr_amount.

The connection between the two tables is between:

DBO.a_invoice.invoice_number

and

DBO.a_acct_trans.main_key

Where the main_key contains the invoice number the transaction relates to.

So in the query, which I'm just editing an existing quiery, I need to connect the key in the two tables and then select the totalship_amount, but substract the cr_amount if the keys match.

So far, I have:

INNER JOIN DBO.a_acct_trans ON DBO.a_invoice.invoice_number = DBO.a_acct_trans.main_key

SELECT DBO.a_invoice.totalship_amount - DBO.a_acct_trans.cr_amount

But I'm getting an error saying I have a syntax error near ""FROM"" and near ""DBO""

Any way you guys can hep? Thanks again.

**EDIT** Code. I apologize if it's messy. It's not my code. I'm just trying to learn how to modify it.

    SELECT DBO.a_credit_memo.credit_memo_number , DBO.a_credit_memo.date_issued , 

    -DBO.a_credit_memo.credit_amount+DBO.a_credit_memo.sales_tax_amount , 

    DBO.a_credit_memo.invoice_number, DBO.a_invoice.project_no, 

    DBO.a_invoice.job_no, DBO.a_invoice.approved, DBO.a_salesrep.name, 

    DBO.a_proj_setup_new.budget_name, DBO.a_proj_setup_new.program_name 

    FROM DBO.a_credit_memo 

    INNER JOIN DBO.a_invoice ON DBO.a_credit_memo.invoice_number = DBO.a_invoice.invoice_number 

    INNER JOIN DBO.a_proj_setup_new ON DBO.a_invoice.project_no = DBO.a_proj_setup_new.project_no 

    INNER JOIN DBO.a_salesrep ON a_proj_setup_new.sr_proj_mgr = a_salesrep.salesrep_no 

    WHERE (((DBO.a_credit_memo.date_issued)&gt;'12/31/2012') AND (DBO.a_credit_memo.date_issued)&lt;'01/01/2014')
    UNION    

    SELECT DBO.a_invoice.invoice_number , DBO.a_invoice.invoice_date , DBO.a_invoice.totalship_amount , 

    DBO.a_invoice.invoice_number, DBO.a_invoice.project_no, DBO.a_invoice.job_no, 

    DBO.a_invoice.approved, DBO.a_salesrep.name, DBO.a_proj_setup_new.budget_name,

    DBO.a_proj_setup_new.program_name   

    FROM DBO.a_invoice 

    INNER JOIN DBO.a_proj_setup_new ON DBO.a_invoice.project_no = DBO.a_proj_setup_new.project_no 

    INNER JOIN DBO.a_salesrep ON a_proj_setup_new.sr_proj_mgr = a_salesrep.salesrep_no 

    WHERE (((DBO.a_invoice.invoice_date)&gt;'12/31/2012') AND (DBO.a_invoice.invoice_date)&lt;'01/01/2014');",,False,self,t5_2qp8q,1363879401.0,,,True,t3_1aqgao,http://www.reddit.com/r/SQL/comments/1aqgao/help_a_newbie_subtract_sales_tax_from_the_invoice/,
1363191425.0,1,self.SQL,1a800n,"SQL Server 2012
",wallyflops,7,6,4,http://www.reddit.com/r/SQL/comments/1a800n/sql_server_2012/,"Anything to be wary of thinking of upgrading soon.
DB is around 700GB of important non transactional data mostly used for BI purposes.

",,False,self,t5_2qp8q,False,,,True,t3_1a800n,http://www.reddit.com/r/SQL/comments/1a800n/sql_server_2012/,
1363103323.0,1,self.SQL,1a5gz5,[MySQL] At my work we use SQL to bring up information about invoices from our server...is there any way to then mass edit information about those invoices once they are brought up or is that not possible?,aporcelaintouch,1,0,9,http://www.reddit.com/r/SQL/comments/1a5gz5/mysql_at_my_work_we_use_sql_to_bring_up/,,,False,self,t5_2qp8q,False,,,True,t3_1a5gz5,http://www.reddit.com/r/SQL/comments/1a5gz5/mysql_at_my_work_we_use_sql_to_bring_up/,
1363016290.0,1,self.SQL,1a3422,SSRS Help on Filtering [TSQL],chairdeskphone,1,0,3,http://www.reddit.com/r/SQL/comments/1a3422/ssrs_help_on_filtering_tsql/,"Is there a value in the Value field I can entered which will mean the user can select all as an option for a filter and is there a value in the Value field which can be entered which would all the user to filter for items in the column which begin with a specific letter such as “A”?  
[Example](http://postimage.org/image/imkq7nlo5/)
An example would be if there is Adam, Alex, Barbara, Candy, and Will in a column.  They could either select all or filter for names beginning with A.  
FYI I could not find a SSRS forum so if there is a better place for me to post, please let me know.


",,False,self,t5_2qp8q,False,,,True,t3_1a3422,http://www.reddit.com/r/SQL/comments/1a3422/ssrs_help_on_filtering_tsql/,
1362869014.0,1,self.SQL,19zrck,"[]MySQL]Query help, finding total hours worked.",Not_Hulk_Hogan,2,1,2,http://www.reddit.com/r/SQL/comments/19zrck/mysqlquery_help_finding_total_hours_worked/,"I have no idea what I am doing. I have a project table which includes ProjectID, EmployeeNumber, and HoursWorked. Employees work on multiple projects and I need to find out how many hours total each employee has worked. I have no idea how to do this so I don't even have starting code. I need to add the HoursWorked attribute for each unique EmployeeNumber 

Actually I just tried:

    Select  EmployeeNumber, Sum(HoursWorked) as TotalHoursWorked
    From assignment a
    Where a.EmployeeNumber = a.EmployeeNumber
    Group by a.EmployeeNumber;

and it seemingly worked? Does that make sense? I did not expect it to. ",,False,self,t5_2qp8q,1362869346.0,,,True,t3_19zrck,http://www.reddit.com/r/SQL/comments/19zrck/mysqlquery_help_finding_total_hours_worked/,
1362063677.0,1,self.SQL,19ebup,Is this Update Syntax correct - replacing nulls with 0,mmohon,2,1,7,http://www.reddit.com/r/SQL/comments/19ebup/is_this_update_syntax_correct_replacing_nulls/,"I'm doing:

Update table

Set Field1 = IsNull(Field1,0)



Or should I be doing:

Update Table1

Set Field1 = Case When IsNull(Field1) Then 0 Else Field1 End",,False,self,t5_2qp8q,False,,,True,t3_19ebup,http://www.reddit.com/r/SQL/comments/19ebup/is_this_update_syntax_correct_replacing_nulls/,
1361568204.0,1,self.SQL,191l7a,How Does Bulk Insert work - Udating vs Appending?,mmohon,1,0,3,http://www.reddit.com/r/SQL/comments/191l7a/how_does_bulk_insert_work_udating_vs_appending/,"I have 4 years of big files, 2008-2011. I get updates, but they are rolling 4 quarters, like I just got 4Q2011 through 3Q2012.  If I bulk insert my file into the table with 2011 already there, there would be over lapping records for 3 quarters.  There is a primary key.

Will the bulk insert straight into the table ""update"" where the key is already there and ""append"" when it doesn't find a key?

Or should I bulk insert into a temp table, run an update query from the temp table to the main table, then drop it?",,False,self,t5_2qp8q,False,,,True,t3_191l7a,http://www.reddit.com/r/SQL/comments/191l7a/how_does_bulk_insert_work_udating_vs_appending/,
1361553831.0,1,self.SQL,1913ox,Need help with a case statement [ms sql],tedistkrieg,1,0,5,http://www.reddit.com/r/SQL/comments/1913ox/need_help_with_a_case_statement_ms_sql/,"I have two columns MachineDescription,MachineTypeID.  Right now, the machine descriptions are all called MD-Multigame. I would like to do something like
    

    SELECT CASE WHEN MachineTypeID='5010' 
    THEN change MachineDescription to Siberian Storm 
    ELSE md-multigame

or something like that. ",,False,self,t5_2qp8q,1361554027.0,,,True,t3_1913ox,http://www.reddit.com/r/SQL/comments/1913ox/need_help_with_a_case_statement_ms_sql/,
1360244556.0,1,self.SQL,182av0,[Oracle] First function attempt. Need help with the bugs,Cat_friendly,3,2,6,http://www.reddit.com/r/SQL/comments/182av0/oracle_first_function_attempt_need_help_with_the/,"***SOLVED/FIXED*** Thanks to CubedCodeMonkey and trane_0

I found the following function to subtract number of holidays and week days between two dates. I have tried to modify it so that I can use it in Oracle but have been unable to get past the many errors. Any help would be appreciated!  I think the problem is with declaring the temp vars.  

 

    CREATE OR REPLACE Function WeekendOrHolidaysInDateRange 

    (
    pi_StartDate  IN DATE,
    pi_EndDate   IN DATE
    )
    RETURN INT
    IS v_TotalDays INT;



 
  
    v_TotalDays  INT;
    v_dayOfWeek  INT;
    v_Count  INT;
    SET v_totaldays := 0;
    BEGIN     
        
    WHILE (pi_StartDate &lt;= pi_EndDate) LOOP

        --work out what day of the week the start date is
        v_DayOfWeek := DATEPART(dw, pi_StartDate) ;
       IF (v_dayOfWeek = 6 OR v_dayOfWeek = 7) THEN --sat or sunday
            v_TotalDays:=v_TotalDays +1;
       END IF;
        
        SELECT   count(*) AS v_Count
        FROM holidays WHERE holiday_date = pi_startDate;
        
        IF (v_Count &gt;=1) THEN
            v_TotalDays := v_TotalDays +1;
        END IF;
       pi_StartDate := DateAdd(day, 1, pi_StartDate) ;
        
    END LOOP;

    RETURN v_TotalDays;
    END WeekendOrHolidaysInDateRange;
",,False,self,t5_2qp8q,1360262340.0,,,True,t3_182av0,http://www.reddit.com/r/SQL/comments/182av0/oracle_first_function_attempt_need_help_with_the/,
1360004788.0,1,self.SQL,17vq2v,Bulk Insert - Format File - issues with nulls &amp;  dbl quote text,mmohon,1,0,8,http://www.reddit.com/r/SQL/comments/17vq2v/bulk_insert_format_file_issues_with_nulls_dbl/,"I have big chunks of data I move around and process.  The file comes to me comma delimited, text qualifiers of  ' "" '  I built a corresponding format file for the bulk insert, that's a pain in the rear because I'm using SQL Express and can't use a wizard to do it.

Anyways, when the field is null it's: ,, but it can be: ,""text"",

My file goes for "","" as the field terminator, but it can be ""\"",""  is there a way that SQL can get smart and determine that? ",,False,self,t5_2qp8q,False,,,True,t3_17vq2v,http://www.reddit.com/r/SQL/comments/17vq2v/bulk_insert_format_file_issues_with_nulls_dbl/,
1359844282.0,1,self.SQL,17rx2u,Upgrade path from MCTS 70-433,carlhunt3r,2,1,3,http://www.reddit.com/r/SQL/comments/17rx2u/upgrade_path_from_mcts_70433/,"Does anyone know the SQL Server 2008 to SQL Server 2012 upgrade path for microsoft certifications? I'm about to take the 70-433 exam for the second time, hopefully successfully. I'll be wanting to upgrade my certification, but can't seem to find any info about it?",,False,self,t5_2qp8q,False,,,True,t3_17rx2u,http://www.reddit.com/r/SQL/comments/17rx2u/upgrade_path_from_mcts_70433/,
1359619127.0,1,self.SQL,17mb6j,[MySQL] Application Error ,d4rwins_chap,1,0,1,http://www.reddit.com/r/SQL/comments/17mb6j/mysql_application_error/,"Im attempting to configure a server for a game I play however when attempting to modify any values for the admin panel I receive the following error 

[Application Error](http://i.imgur.com/L7e5eTq.png)

after quick googling I find no real aide in working this issue..

if you have any questions  regarding my system please let me know


thanks",,False,self,t5_2qp8q,False,,,True,t3_17mb6j,http://www.reddit.com/r/SQL/comments/17mb6j/mysql_application_error/,
1359056539.0,1,self.SQL,177gi6,[MS SQL 2005] Help searching a value in fields with many comma delimited values,calu1986,2,1,7,http://www.reddit.com/r/SQL/comments/177gi6/ms_sql_2005_help_searching_a_value_in_fields_with/,"Field ""Account"" allows one numerical value to be stored in it.

Field ""Key"" allows many comma delimited number values (keys) to be stored in it. 

e.g. Key = 1,2,3...

I want to select an ""Account"" that has the number ""2"" in one of the values found inside ""KEY""

Kind of like 

    select top 1 Account from TABLE where Key = '2'
(I know this query will return nothing, just a reference)

Is there a query/anything that would allow me to do what I just described?


**EDIT** this is not the design of the table, it was just to illustrate what I wanted to achieve.
",,False,self,t5_2qp8q,1359063115.0,,,True,t3_177gi6,http://www.reddit.com/r/SQL/comments/177gi6/ms_sql_2005_help_searching_a_value_in_fields_with/,
1359050538.0,1,self.SQL,1778tt,"[MS SQL]Merging 2 tables, updating FKs",TL-PuLSe,1,0,2,http://www.reddit.com/r/SQL/comments/1778tt/ms_sqlmerging_2_tables_updating_fks/,"Hello /r/SQL! I need some serious help.

Due to an error, an environment was left with data in backup tables and empty copies of the tables. Meanwhile, new data populated these tables.

We're using incremental integer Id columns as the PKs.

So, we have two tables with original data, let's say:

TABLE A
-------
Id    Data  
--    ----
1      a  
2      b  
3      c  

TABLE A_BAK
-------
Id    Data  
--    ----
1      z  
2      x  
3      y  

TABLE B_BAK
-------
Id    A_BAK_FKey  
--    -----------
1      1  
2      2  
3      3  

I need to insert the data in A_BAK into A, and insert the data in B_BAK into B. However, while inserting into B i need to update the FK values to, in this example, 4, 5, and 6.

TABLE A
-------
Id    Data  
--    ----
1      a  
2      b  
3      c  
4      z  
5      x  
6      y  

TABLE B
-------
Id    A_FKey  
--     ------
1        4  
2        5  
3        6  
The two ideas I'm bouncing around are using a cursor to insert into A, get SCOPE_IDENTITY(), and insert into B. The second idea is set TRANSACTION ISOLATION LEVEL SERIALIZABLE, get the IDENT_CURRENT(A), and add that to the value of FKeys in B_BAK when inserting into B (so, FKeys = (3+1, 3+2, 3+3))

Can anyone suggest a better way? The system will be live and trying to insert into the database, so I'd like to do this quickly and safely.

Thank you!",,False,self,t5_2qp8q,False,,,True,t3_1778tt,http://www.reddit.com/r/SQL/comments/1778tt/ms_sqlmerging_2_tables_updating_fks/,
1359046441.0,1,mssqlfun.com,1773tj,Cumulative Update – 9 for SQL Server 2008 Service Pack 3 Is Now Available !,rohitga,1,0,0,http://www.reddit.com/r/SQL/comments/1773tj/cumulative_update_9_for_sql_server_2008_service/,,,False,http://d.thumbs.redditmedia.com/N_XlesLJr_RMRIy3.jpg,t5_2qp8q,False,,,False,t3_1773tj,http://mssqlfun.com/2013/01/23/cumulative-update-9-for-sql-server-2008-service-pack-3-is-now-available/,
1359034550.0,1,self.SQL,176s66,[Oracle] Constraint which tests data already in table,tk338,1,0,3,http://www.reddit.com/r/SQL/comments/176s66/oracle_constraint_which_tests_data_already_in/,"Hi, I am currently writing a set of instructions which will form the basis for a database due to be handed in for coursework. I'm new to SQL so please bear with me. Also I want to be clear I'm not asking for an answer as such but just any pointers in the right direction, I understand I've got to do and learn the work, but google renders nothing to help after several hours searching (maybe I'm typing the wrong kind of query?). Nonetheless:

The table I'm responsible for has to keep a record of meetings for clients who will be inserting values into it. 

Meetings cannot be scheduled at the same time. 

With relevance to time, the table has a meeting date (DATE), time start and time end of meeting (both 4 numerics; the first two representing hours and the second two representing minutes). We are not allowed to introduce new entities.

If say for example the table had...

m_date: 05/05/2013 
s_time: 1300
e_time: 1500

...noone should be able to enter a meeting which would start or end between 1300 and 1500 on 05/05/2013.

If anyone had any ideas as to how this could be done I would be very grateful. My pseudo code-esque solution for a table constraint was:

    IF entered_m_date = col_m_date THEN
         CHECK((entered_e_time &lt; col_s_time) OR (entered_s_time &gt; col_e_time))
    END IF

I understand this probably makes very little sense, I'm not even sure if you can put an If statement into a constraint, nor am I aware as to how you can reference one specific row of data and compare that against the entered data. 

Once again I would very much appreciate any help you guys could offer. 

Thank you.",,False,self,t5_2qp8q,False,,,True,t3_176s66,http://www.reddit.com/r/SQL/comments/176s66/oracle_constraint_which_tests_data_already_in/,
1358976483.0,1,self.SQL,175ae4,[MS SQL08 SSRS] How to properly format a column with calculated percentage value,OK_now_what,1,0,2,http://www.reddit.com/r/SQL/comments/175ae4/ms_sql08_ssrs_how_to_properly_format_a_column/,"Good afternoon all,

To summarize, I'm using SSRS to publish some reports with sales totals. One report has a column called ""SALES"" and another called ""NETCOST""

I want to calculate percentage as (sales-cost)/sales = GM%

The expression I'm using is:
=(SUM(Fields!Sales.Value)-(Fields!NetCost.Value))/(Fields!Sales.Value)

The problem is if sales is zero and cost is &gt; 0, the value comes back as ""INFINITY"" and if sales is zero AND cost is zero, the value comes back as ""NaN""

.... I'm not sure how to get rid of those with SSRS and replace them with zeros. 

I know how to do it in Excel, it would be:
=IF(A1=0,0(A1-B1)/A1) but what would the SSRS expression look like?",,False,self,t5_2qp8q,False,,,True,t3_175ae4,http://www.reddit.com/r/SQL/comments/175ae4/ms_sql08_ssrs_how_to_properly_format_a_column/,
1358974361.0,1,self.SQL,1757g5,[MS SQL] Need help with query using joins,OrinMacGregor,1,0,4,http://www.reddit.com/r/SQL/comments/1757g5/ms_sql_need_help_with_query_using_joins/,"SQL isn't really my thing, so I have next to zero exposure to it. However, I'm being thrust into modifying something.

I have 2 tables, we'll call them Details and Docks. Details has the column DockID. Docks has DockID as the primary key, and a column called WarehouseID. Multiple DockIDs can have the same WarehouseID.

I need to return the results from Details where the DockIDs have the same WarehouseID as a DockID that's been provided (let's just call that @provided).

Sorry if this is a very elementary operation, but my brain is just fried right now and I can't quite wrap my head around it.",,False,self,t5_2qp8q,False,,,True,t3_1757g5,http://www.reddit.com/r/SQL/comments/1757g5/ms_sql_need_help_with_query_using_joins/,
1358373100.0,1,self.SQL,16pk10,[TSQL]-Need help with case statement construction,kingmikolaj,1,0,2,http://www.reddit.com/r/SQL/comments/16pk10/tsqlneed_help_with_case_statement_construction/,"Trying to convert this portion of nested if statements into a case statement. Any help would be much appreciated :)
Here is portion of nested if:

IF @isACMJob =1   
BEGIN

IF @currentjoblength &gt; @minutelimit
BEGIN
SET @minutelimit = CAST( @minutelimit as varchar(max))
SET @subj = 'ERROR: ACM Job (AutoSearch) ran for too long'
SET @imp = 'HIGH'
SET @msg = '&lt;strong&gt;&lt;span style=""color: red""&gt;&lt;strong&gt;**Client Auto Search Job ran for ' + @minutelimit + '. Client Auto Search Job ran for too long.**&lt;/span&gt;&lt;/strong&gt;'
					
END
			
ELSE(...nested loops continue)

Here is what i have in terms of case so far:

CASE WHEN 
        @isACMJob=1 
AND(not sure if i can use and) WHEN 
        @currentjoblength&gt; @minutelimit
THEN 
SET @minutelimit = CAST( @minutelimit as varchar(max))
SET @subj = 'ERROR: ACM Job (AutoSearch) ran for too long'
SET @imp = 'HIGH'
SET @msg = '&lt;strong&gt;&lt;span style=""color: red""&gt;&lt;strong&gt;**Client Auto Search Job ran for ' + @minutelimit + '. Client Auto Search Job ran for too long.**&lt;/span&gt;&lt;/strong&gt;'",,False,self,t5_2qp8q,False,,,True,t3_16pk10,http://www.reddit.com/r/SQL/comments/16pk10/tsqlneed_help_with_case_statement_construction/,
1358269596.0,1,self.SQL,16mjpm,[MS SQL] best way to do a delete when needing to join tables?,whoisearth,2,1,4,http://www.reddit.com/r/SQL/comments/16mjpm/ms_sql_best_way_to_do_a_delete_when_needing_to/,"[RESOLVED] - my second script did work I just hadn't tested it yet.

I figured out how to do it when I'm just joining to 1 table by doing an ""ANY"" command.  ie - 

    DELETE FROM table1
    	WHERE column_id=ANY(
    	SELECT column_id FROM table2 WHERE table1.join_id = table2.join_id AND table2.fordelete_yn = 'y')

Unfortunately I'm stuck on the following - 

    DELETE FROM table3
    	WHERE column_id=ANY(SELECT column_id FROM table1
    	JOIN table2 ON (table1.join_id = table2.join_id)
    	WHERE table2.fordelete_yn = 'y')",,False,self,t5_2qp8q,1358272930.0,,,True,t3_16mjpm,http://www.reddit.com/r/SQL/comments/16mjpm/ms_sql_best_way_to_do_a_delete_when_needing_to/,
1357892941.0,1,self.SQL,16dcrm,[MS SQL] I need to group these line items so that the Values are combined. Help!,smellycooter,1,0,16,http://www.reddit.com/r/SQL/comments/16dcrm/ms_sql_i_need_to_group_these_line_items_so_that/,"So my code involves 4 tables which i have joined, table C(Customers) contains cname and custid, table O(Orders) contains custid and orderid, table I(OrderItems) contains Quantity ordered orderid, and partid, and table V(Inventory) contains Price and partid. from that I started here:

    SELECT CAST(C.custid AS CHAR(5)) AS ""Customer ID""
	     , CAST(C.cname AS CHAR(20)) AS ""Customer Name""
	     , STR(I.qty * V.price,6,2)  AS ""Total Value""

    FROM Customers AS C 
    JOIN Orders AS O
    ON C.custid = O.custid
    JOIN OrderItems AS I 
    ON O.orderid  = I.orderid
    JOIN Inventory AS V
    ON I.partid = v.partid
    group by C.custid, C.cname, I.qty, V.price

the results are:

    Customer ID Customer Name        Total Value
    ----------- -------------------- -----------
    1           Stanwood Consulting   80.00
    1           Stanwood Consulting    7.50
    1           Stanwood Consulting   22.50
    1           Stanwood Consulting   75.00
    1           Stanwood Consulting  210.00
    2           Vallecito Industries  10.00
    2           Vallecito Industries  12.50

 and so on

I need these grouped in single totals per customer, moreover The Customer with the highest purchase needs to be shown only. but i'll start with grouping. Any ideas?",,False,self,t5_2qp8q,1357893144.0,,,True,t3_16dcrm,http://www.reddit.com/r/SQL/comments/16dcrm/ms_sql_i_need_to_group_these_line_items_so_that/,
1357873408.0,1,ledgersmbdev.blogspot.com,16cubt,Perspectives on LedgerSMB: An awesome one-liner for PostgreSQL,einhverfr,1,0,0,http://www.reddit.com/r/SQL/comments/16cubt/perspectives_on_ledgersmb_an_awesome_oneliner_for/,,,False,default,t5_2qp8q,False,,,False,t3_16cubt,http://ledgersmbdev.blogspot.com/2013/01/an-awesome-one-liner-for-postgresql.html,
1357659757.0,1,self.SQL,166qxe,[Oracle] A question about declaring columns as number,just_dig_in,1,0,4,http://www.reddit.com/r/SQL/comments/166qxe/oracle_a_question_about_declaring_columns_as/,"I have searched this subreddit and googled the internet at large and have not found an answer to this.

Which would be the best way to build a table with an id column?

create table mytable1 (
  mytable1_id number);

create table mytable2 (
  mytable2_id number(p, 0); --where p is a predetermined precision

I have seen  both examples and have not found an indication of which would be preferred.

It seems to me a benefit of #1 would be no artificial upper bound. Whereas a benefit to #2 is a known upper bound. Is that correct? Are there any other benefits or reasons why one method would be preferred over the other?

thanks for your time!
",,False,self,t5_2qp8q,False,,,True,t3_166qxe,http://www.reddit.com/r/SQL/comments/166qxe/oracle_a_question_about_declaring_columns_as/,
1356540605.0,1,self.SQL,15h1ek,[Oracle] to [MS SQL] table synchronization,devilized,2,1,4,http://www.reddit.com/r/SQL/comments/15h1ek/oracle_to_ms_sql_table_synchronization/,"I have a MS SQL database (run by someone else) that contains data that I need to import into my own Oracle database. The table in question contains a few hundred-thousand rows, and will need to be synchronized daily. I anticipate the actual number of changes to be in the 1000-2000 rows per day. It's not just an easy ""select from mssql"" and ""insert into oracle"" as the Oracle database will have some foreign keys that would need to be resolved. I also need to keep track of the changes that are made during each sync job. 

A couple of ideas I had were:

-Create a temporary table in Oracle to store the data from MSSQL, and create a stored procedure to do the synchronization and return the changes. 

-Use a synchronization script to grab all of the data from MS SQL and use already-written PHP functions to verify/update the data row by row. I imagine this would probably take a long time and a bunch of memory. 

Any other ideas, or does anyone feel strongly about the two options I've thought of?

Thanks in advance for any advice. ",,False,self,t5_2qp8q,False,,,True,t3_15h1ek,http://www.reddit.com/r/SQL/comments/15h1ek/oracle_to_ms_sql_table_synchronization/,
1355501496.0,1,self.SQL,14uilm,Somebody please help me with my SQL extra credit assignment,Jboi23,3,2,5,http://www.reddit.com/r/SQL/comments/14uilm/somebody_please_help_me_with_my_sql_extra_credit/,"I am taking a intro to database course and even though we haven't gotten far in covering SQL my professor assigned a extra credit sql project. Im having some trouble answering some of the questions and wanted to see if this subreddit could help a brother out. 

Consider the following relational database:

branch(branch name, branch city, assets)
customer(customer id, customer name, customer street, customer city)
account(account number, branch name, balance)
depositor(customer id, account number)

1.	 Identify an appropriate primary key for each relation schema. 

**the customer id and account number form the primary key**


2.	 Identify all of the foreign keys. (5%

**Branch Name**


 
3 Give an SQL data definition of the above database (i.e., write SQL commands that create tables). Integrity constraints must be included in the data definition. (20%)
 
4.	 Find the names of all depositors who have an account with a balance greater than $6,000. (10%)

5.	 Find the account numbers of all joint accounts (i.e., accounts owned by at least two customers). (10%


6.	 Find the identifiers of all customers who do not own any account (assume that customer information is kept even if customers close accounts, and account information is removed when accounts are closed). (10%


7.	 Find the identifiers of all depositors who have an account with a higher balance than any account (i.e., all accounts) in the 'Albany' branch. (10%)

8.	 Find the identifiers of all depositors who have accounts at all branches in the city of 'Albany'. (10%)

9. Update the balance of each account as follows. If the balance of an account is less than $100,000, increase the balance by 2 percent. Otherwise, increase the balance by 1 percent. (10%)
Find the names of all customers who do not have any account (








",,False,self,t5_2qp8q,1355503857.0,,,True,t3_14uilm,http://www.reddit.com/r/SQL/comments/14uilm/somebody_please_help_me_with_my_sql_extra_credit/,
1355242652.0,1,self.SQL,14o4qm,[Oracle] Need a second set of eyes - ORA-00936: missing expression during update,rbartlejr,2,1,15,http://www.reddit.com/r/SQL/comments/14o4qm/oracle_need_a_second_set_of_eyes_ora00936_missing/,"I'm attempting to update a field with selects from another table and concatenations. It's erroring on the first select but when I cut and select that single select it works ok. I'm fairly new to Oracle and could use a little help. Here is the update with the error:

    UPDATE
      SA_ASSET
    SET
      ASSET_DESC = TRIM(ATTRIBUTE1)
      || ' - Service Type: PW, Manf: '
      || TRIM
      (
        SELECT
          d.ATTRIBUTE_VALUE
        FROM
          SA_SPECIFICATION_DETAILS d,
          SA_ASSET a
        WHERE
          d.SPECIFICATION_NO = a.SPECIFICATION_NO
        AND d.ATTRIBUTE_DESC = 'MANUFACTURER'
      )
      || ', Model: '
      || TRIM
      (
        SELECT
          ATTRIBUTE_VALUE
        FROM
          SA_SPECIFICATION_DETAILS d,
          SA_ASSET a
        WHERE
          d.SPECIFICATION_NO = a.SPECIFICATION_NO
        AND ATTRIBUTE_DESC   = 'MODEL'
      )
      || ', Main Valve Size: '
      || TRIM
      (
        SELECT
           ATTRIBUTE_VALUE
        FROM
          SA_SPECIFICATION_DETAILS d,
          SA_ASSET a
        WHERE
          d.SPECIFICATION_NO = a.SPECIFICATION_NO
        AND ATTRIBUTE_DESC   = 'MAIN VALVE SIZE'
      )
      || ', Year Manf: '
      || TRIM
      (
        SELECT
          ATTRIBUTE_VALUE
        FROM
          SA_SPECIFICATION_DETAILS d,
          SA_ASSET a
        WHERE
          d.SPECIFICATION_NO = a.SPECIFICATION_NO
        AND ATTRIBUTE_DESC   = 'YEAR MANUFACTURED'
      )
      || ', Location: '
      || TRIM(SA_ASSET.STREET_NUMBER_CHAR)
      || ' '
      || TRIM(SA_ASSET.STREET_NAME)
    WHERE
      ASSET_TYPE     = 'HYDRANT'
    AND ASSET_STATUS = 'ACTIVE'
    AND UPPER(ASSET_DESC) NOT LIKE '%LOCATION:%'
    AND UPPER(ASSET_DESC) NOT LIKE '%HYDRANT%'
    AND SA_ASSET.ASSET_ID = '006130'

Error at Command Line:8 Column:5
Error report:
SQL Error: ORA-00936: missing expression
00936. 00000 -  ""missing expression""
*Cause:    
*Action:
    ",,False,self,t5_2qp8q,False,,,True,t3_14o4qm,http://www.reddit.com/r/SQL/comments/14o4qm/oracle_need_a_second_set_of_eyes_ora00936_missing/,
1355165928.0,1,self.SQL,14m8hh,[MS SQL 2005] Update Temporary Table (Column of NULL) With Row Numbers,softball753,2,1,1,http://www.reddit.com/r/SQL/comments/14m8hh/ms_sql_2005_update_temporary_table_column_of_null/,"/SQL, this is something I've been trying to do that I cannot seem to properly do. I think this should be a very basic operation yet every solution I try on my own or from my Google search produces query errors.

Essentially, I have a table object, with 3 columns. Column 3 is the pertinent data, column 2 is an identity(1,1) column, and column 1 is NULL from the get go.

I perform an operation that inserts data into column 3, column 2 is updated with integers automatically, and column 1 is left blank. I then perform operations that may or may not remove some rows from temp table. What I need to do at this point is update column 1, which was NULLs up until this point, with integer row numbers.

To put is visually, I have this

    NewID       OldID (iden)      Data
    NULL        1                 Data-A
    NULL        2                 Data-B
    NULL        3                 Data-C
    NULL        4                 Data-D
    NULL        5                 Data-E
    NULL        6                 Data-F
    NULL        7                 Data-G
    NULL        8                 Data-H

I filter the data and get this:

    NewID       OldID (iden)      Data
    NULL        1                 Data-A
    NULL        2                 Data-B
    NULL        3                 Data-C
    NULL        5                 Data-E
    NULL        7                 Data-G
    NULL        8                 Data-H

This is easy. What I want is to update the table to get this:

    NewID       OldID (iden)      Data
    1           1                 Data-A
    2           2                 Data-B
    3           3                 Data-C
    4           5                 Data-E
    5           7                 Data-G
    6           8                 Data-H

I've tried all manner up updating the field using an self-JOIN and the ROW_NUMBER() function. But I can't seem to get it to work. Any advice on this? The only thing I can think of now is to create a second table, insert the data from this table setting column 1 as an identity(1,1) field in the second table. The data I'll be working with is relatively small and this would be doable, but it seems sloppy. I feel like I should be able in update the table from ""within.""

Thanks in advance for any help.",,False,self,t5_2qp8q,False,,,True,t3_14m8hh,http://www.reddit.com/r/SQL/comments/14m8hh/ms_sql_2005_update_temporary_table_column_of_null/,
1354899517.0,1,self.SQL,14g8ww,Help with REA diagram ,rembomart,1,0,1,http://www.reddit.com/r/SQL/comments/14g8ww/help_with_rea_diagram/,"In given situation im having a hard time pining down events, resources, and agents.

Hart Supply Company is a wholesaler of plumbing supplies products that sells to construction companies. It carries an inventory of approximately 7,500 items. Customers place orders by phone and buy on credit through a line-of-credit arrangement with Hart Supply. A typical transaction involves the customer first contacting the customer services department to check the price and availability of the needed item or items. Sometimes the customer ends up talking with several customer service clerks, depending upon the quantity and types of items he or she is seeking. If the customer decides to buy, he or she is transferred to a sales agent, who takes the order. The fulfillment clerk picks the items in the order and packs them together in preparation for delivery. Orders are sometimes delivered in multiple shipments. Once the ordered items are loaded onto the truck, the billing clerk records the sale in the sales journal, prepares an invoice, and sends it to the customer, who is given 30 days to make payment. In order to reduce accounting errors, Hart Supply’s business policy only allows a check to be applied to one invoice. In other words, customers are not allowed to write a single check to pay off multiple invoices.  The AR clerk also receives a copy of the invoice and records it in the AR ledger. Subsequently (within 30 days), the customer sends a check and the remittance advice to Hart Supply. The cash receipts clerk receives the check, records it in the cash receipts journal, and updates the cash account. The remittance advice goes to the AR clerk, who updates (reduces) the customer’s account receivable. ",,False,self,t5_2qp8q,False,,,True,t3_14g8ww,http://www.reddit.com/r/SQL/comments/14g8ww/help_with_rea_diagram/,
1354827102.0,1,self.SQL,14eirp,Terrible Teacher. Need a good Youtube Tutorial,gamermonk,1,0,3,http://www.reddit.com/r/SQL/comments/14eirp/terrible_teacher_need_a_good_youtube_tutorial/,"Hey guys, my teacher for SQL is absolutely terrible. She wasn't even supposed to teach the class, and it got dumped on her. The whole class is just thrown together. I would drop it, but I need it for my degree. Therefore, I am in need of a good video tutorial / set of videos for learning SQL. Suggestions?",,False,self,t5_2qp8q,False,,,True,t3_14eirp,http://www.reddit.com/r/SQL/comments/14eirp/terrible_teacher_need_a_good_youtube_tutorial/,
1354691625.0,1,self.SQL,14b949,[WeBid] Is there any documentation on the WeBid database schema?,,4,3,0,http://www.reddit.com/r/SQL/comments/14b949/webid_is_there_any_documentation_on_the_webid/,My organization is looking to modify WeBid. We'd hate to write the documentation ourselves. (posted in both PHP and SQL),,False,self,t5_2qp8q,False,,,True,t3_14b949,http://www.reddit.com/r/SQL/comments/14b949/webid_is_there_any_documentation_on_the_webid/,
1354626212.0,1,self.SQL,149daf,[Oracle] Count rows from query,Garix,3,2,8,http://www.reddit.com/r/SQL/comments/149daf/oracle_count_rows_from_query/,"    select patient_t.firstname, patient_t.lastname, carecenter_t.carecentername
      from patient_t, carecenter_t, bed_t
        where bed_t.bednumber=patient_t.bednumber
    and carecenter_t.carecentername='Emergency Center';

I have this query that returns a list of all patients that have been to ""Emergency Center"". How do I count those results?",,False,self,t5_2qp8q,False,,,True,t3_149daf,http://www.reddit.com/r/SQL/comments/149daf/oracle_count_rows_from_query/,
1354556210.0,1,self.SQL,147jii,Any recommendations for some Fuzzy Match software,borensoren,1,0,0,http://www.reddit.com/r/SQL/comments/147jii/any_recommendations_for_some_fuzzy_match_software/,"So I recently lucked into a promotion, I'm going from teleservice to running some basic Oracle queries.  The big issue we have right off the bat is with the software we've been using(Pervasive Software's NameSearch) in house to run some fuzzy matches won't allow us to transfer the licence from one profile to the next on the same machine.  

Our DBA here is of the mindset to want to ditch it all together and suggested I look into some other options...so y'all have any other options?",,False,self,t5_2qp8q,False,,,True,t3_147jii,http://www.reddit.com/r/SQL/comments/147jii/any_recommendations_for_some_fuzzy_match_software/,
1353712465.0,1,self.SQL,13osu0,"I need help writing a ""divide"" query in Access",percautio,1,0,8,http://www.reddit.com/r/SQL/comments/13osu0/i_need_help_writing_a_divide_query_in_access/,"I'm taking my first course on info mgmt systems and am working on the final project - designing a student housing database using Microsoft Access.

Currently I'm having trouble designing a particular query. The relevant tables are UTILITY (only one column, ""Utility,"" which contains several utilities that a house/apartment might offer), PROPERTY_UTILITY (a gerund between a property and its offered utilities, with the columns ""PropertyID"" and ""Utility""), and USER_UTILITY (gerund between a user and their preferred utilities, with the columns ""Username"" and ""Utility"").

What I want to do with this query is show a list matching users to properties based on the utilities. In order to match, ALL of a user's preferred utilities MUST be offered by a particular property, but NOT all of a property's utilities must be requested by the user. (So if it were a Venn Diagram, there would be a smaller circle called ""user utilities"" that is enclosed entirely in a larger circle called ""property utilities."") So the query should list every match between each user and any house that fits them.

I haven't been able to figure it out. When I asked my professor about it, he said it called for something called a divide, but that Access can't do those, so I have to work around it by doing something involving counts (I didn't quite follow what he was talking about and won't have a chance to ask again until next week).

I'm not sure I explained this very well (and if not I'll do my best to clarify), but if anyone has any ideas or solutions that might help me out I'd be really grateful!

**Tl;dr**: How do you approximate a ""divide"" in Microsoft Access?",,False,self,t5_2qp8q,False,,,True,t3_13osu0,http://www.reddit.com/r/SQL/comments/13osu0/i_need_help_writing_a_divide_query_in_access/,
1352926462.0,1,self.SQL,1377zm,[MS SQL] Help With Recursive Table,mannheimroll,1,0,8,http://www.reddit.com/r/SQL/comments/1377zm/ms_sql_help_with_recursive_table/,"I'm working with a conversion table which is, for lack of a better word, incomplete.  A &gt; B does not mean there is a row for B &gt; A and if B &gt; C there might not be a A &gt; C.  I think the best way to handle this is by using a recursive table based off of a mirrored table.  However, after the Anchor is set, the recursive element only returns a set based on the last row, and then the last row of that set.  This is causing it to fall into a loop while not returning a ""complete"" conversion.

This is a mimic table I've been working with where the starting unitID is 5, and I want to return 7.  There is a link between 5 and 1, and one between 1 and 7, but the statement is terminated due to it looping.
This is my first attempt at a Recursive table, so any feedback would be appreciated.  I may not be using it correctly.

Edit for spacing.

    
    create table #t(i_fk int null, u1_fk int null, u2_fk int null, u1_qty     float null, u2_qty float null)
    insert into #t values (1, 3, 5, 1, 2)
    insert into #t values (1, 2, 3, 3, 2)
    insert into #t values (1, 5, 2, 5, 3)
    insert into #t values (1, 7, 1, 3, 2)
    insert into #t values (1, 1, 5, 1, 5)
    insert into #t values (1, 6, 5, 1, 2)
    insert into #t values (1, 4, 5, 3, 2)
    insert into #t values (1, 2, 4, 4, 3)
    insert into #t values (1, 6, 2, 7, 2)

    insert into #t(i_fk, u1_fk, u2_fk, u1_qty, u2_qty)
       	(select i_fk, 
    			u2_fk, 
    			u1_fk, 
    			u2_qty, 
    			u1_qty 
    	from #t)
    
    ;with #cte(i_fk, u1_fk, u2_fk, MultFact, lvl)
    as

    (select i_fk, 
    		u1_fk, 
    		u2_fk, 
    		u2_qty/u1_qty,
    		0
    From #t
    where u1_fk = 5

    UNION ALL

    select c.i_fk,
    		c.u1_fk,
    		t.u2_fk,
    		c.MultFact * (t.u2_qty/t.u1_qty),
    		c.lvl+1
    From #cte as c
    join #t as t ON c.u2_fk = t.u1_fk 
    )

    select top 1 * from #cte
    where #cte.u2_fk = 7

    drop table #t",,False,self,t5_2qp8q,False,,,True,t3_1377zm,http://www.reddit.com/r/SQL/comments/1377zm/ms_sql_help_with_recursive_table/,
1352861313.0,1,self.SQL,135rv8,Embedded Select statements within Functions?,firearmed,1,0,8,http://www.reddit.com/r/SQL/comments/135rv8/embedded_select_statements_within_functions/,"Hi all, I'm working on an assignment for my SQL course and have a quick question:

I have three tables: Movies, Sales, and Orders.
The Movies table keeps track of the movies on sale at a video store. Each record consists of a MovieID, format (DVD or VHS), title, genre, and price.

The Orders table keeps track of orders made by customers. The table consists of an OrderID, CustomerID, dateStamp, and the shipping address.

The Sales table is the link between the two and consists of OrderID, MovieID, and the quantity of copies of each movie in that specific sale. Naturally, an order can be composed of several sales.

I've been asked to find the average number of DVDs sold per order. The only way I can think to do this with my current model is to take the average quantity per order, which, if I'm not mistaken, requires a nested select statement within the AVG function. Does the following snippet of SQL make sense?

SELECT AVG
	(
		(SELECT SUM(sales.quantity) 
		 FROM sales, orders, movies
		 WHERE sales.orderID = orders.orderID
		       AND movies.movieID = sales.movieID
		       AND movies.genre = ‘DVD’
		 GROUP BY orders.orderID)
	) AS ‘Average DVD Sales per Order’
FROM sales, orders
WHERE ...

Thanks!
",,False,self,t5_2qp8q,False,,,True,t3_135rv8,http://www.reddit.com/r/SQL/comments/135rv8/embedded_select_statements_within_functions/,
1352279174.0,1,firebirdsql.org,12sf8z,Firebird 2.5.2 sub-release is available with many bugfixes,mariuz,3,2,0,http://www.reddit.com/r/SQL/comments/12sf8z/firebird_252_subrelease_is_available_with_many/,,,False,http://c.thumbs.redditmedia.com/XJVDAgklid6hNnq2.jpg,t5_2qp8q,False,,,False,t3_12sf8z,http://www.firebirdsql.org/en/news/firebird-2-5-2-sub-release-is-available-18914/,
1351992211.0,1,self.SQL,12lbdu,"Hi. The supervisor at my job says i should master that  ""SQL stuff"" so we can have a better grip on those websites we create with Joomla! - Any tips on where i should begin, good tutorials etc...? ",freefrompress,3,2,6,http://www.reddit.com/r/SQL/comments/12lbdu/hi_the_supervisor_at_my_job_says_i_should_master/,,,False,self,t5_2qp8q,False,,,True,t3_12lbdu,http://www.reddit.com/r/SQL/comments/12lbdu/hi_the_supervisor_at_my_job_says_i_should_master/,
1351683348.0,1,sqlite.awardspace.info,12e6no,SQLite - String Manipulation,myururdurmaz,2,1,0,http://www.reddit.com/r/SQL/comments/12e6no/sqlite_string_manipulation/,,,False,default,t5_2qp8q,False,,,False,t3_12e6no,http://sqlite.awardspace.info/syntax/sqlitepg08.htm,
1351285782.0,1,self.SQL,1256zm,[SQL Server] SSRS Parameter doesn't display even though the query works,BelgoCanadian,1,0,6,http://www.reddit.com/r/SQL/comments/1256zm/sql_server_ssrs_parameter_doesnt_display_even/,"I have a query to fill a report parameter:

    select distinct [Source No_] from _report_sales_master
    where [Industry] = @Industries
    and [posting date] &gt;= dateadd(year,datediff(year,'01/06/2000',@year)-1,'01/06/2000') 
    and  [posting date] &lt; dateadd(year,datediff(year,'01/06/2000',@year),'01/06/2000')
    order by [Source No_]

The query results in a list that I use to fill a multi-value report parameter.

When I run the query, it generates the right results.

When I run the report, the ""Source No_"" parameter stays empty, no matter which @year or @industries i choose

When I remove the ""posting date"" clauses from the query, the parameter list populates and works properly.

What am I missing?",,False,self,t5_2qp8q,False,,,True,t3_1256zm,http://www.reddit.com/r/SQL/comments/1256zm/sql_server_ssrs_parameter_doesnt_display_even/,
1350593667.0,1,self.SQL,11pkhn,Can someone walk me through Transactions?,larg3-p3nis,4,3,8,http://www.reddit.com/r/SQL/comments/11pkhn/can_someone_walk_me_through_transactions/,"I looked at Transactions for the past few days and while I grasp the theory I'm having problems finding details on the implementation. For example the code below does not work as planned:

    START TRANSACTION;
    DELETE FROM PART WHERE Part_Code ='F';
    DELETE FROM PART WHERE Part_Code ='P';
    COMMIT; 

Even though the Part_Code 'P' does not exist the transaction will still be committed. My understanding is that the COMMIT command should be encapsulated in some conditional logic. So my question is how do I do that? 
",,False,self,t5_2qp8q,False,,,True,t3_11pkhn,http://www.reddit.com/r/SQL/comments/11pkhn/can_someone_walk_me_through_transactions/,
1350337979.0,1,petri.co.il,11j8kt,How to Connect CentOS Web Server to a SQL Server,Petri_IT,1,0,0,http://www.reddit.com/r/SQL/comments/11j8kt/how_to_connect_centos_web_server_to_a_sql_server/,,,False,http://e.thumbs.redditmedia.com/M2gzFNNDj4iR95lF.jpg,t5_2qp8q,False,,,False,t3_11j8kt,http://www.petri.co.il/how-to-connect-centos-web-server-to-a-sql-server.htm,
1350000854.0,1,self.SQL,11c7vb,[MS-SQL] Any MS-SQL alternative for Netmask datatype from Postgresql?,saaadfaaace,2,1,2,http://www.reddit.com/r/SQL/comments/11c7vb/mssql_any_mssql_alternative_for_netmask_datatype/,"My shop supports My-SQL, Oracle, and MS-SQL Enterprise. A developer refuses to use another language unless I can come up with a suitable datatype comparable to netmask in postgresql. Any ideas/links?",,False,self,t5_2qp8q,False,,,True,t3_11c7vb,http://www.reddit.com/r/SQL/comments/11c7vb/mssql_any_mssql_alternative_for_netmask_datatype/,
1349990411.0,1,self.SQL,11bwvu,Learning SQL,Wtgamerz,2,1,2,http://www.reddit.com/r/SQL/comments/11bwvu/learning_sql/,"I'm trying to make a transition from teaching to something within the IT world, and friends have recommended being a database manager or someone who can be versed in SQL. 

I'm pretty knowledgeable with computers and most basic to intermediate programs within windows, including building pc's, maintenance, etc. I took mainly comp sci courses in college before deciding to teach history/graphics design(photoshop). 

My real question is, what's the best way to go about learning sql and gauging what I will need to learn, or be aware of about being a db manager or an SQL knowledgable professional in the future? ",,False,self,t5_2qp8q,False,,,True,t3_11bwvu,http://www.reddit.com/r/SQL/comments/11bwvu/learning_sql/,
1349388712.0,1,self.SQL,10yl07,[Oracle] - How could I update the comment headers in objects with the build number during automated deploy from Hudson?,just_dig_in,1,0,4,http://www.reddit.com/r/SQL/comments/10yl07/oracle_how_could_i_update_the_comment_headers_in/,"As a result of botched deploy and a 14 hour bailout operation this weekend, I am looking for a method of updating a comment header with the build number of an automated deploy to confirm the version deployed is the one expected. I know I have seen something like this at my last job, but I was so far removed from it that I never saw the mechanism that did it.

I am contacting old colleagues also, but I figured the community here would save me. 

thanks!",,False,self,t5_2qp8q,False,,,True,t3_10yl07,http://www.reddit.com/r/SQL/comments/10yl07/oracle_how_could_i_update_the_comment_headers_in/,
1349358443.0,1,self.SQL,10xo53,[MSSQL] A question about use of XML schemas,taeratrin,1,0,1,http://www.reddit.com/r/SQL/comments/10xo53/mssql_a_question_about_use_of_xml_schemas/,"OK, here's what I have:

1) A MSSQL database and working knowledge to pull the required data out of it.

2) A XSD file with several one-to-many relationships.

Here is what I don't have:

A working knowledge of XML.

Here's what I need:

A XML file populated with data from the database formatted according to the XSD.

My question: Is there an easy way to do this?",,False,self,t5_2qp8q,False,,,True,t3_10xo53,http://www.reddit.com/r/SQL/comments/10xo53/mssql_a_question_about_use_of_xml_schemas/,
1349200166.0,1,self.SQL,10ts19,[MS SQL] Is it possible to create a cursor where one of the where criteria is based on local variable?,GoingHome,1,0,16,http://www.reddit.com/r/SQL/comments/10ts19/ms_sql_is_it_possible_to_create_a_cursor_where/,"If I declare first cursor as Select A1 from T1; and second cursor as Select col1, col2 from T2 where A1 = @A1 where @A1 is data fetched from first cursor.

I'm getting Fetch_status of -1 on the fetch to the second cursor. What's the best way to go about it? See example code in comment.",,False,self,t5_2qp8q,1349200645.0,,,True,t3_10ts19,http://www.reddit.com/r/SQL/comments/10ts19/ms_sql_is_it_possible_to_create_a_cursor_where/,
1349055263.0,1,self.SQL,10qlvt,[MySql] Grouping two AVG as one field? ,omegawoot,2,1,9,http://www.reddit.com/r/SQL/comments/10qlvt/mysql_grouping_two_avg_as_one_field/,"This is an example from an old homework which my professor never explained the answer to. How would one make two columns using calculated values? 

Like this:




* Display average income per-book for all award-winning books and the average income perbook for all non-award-winning books as a two-row result like this (yes and no are literals, $$$
$ replaced with values).

awardWinning | perBookIncome

___  | _____


yes         |         $$$$$


no   |  $$$$$

(Can't get the lines straight) *AwardWinning is when the book's ISBN appears in the awards category*

**EDIT. SCHEMA:**

____
     CREATE TABLE book( isbn CHAR(13) UNIQUE NOT NULL, title CHAR(50), publisher CHAR(30), category CHAR(20), price DECIMAL(5,2), unitssold INTEGER );
     CREATE TABLE author( isbn CHAR(13), name CHAR(30), city CHAR(15), state CHAR(2) );
     CREATE TABLE sale( isbn CHAR(13), state CHAR(2), unitssold INTEGER );
     CREATE TABLE award( isbn CHAR(13), prize CHAR(10) );",,False,self,t5_2qp8q,1349072789.0,,,True,t3_10qlvt,http://www.reddit.com/r/SQL/comments/10qlvt/mysql_grouping_two_avg_as_one_field/,
1349044717.0,1,self.SQL,10qbsn,Very Newb Question: Change physical width of column?,Pop-Shuvit,2,1,9,http://www.reddit.com/r/SQL/comments/10qbsn/very_newb_question_change_physical_width_of_column/,"Excuse me for the beginner question, but I created a database for my company's conference contacts. The last column is NOTES which has any additional information that was provided with the contact.

This column is too narrow, and it cuts off every note to the first word.
Is this something I can fix by pressing a button within SSMS?

http://i.imgur.com/AnpLi.jpg",,False,self,t5_2qp8q,False,,,True,t3_10qbsn,http://www.reddit.com/r/SQL/comments/10qbsn/very_newb_question_change_physical_width_of_column/,
1348882356.0,1,self.SQL,10nds9,MS sql server error,anon_610,2,1,3,http://www.reddit.com/r/SQL/comments/10nds9/ms_sql_server_error/,"I recently started learning  ms sql and have no idea how to fix this error.  Although I set up sql express 2008 on my laptop, I keep getting error 53 cannot connect    on my PC.  To give you some info I am running vista sp2 on an amd athlon based system. Any ideas on what the problem may be? ",,False,self,t5_2qp8q,False,,,True,t3_10nds9,http://www.reddit.com/r/SQL/comments/10nds9/ms_sql_server_error/,
1348784834.0,1,self.SQL,10l5ls,What is the best way to go about creating a script which switches between databases that are on the same server in SSMS [T-SQL]?  ,,1,0,12,http://www.reddit.com/r/SQL/comments/10l5ls/what_is_the_best_way_to_go_about_creating_a/,,,False,self,t5_2qp8q,False,,,True,t3_10l5ls,http://www.reddit.com/r/SQL/comments/10l5ls/what_is_the_best_way_to_go_about_creating_a/,
1348239865.0,1,self.SQL,10910b,Opening a portion of a massive table in Access for querying,Deanicus,2,1,3,http://www.reddit.com/r/SQL/comments/10910b/opening_a_portion_of_a_massive_table_in_access/,"I'm trying to open a massive data acquisition table off of our company server that's much too large to open the entire file, I have timestamp values but am having trouble finding a way to run a selection query to limit the size of the table to simply view it.  I'm pretty new to Access and have been trying to use the Query Design to accomplish this.",,False,self,t5_2qp8q,False,,,True,t3_10910b,http://www.reddit.com/r/SQL/comments/10910b/opening_a_portion_of_a_massive_table_in_access/,
1347488146.0,1,self.SQL,zsfkx,[MS SQL] Syncing Two MS SQL Servers,CaptainKirk0000,3,2,4,http://www.reddit.com/r/SQL/comments/zsfkx/ms_sql_syncing_two_ms_sql_servers/,"I have an somewhat elaborate SQL problem that I could really use some help with. I am an electrical engineer, but I feel like I can work my way around SQL Server somewhat decently.

We use a certain engineering program that stores files in a network file folder, and uses SQL Server to store a significant amount of metadata about those files in several databases.  The number of databases increases every day each time a new ""Project"" is created within the software. Almost every action a user takes within the software makes a call to the SQL server, so network latency is paramount.

Here is the problem, we have two locations using this server that are 800 miles about. The user experience goes to crap when communicating with an SQL server that far away. Therefore, each location has its own SQL Server instance. Of course this then cause both locations to have different data. I would like the SQL servers to sync bidirectionally in the background after an action is taken, so that it appears as if they are operating as one. Neither server should have priority, and the newest info should win. The engineering software itself cannot be changed, everything must happen on the server.

Any pointers on where to go with this? Bonus points if you can help me sync the file data as well.",,False,self,t5_2qp8q,False,,,True,t3_zsfkx,http://www.reddit.com/r/SQL/comments/zsfkx/ms_sql_syncing_two_ms_sql_servers/,
1346961509.0,1,self.SQL,zgryo,[MS SQL] Multiple Snapshot Help,Javadocs,1,0,0,http://www.reddit.com/r/SQL/comments/zgryo/ms_sql_multiple_snapshot_help/,"So, I got the job to set up a snapshot replication process to update data from our production server to our dev server, and I just want to make sure I don't screw up anything too bad. We have ~30 databases on our production server, the average size being about 5-6GB, and the biggest database being 25GB. We'll be using pull subscriptions and will be running this at the early hours of the morning (only weekdays, though we might make it weekly depending on a few other factors).

My questions are the following:

* How long do the snapshot files take to initialize? How far apart should I space the initialization of the snapshot files?
* Which takes longer, initializing the snapshot or doing the pull from the subscribing server? (snapshot folder will be located on the DEV machine)
* Depending on the size of each database, how far apart should I space the pull subscriptions?
* Is it pretty much safe to pull data while initializing a snapshot? (for a different database, of course)

Let me know if you need any more details! Thanks in advance!",,False,self,t5_2qp8q,False,,,True,t3_zgryo,http://www.reddit.com/r/SQL/comments/zgryo/ms_sql_multiple_snapshot_help/,
1346930418.0,1,self.SQL,zg0qm,Is it possible to include and sql compact database in an executable windows form without having to install it?,awalkingabortion,1,0,4,http://www.reddit.com/r/SQL/comments/zg0qm/is_it_possible_to_include_and_sql_compact/,"Hi all, I'm building a simple windows form with a compact SQL - Is there any way to have this as a portable .exe without the need for an install? If so, how? Many thanks",,False,self,t5_2qp8q,False,,,True,t3_zg0qm,http://www.reddit.com/r/SQL/comments/zg0qm/is_it_possible_to_include_and_sql_compact/,
1346277618.0,1,self.SQL,z1jpb,Best equivalent to Access in open source software (specifically for Ubuntu)?,rhino0010,4,3,32,http://www.reddit.com/r/SQL/comments/z1jpb/best_equivalent_to_access_in_open_source_software/,"I'm starting a class in database design and development, and need software that functions like Access solely for a few class assignments. I'm using an Ubuntu 12.04 LTS desktop environment. I have attempted installing MySQL and have not met with any success (it's an .rpm file). So...long story short, I need some advice on installing MySQL (best way to get the software or best alternative), and some options for an alternative to Access. Any ideas?",,False,self,t5_2qp8q,False,,,True,t3_z1jpb,http://www.reddit.com/r/SQL/comments/z1jpb/best_equivalent_to_access_in_open_source_software/,
1346157796.0,1,ledgersmbdev.blogspot.com,yyihs,PostgreSQL Table Inheritance w/o primary/foreign Key Problems,einhverfr,1,0,0,http://www.reddit.com/r/SQL/comments/yyihs/postgresql_table_inheritance_wo_primaryforeign/,,,False,default,t5_2qp8q,False,,,False,t3_yyihs,http://ledgersmbdev.blogspot.com/2012/08/postgresql-or-modelling-part-3-table.html,
1346112704.0,1,self.SQL,yxlcw,[MySQL]How best to store and index similar phrases?,WiglyWorm,1,0,3,http://www.reddit.com/r/SQL/comments/yxlcw/mysqlhow_best_to_store_and_index_similar_phrases/,"Let's say I want to store an item in my database like ""visit Spain"". However, I'm going to allow user submissions, and I'd like to keep track of all the users who wish to visit Spain, however I'd like them to be able to type ""Visit Spain"" as well as ""Go to Spain"", ""See Spain"", or ""tour spain"".

I am looking for an efficient way to do this. Currently my thinking has me going along these lines (simplified):

* Nouns
 * uniqueId
 * noun
 * verb [fk]

* Verbs
 * uniqueId
 * verb

* synonyms
 * uniqueId
 * verb [fk]
 * synonym


Am I off base, or is this the best way to be going about it? I'm looking for both performance and ease of maintenance...

Edit: Apparently I don't know how to make tables...",,False,self,t5_2qp8q,1346112891.0,,,True,t3_yxlcw,http://www.reddit.com/r/SQL/comments/yxlcw/mysqlhow_best_to_store_and_index_similar_phrases/,
1346099018.0,1,self.SQL,yx6n8,[MS SQL] SSRS User permissions (on the server) question,ImHighCurrently,2,1,2,http://www.reddit.com/r/SQL/comments/yx6n8/ms_sql_ssrs_user_permissions_on_the_server/,"MYDOMAIN\TestUser is all setup in the SSRS permissions.

If I go into MS SQL Server Management Studio (2008 R2) | Security | Logins | and give MYDOMAIN\TestUser sysadmin permission, everything works fine

However if I remove sysadmin (even if I give him every permission other than sysadmin), the query (in SSRS) will fail to connect.

Does anyone have any idea what I'm doing wrong?

Big Huge Thank you in advance for being awesome.",,False,self,t5_2qp8q,False,,,True,t3_yx6n8,http://www.reddit.com/r/SQL/comments/yx6n8/ms_sql_ssrs_user_permissions_on_the_server/,
1345651027.0,1,ledgersmbdev.blogspot.com,yn5do,Intro to PostgreSQL as Object-Relational Database Management System (x-post from PostgreSQL),einhverfr,1,0,1,http://www.reddit.com/r/SQL/comments/yn5do/intro_to_postgresql_as_objectrelational_database/,,,False,default,t5_2qp8q,False,,,False,t3_yn5do,http://ledgersmbdev.blogspot.com/2012/08/intro-to-postgresql-as-object.html,
1345632870.0,1,reddit.com,ymrcq,"[xpost from MySQL] - new to this, need some help please!",reel_big_ad,1,0,0,http://www.reddit.com/r/SQL/comments/ymrcq/xpost_from_mysql_new_to_this_need_some_help_please/,,,False,default,t5_2qp8q,False,,,False,t3_ymrcq,http://www.reddit.com/r/mysql/comments/ymq64/help_needed/,
1345565969.0,1,self.SQL,yl41m,[MS SQL] DATEADD() Help,Devel89,2,1,5,http://www.reddit.com/r/SQL/comments/yl41m/ms_sql_dateadd_help/,"I have a website where we allow people to sign up for jobs on a certain date. We're using a dropdown list to display the next few upcoming dates and right now we enter all the dates by hand. The dates are just the upcoming Sundays of the month/year. We are wanting to use dateadd() to select the next few sundays for us so, they don't have to be entered by hand. Could anyone provide some help on how to do this?",,False,self,t5_2qp8q,False,,,True,t3_yl41m,http://www.reddit.com/r/SQL/comments/yl41m/ms_sql_dateadd_help/,
1345198814.0,1,self.SQL,ydcsm,"Guarantee that ""select id &amp; insert id"" is atomic without Transaction",RMiranda,2,1,8,http://www.reddit.com/r/SQL/comments/ydcsm/guarantee_that_select_id_insert_id_is_atomic/,"SS2005, here's the code that i have to guarantee that ""select id &amp; insert id"" is atomic without Transaction:

    create procedure FOO
    	@Val varchar(50),
    	@ID bigint OUTPUT
    as
    begin
    	SET TRANSACTION ISOLATION LEVEL REPEATABLE READ;
    		Select @ID = MAX(ID)+1 from tbl
    		
    		INSERT INTO tbl (
    				[ID],
    			)
    		VALUES(	@ID,
    				@Val			
    			)
    	SET TRANSACTION ISOLATION LEVEL READ COMMITTED;
    GO

I prefer not to use a transaction because this store will be called in a major transaction, and i've been warned that nested transactions are not something to play with. 

So my question is, will the above store guarantee that no other process might insert the same id before the insert statement? and will this leave the remain statements with the default isolation level?",,False,self,t5_2qp8q,False,,,True,t3_ydcsm,http://www.reddit.com/r/SQL/comments/ydcsm/guarantee_that_select_id_insert_id_is_atomic/,
1344460365.0,1,self.SQL,xwi9i,[MS SQL] Recovery Model / Log truncation question,steezburgers,2,1,6,http://www.reddit.com/r/SQL/comments/xwi9i/ms_sql_recovery_model_log_truncation_question/,"We running MS SQL 2005.

Our backup software (Quest's NetVault FastRecover) protects our DBs in real-time via an agent that sits on the SQL server.  In order for it to properly handle snapshots the instructions for FastRecover specify that we:

* Set the Recovery Model for all DBs to 'Full'
* Disable auto-shrink
* Disable auto-truncation
* Take a full backup of the DB via MSSQLMS
* Set the 'truncation interval' on the agent

**According to their tech support all that will happen at this interval is the agent will issue a checkpoint on all the DBs.**

Problem is, Full recovery model dictates that log truncation will **ONLY** occur after a transaction log backup.  See here:
http://technet.microsoft.com/en-us/library/ms189085(v=sql.90).aspx

So even though I'll have full transaction logs with current checkpoints, the log file will never truncate and **will continue to grow**.  Their tech support's response was:

&gt; Do you have logs that are not getting truncated or something? 
We would think someone in your enviroment would have noticed by now if logs weren't getting truncated.
Normally we do realtime protection that includes the logs. 

I have been back and forth with him and he's convinced I'm wrong.  I'm not a SQL guru but the TechNet article seems pretty clear cut on the issue.   It wouldn't matter if we didn't have such insane growth in some of our DBs and such limited space on the transaction log volume, but we do.

tl;dr

I'm just looking for somebody that can confirm or deny this statement for me:

&gt; A database using the Full recovery model only truncates it's transaction logs after a log backup.


",,False,self,t5_2qp8q,False,,,True,t3_xwi9i,http://www.reddit.com/r/SQL/comments/xwi9i/ms_sql_recovery_model_log_truncation_question/,
1343768385.0,1,self.SQL,xgww1,Is it possible to port the mining models you created in SQL Server Analysis Services to SQL Server Reporting Services?,Mathlete86,1,0,1,http://www.reddit.com/r/SQL/comments/xgww1/is_it_possible_to_port_the_mining_models_you/,"I am using the Contoso Retail Database and I am trying to make a dashboard with various reports. One thing my boss would like to see on this dashboard is the actual mining model that has been used (ex. The decision tree with mining legend if the Microsoft decision trees algorithm was used) so I am wondering if there is a way to port the model from SQL Server Management Studio or SQL Server Analysis Services into Reporting Services?

Any help is greatly appreciated. Thanks.",,False,self,t5_2qp8q,False,,,True,t3_xgww1,http://www.reddit.com/r/SQL/comments/xgww1/is_it_possible_to_port_the_mining_models_you/,
1343717341.0,1,self.SQL,xfrun,[MS SQL][ORACLE] Multiple Replication 'streams',Kytro,1,0,0,http://www.reddit.com/r/SQL/comments/xfrun/ms_sqloracle_multiple_replication_streams/,"I'm attempting to do 1-way transactional replication from an Oracle 11g server to a Microsoft 2008 R2 server. 

I have this working using Microsoft's Oracle replication, but it will not let me add an additional Oracle publisher. I suspect the problem will prevent me from using a different Microsoft SQL server as well because it creates a public synonym.

My issue is there are sometimes large changes to some of the articles, and it holds up all the other articles while it plays catch up. There are a few articles I require to run separately, any ideas on how I can achieve this? ",,False,self,t5_2qp8q,False,,,True,t3_xfrun,http://www.reddit.com/r/SQL/comments/xfrun/ms_sqloracle_multiple_replication_streams/,
1343589592.0,1,self.SQL,xcp9d,[MS SQL] Random population smoothing? ,rikrokola,3,2,6,http://www.reddit.com/r/SQL/comments/xcp9d/ms_sql_random_population_smoothing/,"So I can pull a random population from a dataset, no problem. However, let’s say that I have two key characteristics to this dataset: color and unit_id. I want a population that doesn’t only have just reds, but I want the myriad of colors. Out of my first dataset, let’s say I have 55% reds, 35% blues, 14% purples and 13% blacks. I want my random population from my dataset to be a good healthy mix of colors. What do you guys think is the best way to go about this? My initial thought was a loop, but my biggest weakness is that I make things way too complex for what it is. I’m open to a lot of ideas and logic. 
",,False,self,t5_2qp8q,False,,,True,t3_xcp9d,http://www.reddit.com/r/SQL/comments/xcp9d/ms_sql_random_population_smoothing/,
1343233337.0,1,self.SQL,x4y72,"[Oracle] ""partition by"" question",Almace,1,0,1,http://www.reddit.com/r/SQL/comments/x4y72/oracle_partition_by_question/,"Basically, I have a query that looks something like this:

    select DATA_ID,
           DATA_GROUP,
           row_number() over ( partition by DATA_ID order by rownum ) GROUP_ID,
           DATA_VALUE
      from DATA

that pulls information along the lines of

    00000001 01 1 Info1
    00000002 01 1 Info1
    00000002 01 2 Info2
    00000003 01 1 Info1
    00000004 01 1 Info1
    00000004 02 2 Info2

However, I only want the ""GROUP_ID"" field to reset on each ID, but remain the same for each ID so long as ""DATA_GROUP"" doesn't change. So ideally I want to pull:

    00000001 01 1 Info1
    00000002 01 1 Info1
    00000002 01 1 Info2
    00000003 01 1 Info1
    00000004 01 1 Info1
    00000004 02 2 Info2

Any ideas if this is possible?",,False,self,t5_2qp8q,False,,,True,t3_x4y72,http://www.reddit.com/r/SQL/comments/x4y72/oracle_partition_by_question/,
1342728639.0,1,self.SQL,wu2ci,Select count(distinct @var) from contacts  returns count of @var and not the value.,ramse,5,4,6,http://www.reddit.com/r/SQL/comments/wu2ci/select_countdistinct_var_from_contacts_returns/,"I have this thing i'm trying to come up with.

It grabs the custom column names from the definition table and then should get a distinct count of all values from that column.

The main goal here is to find all custom columns in CONTACTS that do not have data. In the end i plan on removing the column, but so far i'm having issues because the

    count(distinct @field_name)

Always comes back as 1, and if i remove the distinct it always returns 1023. Just from that, i believe that count() is taking a literal count of the @field_name variable instead of the variable inserting it's data before count() happens.

    declare @i INT, @numRows INT
    declare @field_name NVARCHAR(100)

    DECLARE emptyC2_cur CURSOR FOR 
    select FIELD_NAME from definition where DBFNAME = 'CONTACTS' order by FIELD_NAME desc

    OPEN emptyC2_cur
    FETCH NEXT FROM emptyC2_cur INTO @field_name
    WHILE @@FETCH_STATUS = 0
    	BEGIN
	
    	set @numRows = (select COUNT(distinct @field_name) from CONTACTS)
    	print @numRows
    
    	FETCH NEXT FROM emptyC2_cur INTO @field_name
    	END
    CLOSE emptyC2_cur
    DEALLOCATE emptyC2_cur

How can i stop count() from literally counting @field_name.",,False,self,t5_2qp8q,False,,,True,t3_wu2ci,http://www.reddit.com/r/SQL/comments/wu2ci/select_countdistinct_var_from_contacts_returns/,
1342657653.0,1,self.SQL,wsgn1,[Oracle] Need help getting around multiple rows on a one to many join between two tables. Need to get single row.,Doofio,5,4,3,http://www.reddit.com/r/SQL/comments/wsgn1/oracle_need_help_getting_around_multiple_rows_on/,"This may be somewhat of a n00bish question, but I'm having trouble with getting more rows than I want on a one to many join.  Here's the scenario:

Table A &lt;---1:M---&gt; Table B

In table A, we have a dispatch_id column with a single record for dispatch 123.  In table B, we have four records associated with dispatch 123, each referring to a different Part (antenna, racks, router and gear).  I'm trying to design a report that will determine if each part has been installed or not (status of 'INS' from table B).  This all needs to be returned in a single row for each dispatch_id.

Example column Output:

Dispatch      Antenna Installed (y/n)     Racks Installed (y/n) etc..
123                      Y                                    N

Essentially, I was trying to use a case statement like the following:
case when part = 'ANTENNA' and status = 'INS' then 'Y' else 'N'

The problem is that, since table B has four records for the dispatch and it's joining on the dispatch ID, no matter what I try, it always returns four records (one for each part).  I can't guarantee that more parts won't be added to table B for a particular dispatch so I'm hesitant to just hard code some filters in there and I want to avoid having to create a view if possible.  Is there any other way to get the results I want into one single row?  Essentially, I want the query to cycle through the records and if it finds a scenario when it can produce a 'Y', then ONLY use that value.  

This may be somewhat confusing so let me know if any clarification is needed.
",,False,self,t5_2qp8q,False,,,True,t3_wsgn1,http://www.reddit.com/r/SQL/comments/wsgn1/oracle_need_help_getting_around_multiple_rows_on/,
1342200942.0,1,self.SQL,wibl5,[MS SQL] How can I return fewer rows with more data? (grouping? concat?),gadorp,4,3,13,http://www.reddit.com/r/SQL/comments/wibl5/ms_sql_how_can_i_return_fewer_rows_with_more_data/,"I've got a rather unwieldy query that reports specific data on users within a given time-frame.

An example of what a basic return for this query would be something like: (I've removed the massive amount of REPLACE functions used in the query to make the structure easier to view)


    User Name, caseid, casedate, code#, Status1, Status2, Status3, Status4, Status5, internalcode, codedescription
    John Doe, 1234, 2012-07-13, ABC123, 1, null, null, null, null, null, null, null
    John Doe, 1234, 2012-07-13, ABC123, null, 1, null, null, null, null, null, null
    John Doe, 1234, 2012-07-13, ABC123, null, +, null, null, null, null, null, null
    John Doe, 1234, 2012-07-13, ABC123, null, null, 1, null, null, null, null, null
    John Doe, 1234, 2012-07-13, ABC123, null, null, null, 'Negative', null, null, null, null
    John Doe, 1234, 2012-07-13, ABC123, null, null, null, null, 'Negative', null, null, null
    John Doe, 1234, 2012-07-13, ABC123, null, null, null, null, null, 'Positive', null, null
    John Doe, 1234, 2012-07-13, ABC123, null, null, null, null, null, null, 713, 'Name of Function Performed Etc'


Almost every piece of this is stored in separate rows

(I'm still pretty new to SQL, go easy on me)


    select u.LastName+', '+u.FirstName AS 'User Name', c.CaseId, c.CaseDate, c.CodeNum, st.Status1, st.Status2, st.Status3, st.Status4, st.Status5, st.InternalCode, st.CodeDesc
    FROM [Case] c
    LEFT JOIN casegroup cg
        ON c.CaseId = cg.CaseId
    LEFT JOIN CaseTest st
        ON cg.CaseGroupId = st.CaseTestId
    LEFT JOIN Users u
        ON c.UserId = u.UserId
    WHERE c.FinalizedDate BETWEEN GETDATE()-30 AND GETDATE()
        AND c.CaseStatusId in (4,5)
    ORDER BY 'User Name',c.CaseId,c.CaseDate ASC


I'd really like for the example above to look like this:


    User Name, CaseId, CaseDate, code#, Status1, Status2, Status3, Status4, Status5, InternalCode, CodeDesc
    John Doe, 1234, 2012-07-13, ABC123, 1, 1+, 1, 'Negative', 'Negative', 'Positive', 713, 'Name of Function Performed Etc'


Where do I begin? (restructuring the database at all is absolute no-go)
",,False,self,t5_2qp8q,1342201227.0,,,True,t3_wibl5,http://www.reddit.com/r/SQL/comments/wibl5/ms_sql_how_can_i_return_fewer_rows_with_more_data/,
1341883768.0,1,self.SQL,waxgi,[MYSQL 5.5.24]  Syntax error when trying to create a Cursor in console,oceanofperceptions,4,3,0,http://www.reddit.com/r/SQL/comments/waxgi/mysql_5524_syntax_error_when_trying_to_create_a/,"I am using the syntax:

DECLARE cur1 CURSOR FOR select * from items;

and the return is an error 1064(42000).

Select * from items works as expected.  I installed MYSQL using WAMP server.  I have tried this with multiple tables in my database and each time get the same error.  This is frustrating as I just do not see anything wrong with the syntax.  Any help greatly appreciated.  This is very frustrating as I can not find anything wrong with the syntax.  Any help is greatly appreciated.",,False,self,t5_2qp8q,1341884319.0,,,True,t3_waxgi,http://www.reddit.com/r/SQL/comments/waxgi/mysql_5524_syntax_error_when_trying_to_create_a/,
1341499754.0,1,self.SQL,w2tvv,[MySQL] Need help identifying botched code,Haash,5,4,7,http://www.reddit.com/r/SQL/comments/w2tvv/mysql_need_help_identifying_botched_code/,"Hi guys,

Just wondering if you could help me spot some SQL error code. I get the error:

 &gt;#1064 - You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ')' at line 13 

when entering this sql file into my PHPMyAdmin control panel DB under ""import"". Here's the current sql file, I've tried entering through just plain SQL import, also with compatibility for MYSQL323 and MYSQL40 (If you could also help me understand this that would be great)

[Click to see uploaded file to pastebin](http://pastebin.com/g9s9iSTQ). (Had some trouble with the formatting.)

Thanks for the help :)

PS. Changed some of the code to censor out some information for privacy reasons.

Okay, Thanks to shaunc and cogweh (upboats), now I've got the error 

&gt;#1136 - Column count doesn't match value count at row 1

at

&gt;INSERT INTO users
VALUES ( 1,  'Administrator',  'Admin',  'admin',  '**********',  'Administrator',  'Today()',  'Today()',  '******',  '12',  'No' ) ;
",,False,self,t5_2qp8q,1341529029.0,,,True,t3_w2tvv,http://www.reddit.com/r/SQL/comments/w2tvv/mysql_need_help_identifying_botched_code/,
1341094237.0,1,self.SQL,vuvx1,[MS SQL Server] Newbie SQL user with a puzzling SELECT query issue,Lovetones,6,5,7,http://www.reddit.com/r/SQL/comments/vuvx1/ms_sql_server_newbie_sql_user_with_a_puzzling/,"Hello!

So I am new to SQL as a trainee in BI and have begun learning it/teaching myself  since being given access to the company database recently. I have put together a SELECT query to pull out customer data for standard monthly reports. However, since doing this for 1 or 2 new group customers I have found an issue with the code that has befuzzled me (although I have found a workaround). I have posted the code in a comment below.

When I change Cust1, etc. in this line of the WHERE clause it will run perfectly for some groups, but for others it will continue to run (presumably indefinitelY) until I am forced to cancel it:

    Orders.groupCustomer  In  ( 'Cust1','Cust2','Cust3','Cust4' ) 

I have figured out a few things:

 - It only has an issue when at least one of the groupCustomers returns data
 - The issue does not present if I comment out the bold areas of my code (so that join is causing the issue somehow)
 - Adding an OR to the WHERE statement for a value that does not have this issue/return data makes the code run smoothly in 3secs (this is my workaround - commented out in code)

I have got it working but I would rather know why this is happening. I can't understand how adding an OR to WHERE would ever make anything run faster. Any ideas?

**TLDR; SELECT query runs indefinitely when I change values selected in 1 line of WHERE clause. Looks like a join is causing the issue. Issue is resolved by adding an OR to WHERE clause. Why?** 

**EDIT** Didn't realise bold doesn't appear in reddit's code script. Areas I said I would highlight in bold will have a * at the start of the line. Apologies for the long code - had to split into 2.",,False,self,t5_2qp8q,1341094987.0,,,True,t3_vuvx1,http://www.reddit.com/r/SQL/comments/vuvx1/ms_sql_server_newbie_sql_user_with_a_puzzling/,
1341073915.0,1,self.SQL,vug7k,[MS SQL] I did an in-place upgrade from sql server 2005 standard to 2008 r2 standard and got an error at the end NEED HELP! 911!,terraburn,4,3,16,http://www.reddit.com/r/SQL/comments/vug7k/ms_sql_i_did_an_inplace_upgrade_from_sql_server/,"Thanks everyone for taking the time out to help me with the issue. I apologize for not updating sooner.

I still have a job (yay).

I ended up just wiping SQL server off altogether and reinstalling it fresh and brand new.


For those who don't know, Autodesk has a piece of software called Autodesk Management Suite or ADMS. It basically controls everything regarding Autodesk Inventor and Vault and uses SQL Server simply as a means to an end.

When you do a backup out of ADMS it saves everything you would need from the SQL instance allowing you to do a clean install of SQL and just restore the backup to ADMS and it will take care of the rest.

**TL;DR - Have a job still. Everything is back to normal.**",,False,self,t5_2qp8q,1341615940.0,,,True,t3_vug7k,http://www.reddit.com/r/SQL/comments/vug7k/ms_sql_i_did_an_inplace_upgrade_from_sql_server/,
1340905823.0,1,self.SQL,vr22b,Can I get some help with a left join?,ffxpwns,4,3,6,http://www.reddit.com/r/SQL/comments/vr22b/can_i_get_some_help_with_a_left_join/,"I know this is super easy for you guys, but I have 2 tables, one called comments and the other called following.  In following, I have 'user_id' and 'follower_id'  The former is the person being followed, the latter is the person following them. In comments, I have user_id, text, and other ones but those are the important ones.  I need  a join where is selects * from comments that were written by the person you are following.  If I can provide any more help, please let me know.  Thank you!",,False,self,t5_2qp8q,False,,,True,t3_vr22b,http://www.reddit.com/r/SQL/comments/vr22b/can_i_get_some_help_with_a_left_join/,
1340565866.0,1,self.SQL,vj9l3,Help running [MS SQL] scripts on [Oracle] SQL Developer,i_have_a_gub,1,0,2,http://www.reddit.com/r/SQL/comments/vj9l3/help_running_ms_sql_scripts_on_oracle_sql/,"I've just starting learning SQL using the beginner Joes2Pros book which is based on MS SQL.  I'm not allowed to run SQL Server Express on my work computer, so I'm stuck using Oracle SQL Developer on my Mac at home.  I've installed the MS SQL driver, but I don't know what I need to do next to run the set up scripts used for the labs in the book.  I'm assuming I need to establish a connection to a database before doing anything, but don't know how to do this.  Can anyone tell me how to do this?",,False,self,t5_2qp8q,False,,,True,t3_vj9l3,http://www.reddit.com/r/SQL/comments/vj9l3/help_running_ms_sql_scripts_on_oracle_sql/,
1340309925.0,1,self.SQL,vedhb,Query Analyzer that stores history?,jmelloy,1,0,3,http://www.reddit.com/r/SQL/comments/vedhb/query_analyzer_that_stores_history/,"A few weeks ago I swear I saw a link to a Rails app that stored the history of everything that was executed with it for later analytics purposes.

I need to store &amp; pre-parse result sets for work, and am looking for options.",,False,self,t5_2qp8q,False,,,True,t3_vedhb,http://www.reddit.com/r/SQL/comments/vedhb/query_analyzer_that_stores_history/,
1340201380.0,1,self.SQL,vbu6i,[MySQL] Help with DB structure (X-Post from r/MySQL),androiDoc,1,0,5,http://www.reddit.com/r/SQL/comments/vbu6i/mysql_help_with_db_structure_xpost_from_rmysql/,I have to make an ordering system for a local dairy where they will have a table of customers who will then have orders against their record. I'm struggling with the structure a little bit though. How do I make an order for a customer? Do I generate a new table with the appropriate values filled in for each order? ,,False,self,t5_2qp8q,False,,,True,t3_vbu6i,http://www.reddit.com/r/SQL/comments/vbu6i/mysql_help_with_db_structure_xpost_from_rmysql/,
1340109807.0,1,self.SQL,v9uy5,[MS SQL] v2008 R2 Reporting Services Question: Can I have user-populated fields in a report?,OK_now_what,2,1,4,http://www.reddit.com/r/SQL/comments/v9uy5/ms_sql_v2008_r2_reporting_services_question_can_i/,"I'm very much a self-taught SSRS novice - I have a report that I want to share via the Reporting Services website because it needs to be run on-demand, at any time of the month as needed.

The problem is that it runs based off of a date range that is totally unpredictable. One day they might run it for 10/1/2012 - 12/1/2012 and the next time it might be 10/1/1980 - 05/13/1993 ....so you see what I'm saying.

Is there any way to give the user access (without full ""report builder"" capabilities) to populate a date-range criteria field in the report? Like a popup box to enter the date range or something like that?",,False,self,t5_2qp8q,False,,,True,t3_v9uy5,http://www.reddit.com/r/SQL/comments/v9uy5/ms_sql_v2008_r2_reporting_services_question_can_i/,
1339784704.0,1,self.SQL,v3sn5,[Oracle] Passing XML to a stored procedure,stread,3,2,6,http://www.reddit.com/r/SQL/comments/v3sn5/oracle_passing_xml_to_a_stored_procedure/,"I've recently gotten involved with one of our products that supports both Oracle and MSSQL (whereas my ~5 years experience is all on the MSSQL side and no one else has Oracle experience or the drive to do so :) ) and as part of trying to transition it from mostly ad-hoc queries to XML utilizing stored procs.  MSSQL is no issue as XML has been in use for several years on the product I've been supporting but running into issues trying to mesh similar functionality over to Oracle.

The actual parsing of the document is pretty easy and similar to MSSQL and I've done so with anonymous blocks as well as a simple stored procedure for sanity testing.  However, I ran into an issue when I attempted to pass a very large XML(probably a couple megs in size) as part of the SP call and receive the 'string literal too long' message which I've since learned occurs with documents greater in size than 4000 characters.  I'd hoped that using a bind variable would satisfy it but no luck.(also took a stab at swapping between CLOB and XMLTYPE but didn't expect any change and wasn't surprised)

I've scoured the web and I haven't really found information that seems straight forward or along the lines of what I'm hoping to accomplish whereas the document is passed to the DB along with SP call(i.e. CALL PARSEXMLTEST(xmldocument);) and the closest thing I've found looks to be having the application build the documents in chunks into a CLOB field in the DB then passing a sequence value to the SP so that it can grab the data from a table and begin to parse it from there.

TLDR; Is there a method to allow the passing of a large XML document directly to a stored procedure in Oracle?",,False,self,t5_2qp8q,False,,,True,t3_v3sn5,http://www.reddit.com/r/SQL/comments/v3sn5/oracle_passing_xml_to_a_stored_procedure/,
1339702714.0,1,self.SQL,v25lf,"[MS SQL] A service said ""Login Failed for domain\user"", and the user no longer had access to the DB.  We had network issues a couple hours earlier and the DBA is pointing to that causing the user to no longer have access.  Is that a load of bull or not?",AlexHimself,3,2,18,http://www.reddit.com/r/SQL/comments/v25lf/ms_sql_a_service_said_login_failed_for_domainuser/,"Seems like he is trying to CYA and won't fess up to a mistake, but I don't know if it's possible he's telling the truth.  The event viewer just showed that the user didn't have permission to the DB.  Added and it solved.

How can the user just ""disappear"" or lose access?",,False,self,t5_2qp8q,False,,,True,t3_v25lf,http://www.reddit.com/r/SQL/comments/v25lf/ms_sql_a_service_said_login_failed_for_domainuser/,
1339552378.0,1,self.SQL,uz1mw,[WINSQL] - Find where only 1 record exists with unique values,Sprooty,1,0,5,http://www.reddit.com/r/SQL/comments/uz1mw/winsql_find_where_only_1_record_exists_with/,"Hi guys,

Trying to work out an SQL to find some certain data, what we have is;

Employer Table
 - Employers have an **attribute** (a or b) if an employer is A AND B they will have two records, one for each. All other fields will be the same.

Trying to provide a list of employers  where no record exists for A but has a record for B.

My current thought (which does not work is)

select EMP_NAME, COUNT(DISTINCT **attribute**) as COUNTER from bla bla

where COUNTER = 1 and **attribute** = B

GROUP BY EMP_NAME 
",,False,self,t5_2qp8q,1339552575.0,,,True,t3_uz1mw,http://www.reddit.com/r/SQL/comments/uz1mw/winsql_find_where_only_1_record_exists_with/,
1339433327.0,1,self.SQL,uwcwx,SQL Dates question,petedawes,1,0,3,http://www.reddit.com/r/SQL/comments/uwcwx/sql_dates_question/,"I first submitted this to r/techsupport, but I think this might be a better place for it.

I need to somehow get consecutive dates based off of todays date into a block of  SQL commands.

essentially it will look like this if the dates are hard coded in:



    update myDB.object set effective_date = '2012-06-11' where object_seq = 1;

    update myDB.object set effective_date = '2012-06-12' where object_seq = 2;

    update myDB.object set effective_date = '2012-06-13' where object_seq = 3;



and so on. these effective dates need to be scheduled to be updated every 5 weeks, so I want to schedule a task to run a .sql file on the day they update so in pseudocode it would be something along the lines of:



    set a variable called date_variable to today's date somehow;

    update myDB.object set effective_date = date_variable where object_seq = 1;

    update myDB.object set effective_date = date_variable + 1 where object_seq = 2;

    update myDB.object set effective_date = date_variable + 2 where object_seq = 3;




I do not know how to create a variable using sql or how to get todays date, or if the ""variable + 1"" would work for dates. 

Anyone with any SQL proficiency's input would be greatly appreciated.

this is a sybase database, sybase central ver 4.3.0.2461; adaptive server anywhere ver 9.0.2.3586 
",,False,self,t5_2qp8q,False,,,True,t3_uwcwx,http://www.reddit.com/r/SQL/comments/uwcwx/sql_dates_question/,
1339086591.0,1,self.SQL,upywl,[MS SQL],ElMatadorBorracho,6,5,7,http://www.reddit.com/r/SQL/comments/upywl/ms_sql/,"This is going to sound completely nub, but I am very new to SQL and still trying to feel my way around. 

I have a situation where I need to remove double quotes and/or pipe characters from text field. I know how to search for them using:

LIKE '%""%' or '%|%' 

However I want to write an update that removes the characters from those results of my select statement. My goal is to  avoid manually updating the value to whatever it would be without those characters. As my results of the select statement would require me to write numerous simple updates.  

Any help would be appreciated and I hope this makes sense. ",,False,self,t5_2qp8q,False,,,True,t3_upywl,http://www.reddit.com/r/SQL/comments/upywl/ms_sql/,
1338839856.0,1,self.SQL,ukqkk,[MSSQL] Trying to update a single table with the sum of three related rows,mcraamu,2,1,3,http://www.reddit.com/r/SQL/comments/ukqkk/mssql_trying_to_update_a_single_table_with_the/,"I have to update many rows in a single table, with values aggregated from separate but similar rows in the same table. I have a humongous ScorecardTable (design below). I'll be updating rows with MetricID = 4, which is a sum of rows with MetricID = (1,2,3). Recently I found and deleted some duplicates where MetricID = 2 for five certain employees. Don't know or care how those were created, the goal right now is to update MetricID = 4 so that it's a correct and current SUM of MetricIDs 1, 2 and 3.

ScorecardTable

&gt;ScorecardID int, pk

&gt;OrderID int

&gt;EmployeeID int

&gt;MetricID int

&gt;Date int

&gt;Money money


6717	501	50	1	20120401	$5.00

6418	501	50	2	20120401	$3.00

1628	501	50	3	20120401	$2.00

1221	501	50	4	20120401	$10.00 (correct result)

9079	502	30	2	20120415	$1

4611	502	30	3	20120415 	$1 (duplicate, is now deleted)

4117	502	30	4	20120415	$2 (remaining bad result, should be $1)


Again:

* Money for MetricID = 4 is created by taking the SUM of the Money column for MetricID = (1,2,3).

* Some duplicates for MetricID = 2 were deleted, but I'm not sure which.

* OrderID, EmployeeID, MetricID, Date, and Money are grouped and should be distinct. (There should not be more than one combination of OrderID = EmployeeID = MetricID = Date = Money). One MetricID = 4 is made for each combination, though, grouping (1,2,3)

How do I best update the Money column for MetricID = 4 for five different EmployeeIDs to make it correct? 

I was thinking something like this:

    UPDATE [dbo].[ScoreCardTable] SC1

    SET [Money] =

    (

    SELECT SUM([Money])

    FROM [dbo].[ScoreCardTable] SC2 (NOLOCK)

    WHERE [EmployeeID] IN (10,20,30,40,50)

    AND [MetricID] IN (1,2,3)

    AND [Date] &gt;= 20120401 and [Date] &lt;= 20120601

    AND SC1.OrderID = SC2.OrderID

    AND SC1.EmployeeID = SC2.EmployeeID

    AND SC1.Date = SC2.Date

    AND SC1.Money = SC2.Money

    )

    WHERE [MetricID] = 4

    AND [Date] &gt;= 20120401 and [Date] &lt;= 201200601

    GROUP BY OrderID, EmployeeID, MetricID, Date, Money


Thanks in advance!


Edit: Is formatting on Reddit always this difficult?",,False,self,t5_2qp8q,1338840436.0,,,True,t3_ukqkk,http://www.reddit.com/r/SQL/comments/ukqkk/mssql_trying_to_update_a_single_table_with_the/,
1338750535.0,1,self.SQL,uiwkb,Need to brush up on SQL; not sure where to start.,SevenSignz,1,0,4,http://www.reddit.com/r/SQL/comments/uiwkb/need_to_brush_up_on_sql_not_sure_where_to_start/,"I recently graduated college with a computer science degree and wanted to get into the database job world. I have experience scrubbing and creating databases in MS Access, but I recently got a job offer that would entail writing SQL code.

The job I'm working at now (data entry, nothing major) is about to get a new server system and would need their databases revived, revised, and written into the new server client. What my boss told me was that he had about 12 Access databases that he will need amalgamated using SQL to be entered to the new system.

My classes only just touched on SQL and I never actually learned how to write in it, so I have been trying to learn, but I have no idea what is relevant or where to start. I've been perusing SQLZoo and Google but like I said, I don't know what would be relevant to my goals. I also looked at the Stanford class mentioned in the sidebar thread, but that looked like it was too basic for what I need to do.

Can anyone nudge me in the right direction or provide some insight as to what is actually required from the task presented to me? Thanks!",,False,self,t5_2qp8q,False,,,True,t3_uiwkb,http://www.reddit.com/r/SQL/comments/uiwkb/need_to_brush_up_on_sql_not_sure_where_to_start/,
1337714321.0,1,self.SQL,tzp1y,Novice question about updating a table,jamarax,1,0,9,http://www.reddit.com/r/SQL/comments/tzp1y/novice_question_about_updating_a_table/,"After spending a while googling this, I either cant find it or what I'm looking at it way over my head so I came here.

I want to update a table where the column is a variable instead of a known fixed value. ie. Update table set $variable where...

I cant seem to do this correctly...the exact line is this:
   $updateplayer = ""UPDATE players set $equipstat = '$playerstat' where id = '$playerid'"";

$equipstat being the name of a column in the players table.

Edit: I should explain that I'm using php hence the syntax.",,False,self,t5_2qp8q,1337717813.0,,,True,t3_tzp1y,http://www.reddit.com/r/SQL/comments/tzp1y/novice_question_about_updating_a_table/,
1336054956.0,1,self.SQL,t540j,JOIN question: including info from a table that may not be linked,YoureAFuckingTowel,2,1,4,http://www.reddit.com/r/SQL/comments/t540j/join_question_including_info_from_a_table_that/,"I can't figure out how to word this properly... here's my scenario: 

I have a main table and a user table. The main table has three ID fields that correspond to the user that created the record (1), the user that last updated the record (2), and the user who closed out the record (3). 

Every record in the main table will have a value for the first user, but may not have values for the second and third user. 

I want to see the user's names (instead of IDs). However I've tried all sorts of JOINs and when any of the 3 user IDs are not listed in the record, the query returns an empty set.",,False,self,t5_2qp8q,False,,,True,t3_t540j,http://www.reddit.com/r/SQL/comments/t540j/join_question_including_info_from_a_table_that/,
1335999680.0,1,self.SQL,t43yi,Code Review (T-SQL) : Last day of the year for 5 years....,nyballa,2,1,13,http://www.reddit.com/r/SQL/comments/t43yi/code_review_tsql_last_day_of_the_year_for_5_years/,"for T-SQL:

I need to generate the LAST DAYS (zero hour) of the the PAST 5 years (in rows) .
This looks about right ?

				/*------------------------
				WITH numbers AS (
						SELECT 1 AS number
						UNION ALL
						SELECT number + 1 
						FROM  numbers
						WHERE number &lt; 5)
				SELECT DATEADD(dd, -1, DATEADD(yy, -1 * number, DATEADD(yy,DATEDIFF(yy,0,getdate())+1,0))) as past_end_of_year
						FROM numbers
				OPTION (MAXRECURSION 0);  
				------------------------*/
				past_end_of_year
				-----------------------
				2011-12-31 00:00:00.000
				2010-12-31 00:00:00.000
				2009-12-31 00:00:00.000
				2008-12-31 00:00:00.000
				2007-12-31 00:00:00.000
",,False,self,t5_2qp8q,False,,,True,t3_t43yi,http://www.reddit.com/r/SQL/comments/t43yi/code_review_tsql_last_day_of_the_year_for_5_years/,
1335861658.0,1,snaglur.com,t1aic,How to get your table index or ID back to 1 on a SQL or MySql Database,wordofwisdom,6,5,3,http://www.reddit.com/r/SQL/comments/t1aic/how_to_get_your_table_index_or_id_back_to_1_on_a/,,,False,default,t5_2qp8q,False,,,False,t3_t1aic,http://www.snaglur.com/s/content_view.aspx?post=619,
1335366652.0,1,self.SQL,sru86,(T-SQL) Why is my LIKE condition causing my statement to return 0 records? [x-post from r/SQLServer],mortodestructo,1,0,5,http://www.reddit.com/r/SQL/comments/sru86/tsql_why_is_my_like_condition_causing_my/,"SOLVED: Solution below.

This may seem a little backwards, but any help would be greatly appreciated.
I have a relatively simple SQL statement that is failing to return any records due to a WHERE condition that utilizes the LIKE operator.

To condense:

    SELECT * FROM Table
    WHERE '%' + RTRIM(Table.Column) + '%' LIKE @parameter

For example, I know that there are multiple rows with a Table.Column value of ""R.L "" with two trailing spaces. The @parameter I'm passing in should allow me to query on values such as ""R.L"" and others, separated by pipes (|). 
However, even when passing in just ""R.L"", the query returns no rows.

I've wasted so much time on this already. Any ideas what I'm missing here?

____________________________________________________________________

This finally did the trick.

SELECT * FROM Table
WHERE @parameter LIKE '%' + RTRIM(Table.Column) + '%'

I feel stupid that I wasted so much time on this. Thank you all so much (especially stealth210 on [/r/SQLServer](/r/SQLServer) and buckbova) for your help.",,False,self,t5_2qp8q,True,,,True,t3_sru86,http://www.reddit.com/r/SQL/comments/sru86/tsql_why_is_my_like_condition_causing_my/,
1335152088.0,1,self.SQL,snmsv,[MS SQL] Need Help Developing DB,SomeAwesomeDudeGuy,1,0,5,http://www.reddit.com/r/SQL/comments/snmsv/ms_sql_need_help_developing_db/,"Hello its been over a year since I did any serious DB work and been having trouble with the following:

I'm creating a DB for a Java program I am writing. The program is for viewing grades from/grading/taking/creating assignments. There are two different types of assignments that it does, multiple choice and short answer. I am having trouble trying to figure out how to maintain a table of the assignments (ID [Auto-generated PK], name, type [short answer/multiple choice], # of questions, due date) that can be linked to a table of questions and/or the grades for that assignment.

I hope that all makes sense, if you have any questions feel free to ask and thanks for any help in advance.",,False,self,t5_2qp8q,False,,,True,t3_snmsv,http://www.reddit.com/r/SQL/comments/snmsv/ms_sql_need_help_developing_db/,
1334916767.0,1,self.SQL,sjfq1,Evaluation Matrix on OLAP [crosspost from /r/oracle],n4rwoo,1,0,0,http://www.reddit.com/r/SQL/comments/sjfq1/evaluation_matrix_on_olap_crosspost_from_roracle/,"If you had to do an evaluation matrix for a comparison between ROLAP and MOLAP what would it look like?
I am looking for criterias that can be evaluated and be used as a decision support on which model is better for certain cases.

Thanks in advance.",,False,self,t5_2qp8q,False,,,True,t3_sjfq1,http://www.reddit.com/r/SQL/comments/sjfq1/evaluation_matrix_on_olap_crosspost_from_roracle/,
1334778152.0,1,self.SQL,sgiof,How do I limit the input of a varchar to predefined categories?,Guest897894,1,0,1,http://www.reddit.com/r/SQL/comments/sgiof/how_do_i_limit_the_input_of_a_varchar_to/,"I can't find anything useful on Google or in any of the books I have.

EDIT: I am using Oracle, if that helps/makes a difference
EDIT2: I found it, used the check constraint",,False,self,t5_2qp8q,True,,,True,t3_sgiof,http://www.reddit.com/r/SQL/comments/sgiof/how_do_i_limit_the_input_of_a_varchar_to/,
1334586146.0,1,self.SQL,scegl,[Question: MySQL] Database performance different on same server,fluffy_mass,1,0,3,http://www.reddit.com/r/SQL/comments/scegl/question_mysql_database_performance_different_on/,"Hello r/SQL,

I have an issue with my MySQL server. I have several databases. Some of them are imported from delimited files, and some are just imported (MYD, frm, MYI files). An example of delimited files can be found here: ftp://ftp.ncbi.nlm.nih.gov/hapmap/ld_data/latest/ and an example of latter can be found here: (Warning heavy site, don't open on your phone) ftp://hgdownload.cse.ucsc.edu/mysql/hg19/ . These are public data.

As a result my tables are around 30-60million rows in each database. But I noticed that even simplest form of query in the database that I imported from delimited file is much much slower than the ones I just copied (i.e. from the second list). I have been struggling on it for days now, but I have not found any proper reason why it should be like this.

Does anybody can help me find the issue behind this?

Operating system: Linux CentOS 5.8

Slow table: http://pastebin.com/yyYsFNPX
Fast table: http://pastebin.com/x9nH1s87

My skill level: Moderate. I can find my way around in Linux environment and know a little bit of programming and familiar with some terms about databases, operating systems and programming.

Thanks in advance.",,False,self,t5_2qp8q,False,,,True,t3_scegl,http://www.reddit.com/r/SQL/comments/scegl/question_mysql_database_performance_different_on/,
1334542132.0,1,self.SQL,sbpg9,How to create a INSTEAD OF INSERT trigger to prevent duplicate records from being inserted,djgfx,2,1,3,http://www.reddit.com/r/SQL/comments/sbpg9/how_to_create_a_instead_of_insert_trigger_to/,"So I have a ""CustomerOLD"" table which has duplicate values and records in various fields (ID, NAME,ADDRESS, ZIP). I want to insert only the DISTINCT records into ""CustomerNEW"" without having records repeat. The issue is, even if I select DISTINCT CustomerID from the CustomerOLD table, I still have records that have duplicate names and addresses. So I would like to have a trigger in the CustomerNEW table which checks to see if the values that are being inserted are already in the CustomerNEW table and if they are it rejects that record and puts it into a CustomerReject table.  Any help would be greatly appreciated! Thank you",,False,self,t5_2qp8q,False,,,True,t3_sbpg9,http://www.reddit.com/r/SQL/comments/sbpg9/how_to_create_a_instead_of_insert_trigger_to/,
1334541314.0,1,self.SQL,sbopy,[MS SQL] Grouping rows based on timestamp,OldBailey,2,1,4,http://www.reddit.com/r/SQL/comments/sbopy/ms_sql_grouping_rows_based_on_timestamp/,"I need to find a way of grouping rows that occur within 5 minutes of the latest timestamp in the group and the displayid and object id are the same..... 

    CREATE TABLE [dbo].[ExampleLog]( 
    [ID] [uniqueidentifier] NOT NULL, 
    [EVENTNUMBER] [int] NULL, 
    [DISPLAYSERIAL] [int] NULL, 
    [DISPLAYID] [varchar](50) NULL, 
    [OBJECTSERIAL] [int] NULL, 
    [OBJECTRSSILEVEL] [int] NULL, 
    [OBJECTID] [varchar](50) NULL, 
    [TIMESTAMP] [datetime] NULL) 

    INSERT INTO [dbo].[ExampleLog] 
    VALUES  
    (NewID(), 206, 6897913, 'HV 644', 6885819, 66, 'WAP 8', '2012-01-01 12:12:00'), 
    (NewID(), 206, 6897913, 'HV 644', 6885819, 66, 'WAP 8', '2012-01-01 12:13:00'), 
    (NewID(), 206, 6897913, 'HV 644', 6877807, 54, 'MV 20', '2012-01-01 12:16:00'), 
    (NewID(), 103, 6897913, 'HV 644', 6898052, 118, 'HV 62', '2012-01-01 12:20:00'), 
    (NewID(), 206, 6897913, 'HV 644', 6886130, 122, 'HV 62', '2012-01-01 12:21:00'), 
    (NewID(), 206, 6897913, 'HV 644', 6886130, 106, 'HV 62', '2012-01-01 12:25:00'), 
    (NewID(), 204, 6897913, 'HV 644', 6886130, 106, 'HV 62', '2012-01-01 12:31:00'), 
    (NewID(), 204, 6897913, 'HV 644', 6886130, 106, 'HV 62', '2012-01-01 12:33:00'), 
    (NewID(), 104, 6897913, 'HV 644', 6886130, 106, 'HV 62', '2012-01-01 12:39:00') 

so using the dataset above, my results would ideally be grouped as follows;

Rows 1 and 2 are grouped because the objectid and displayid are the same and row 2 occurs within 5 minutes of row 1, there are no other rows in the dataset that contain the same displayid and objectid and a timestamp within 5 minutes of the group’s latest timestamp (row 2) so..

Row 3 is grouped by itself because there are no rows in the dataset where the displayid and objectid match within a 5 minute of that groups latest timestamp (row 3).

Row 4, 5 and 6 are grouped because the displayid's match, the objectid's match and the rows timestamps are within 5 minutes of the last row, row 5's timestamp is within 5 minutes of row 4's, and row 6 timestamp is within 5 minutes of row 5's.

Row 7 and 8 are grouped because the objectid's and displayid's are the same and row 8's timestamp is within 5 minutes of that groups latest timestamp (row 7). 

Row 9 is grouped by itself because there are no rows in the dataset where the displayid and objectid match within a 5 minute of that groups latest timestamp

*I am using SQL Server 2008 R2
",,False,self,t5_2qp8q,False,,,True,t3_sbopy,http://www.reddit.com/r/SQL/comments/sbopy/ms_sql_grouping_rows_based_on_timestamp/,
1334315596.0,1,self.SQL,s7rqm,[Question: Access] Mixing 2 queries,Krainz,1,0,5,http://www.reddit.com/r/SQL/comments/s7rqm/question_access_mixing_2_queries/,"Good morning fellow redditors,

I have two queries, and I'd like to mix them, but...

When I use the Access Assistant, it repeats the data of 'Empresas' more than once, for every line in the 'Técnicos e Engenheiros' query.

'Técnicos e Engenheiros' query:

    SELECT DISTINCTROW [Regiões do Paraná].Região,
        Sum([Técnicos e Engenheiros do Paraná].Técnicos) AS [Soma De Técnicos],
        Sum([Técnicos e Engenheiros do Paraná].Engenheiros) AS [Soma De Engenheiros]
    FROM [Regiões do Paraná] INNER JOIN [Técnicos e Engenheiros do Paraná] ON [Regiões do Paraná].[Código] = [Técnicos e Engenheiros do Paraná].[Região]
    GROUP BY [Regiões do Paraná].Região;

'Empresas' query:

    SELECT DISTINCTROW [Regiões do Paraná].Região,
        Sum([Empresas do Paraná (numeros)].Empresas) AS [Soma De Empresas]
    FROM [Regiões do Paraná] INNER JOIN [Empresas do Paraná (numeros)] ON [Regiões do Paraná].[Código] = [Empresas do Paraná (numeros)].[Região]
    GROUP BY [Regiões do Paraná].Região;

The bizarre one generated by access:


    SELECT DISTINCTROW [Regiões do Paraná].Região,
        Sum([Técnicos e Engenheiros do Paraná].Técnicos) AS [Soma De Técnicos],
        Sum([Técnicos e Engenheiros do Paraná].Engenheiros) AS [Soma De Engenheiros],
        Sum([Empresas do Paraná (numeros)].Empresas) AS [Soma De Empresas]
    FROM ([Regiões do Paraná]
        INNER JOIN [Técnicos e Engenheiros do Paraná] ON [Regiões do Paraná].[Código] = [Técnicos e Engenheiros do Paraná].[Região])
        INNER JOIN [Empresas do Paraná (numeros)] ON [Regiões do Paraná].[Código] = [Empresas do Paraná (numeros)].[Região]
    GROUP BY [Regiões do Paraná].Região, [Regiões do Paraná].Região;

So, what should I do in order to fix this problem? Any instructions on SQL?

Thanks in advance",,False,self,t5_2qp8q,True,,,True,t3_s7rqm,http://www.reddit.com/r/SQL/comments/s7rqm/question_access_mixing_2_queries/,
1334312372.0,1,firebirdnews.org,s7qn1,Firebird SQL V2.0.7 has been released - likely to be the last for the 2.0-series,mariuz,1,0,1,http://www.reddit.com/r/SQL/comments/s7qn1/firebird_sql_v207_has_been_released_likely_to_be/,,,False,default,t5_2qp8q,False,,,False,t3_s7qn1,http://www.firebirdnews.org/?p=7086,
1334262353.0,1,self.SQL,s6qgw,[MS SQL] v2008 R2 Reporting Services: not sure how to multiple column values together - please help :-),OK_now_what,1,0,6,http://www.reddit.com/r/SQL/comments/s6qgw/ms_sql_v2008_r2_reporting_services_not_sure_how/,"I'm a total Reporting Services novice, no formal training - just winging it off of youtube and google and I can't find the answer to this one....

Let's say I've got a column called ""QTY"" and a column called PRICE""...I want to create a third column called NET PRICE and have it be QTY*PRICE

I can't figure out how to do that, I can see how to total individual columns but not across columns.... would this be done via ""Expressions"" ? not sure how :-\


EDIT: Thank you all very much for you help! I've got it working now! ",,False,self,t5_2qp8q,True,,,True,t3_s6qgw,http://www.reddit.com/r/SQL/comments/s6qgw/ms_sql_v2008_r2_reporting_services_not_sure_how/,
1334221214.0,1,self.SQL,s5x6e,"[MsSQL Help please] The XML data type cannot be compared or sorted, except when using the IS NULL operator.
",mogawowo,1,0,2,http://www.reddit.com/r/SQL/comments/s5x6e/mssql_help_please_the_xml_data_type_cannot_be/,"I know i have to do a subselect here but I cannot get this right despite hours of faffing. I have  the following columns
[SerialisedObject XML] and [DateAdded DateTime]
I need the max date for each specific xml value ""ApplicationCode"" here is what i have:


Select 
    b.ApplicationCode,b.DaysGrace,b.LicenceBySeat,b.LicenceByToken,b.LicenceByTransaction,
b.NumberOfSeats,b.NumberOfTransactions
    FROM
    (
SELECT

 [Session].SerialisedObject.query ('data(/ApplicationLicence/ApplicationCode)') AS ApplicationCode,
 [Session].SerialisedObject.query ('data    (/ApplicationLicence/DaysGrace)') AS DaysGrace,
 [Session].SerialisedObject.query ('data    (/ApplicationLicence/LicenceBySeat)') AS  LicenceBySeat,
 [Session].SerialisedObject.query ('data(/ApplicationLicence/LicenceByTransaction)') AS     LicenceByTransaction, 
 [Session].SerialisedObject.query ('data(/ApplicationLicence/ LicenceByToken)') AS LicenceByToken,    
 [Session].SerialisedObject.query ('data    (/ApplicationLicence/NumberOfSeats)') AS NumberOfSeats,
 [Session].SerialisedObject.query ('data    (/ApplicationLicence/NumberOfTransactions)') AS NumberOfTransactions 
    
FROM [Session] 
WHERE sessionguid = 'E5D38E6A-78A0-4257-AA8F-168A0334ACDF'   
AND Closed = 0
AND DateAdded = 
(
SELECT MAX(DateAdded) from [session]
WHERE CAST([Session].SerialisedObject.query('data(/ApplicationLicence/ApplicationCode)') AS NVARCHAR(MAX)) =
CAST([Session].SerialisedObject.query('data (/ApplicationLicence/ApplicationCode)') AS NVARCHAR(MAX))
)
) As b
group by b.ApplicationCode




Why does this not work please help me ;)",,False,self,t5_2qp8q,False,,,True,t3_s5x6e,http://www.reddit.com/r/SQL/comments/s5x6e/mssql_help_please_the_xml_data_type_cannot_be/,
1333635745.0,1,reddit.com,rumuq,[Question: MS SQL] Programming in Microsoft SQL 2008 : x-post SQLServer,Demeon099,1,0,0,http://www.reddit.com/r/SQL/comments/rumuq/question_ms_sql_programming_in_microsoft_sql_2008/,,,False,default,t5_2qp8q,False,,,False,t3_rumuq,http://www.reddit.com/r/SQLServer/comments/rum5n/question_programming_in_microsoft_sql_2008/,
1333040665.0,1,postgresqlconference.org,rjh0i,PgNext PostgreSQL conference CFP is open (DENVER!),smartwaffle,1,0,0,http://www.reddit.com/r/SQL/comments/rjh0i/pgnext_postgresql_conference_cfp_is_open_denver/,,,False,default,t5_2qp8q,False,,,False,t3_rjh0i,https://www.postgresqlconference.org/,
1332958790.0,1,self.SQL,rhvyi,"[MySQL] ""Invalid Column Count in CSV file""",nichiatu,1,0,4,http://www.reddit.com/r/SQL/comments/rhvyi/mysql_invalid_column_count_in_csv_file/,"So, I'm supposed to insert shitloads of information into a MySQL table, I chose to use CSV, and it worked once, but not any more.

The row ""Long text"" includes new lines, so every time I try and insert, I get the ""invalid column count"" error. We need to have the new line thing because the info is kinda table-generated. How do I go about doing this?",,False,self,t5_2qp8q,True,,,True,t3_rhvyi,http://www.reddit.com/r/SQL/comments/rhvyi/mysql_invalid_column_count_in_csv_file/,
1332864742.0,1,self.SQL,rg07l,"[MySQL] Tried inserting a CSV into a table, it has characters like ""æøå"" (norwegian characters). The characters show up like HEX codes, why is this happening?",nichiatu,2,1,2,http://www.reddit.com/r/SQL/comments/rg07l/mysql_tried_inserting_a_csv_into_a_table_it_has/,,,False,self,t5_2qp8q,False,,,True,t3_rg07l,http://www.reddit.com/r/SQL/comments/rg07l/mysql_tried_inserting_a_csv_into_a_table_it_has/,
1331588091.0,1,self.SQL,qti6o,[MS Access] Query for difficult data layout,redditaccount1975,2,1,5,http://www.reddit.com/r/SQL/comments/qti6o/ms_access_query_for_difficult_data_layout/,"Here is Table 1 (The # under each item corresponds the CatID in table two...Column headers correspond to Type)

    PropID      VersionID    Client    Fruit    Car    Color     Size 
    dbtester      1           Bob        1        null    null          2 
    dbtester      1           Amy       null      2      null        null 
    dbtester      1           Sam       null     null     1          null 
    dbtester      1           Tom       null       1      null         1 
    dbtester      1           Lee        null     null    null        null

Here is Table two 

     PropID      VersionID     CatID       Item     Type 
     dbtester      1             1            Apple       1 
     dbtester      1             1            Ford        2 
     dbtester      1             2            Chevy      2 
     dbtester      1             1            Blue         3 
     dbtester      1             1            Large       4 
     dbtester      1             2            Small       4
 
Trying to get the output to be:

    PropID      VersionID    Client    Fruit     Car     Color    Size 
    dbtester      1           Bob       Apple                       Small 
    dbtester      1           Amy               Chevy 
    dbtester      1           Sam                            Blue 
    dbtester      1           Tom               Ford                 Large 
    dbtester      1           Lee

PropID and VersionID are variables I input each time the query runs.

Thanks very much!!",,False,self,t5_2qp8q,False,,,True,t3_qti6o,http://www.reddit.com/r/SQL/comments/qti6o/ms_access_query_for_difficult_data_layout/,
1330555986.0,1,self.SQL,qc070,[Oracle] Can someone please explain how OPEN cursor_name FOR query_string works?,hindermore,1,0,4,http://www.reddit.com/r/SQL/comments/qc070/oracle_can_someone_please_explain_how_open_cursor/,"I have been trying to understand how this works.  I have a procedure that is passed a cursor variable as an IN variable and at the very end of the procedure (just before the END;) I see this code:

    OPEN c_dailyStaffingSheet FOR 
    SELECT * FROM TEMP_DAILY_RECORDS WHERE SESSIONID = p_sessionid;

I have been reading documentation on it, but I still don't really understand it.  Could someone provide an explanation for the SQL novice?  Thanks in advance!",,False,self,t5_2qp8q,False,,,True,t3_qc070,http://www.reddit.com/r/SQL/comments/qc070/oracle_can_someone_please_explain_how_open_cursor/,
1329749600.0,1,self.SQL,pxt8g,[noob question] importing XML into SQL,,1,0,2,http://www.reddit.com/r/SQL/comments/pxt8g/noob_question_importing_xml_into_sql/,"Hey guys,


Networking guy trying to do a little side project for work to create a small video site that can pull in information. It is safe to safe that my knowledge is extremely low when it comes to this. So please kids gloves and I promise I will try not to frustrate you.



The end goal is to display data, from sql that has been imported from xml. Although if there is a smarter way to go about it, please school me.



Anyways, we have multiple xml tables that are similar to:



&lt;?xml version=""1.0"" encoding=""utf-8""?&gt;

&lt;videos&gt;

	&lt;video&gt;

		&lt;id&gt;123&lt;/id&gt;

		&lt;thumbs&gt;
		&lt;thumb&gt;&lt;![CDATA[http://internalwebsite/example.jpg]]&gt;&lt;/thumb&gt;
		&lt;/thumbs&gt;
		&lt;link&gt;&lt;![CDATA[http://www.internal.com/123]]&gt;&lt;/link&gt;
		&lt;title&gt;&lt;![CDATA[Test Link]]&gt;&lt;/title&gt;
		&lt;categories&gt;
			&lt;category&gt;&lt;![CDATA[E]]&gt;&lt;/category&gt;
		&lt;/categories&gt;
		&lt;tags&gt;
			&lt;tag&gt;&lt;![CDATA[A]]&gt;&lt;/tag&gt;
			&lt;tag&gt;&lt;![CDATA[B]]&gt;&lt;/tag&gt;
			&lt;tag&gt;&lt;![CDATA[C]]&gt;&lt;/tag&gt;
			&lt;tag&gt;&lt;![CDATA[E]]&gt;&lt;/tag&gt;
		&lt;/tags&gt;
		&lt;duration&gt;&lt;![CDATA[25:15]]&gt;&lt;/duration&gt;
		&lt;pubDate&gt;&lt;![CDATA[2012-02-18]]&gt;&lt;/pubDate&gt;
	&lt;/video&gt;
&lt;/videos&gt;

What we are thinking is that we should import, these into a table where the fields are 

-ID

-thumbs

-link

-title

-categories

-tags

-duration

-publication date



Once we have that into a table, we can then work on importing similar XML files into similar tables that we can reference and display as required.


Any advice on where to start looking would be greatly appreciated.",,False,self,t5_2qp8q,False,,,True,t3_pxt8g,http://www.reddit.com/r/SQL/comments/pxt8g/noob_question_importing_xml_into_sql/,
1328713452.0,1,kodyaz.com,pgaet,Free Microsoft SQL Server 2012 Download aka SQL Server Denali,luismiguel982,2,1,0,http://www.reddit.com/r/SQL/comments/pgaet/free_microsoft_sql_server_2012_download_aka_sql/,,,False,http://e.thumbs.redditmedia.com/qAg-5JQgNhntF3aF.jpg,t5_2qp8q,False,,,False,t3_pgaet,http://www.kodyaz.com/sql-server-2012/microsoft-sql-server-2012-download-sql-server-denali.aspx,
1328206357.0,1,self.SQL,p7z54,Need help with statement ,dude2k5,2,1,3,http://www.reddit.com/r/SQL/comments/p7z54/need_help_with_statement/,"So here's the deal. I created a SQL statement using MS Query to get me some data from a database to an excel sheet. But it gets only a fraction of the data because in some fields there's missing data. So basically what we need to add is an IF and THEN to the following statement which gets data from a different set of fields if the data in the first set of fields are missing. 

So basically i need to add a correct IF and THEN to the block I have marked below. 



SELECT DISTINCT CUSTOMER_ORDER.ORDER_DATE, CUSTOMER.NAME AS 'Sold_To', CR_CUST_CUST_ADDR.NAME AS 'Ship_To', 

-----------------------------------------------
** IF CR_CUST_CUST_ADDR.CITY is not NULL then get values from the following fields.

CR_CUST_CUST_ADDR.ADDR_1, CR_CUST_CUST_ADDR.CITY, CR_CUST_CUST_ADDR.STATE, CR_CUST_CUST_ADDR.ZIPCODE, 

else get it from

SOLD_TO.ADDR_1, SOLD_TO.CITY, SOLD_TO.STATE, SOLD_TO.ZIPCODE,

-----------------------------------------
CUST_ORDER_LINE.PART_ID, PART.DESCRIPTION, CUST_ORDER_LINE.ORDER_QTY, CUST_ORDER_LINE.UNIT_PRICE, CUSTOMER_ORDER.ID, CUSTOMER_ORDER.CUSTOMER_ID, CUSTOMER_ORDER.CUSTOMER_PO_REF, CUSTOMER_ORDER.DESIRED_SHIP_DATE, CUST_ORDER_LINE.TRADE_DISC_PERCENT, CUSTOMER_ORDER.SALESREP_ID



FROM VMFG.dbo.CR_CUST_CUST_ADDR CR_CUST_CUST_ADDR, VMFG.dbo.CUST_ORDER_LINE CUST_ORDER_LINE, VMFG.dbo.CUSTOMER CUSTOMER, VMFG.dbo.CUSTOMER_ORDER CUSTOMER_ORDER, VMFG.dbo.PART PART




Hope this is clear. If not let me know.
",,False,self,t5_2qp8q,False,,,True,t3_p7z54,http://www.reddit.com/r/SQL/comments/p7z54/need_help_with_statement/,
1325785867.0,1,imgur.com,o46tj,Close Enough ,TokinAg08,3,2,2,http://www.reddit.com/r/SQL/comments/o46tj/close_enough/,,,False,http://b.thumbs.redditmedia.com/1mVfxc1yV7vLVCms.jpg,t5_2qp8q,False,,,False,t3_o46tj,http://imgur.com/ywFek,
1325092140.0,1,self.SQL,ntqsq,sql noob - have a training question,aatek,1,0,6,http://www.reddit.com/r/SQL/comments/ntqsq/sql_noob_have_a_training_question/,"Hello all, I have taken a SAP BI course, and realize that I will need to learn SQL to get anywhere.  I am a hands on learner, and want your opinion on how to learn it quickly. ",,False,self,t5_2qp8q,False,,,True,t3_ntqsq,http://www.reddit.com/r/SQL/comments/ntqsq/sql_noob_have_a_training_question/,
1324944201.0,1,self.SQL,nrmw9,Apostrophes in a string literal on Azure SQL.,snyper7,1,0,7,http://www.reddit.com/r/SQL/comments/nrmw9/apostrophes_in_a_string_literal_on_azure_sql/,"I'm trying to insert a string containing an apostrophe into a table in an Azure SQL database. I want to insert ""committee's"" and I've tried:

* 'committee''s'

* 'committee' &amp; chr(39) &amp; 's'

The first parsed correctly but produced a bunch of other (seemingly unrelated) errors in the script and the second complained about not knowing what the ""chr"" function is. Anyone encounter something similar? Thanks!",,False,self,t5_2qp8q,False,,,True,t3_nrmw9,http://www.reddit.com/r/SQL/comments/nrmw9/apostrophes_in_a_string_literal_on_azure_sql/,
1323709502.0,1,use-the-index-luke.com,n9sw2,Indexing GROUP BY,gthank,2,1,0,http://www.reddit.com/r/SQL/comments/n9sw2/indexing_group_by/,,,False,default,t5_2qp8q,False,,,False,t3_n9sw2,http://use-the-index-luke.com/sql/sorting-grouping/indexed-group-by,
1321400058.0,1,self.SQL,mdoo5,MS SQL Server 2008 r2 questions. (fail-over cluster),gadorp,1,0,0,http://www.reddit.com/r/SQL/comments/mdoo5/ms_sql_server_2008_r2_questions_failover_cluster/,"I used to work at a place where 'all I did' was create web-tools for the intranet, create and maintain databases and the occasional hardware/software configuration and tweaking. The company had a higher-tier of IT on the other side of the country for dealing with the nitty gritty of our environment.

I now have a job where I've taken on a hell of a lot more responsibility in a smaller company. (More rewarding, less of an automaton, blah blah blah) I am now almost entirely responsible for the configuration (both hardware and software) of almost all of the database and web servers (a few racks with between 4 and 8 servers each, SAN, VMs, etc, almost all new hardware) I run into problems fairly frequently and haven't had a full weekend-off in about 6 months. It'll get better... I hope.

My setup is basically:

Two VMs of the MS SQL 2008 r2 variety. (each 3GHz, 4GB RAM, 2x250GB LUNs from the SAN. each on a different physical server.) The main database for the web-app is approximately 50 tables, ~10 of which have between 300,000 and 600,000 records with 10-20 columns, almost none of which have more than a 50-character limit. It's not the largest database I've ever dealt with, but I've never dealt with MS SQL intimately before this job. (I mainly dealt with a bunch of MySQL stuff about 1/10 this size and complexity)

Two VMs running IIS 7.5 serving the ASP.NET front-end.

The SQL servers are in a failover cluster, as are the web servers. The web servers have never really been an issue.

My main issue/question is this: About every 4-6 days, the SQL server hosting the actual ""SQL Server"" service becomes bogged down (timeouts here and there, slow resulting, etc) and I switch from A to B, (or B to A whatever the case may be) and all's well for a few more days.

Obviously, his just doesn't work, especially if I have to bump people off for a few seconds every couple of days.

I've checked logs there isn't any single proc or view giving more grief than any other. Ive optimized the more complex stored procedures and views as much as I can. Nothing has helped in any noticeable way.

I guess what I'm asking is, is there something more I need to be doing to keep this from being bogged-down and having to switch from server to server? Is there some way to share the load all the time? Tips/tricks I should be trying?

Any help or advice is greatly appreciated.",,False,self,t5_2qp8q,False,,,True,t3_mdoo5,http://www.reddit.com/r/SQL/comments/mdoo5/ms_sql_server_2008_r2_questions_failover_cluster/,
1318014148.0,1,self.SQL,l4eld,need to know the size of a column in data base table,,2,1,11,http://www.reddit.com/r/SQL/comments/l4eld/need_to_know_the_size_of_a_column_in_data_base/,"I have a database with following schema: rtl_item_tbl { NetName : text reader_list : text } Now in a row, NetName would never be NULL but ""reader_list"" could be NULL. So I want to calculate the contribution of ""readers_list"" into db-size. Does anyone have any idea, about how to do this ?",,False,self,t5_2qp8q,False,,,True,t3_l4eld,http://www.reddit.com/r/SQL/comments/l4eld/need_to_know_the_size_of_a_column_in_data_base/,
1317935444.0,1,microsoft.com,l3f1l,Service Pack 3 for SQL Server 2008 released,venzann,1,0,0,http://www.reddit.com/r/SQL/comments/l3f1l/service_pack_3_for_sql_server_2008_released/,,,False,default,t5_2qp8q,False,,,False,t3_l3f1l,http://www.microsoft.com/download/en/details.aspx?id=27594,
1317240155.0,1,self.SQL,kufn1,How to delete entities involved in relationships when the relationships are deleted?,mussorsky,1,0,5,http://www.reddit.com/r/SQL/comments/kufn1/how_to_delete_entities_involved_in_relationships/,"I have an entity called photo and an entity called photo and an entity called album.

They are connected by the relationship photo_belongs.

If an album is deleted it cascades to photo_belongs and deletes that row from the relationship table using:

    foreign key (album_id)
        references album
        on delete cascade);

However I am looking for a way to also delete the photo when the album is deleted, since a photo must belong to an album.  Currently we are considering adding the album_id into photo_id so it can reference it but that seems like it is using more space than is necessary.  

If I haven't provided enough information please ask.  Any help is greatly appreciated.",,False,self,t5_2qp8q,False,,,True,t3_kufn1,http://www.reddit.com/r/SQL/comments/kufn1/how_to_delete_entities_involved_in_relationships/,
1317215991.0,1,self.SQL,ku1sh,Comparing 5 date columns,DrTrunks,1,0,12,http://www.reddit.com/r/SQL/comments/ku1sh/comparing_5_date_columns/,"First of all lets say I'm new to SQL, but I'm a quick learner.
I have 3 columns from table 1 and 2 columns from table2 and i need to make 2 comparisons. I want to make sure the data is the same (in the example it is).


table|Start time|End time|(date)|appointment_id
|:------------:|:------------:|:------------:|:------------:|:------------:|
table 1|08:00:00|09:00:00|31-10-2011|5476
table 2|31-10-11 8:00|31-10-11 9:00|null|5476


As you can see the data is formatted differently but they are all data fields and I'd rather keep them this way (not building a string).
I've tried adding the data together in table 1 but it messes up the output or I'm doing it wrong: select column1 + column3, column2 + column 3 ect. I would rather not split the data in table 2 to match it in table 2 (keep it simple).

I would like to see if it matches in an extra column, but I've never written a function before that's why I'm trying to filter out the mismatches. ",,False,self,t5_2qp8q,True,,,True,t3_ku1sh,http://www.reddit.com/r/SQL/comments/ku1sh/comparing_5_date_columns/,
1317058252.0,1,self.SQL,ks05d,Materialized views with keys?,devilized,2,1,0,http://www.reddit.com/r/SQL/comments/ks05d/materialized_views_with_keys/,"So let's say I have a table with a bunch of alerts coming from various servers. Each alert has its own entry, even if it's a duplicate. I'm using some subqueries and joins to produce a dataset that gives me unique alerts, along with the information about the most recent details about a specific alert on a specific server, and the number of times that particular alert has appeared. If there are 15 alerts about a disk being full on a particular server, my query will return the most recent message along with a count result of 15.

That join takes a couple of seconds to run on about 300k rows. The number of rows I get from this query is roughly 15k (which means a lot of duplicate alerts). To cut down on resources used by people querying this information, I'd like to use a materialized view. 

However, I'd like to store some information around the alert sets (the rows I've retrieved from my join). After an update, the newest instance of a particular alert set will be retrieved by the join. Is there a way to add a primary key to the materialized view, that won't change during subsequent updates, so I can reference it within other tables?

Please let me know if you need further details or clarification, I feel like what I've written above might be confusing... 

Thanks!",,False,self,t5_2qp8q,False,,,True,t3_ks05d,http://www.reddit.com/r/SQL/comments/ks05d/materialized_views_with_keys/,
1316547244.0,1,self.SQL,klw8q,SSIS Package Configuration User Variable Assistance,MyVeryOwnTempAcct,1,0,1,http://www.reddit.com/r/SQL/comments/klw8q/ssis_package_configuration_user_variable/,"I'm trying to see if it is possible to set a path to a config file based on a User Variable.  Currently, I have set up a base config file that has the server path, and some database connections.  

i'd like to be able to extend this so other config files can be used, but not have to constantly create new Environmental variables or change the package.  Since my base path is in the base config file (path given in the Environmental Variable), can I use that when setting a user variable and then pass the user variable as the location of a config file?",,False,self,t5_2qp8q,False,,,True,t3_klw8q,http://www.reddit.com/r/SQL/comments/klw8q/ssis_package_configuration_user_variable/,
1316301641.0,1,self.SQL,kj21n,what does '%[%]%' the square brackets mean please help :(,princeofsin,1,0,0,http://www.reddit.com/r/SQL/comments/kj21n/what_does_the_square_brackets_mean_please_help/,"Hello reddit,

I got a book on beginning SQL joes 2 pros and the issue is what are the square brackets in this problem for. I will write down the part from the chapter and if someone can please explain it to me i will really appreciate it

We have a grant called ""K_Land fund trust"" with an actiual underscore in the name. We have other grants with underscores as well. How do you search for an underscore sign with a wildcard on each side? The ineffective query below gets all records that are at least one character long:

*Bad query*
[9/16/2011 12:08:09 PM] Attorney K: select *
[9/16/2011 12:11:03 PM] Attorney K: from [grant]
where grantname like '%_%'

we have 3 special characters and no literal percent sign. Again, we take the wild that you want to evaluate and put it inside square brackets. You see 3 grants having underscores in their names. In This example the square brackets tell SQL you are looking for literal underscore character.

Select *
From [Grant]
where grantname like '%[_]%'

Thank you reddit :)
",,False,self,t5_2qp8q,False,,,True,t3_kj21n,http://www.reddit.com/r/SQL/comments/kj21n/what_does_the_square_brackets_mean_please_help/,
1315015407.0,1,self.SQL,k34mh,Need help with SQL key violation,AwfulWaffle,2,1,3,http://www.reddit.com/r/SQL/comments/k34mh/need_help_with_sql_key_violation/,"Hi, Im working on a java game that requires a database and am wondering if someone can help me around an error Im getting but cant figure out.

The table is created with the following definition

* create table tblgames(GameID VARCHAR(255) Primary key, LastUpdate timestamp default current_time(), NextTurn Int references tblTeams(TeamID), Team1 Array, Team2 Array, Team3 Array, Team4 Array, GameOver Boolean default false, Winner VARCHAR(255) references tblPlayers(PlayerID));

Here is the statement that Im using. It works the first time with one gameid but then fails the second time when I try and create a second record.

* insert into tblgames (GameID, NextTurn, Team1, Team2, Team3, Team4, GameOver) values (?, 1, (0,0,0,0), (0,0,0,0), (0,0,0,0), (0,0,0,0), false);


And here is the error that Im receiving:

* org.h2.jdbc.JdbcSQLException: Unique index or primary key violation: ""CONSTRAINT_INDEX_3EF ON PUBLIC.TBLGAMES(GAMEOVER)""; SQL statement:
insert into tblgames (GameID, NextTurn, Team1, Team2, Team3, Team4, GameOver) values (?, 1, (0,0,0,0), (0,0,0,0), (0,0,0,0), (0,0,0,0), false); [23505-159]

Can anyone help me see the error that is causing me to only be able to create 1 record successfully?",,False,self,t5_2qp8q,False,,,True,t3_k34mh,http://www.reddit.com/r/SQL/comments/k34mh/need_help_with_sql_key_violation/,
1313619972.0,1,self.SQL,jm34w,SQL stupid question: finding text with any case ,CreamyKnougat,2,1,0,http://www.reddit.com/r/SQL/comments/jm34w/sql_stupid_question_finding_text_with_any_case/,"How can I query a field to return content regardless of case? What I mean is, I have a field that is filled with different variations of 'Yes' and 'No' ('YES', 'Yes', 'NO', 'no', etc...you get the idea).

In the query:
    
    select free_lunch
    from student
    where free_lunch = 'YES'


only the 'YES' content will show up. How do I query so that all cases show up?

This is in Oracle 11g, if that makes a difference. Thank you
",,False,self,t5_2qp8q,False,,,True,t3_jm34w,http://www.reddit.com/r/SQL/comments/jm34w/sql_stupid_question_finding_text_with_any_case/,
1311889427.0,1,self.SQL,j2lcu,A little help please.   ,EyeBoz,1,0,0,http://www.reddit.com/r/SQL/comments/j2lcu/a_little_help_please/,"I work at an Eye Bank and Cornea Research Center.

After unplugging all of the electronics in the lab to move them due to a water leak, my computer and slit-lamp are having problems communicating.  

It reads...

Winstation Error
Failed to open Winstation database.
Reason&gt;&gt; SQL Server does not exist or access denied.
ConnectionOpen (Connect()).

Please Contact OIS tech. support!




I don't know if it's the exclamation mark or frugality, but I don't want to call them.  Any advice would be very much appreciated.  

Thank you in advance.   :)",,False,self,t5_2qp8q,False,,,True,t3_j2lcu,http://www.reddit.com/r/SQL/comments/j2lcu/a_little_help_please/,
1311306812.0,1,self.SQL,iwi1k,I managed to land a technical interview for a job I'd love to have.  Can you think of what SQL questions you'd want to ask an applicant?,joehouse,1,0,0,http://www.reddit.com/r/SQL/comments/iwi1k/i_managed_to_land_a_technical_interview_for_a_job/,"So following are some of the requirements.  I'll just focus on the SQL related ones.

* Development and maintenance of custom SQL reports, clinical note
templates, immunization compliance configuration, and web portal
content and configuration.
* User training and user support, including troubleshooting and escalation
to vendor. Participate in user group and maintain currency with upcoming
software developments.
* Administration of setup tables for practice management, clinical data,
users, providers, and system-wide configuration. Support for lab and EKG
interfaces and peripheral devices.
* Provides support for specialized software/data installation,
configuration and planning. Investigates and analyzes various specialized
computing options and solutions.
* Stays informed of new developments and technologies by reading
journals and other pertinent publications, maintaining contact with
vendors, and participating in professional organizations, meetings and
seminars.
* Researches, gathers, organizes and summarizes data for reports.
Analyzes data for trends or conclusions and presents results and
recommendations to supervisor.
* Provides expert consulting services in specialized areas such as
specialized software, critical computer/networked systems, data
access/analysis, and/or academic research.

So what questions would you have for someone with a SQL background with such a vague job description?

Everything being said I feel pretty confident about the technical interview.  I just don't want to screw up on something I may not have thought about or just plain CHOKE.
",,False,self,t5_2qp8q,False,,,True,t3_iwi1k,http://www.reddit.com/r/SQL/comments/iwi1k/i_managed_to_land_a_technical_interview_for_a_job/,
1311203214.0,1,self.SQL,iva91,Ideas for joining the contents of a reporting services field in the table footer?,ITAndrew,2,1,2,http://www.reddit.com/r/SQL/comments/iva91/ideas_for_joining_the_contents_of_a_reporting/,"Does anyone have any ideas on how this could be done? 

If the query behind my report is:

    SELECT '1' AS NUMBER    UNION
    SELECT '2'
    UNION
    SELECT '3'

A textbox in the details section of the report would have Fields!NUMBER.Value, and I would like a text-box in the table footer to have all values of the field joined, for the above example ""123"".

The query behind this is much more complex than I've described above, so I'm trying to stay away from copying and modifying the query to join all values of the field in SQL.

I'd really appreciate any ideas.",,False,self,t5_2qp8q,False,,,True,t3_iva91,http://www.reddit.com/r/SQL/comments/iva91/ideas_for_joining_the_contents_of_a_reporting/,
1311184159.0,1,self.SQL,iv0ho,Need help with a cloned VM Server 2008 w/MSSQL 2008,ignathius,1,0,4,http://www.reddit.com/r/SQL/comments/iv0ho/need_help_with_a_cloned_vm_server_2008_wmssql_2008/,"We wanted to setup a test environment for someone so they could hammer on a DB without affecting the production DB. We found some instructions on cloning a Hyper-V VM, and it seemed to work. However, when ever data is entered into the new test server DB, it's also showing up on the production server DB as well. Is there something in either MSSQL or perhaps the software that's entering the data that we're missing that's having it enter data into both servers DBs?

Also, someone mentioned setting up a destructive testing database instead of cloning the VM. We've done some searching, but can't seem to come up with anything on setting up a destructive testing database. Anyone have any more info on this approach?

TIA",,False,self,t5_2qp8q,False,,,True,t3_iv0ho,http://www.reddit.com/r/SQL/comments/iv0ho/need_help_with_a_cloned_vm_server_2008_wmssql_2008/,
1310937939.0,1,self.SQL,is99l,SQL Beginner's Guide?,,1,0,0,http://www.reddit.com/r/SQL/comments/is99l/sql_beginners_guide/,"Hello!

I'm surprised this subreddit has so few subscribers! Anywho. I'm in a database management class, and the professor can be a bit difficult to follow. Is there a particular resource that anyone would recommend for learning SQL fundamentals? Any help would be awesome.

Thanks",,False,self,t5_2qp8q,False,,,True,t3_is99l,http://www.reddit.com/r/SQL/comments/is99l/sql_beginners_guide/,
1309885159.0,1,self.SQL,ihasu,"I need to learn SQL to get a permanent job at my college, whats the best book to help get me started?",magnumuser,1,0,0,http://www.reddit.com/r/SQL/comments/ihasu/i_need_to_learn_sql_to_get_a_permanent_job_at_my/,I already have sql servers for dummies and read through it about 5 times but I need more information and practice. ,,False,self,t5_2qp8q,False,,,True,t3_ihasu,http://www.reddit.com/r/SQL/comments/ihasu/i_need_to_learn_sql_to_get_a_permanent_job_at_my/,
1309333374.0,1,self.SQL,ic45y,InfoPath help,,1,0,2,http://www.reddit.com/r/SQL/comments/ic45y/infopath_help/,"My supervisor instructed me to create a search for a username and the information for that user, through infopath. All this information is stored in a sql database, which I was able to link to InfoPath. 

Can anyone give me a few tips/hints as to how to create multiple fields/views for when creating a search field for a specified username?

Thanks in advance :)",,False,self,t5_2qp8q,False,,,True,t3_ic45y,http://www.reddit.com/r/SQL/comments/ic45y/infopath_help/,
1308748116.0,1,self.SQL,i65t9,SQL query with two tables question.,aaneton,2,1,4,http://www.reddit.com/r/SQL/comments/i65t9/sql_query_with_two_tables_question/,"I have to tables in a oracle database, it's an old DB for a custom software in our company that is a mess and I just want data out of it.One table is called feature and the other feature_link.


Here are the tables and columns (only listing the once concerning this problem)

Feature:
---------
fnumber
name

Example:
    fnumber     name
    10            potato
    20            carrot
    30            apple


Feature_link:
--------------
f_feature_number
to_feature number

Example:
    f_feature_number     to_feature_number
    10                   20
    10                   30
    20                   10

So I gotten this far:


SELECT feature_link.F_FEATURE_NUMBER, feature.NAME, feature_link.TO_F_FEATURE_NUMBER
FROM feature, feature_link
WHERE (feature_link.F_FEATURE_NUMBER = feature.FNUMBER)


Gives the output
    f_feature_number name    to_feature_number
    10               potato  20
    10               potato  30
    20               carrot  10 


I want to find the name matching also the to_feature_number field, how can I accomplish this?

End result should look like this:
    f_feature_number name    to_feature_number  to_name
    10               potato  20                 carrot                 
    10               potato  30                 apple
    20               carrot  10                 potato

Any advice? all my subquery attempts have failed.
",,False,self,t5_2qp8q,False,,,True,t3_i65t9,http://www.reddit.com/r/SQL/comments/i65t9/sql_query_with_two_tables_question/,
1308589205.0,1,self.SQL,i4gez,Query database to find partial match?,Philip1209,1,0,2,http://www.reddit.com/r/SQL/comments/i4gez/query_database_to_find_partial_match/,"I need to set up an alias database to go from a name to a unique id and I am trying to figure out a way to structure the table so that it is scalable (e.g. don't have to keep adding columns). I'm thinking of an auto-incremented column with the ID then a  blob field with aliases. In my search function I need a way to identify a match of a substring. Do you have any advice on how to do this? I'm having trouble writing a query that would work. 

The table isn't terribly large, so efficiency isn't a major concern, and it is safe to assume that search queries will not have matches in multiple rows.",,False,self,t5_2qp8q,False,,,True,t3_i4gez,http://www.reddit.com/r/SQL/comments/i4gez/query_database_to_find_partial_match/,
1307703022.0,1,self.SQL,hwabg,Importing .SQL file to mysql 5.5 community server (X-post from /r/database),hungoverbunny,2,1,2,http://www.reddit.com/r/SQL/comments/hwabg/importing_sql_file_to_mysql_55_community_server/,complete noob here just wondering how you would import a database file into a MySQL database....i have an empty database created and I have a previous database file copied over...i just want to know how to go about doing this if someone could post a guide or point me to one... I've tried this command but doesnt seem to work for me/not sure if its the one i need mysqldump -u USER -pPASSWORD DATABASE &gt; filename.sql,,False,self,t5_2qp8q,False,,,True,t3_hwabg,http://www.reddit.com/r/SQL/comments/hwabg/importing_sql_file_to_mysql_55_community_server/,
1307552839.0,1,self.SQL,hur7g,"Trigger - after import or after commit, NOT on each row.  Oracle 10g",MisterFlibble,2,1,3,http://www.reddit.com/r/SQL/comments/hur7g/trigger_after_import_or_after_commit_not_on_each/,"So I've built an intranet page for users to update a table with information one item at a time, and have a trigger that sanitizes the data (runs a procedure that makes sure there's no duplicates and makes sure the 'reason code' they use applies to the item they add, etc).

Recently, they've been having to send long lists of items to me so I can import them to the table.  Before importing, I have to disable the trigger because the procedure wants to run after every row is inserted despite my trigger not specifying ""ON EACH ROW""

Does anyone know of a way I can build this trigger to have the procedure only run when I import these Excel sheets into the database using TOAD?

example:

    CREATE OR REPLACE TRIGGER clean_up_items
    AFTER /*(COMMIT or IMPORT)*/
    ON items_table 
    DISABLE
    begin
    schema.pkg_clean_items.p_run_all;
    END;
    /",,False,self,t5_2qp8q,False,,,True,t3_hur7g,http://www.reddit.com/r/SQL/comments/hur7g/trigger_after_import_or_after_commit_not_on_each/,
1306625232.0,1,self.SQL,hmibu,First time with a query this complex - any help appreciated,lukes386,1,0,0,http://www.reddit.com/r/SQL/comments/hmibu/first_time_with_a_query_this_complex_any_help/,"I don't have a lot of experience with SQL beyond your basic SELECT and INSERT queries, and the one I'm trying to put together now is a real doosie.

There are five tables involved: Jobs, Users, Occupations, Fields, and Expertises.

Jobs have foreign keys ""customer_id"" (points to user), ""employee_id"" (also points to user), and ""field_id"".

Users contains all of the application's users, both customers and employees (people can be both)

Occupations have foreign keys ""user_id"", ""field_id"", and ""expertise_id"".

Expertises have an integer ""rank"" field. 

What I'm trying to do is return all of the jobs an employee (user) is qualified for. This means all jobs that have been assigned to them already (job.employee_id = current_user.id), and jobs that have not been assigned to anyone yet (job.employee_id IS NULL). The second case (jobs not yet assigned) also requires that the employee have at least one occupation in that job's field, and if the job's customer (user pointed to by job.customer_id) also has an occupation in that same field, the employee must have a higher ranked expertise in that field. 

Like I said, I don't have a lot of experience with SQL, and my tongue ges twisted just trying to say the requirements in English. I'm sure this isn't overly complicated for someone who actually knows what they're doing, so if any of you could give me some pointers I'd be very appreciative. 

**EDIT**: I'm not sure if it matters, but I'm using both SQLite and Postgres.",,False,self,t5_2qp8q,True,,,True,t3_hmibu,http://www.reddit.com/r/SQL/comments/hmibu/first_time_with_a_query_this_complex_any_help/,
